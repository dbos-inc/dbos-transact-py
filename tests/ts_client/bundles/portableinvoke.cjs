var H8=Object.create;var nf=Object.defineProperty;var Y8=Object.getOwnPropertyDescriptor;var z8=Object.getOwnPropertyNames;var K8=Object.getPrototypeOf,Q8=Object.prototype.hasOwnProperty;var Q=(t,e)=>()=>(t&&(e=t(t=0)),e);var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),J8=(t,e)=>{for(var r in e)nf(t,r,{get:e[r],enumerable:!0})},EN=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of z8(e))!Q8.call(t,s)&&s!==r&&nf(t,s,{get:()=>e[s],enumerable:!(n=Y8(e,s))||n.enumerable});return t};var X8=(t,e,r)=>(r=t!=null?H8(K8(t)):{},EN(e||!t||!t.__esModule?nf(r,"default",{value:t,enumerable:!0}):r,t)),B=t=>EN(nf({},"__esModule",{value:!0}),t);var dr=p(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.getDBOSErrorCode=Y.DBOSInvalidQueuePriorityError=Y.DBOSQueueDuplicatedError=Y.QueueDedupIDDuplicated=Y.DBOSAwaitedWorkflowCancelledError=Y.DBOSUnexpectedStepError=Y.DBOSConflictingRegistrationError=Y.DBOSWorkflowCancelledError=Y.DBOSMaxStepRetriesError=Y.DBOSConflictingWorkflowError=Y.DBOSInvalidWorkflowTransitionError=Y.DBOSExecutorNotInitializedError=Y.DBOSMaxRecoveryAttemptsExceededError=Y.DBOSFailLoadOperationsError=Y.DBOSNonExistentWorkflowError=Y.DBOSConfigKeyTypeError=Y.DBOSNotAuthorizedError=Y.DBOSDataValidationError=Y.DBOSNotRegisteredError=Y.DBOSWorkflowConflictError=Y.DBOSInitializationError=Y.DBOSError=Y.isDataValidationError=void 0;function Z8(t){let e=t?.dbosErrorCode;return e?e===gN:!1}Y.isDataValidationError=Z8;var Fe=class extends Error{dbosErrorCode;constructor(e,r=1){super(e),this.dbosErrorCode=r}};Y.DBOSError=Fe;var eK=3,eE=class extends Fe{error;constructor(e,r){super(e,eK),this.error=r}};Y.DBOSInitializationError=eE;var tK=5,tE=class extends Fe{constructor(e){super(`Conflicting WF ID ${e}`,tK)}};Y.DBOSWorkflowConflictError=tE;var rK=6,rE=class extends Fe{constructor(e,r){let n=r??`Operation (Name: ${e}) not registered`;super(n,rK)}};Y.DBOSNotRegisteredError=rE;var gN=9,nE=class extends Fe{constructor(e){super(e,gN)}};Y.DBOSDataValidationError=nE;var nK=12,iE=class extends Fe{status;constructor(e,r=403){super(e,nK),this.status=r}};Y.DBOSNotAuthorizedError=iE;var iK=14,oE=class extends Fe{constructor(e,r,n){super(`${e} should be of type ${r}, but got ${n}`,iK)}};Y.DBOSConfigKeyTypeError=oE;var oK=16,sE=class extends Fe{constructor(e){super(e,oK)}};Y.DBOSNonExistentWorkflowError=sE;var sK=17,aE=class extends Fe{constructor(e){super(e,sK)}};Y.DBOSFailLoadOperationsError=aE;var aK=18,uE=class extends Fe{constructor(e,r){super(`Workflow ${e} has exceeded its maximum of ${r} execution or recovery attempts. Further attempts to execute or recover it will fail.`,aK)}};Y.DBOSMaxRecoveryAttemptsExceededError=uE;var uK=20,lE=class extends Fe{constructor(){super("DBOS not initialized",uK)}};Y.DBOSExecutorNotInitializedError=lE;var lK=21,cE=class extends Fe{constructor(e){super(e??"Invalid workflow state",lK)}};Y.DBOSInvalidWorkflowTransitionError=cE;var cK=22,fE=class extends Fe{constructor(e,r){super(`Conflicting workflow invocation with the same ID (${e}): ${r}`,cK)}};Y.DBOSConflictingWorkflowError=fE;var fK=23,dE=class extends Fe{errors;constructor(e,r,n){let s=n.map((a,o)=>`Error ${o+1}: ${a.message}`).join(". ");super(`Step ${e} has exceeded its maximum of ${r} retries. Previous errors: ${s}`,fK),this.errors=n}};Y.DBOSMaxStepRetriesError=dE;var dK=24,pE=class extends Fe{workflowID;constructor(e){super(`Workflow ${e} has been cancelled`,dK),this.workflowID=e}};Y.DBOSWorkflowCancelledError=pE;var pK=25,hE=class extends Fe{constructor(e){super(e,pK)}};Y.DBOSConflictingRegistrationError=hE;var hK=26,_E=class extends Fe{workflowID;stepID;expectedName;constructor(e,r,n,s){super(s.startsWith("DBOS.patch")?`During execution of workflow ${e} step ${r}, function ${s} was recorded when ${n} was expected.

          Check that your patches are backward compatible, that you do not have older code trying to recover workflows with newer patches, and that your workflow is deterministic.`:`During execution of workflow ${e} step ${r}, function ${s} was recorded when ${n} was expected. Check that your workflow is deterministic.`,hK),this.workflowID=e,this.stepID=r,this.expectedName=n}};Y.DBOSUnexpectedStepError=_E;var _K=27,mE=class extends Fe{workflowID;constructor(e){super(`Awaited ${e} was cancelled`,_K),this.workflowID=e}};Y.DBOSAwaitedWorkflowCancelledError=mE;Y.QueueDedupIDDuplicated=28;var SE=class extends Fe{workflowID;queue;deduplicationID;constructor(e,r,n){super(`Workflow ${e} was deduplicated due to an existing workflow in queue ${r} with deduplication ID ${n}.`,Y.QueueDedupIDDuplicated),this.workflowID=e,this.queue=r,this.deduplicationID=n}};Y.DBOSQueueDuplicatedError=SE;var mK=29,EE=class extends Fe{priority;min;max;constructor(e,r,n){super(`Invalid priority ${e}. Priority must be between ${r} and ${n}.`,mK),this.priority=e,this.min=r,this.max=n}};Y.DBOSInvalidQueuePriorityError=EE;function SK(t){if(t&&typeof t=="object"&&"dbosErrorCode"in t){let e=t.dbosErrorCode;return typeof e=="number"?e:void 0}}Y.getDBOSErrorCode=SK});var of=p((Cwe,yN)=>{"use strict";var gE=class t extends Error{constructor(e){super(t._prepareSuperMessage(e)),Object.defineProperty(this,"name",{value:"NonError",configurable:!0,writable:!0}),Error.captureStackTrace&&Error.captureStackTrace(this,t)}static _prepareSuperMessage(e){try{return JSON.stringify(e)}catch{return String(e)}}},EK=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],yE=Symbol(".toJSON called"),gK=t=>{t[yE]=!0;let e=t.toJSON();return delete t[yE],e},TE=({from:t,seen:e,to_:r,forceEnumerable:n,maxDepth:s,depth:a})=>{let o=r||(Array.isArray(t)?[]:{});if(e.push(t),a>=s)return o;if(typeof t.toJSON=="function"&&t[yE]!==!0)return gK(t);for(let[i,u]of Object.entries(t)){if(typeof Buffer=="function"&&Buffer.isBuffer(u)){o[i]="[object Buffer]";continue}if(typeof u!="function"){if(!u||typeof u!="object"){o[i]=u;continue}if(!e.includes(t[i])){a++,o[i]=TE({from:t[i],seen:e.slice(),forceEnumerable:n,maxDepth:s,depth:a});continue}o[i]="[Circular]"}}for(let{property:i,enumerable:u}of EK)typeof t[i]=="string"&&Object.defineProperty(o,i,{value:t[i],enumerable:n?!0:u,configurable:!0,writable:!0});return o},yK=(t,e={})=>{let{maxDepth:r=Number.POSITIVE_INFINITY}=e;return typeof t=="object"&&t!==null?TE({from:t,seen:[],forceEnumerable:!0,maxDepth:r,depth:0}):typeof t=="function"?`[Function: ${t.name||"anonymous"}]`:t},TK=(t,e={})=>{let{maxDepth:r=Number.POSITIVE_INFINITY}=e;if(t instanceof Error)return t;if(typeof t=="object"&&t!==null&&!Array.isArray(t)){let n=new Error;return TE({from:t,seen:[],to_:n,maxDepth:r,depth:0}),n}return new gE(t)};yN.exports={serializeError:yK,deserializeError:TK}});var TN=p(sf=>{"use strict";sf.__esModule=!0;sf.DoubleIndexedKV=void 0;var wK=(function(){function t(){this.keyToValue=new Map,this.valueToKey=new Map}return t.prototype.set=function(e,r){this.keyToValue.set(e,r),this.valueToKey.set(r,e)},t.prototype.getByKey=function(e){return this.keyToValue.get(e)},t.prototype.getByValue=function(e){return this.valueToKey.get(e)},t.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},t})();sf.DoubleIndexedKV=wK});var wE=p(af=>{"use strict";af.__esModule=!0;af.Registry=void 0;var OK=TN(),vK=(function(){function t(e){this.generateIdentifier=e,this.kv=new OK.DoubleIndexedKV}return t.prototype.register=function(e,r){this.kv.getByValue(e)||(r||(r=this.generateIdentifier(e)),this.kv.set(r,e))},t.prototype.clear=function(){this.kv.clear()},t.prototype.getIdentifier=function(e){return this.kv.getByValue(e)},t.prototype.getValue=function(e){return this.kv.getByKey(e)},t})();af.Registry=vK});var wN=p(Ko=>{"use strict";var bK=Ko&&Ko.__extends||(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})();Ko.__esModule=!0;Ko.ClassRegistry=void 0;var AK=wE(),RK=(function(t){bK(e,t);function e(){var r=t.call(this,function(n){return n.name})||this;return r.classToAllowedProps=new Map,r}return e.prototype.register=function(r,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(r,n.allowProps),t.prototype.register.call(this,r,n.identifier)):t.prototype.register.call(this,r,n)},e.prototype.getAllowedProps=function(r){return this.classToAllowedProps.get(r)},e})(AK.Registry);Ko.ClassRegistry=RK});var pu=p(pr=>{"use strict";var NK=pr&&pr.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a};pr.__esModule=!0;pr.findArr=pr.includes=pr.forEach=pr.find=void 0;function PK(t){if("values"in Object)return Object.values(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e}function IK(t,e){var r=PK(t);if("find"in r)return r.find(e);for(var n=r,s=0;s<n.length;s++){var a=n[s];if(e(a))return a}}pr.find=IK;function MK(t,e){Object.entries(t).forEach(function(r){var n=NK(r,2),s=n[0],a=n[1];return e(a,s)})}pr.forEach=MK;function LK(t,e){return t.indexOf(e)!==-1}pr.includes=LK;function CK(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e(n))return n}}pr.findArr=CK});var ON=p(uf=>{"use strict";uf.__esModule=!0;uf.CustomTransformerRegistry=void 0;var DK=pu(),xK=(function(){function t(){this.transfomers={}}return t.prototype.register=function(e){this.transfomers[e.name]=e},t.prototype.findApplicable=function(e){return DK.find(this.transfomers,function(r){return r.isApplicable(e)})},t.prototype.findByName=function(e){return this.transfomers[e]},t})();uf.CustomTransformerRegistry=xK});var lf=p(z=>{"use strict";z.__esModule=!0;z.isURL=z.isTypedArray=z.isInfinite=z.isBigint=z.isPrimitive=z.isNaNValue=z.isError=z.isDate=z.isSymbol=z.isSet=z.isMap=z.isRegExp=z.isBoolean=z.isNumber=z.isString=z.isArray=z.isEmptyObject=z.isPlainObject=z.isNull=z.isUndefined=void 0;var UK=function(t){return Object.prototype.toString.call(t).slice(8,-1)},kK=function(t){return typeof t>"u"};z.isUndefined=kK;var BK=function(t){return t===null};z.isNull=BK;var qK=function(t){return typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:Object.getPrototypeOf(t)===Object.prototype};z.isPlainObject=qK;var VK=function(t){return z.isPlainObject(t)&&Object.keys(t).length===0};z.isEmptyObject=VK;var FK=function(t){return Array.isArray(t)};z.isArray=FK;var $K=function(t){return typeof t=="string"};z.isString=$K;var GK=function(t){return typeof t=="number"&&!isNaN(t)};z.isNumber=GK;var WK=function(t){return typeof t=="boolean"};z.isBoolean=WK;var jK=function(t){return t instanceof RegExp};z.isRegExp=jK;var HK=function(t){return t instanceof Map};z.isMap=HK;var YK=function(t){return t instanceof Set};z.isSet=YK;var zK=function(t){return UK(t)==="Symbol"};z.isSymbol=zK;var KK=function(t){return t instanceof Date&&!isNaN(t.valueOf())};z.isDate=KK;var QK=function(t){return t instanceof Error};z.isError=QK;var JK=function(t){return typeof t=="number"&&isNaN(t)};z.isNaNValue=JK;var XK=function(t){return z.isBoolean(t)||z.isNull(t)||z.isUndefined(t)||z.isNumber(t)||z.isString(t)||z.isSymbol(t)};z.isPrimitive=XK;var ZK=function(t){return typeof t=="bigint"};z.isBigint=ZK;var e9=function(t){return t===1/0||t===-1/0};z.isInfinite=e9;var t9=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)};z.isTypedArray=t9;var r9=function(t){return t instanceof URL};z.isURL=r9});var OE=p(yn=>{"use strict";yn.__esModule=!0;yn.parsePath=yn.stringifyPath=yn.escapeKey=void 0;var n9=function(t){return t.replace(/\./g,"\\.")};yn.escapeKey=n9;var i9=function(t){return t.map(String).map(yn.escapeKey).join(".")};yn.stringifyPath=i9;var o9=function(t){for(var e=[],r="",n=0;n<t.length;n++){var s=t.charAt(n),a=s==="\\"&&t.charAt(n+1)===".";if(a){r+=".",n++;continue}var o=s===".";if(o){e.push(r),r="";continue}r+=s}var i=r;return e.push(i),e};yn.parsePath=o9});var LN=p(kt=>{"use strict";var vE=kt&&kt.__assign||function(){return vE=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},vE.apply(this,arguments)},bE=kt&&kt.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},AE=kt&&kt.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t};kt.__esModule=!0;kt.untransformValue=kt.transformValue=kt.isInstanceOfRegisteredClass=void 0;var Ut=lf(),vN=pu();function zr(t,e,r,n){return{isApplicable:t,annotation:e,transform:r,untransform:n}}var bN=[zr(Ut.isUndefined,"undefined",function(){return null},function(){}),zr(Ut.isBigint,"bigint",function(t){return t.toString()},function(t){return typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)}),zr(Ut.isDate,"Date",function(t){return t.toISOString()},function(t){return new Date(t)}),zr(Ut.isError,"Error",function(t,e){var r={name:t.name,message:t.message};return e.allowedErrorProps.forEach(function(n){r[n]=t[n]}),r},function(t,e){var r=new Error(t.message);return r.name=t.name,r.stack=t.stack,e.allowedErrorProps.forEach(function(n){r[n]=t[n]}),r}),zr(Ut.isRegExp,"regexp",function(t){return""+t},function(t){var e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}),zr(Ut.isSet,"set",function(t){return AE([],bE(t.values()))},function(t){return new Set(t)}),zr(Ut.isMap,"map",function(t){return AE([],bE(t.entries()))},function(t){return new Map(t)}),zr(function(t){return Ut.isNaNValue(t)||Ut.isInfinite(t)},"number",function(t){return Ut.isNaNValue(t)?"NaN":t>0?"Infinity":"-Infinity"},Number),zr(function(t){return t===0&&1/t===-1/0},"number",function(){return"-0"},Number),zr(Ut.isURL,"URL",function(t){return t.toString()},function(t){return new URL(t)})];function cf(t,e,r,n){return{isApplicable:t,annotation:e,transform:r,untransform:n}}var AN=cf(function(t,e){if(Ut.isSymbol(t)){var r=!!e.symbolRegistry.getIdentifier(t);return r}return!1},function(t,e){var r=e.symbolRegistry.getIdentifier(t);return["symbol",r]},function(t){return t.description},function(t,e,r){var n=r.symbolRegistry.getValue(e[1]);if(!n)throw new Error("Trying to deserialize unknown symbol");return n}),s9=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(t,e){return t[e.name]=e,t},{}),RN=cf(Ut.isTypedArray,function(t){return["typed-array",t.constructor.name]},function(t){return AE([],bE(t))},function(t,e){var r=s9[e[1]];if(!r)throw new Error("Trying to deserialize unknown typed array");return new r(t)});function NN(t,e){if(t?.constructor){var r=!!e.classRegistry.getIdentifier(t.constructor);return r}return!1}kt.isInstanceOfRegisteredClass=NN;var PN=cf(NN,function(t,e){var r=e.classRegistry.getIdentifier(t.constructor);return["class",r]},function(t,e){var r=e.classRegistry.getAllowedProps(t.constructor);if(!r)return vE({},t);var n={};return r.forEach(function(s){n[s]=t[s]}),n},function(t,e,r){var n=r.classRegistry.getValue(e[1]);if(!n)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(n.prototype),t)}),IN=cf(function(t,e){return!!e.customTransformerRegistry.findApplicable(t)},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return["custom",r.name]},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return r.serialize(t)},function(t,e,r){var n=r.customTransformerRegistry.findByName(e[1]);if(!n)throw new Error("Trying to deserialize unknown custom value");return n.deserialize(t)}),a9=[PN,AN,IN,RN],u9=function(t,e){var r=vN.findArr(a9,function(s){return s.isApplicable(t,e)});if(r)return{value:r.transform(t,e),type:r.annotation(t,e)};var n=vN.findArr(bN,function(s){return s.isApplicable(t,e)});if(n)return{value:n.transform(t,e),type:n.annotation}};kt.transformValue=u9;var MN={};bN.forEach(function(t){MN[t.annotation]=t});var l9=function(t,e,r){if(Ut.isArray(e))switch(e[0]){case"symbol":return AN.untransform(t,e,r);case"class":return PN.untransform(t,e,r);case"custom":return IN.untransform(t,e,r);case"typed-array":return RN.untransform(t,e,r);default:throw new Error("Unknown transformation: "+e)}else{var n=MN[e];if(!n)throw new Error("Unknown transformation: "+e);return n.untransform(t,r)}};kt.untransformValue=l9});var DN=p(Jo=>{"use strict";Jo.__esModule=!0;Jo.setDeep=Jo.getDeep=void 0;var Kr=lf(),RE=pu(),Qo=function(t,e){for(var r=t.keys();e>0;)r.next(),e--;return r.next().value};function CN(t){if(RE.includes(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(RE.includes(t,"prototype"))throw new Error("prototype is not allowed as a property");if(RE.includes(t,"constructor"))throw new Error("constructor is not allowed as a property")}var c9=function(t,e){CN(e);for(var r=0;r<e.length;r++){var n=e[r];if(Kr.isSet(t))t=Qo(t,+n);else if(Kr.isMap(t)){var s=+n,a=+e[++r]==0?"key":"value",o=Qo(t,s);switch(a){case"key":t=o;break;case"value":t=t.get(o);break}}else t=t[n]}return t};Jo.getDeep=c9;var f9=function(t,e,r){if(CN(e),e.length===0)return r(t);for(var n=t,s=0;s<e.length-1;s++){var a=e[s];if(Kr.isArray(n)){var o=+a;n=n[o]}else if(Kr.isPlainObject(n))n=n[a];else if(Kr.isSet(n)){var i=+a;n=Qo(n,i)}else if(Kr.isMap(n)){var u=s===e.length-2;if(u)break;var i=+a,l=+e[++s]==0?"key":"value",c=Qo(n,i);switch(l){case"key":n=c;break;case"value":n=n.get(c);break}}}var f=e[e.length-1];if(Kr.isArray(n)?n[+f]=r(n[+f]):Kr.isPlainObject(n)&&(n[f]=r(n[f])),Kr.isSet(n)){var h=Qo(n,+f),S=r(h);h!==S&&(n.delete(h),n.add(S))}if(Kr.isMap(n)){var i=+e[e.length-2],g=Qo(n,i),l=+f==0?"key":"value";switch(l){case"key":{var E=r(g);n.set(E,n.get(g)),E!==g&&n.delete(g);break}case"value":{n.set(g,r(n.get(g)));break}}}return t};Jo.setDeep=f9});var xN=p(Mt=>{"use strict";var Tn=Mt&&Mt.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Hn=Mt&&Mt.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t};Mt.__esModule=!0;Mt.walker=Mt.generateReferentialEqualityAnnotations=Mt.applyReferentialEqualityAnnotations=Mt.applyValueAnnotations=void 0;var tr=lf(),ff=OE(),pf=LN(),Fi=pu(),hu=OE(),df=DN();function NE(t,e,r){if(r===void 0&&(r=[]),!!t){if(!tr.isArray(t)){Fi.forEach(t,function(o,i){return NE(o,e,Hn(Hn([],Tn(r)),Tn(hu.parsePath(i))))});return}var n=Tn(t,2),s=n[0],a=n[1];a&&Fi.forEach(a,function(o,i){NE(o,e,Hn(Hn([],Tn(r)),Tn(hu.parsePath(i))))}),e(s,r)}}function d9(t,e,r){return NE(e,function(n,s){t=df.setDeep(t,s,function(a){return pf.untransformValue(a,n,r)})}),t}Mt.applyValueAnnotations=d9;function p9(t,e){function r(o,i){var u=df.getDeep(t,hu.parsePath(i));o.map(hu.parsePath).forEach(function(l){t=df.setDeep(t,l,function(){return u})})}if(tr.isArray(e)){var n=Tn(e,2),s=n[0],a=n[1];s.forEach(function(o){t=df.setDeep(t,hu.parsePath(o),function(){return t})}),a&&Fi.forEach(a,r)}else Fi.forEach(e,r);return t}Mt.applyReferentialEqualityAnnotations=p9;var h9=function(t,e){return tr.isPlainObject(t)||tr.isArray(t)||tr.isMap(t)||tr.isSet(t)||pf.isInstanceOfRegisteredClass(t,e)};function _9(t,e,r){var n=r.get(t);n?n.push(e):r.set(t,[e])}function m9(t,e){var r={},n=void 0;return t.forEach(function(s){if(!(s.length<=1)){e||(s=s.map(function(u){return u.map(String)}).sort(function(u,l){return u.length-l.length}));var a=Tn(s),o=a[0],i=a.slice(1);o.length===0?n=i.map(ff.stringifyPath):r[ff.stringifyPath(o)]=i.map(ff.stringifyPath)}}),n?tr.isEmptyObject(r)?[n]:[n,r]:tr.isEmptyObject(r)?void 0:r}Mt.generateReferentialEqualityAnnotations=m9;var S9=function(t,e,r,n,s,a,o){var i;s===void 0&&(s=[]),a===void 0&&(a=[]),o===void 0&&(o=new Map);var u=tr.isPrimitive(t);if(!u){_9(t,s,e);var l=o.get(t);if(l)return n?{transformedValue:null}:l}if(!h9(t,r)){var c=pf.transformValue(t,r),f=c?{transformedValue:c.value,annotations:[c.type]}:{transformedValue:t};return u||o.set(t,f),f}if(Fi.includes(a,t))return{transformedValue:null};var h=pf.transformValue(t,r),S=(i=h?.value)!==null&&i!==void 0?i:t,g=tr.isArray(S)?[]:{},E={};Fi.forEach(S,function(O,v){var b=Mt.walker(O,e,r,n,Hn(Hn([],Tn(s)),[v]),Hn(Hn([],Tn(a)),[t]),o);g[v]=b.transformedValue,tr.isArray(b.annotations)?E[v]=b.annotations:tr.isPlainObject(b.annotations)&&Fi.forEach(b.annotations,function(N,I){E[ff.escapeKey(v)+"."+I]=N})});var T=tr.isEmptyObject(E)?{transformedValue:g,annotations:h?[h.type]:void 0}:{transformedValue:g,annotations:h?[h.type,E]:E};return u||o.set(t,T),T};Mt.walker=S9});var FN=p(ie=>{"use strict";function Be(t){return Object.prototype.toString.call(t).slice(8,-1)}function UN(t){return Be(t)==="Object"}function PE(t){return Be(t)==="Array"}function E9(t){return Be(t)==="Blob"}function kN(t){return Be(t)==="Boolean"}function g9(t){return Be(t)==="Date"&&!isNaN(t)}function y9(t){return PE(t)&&t.length===0}function hf(t){if(Be(t)!=="Object")return!1;let e=Object.getPrototypeOf(t);return!!e&&e.constructor===Object&&e===Object.prototype}function T9(t){return hf(t)&&Object.keys(t).length===0}function w9(t){return t===""}function O9(t){return Be(t)==="Error"||t instanceof Error}function v9(t){return Be(t)==="File"}function b9(t){return PE(t)&&t.length>0}function A9(t){return hf(t)&&Object.keys(t).length>0}function IE(t){return Be(t)==="String"}function R9(t){return IE(t)&&t!==""}function N9(t){return typeof t=="function"}function BN(t,e){if(!(e instanceof Function))throw new TypeError("Type must be a function");if(!Object.prototype.hasOwnProperty.call(e,"prototype"))throw new TypeError("Type is not a class");let r=e.name;return Be(t)===r||!!(t&&t.constructor===e)}function P9(t,e){if(typeof e=="function"){for(let r=t;r;r=Object.getPrototypeOf(r))if(BN(r,e))return!0;return!1}else{for(let r=t;r;r=Object.getPrototypeOf(r))if(Be(r)===e)return!0;return!1}}function I9(t){return Be(t)==="Map"}function M9(t){return Be(t)==="Number"&&isNaN(t)}function _f(t){return Be(t)==="Number"&&!isNaN(t)}function L9(t){return _f(t)&&t<0}function ME(t){return Be(t)==="Null"}function qN(t,e,r,n,s){return a=>t(a)||e(a)||!!r&&r(a)||!!n&&n(a)||!!s&&s(a)}function LE(t){return Be(t)==="Undefined"}var C9=qN(ME,LE);function D9(t){return hf(t)}function x9(t){return UN(t)}function U9(t){return _f(t)&&t>0}function VN(t){return Be(t)==="Symbol"}function k9(t){return kN(t)||ME(t)||LE(t)||_f(t)||IE(t)||VN(t)}function B9(t){return Be(t)==="Promise"}function q9(t){return Be(t)==="RegExp"}function V9(t){return Be(t)==="Set"}function F9(t){return Be(t)==="WeakMap"}function $9(t){return Be(t)==="WeakSet"}ie.getType=Be;ie.isAnyObject=UN;ie.isArray=PE;ie.isBlob=E9;ie.isBoolean=kN;ie.isDate=g9;ie.isEmptyArray=y9;ie.isEmptyObject=T9;ie.isEmptyString=w9;ie.isError=O9;ie.isFile=v9;ie.isFullArray=b9;ie.isFullObject=A9;ie.isFullString=R9;ie.isFunction=N9;ie.isInstanceOf=P9;ie.isMap=I9;ie.isNaNValue=M9;ie.isNegativeNumber=L9;ie.isNull=ME;ie.isNullOrUndefined=C9;ie.isNumber=_f;ie.isObject=D9;ie.isObjectLike=x9;ie.isOneOf=qN;ie.isPlainObject=hf;ie.isPositiveNumber=U9;ie.isPrimitive=k9;ie.isPromise=B9;ie.isRegExp=q9;ie.isSet=V9;ie.isString=IE;ie.isSymbol=VN;ie.isType=BN;ie.isUndefined=LE;ie.isWeakMap=F9;ie.isWeakSet=$9});var GN=p($N=>{"use strict";var CE=FN();function G9(t,e,r,n,s){let a={}.propertyIsEnumerable.call(n,e)?"enumerable":"nonenumerable";a==="enumerable"&&(t[e]=r),s&&a==="nonenumerable"&&Object.defineProperty(t,e,{value:r,enumerable:!1,writable:!0,configurable:!0})}function DE(t,e={}){if(CE.isArray(t))return t.map(s=>DE(s,e));if(!CE.isPlainObject(t))return t;let r=Object.getOwnPropertyNames(t),n=Object.getOwnPropertySymbols(t);return[...r,...n].reduce((s,a)=>{if(CE.isArray(e.props)&&!e.props.includes(a))return s;let o=t[a],i=DE(o,e);return G9(s,a,i,t,e.nonenumerable),s},{})}$N.copy=DE});var WN=p(be=>{"use strict";var $i=be&&be.__assign||function(){return $i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},$i.apply(this,arguments)},W9=be&&be.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},j9=be&&be.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t};be.__esModule=!0;be.allowErrorProps=be.registerSymbol=be.registerCustom=be.registerClass=be.parse=be.stringify=be.deserialize=be.serialize=be.SuperJSON=void 0;var H9=wN(),Y9=wE(),z9=ON(),mf=xN(),K9=GN(),Qr=(function(){function t(e){var r=e===void 0?{}:e,n=r.dedupe,s=n===void 0?!1:n;this.classRegistry=new H9.ClassRegistry,this.symbolRegistry=new Y9.Registry(function(a){var o;return(o=a.description)!==null&&o!==void 0?o:""}),this.customTransformerRegistry=new z9.CustomTransformerRegistry,this.allowedErrorProps=[],this.dedupe=s}return t.prototype.serialize=function(e){var r=new Map,n=mf.walker(e,r,this,this.dedupe),s={json:n.transformedValue};n.annotations&&(s.meta=$i($i({},s.meta),{values:n.annotations}));var a=mf.generateReferentialEqualityAnnotations(r,this.dedupe);return a&&(s.meta=$i($i({},s.meta),{referentialEqualities:a})),s},t.prototype.deserialize=function(e){var r=e.json,n=e.meta,s=K9.copy(r);return n?.values&&(s=mf.applyValueAnnotations(s,n.values,this)),n?.referentialEqualities&&(s=mf.applyReferentialEqualityAnnotations(s,n.referentialEqualities)),s},t.prototype.stringify=function(e){return JSON.stringify(this.serialize(e))},t.prototype.parse=function(e){return this.deserialize(JSON.parse(e))},t.prototype.registerClass=function(e,r){this.classRegistry.register(e,r)},t.prototype.registerSymbol=function(e,r){this.symbolRegistry.register(e,r)},t.prototype.registerCustom=function(e,r){this.customTransformerRegistry.register($i({name:r},e))},t.prototype.allowErrorProps=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];(e=this.allowedErrorProps).push.apply(e,j9([],W9(r)))},t.defaultInstance=new t,t.serialize=t.defaultInstance.serialize.bind(t.defaultInstance),t.deserialize=t.defaultInstance.deserialize.bind(t.defaultInstance),t.stringify=t.defaultInstance.stringify.bind(t.defaultInstance),t.parse=t.defaultInstance.parse.bind(t.defaultInstance),t.registerClass=t.defaultInstance.registerClass.bind(t.defaultInstance),t.registerSymbol=t.defaultInstance.registerSymbol.bind(t.defaultInstance),t.registerCustom=t.defaultInstance.registerCustom.bind(t.defaultInstance),t.allowErrorProps=t.defaultInstance.allowErrorProps.bind(t.defaultInstance),t})();be.SuperJSON=Qr;be.default=Qr;be.serialize=Qr.serialize;be.deserialize=Qr.deserialize;be.stringify=Qr.stringify;be.parse=Qr.parse;be.registerClass=Qr.registerClass;be.registerCustom=Qr.registerCustom;be.registerSymbol=Qr.registerSymbol;be.allowErrorProps=Qr.allowErrorProps});var jN=p(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.PortableWorkflowError=void 0;var xE=class extends Error{name;code;data;constructor(e,r,n,s){super(e),this.name=r,this.code=n,this.data=s}};Sf.PortableWorkflowError=xE});var wn=p(M=>{"use strict";var Q9=M&&M.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(M,"__esModule",{value:!0});M.serializeResErrorWithSerializer=M.serializeResError=M.serializeArgs=M.serializeValue=M.safeParseError=M.safeParsePositionalArgs=M.safeParse=M.deserializeResError=M.deserializePositionalArgs=M.deserializeValue=M.serializeFunctionInputOutputWithSerializer=M.serializeFunctionInputOutput=M.DBOSPortableJSON=M.DBOSJSON=M.SERIALIZER_MARKER_VALUE=M.SERIALIZER_MARKER_KEY=M.DBOSJSONLegacy=M.DBOSReviver=M.DBOSReplacer=M.registerSerializationRecipe=void 0;var Ef=of(),kE=Q9(WN()),J9=jN();function zN(t){kE.default.registerCustom(t,t.name)}M.registerSerializationRecipe=zN;zN({isApplicable:t=>Buffer.isBuffer(t),serialize:t=>Array.from(t),deserialize:t=>Buffer.from(t),name:"Buffer"});function KN(t,e){let r=this[t];return r instanceof Date?{dbos_type:"dbos_Date",dbos_data:r.toISOString()}:typeof r=="bigint"?{dbos_type:"dbos_BigInt",dbos_data:r.toString()}:e}M.DBOSReplacer=KN;function X9(t){return typeof t=="object"&&t!==null&&t.type==="Buffer"}function Z9(t){return typeof t=="object"&&t!==null&&t.dbos_type==="dbos_Date"}function eQ(t){return typeof t=="object"&&t!==null&&t.dbos_type==="dbos_BigInt"}function QN(t,e){switch(!0){case X9(e):return Buffer.from(e.data);case Z9(e):return new Date(Date.parse(e.dbos_data));case eQ(e):return BigInt(e.dbos_data);default:return e}}M.DBOSReviver=QN;M.DBOSJSONLegacy={name:()=>"js_legacy",parse:t=>t===null?null:JSON.parse(t,QN),stringify:t=>JSON.stringify(t,KN)};M.SERIALIZER_MARKER_KEY="__dbos_serializer";M.SERIALIZER_MARKER_VALUE="superjson";var tQ=`"${M.SERIALIZER_MARKER_KEY}":"${M.SERIALIZER_MARKER_VALUE}"`;function rQ(t){return typeof t=="object"&&t!==null&&M.SERIALIZER_MARKER_KEY in t&&t[M.SERIALIZER_MARKER_KEY]===M.SERIALIZER_MARKER_VALUE&&"json"in t}function nQ(t){let e=kE.default.serialize(t);return JSON.stringify({...e,[M.SERIALIZER_MARKER_KEY]:M.SERIALIZER_MARKER_VALUE})}M.DBOSJSON={name:()=>"js_superjson",parse:t=>{if(t==null)return null;if(t.includes(tQ)){let r=JSON.parse(t);if(rQ(r))return kE.default.deserialize(r)}return M.DBOSJSONLegacy.parse(t)},stringify:nQ};function iQ(t,e){if(e instanceof Date)return e.toISOString();if(typeof e=="bigint")return e.toString(10);if(e instanceof Map){let r=!0;for(let s of e.keys())if(typeof s!="string"){r=!1;break}if(!r)throw new TypeError("Attempt to do portable JSON serialization of a map with non-string keys");let n={};for(let[s,a]of e.entries())n[s]=a;return n}return e instanceof Set?Array.from(e.values()):e instanceof Error?{name:e.name,message:e.message}:e}M.DBOSPortableJSON={name:()=>"portable_json",parse:t=>t===null?null:JSON.parse(t),stringify:t=>JSON.stringify(t,iQ)};function oQ(t,e=[],r,n){let s=n==="portable"?M.DBOSPortableJSON.name():n==="native"?M.DBOSJSON.name():r.name();return JN(t,e,r,s)}M.serializeFunctionInputOutput=oQ;function JN(t,e=[],r,n){for(let i of[M.DBOSPortableJSON,M.DBOSJSON])if(n===i.name()){let u=i.stringify(t),l=i.parse(u);return YN(l)&&HN(t,l,e),{deserialized:l,stringified:u,sername:i.name()}}let s=r.name();if(n&&n!==s)throw new TypeError(`Serializer provided (${s}) is not compatible with the required serialization (${n})`);let a=r.stringify(t),o=r.parse(a);return r.name()===M.DBOSJSON.name()&&YN(o)&&HN(t,o,e),{deserialized:o,stringified:a,sername:s}}M.serializeFunctionInputOutputWithSerializer=JN;function HN(t,e,r=[]){let n=new WeakSet,s=[{o:t,d:e,p:r}];for(;s.length;){let{o:a,d:o,p:i}=s.pop();if(!n.has(a)){n.add(a);for(let u of aQ(a))u in o||sQ(o,u,i);for(let u of XN(a))try{let l=a[u],c=o[u];if(!UE(l,c))continue;s.push({o:l,d:c,p:[...i,u]})}catch{}if(a instanceof Map&&o instanceof Map)for(let[u,l]of a){let c=o.get(u);if(UE(l,c)){let f=lQ(u)?String(u):"[MapValue]";s.push({o:l,d:c,p:[...i,f]})}}if(a instanceof Set&&o instanceof Set){let u=Array.from(a),l=Array.from(o);for(let c=0;c<Math.min(u.length,l.length);c++){let f=u[c],h=l[c];UE(f,h)&&s.push({o:f,d:h,p:[...i,c]})}}}}}function YN(t){return typeof t=="object"&&t!==null||typeof t=="function"}function sQ(t,e,r){let n=function(...s){throw new Error(`Attempted to call '${String(e)}' at path ${uQ(r)} on an object that is a serialized function input our output value. Functions are not preserved through serialization; see 'DBOS.registerSerialization'. `)};try{Object.defineProperty(t,e,{value:n,configurable:!0,writable:!1,enumerable:!1})}catch{t[e]=n}}function UE(t,e){return!(!t||!e||typeof t!="object"||typeof e!="object"||[Date,RegExp,WeakMap,WeakSet,ArrayBuffer,DataView].some(n=>t instanceof n))}function XN(t){let e=Object.getOwnPropertyNames(t),r=Object.getOwnPropertySymbols(t);return[...e,...r]}function aQ(t){let e=new Set;for(let n of XN(t)){let s=Object.getOwnPropertyDescriptor(t,n);s&&"value"in s&&typeof s.value=="function"&&e.add(n)}let r=Object.getPrototypeOf(t);for(;r&&r!==Object.prototype;){for(let n of Object.getOwnPropertyNames(r)){if(n==="constructor")continue;let s=Object.getOwnPropertyDescriptor(r,n);s&&"value"in s&&typeof s.value=="function"&&e.add(n)}r=Object.getPrototypeOf(r)}return Array.from(e)}function uQ(t){return t.length===0?"(root)":t.map(e=>typeof e=="number"?`[${e}]`:typeof e=="symbol"?`[${String(e)}]`:/^<?[A-Za-z_$][A-Za-z0-9_$]*>?$/.test(e)?`.${e}`:`[${JSON.stringify(e)}]`).join("").replace(/^\./,"")}function lQ(t){return typeof t=="string"||typeof t=="number"}function ZN(t,e,r){if(e===M.DBOSPortableJSON.name())return M.DBOSPortableJSON.parse(t);if(e===M.DBOSJSON.name())return M.DBOSJSON.parse(t);if(!e||e===r.name())return r.parse(t);throw new TypeError(`Value deserialization type ${e} is not available`)}M.deserializeValue=ZN;function eP(t,e,r){if(e===M.DBOSPortableJSON.name())return M.DBOSPortableJSON.parse(t).positionalArgs??[];if(e===M.DBOSJSON.name())return M.DBOSJSON.parse(t);if(!e||e===r.name())return r.parse(t);throw new TypeError(`Value deserialization type ${e} is not available`)}M.deserializePositionalArgs=eP;function tP(t,e,r){if(e===M.DBOSPortableJSON.name()){let n=M.DBOSPortableJSON.parse(t);throw new J9.PortableWorkflowError(n.message,n.name,n.code,n.data)}if(e===M.DBOSJSON.name())return(0,Ef.deserializeError)(M.DBOSJSON.parse(t));if(!e||e===r.name())return(0,Ef.deserializeError)(r.parse(t));throw new TypeError(`Value deserialization type ${e} is not available`)}M.deserializeResError=tP;function cQ(t,e,r){try{return ZN(e,r,t)}catch{return e}}M.safeParse=cQ;function fQ(t,e,r){try{return eP(e,r,t)}catch{return e}}M.safeParsePositionalArgs=fQ;function dQ(t,e,r){try{return tP(e,r,t)}catch{return new Error(e)}}M.safeParseError=dQ;function pQ(t,e,r){return r==="portable"?{serializedValue:M.DBOSPortableJSON.stringify(t),serialization:M.DBOSPortableJSON.name()}:r==="native"?{serializedValue:M.DBOSJSON.stringify(t),serialization:M.DBOSJSON.name()}:{serializedValue:e.stringify(t),serialization:e.name()}}M.serializeValue=pQ;function hQ(t,e,r,n){if(n==="portable")return{serializedValue:M.DBOSPortableJSON.stringify({positionalArgs:t,namedArgs:e}),serialization:M.DBOSPortableJSON.name()};if(e)throw new TypeError(`Serialization format '${n}' does not currently support named args.`);return n==="native"?{serializedValue:M.DBOSJSON.stringify(t),serialization:M.DBOSJSON.name()}:{serializedValue:r.stringify(t),serialization:r.name()}}M.serializeArgs=hQ;function _Q(t,e,r){let n=r==="portable"?M.DBOSPortableJSON.name():r==="native"?M.DBOSJSON.name():e.name();return rP(t,e,n)}M.serializeResError=_Q;function rP(t,e,r){return r===M.DBOSPortableJSON.name()?{serializedValue:M.DBOSPortableJSON.stringify({name:t.name,message:t.message,code:t.code,data:t.data}),serialization:M.DBOSPortableJSON.name()}:r===M.DBOSJSON.name()?{serializedValue:M.DBOSJSON.stringify((0,Ef.serializeError)(t)),serialization:M.DBOSJSON.name()}:{serializedValue:e.stringify((0,Ef.serializeError)(t)),serialization:e.name()}}M.serializeResErrorWithSerializer=rP});var Xo=p(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.RetrievedHandle=Bt.InvokedHandle=Bt.isWorkflowActive=Bt.StatusString=Bt.DEFAULT_MAX_RECOVERY_ATTEMPTS=void 0;var BE=wn(),gf=mu(),mQ=Gi();Bt.DEFAULT_MAX_RECOVERY_ATTEMPTS=100;Bt.StatusString={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR",MAX_RECOVERY_ATTEMPTS_EXCEEDED:"MAX_RECOVERY_ATTEMPTS_EXCEEDED",CANCELLED:"CANCELLED",ENQUEUED:"ENQUEUED"};function SQ(t){return t===Bt.StatusString.PENDING||t===Bt.StatusString.ENQUEUED}Bt.isWorkflowActive=SQ;var yf=class{systemDatabase;workflowPromise;workflowUUID;workflowName;constructor(e,r,n,s){this.systemDatabase=e,this.workflowPromise=r,this.workflowUUID=n,this.workflowName=s}getWorkflowUUID(){return this.workflowUUID}get workflowID(){return this.workflowUUID}async getStatus(){return await gf.DBOS.getWorkflowStatus(this.workflowUUID)}async getResult(e){return await(0,gf.runInternalStep)(async()=>await this.workflowPromise,"DBOS.getResult",this.workflowUUID,e)}async getWorkflowInputs(){let e=await this.systemDatabase.getWorkflowStatus(this.workflowUUID);return(0,BE.deserializePositionalArgs)(e.input,e.serialization,this.systemDatabase.getSerializer())}};Bt.InvokedHandle=yf;var _u=class{systemDatabase;workflowUUID;constructor(e,r){this.systemDatabase=e,this.workflowUUID=r}getWorkflowUUID(){return this.workflowUUID}get workflowID(){return this.workflowUUID}async getStatus(){return await gf.DBOS.getWorkflowStatus(this.workflowUUID)}async getResult(e){return await gf.DBOS.getResultInternal(this.workflowUUID,void 0,void 0,e)}async getWorkflowInputs(){let e=await this.systemDatabase.getWorkflowStatus(this.workflowUUID);return(0,BE.deserializePositionalArgs)(e.input,e.serialization,this.systemDatabase.getSerializer())}};Bt.RetrievedHandle=_u;(0,BE.registerSerializationRecipe)({name:"DBOS.WorkflowHandle",isApplicable:t=>t instanceof _u||t instanceof yf,serialize:t=>({wfid:t.workflowID}),deserialize:t=>new _u(mQ.DBOSExecutor.globalInstance.systemDatabase,t.wfid)})});var nP=p(Tf=>{"use strict";Object.defineProperty(Tf,"__esModule",{value:!0});Tf.TelemetryCollector=void 0;var qE=class{data=[];push(e){this.data.push(e)}pop(){return this.data.shift()}size(){return this.data.length}},VE=class{exporter;signals=new qE;signalBufferID;processAndExportSignalsIntervalMs=100;constructor(e){this.exporter=e,this.signalBufferID=setInterval(()=>{this.processAndExportSignals()},this.processAndExportSignalsIntervalMs)}async destroy(){clearInterval(this.signalBufferID),await this.processAndExportSignals(),await this.exporter?.flush()}push(e){this.signals.push(e)}pop(){return this.signals.pop()}async processAndExportSignals(){let e=[];for(;this.signals.size()>0;){let r=this.pop();if(!r)break;e.push(r)}if(e.length>0&&this.exporter)try{await this.exporter.export(e)}catch(r){console.error(r.message)}}};Tf.TelemetryCollector=VE});var gt=p(Le=>{"use strict";var iP=Le&&Le.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Le,"__esModule",{value:!0});Le.getClientConfig=Le.interceptStreams=Le.exhaustiveCheckGuard=Le.cancellableSleep=Le.DEBOUNCER_WORKLOW_NAME=Le.INTERNAL_QUEUE_NAME=Le.sleepms=Le.globalParams=Le.defaultEnableOTLP=Le.readFile=void 0;var oP=iP(require("node:fs")),Zo=iP(require("node:path"));async function EQ(t,e="utf8"){return await oP.default.promises.readFile(t,{encoding:e})}Le.readFile=EQ;function gQ(){try{let t=function(n){if(typeof n=="string"&&(n.endsWith(Zo.default.sep)||(n+=Zo.default.sep),n=n.split(Zo.default.sep)),n.length===0)throw new Error("package.json not found in path");n.pop();let s=n.join(Zo.default.sep);return oP.default.existsSync(Zo.default.join(s,"package.json"))?s:t(n)},e=Zo.default.join(t(__dirname),"package.json");return require(e).version}catch{return"unknown"}}function sP(){return process.env.DBOS__CLOUD==="true"}Le.defaultEnableOTLP=sP;Le.globalParams={appVersion:process.env.DBOS__APPVERSION||"",wasComputed:!1,executorID:process.env.DBOS__VMID||"local",appID:process.env.DBOS__APPID||"",enableOTLP:sP(),dbosVersion:gQ()};var yQ=t=>new Promise(e=>setTimeout(e,t));Le.sleepms=yQ;Le.INTERNAL_QUEUE_NAME="_dbos_internal_queue";Le.DEBOUNCER_WORKLOW_NAME="_dbos_debouncer_workflow";function TQ(t){let e,r,n=!1;return{promise:new Promise(o=>{r=()=>{n||(n=!0,o(),e=void 0)},e=setTimeout(r,t)}),cancel:()=>{e&&(clearTimeout(e),e=void 0,r())}}}Le.cancellableSleep=TQ;function wQ(t){throw new Error("Exaustive matching is not applied")}Le.exhaustiveCheckGuard=wQ;var OQ=process.stdout.write.bind(process.stdout),vQ=process.stderr.write.bind(process.stderr);function bQ(t){let e=(r,n)=>(s,a,o)=>{let i=s.toString();return t(i,r),typeof a=="function"?n(s,a):n(s,a,o)};process.stdout.write=e("stdout",OQ),process.stderr.write=e("stderr",vQ)}Le.interceptStreams=bQ;function AQ(t){let e=typeof t=="string"?t:t.toString(),r=n(typeof t=="string"?new URL(t):t);return{connectionString:e,connectionTimeoutMillis:r?r*1e3:1e4};function n(s){try{let a=s.searchParams.get("connect_timeout");return a?Number.parseInt(a,10):void 0}catch{return}}}Le.getClientConfig=AQ});var aP,uP=Q(()=>{aP=typeof globalThis=="object"?globalThis:global});var lP=Q(()=>{uP()});var cP=Q(()=>{lP()});var On,FE=Q(()=>{On="1.8.0"});function RQ(t){var e=new Set([t]),r=new Set,n=t.match(fP);if(!n)return function(){return!1};var s={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(s.prerelease!=null)return function(u){return u===t};function a(i){return r.add(i),!1}function o(i){return e.add(i),!0}return function(u){if(e.has(u))return!0;if(r.has(u))return!1;var l=u.match(fP);if(!l)return a(u);var c={major:+l[1],minor:+l[2],patch:+l[3],prerelease:l[4]};return c.prerelease!=null||s.major!==c.major?a(u):s.major===0?s.minor===c.minor&&s.patch<=c.patch?o(u):a(u):s.minor<=c.minor?o(u):a(u)}}var fP,dP,pP=Q(()=>{FE();fP=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;dP=RQ(On)});function Jr(t,e,r,n){var s;n===void 0&&(n=!1);var a=Eu[Su]=(s=Eu[Su])!==null&&s!==void 0?s:{version:On};if(!n&&a[t]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(o.stack||o.message),!1}if(a.version!==On){var o=new Error("@opentelemetry/api: Registration of version v"+a.version+" for "+t+" does not match previously registered API v"+On);return r.error(o.stack||o.message),!1}return a[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+On+"."),!0}function rr(t){var e,r,n=(e=Eu[Su])===null||e===void 0?void 0:e.version;if(!(!n||!dP(n)))return(r=Eu[Su])===null||r===void 0?void 0:r[t]}function Xr(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+On+".");var r=Eu[Su];r&&delete r[t]}var NQ,Su,Eu,Wi=Q(()=>{cP();FE();pP();NQ=On.split(".")[0],Su=Symbol.for("opentelemetry.js.api."+NQ),Eu=aP});function gu(t,e,r){var n=rr("diag");if(n)return r.unshift(e),n[t].apply(n,IQ([],PQ(r),!1))}var PQ,IQ,hP,_P=Q(()=>{Wi();PQ=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},IQ=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))},hP=(function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return gu("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return gu("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return gu("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return gu("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return gu("verbose",this._namespace,e)},t})()});var pt,wf=Q(()=>{(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(pt||(pt={}))});function mP(t,e){t<pt.NONE?t=pt.NONE:t>pt.ALL&&(t=pt.ALL),e=e||{};function r(n,s){var a=e[n];return typeof a=="function"&&t>=s?a.bind(e):function(){}}return{error:r("error",pt.ERROR),warn:r("warn",pt.WARN),info:r("info",pt.INFO),debug:r("debug",pt.DEBUG),verbose:r("verbose",pt.VERBOSE)}}var SP=Q(()=>{wf()});var MQ,LQ,CQ,yt,ji=Q(()=>{_P();SP();wf();Wi();MQ=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},LQ=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))},CQ="diag",yt=(function(){function t(){function e(s){return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var i=rr("diag");if(i)return i[s].apply(i,LQ([],MQ(a),!1))}}var r=this,n=function(s,a){var o,i,u;if(a===void 0&&(a={logLevel:pt.INFO}),s===r){var l=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((o=l.stack)!==null&&o!==void 0?o:l.message),!1}typeof a=="number"&&(a={logLevel:a});var c=rr("diag"),f=mP((i=a.logLevel)!==null&&i!==void 0?i:pt.INFO,s);if(c&&!a.suppressOverrideMessage){var h=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";c.warn("Current logger will be overwritten from "+h),f.warn("Current logger will overwrite one already registered from "+h)}return Jr("diag",f,r,!0)};r.setLogger=n,r.disable=function(){Xr(CQ,r)},r.createComponentLogger=function(s){return new hP(s)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t})()});var DQ,xQ,EP,gP=Q(()=>{DQ=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},xQ=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},EP=(function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=DQ(e,2),n=r[0],s=r[1];return[n,s]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var a=new t(this._entries);try{for(var o=xQ(n),i=o.next();!i.done;i=o.next()){var u=i.value;a._entries.delete(u)}}catch(l){e={error:l}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return a},t.prototype.clear=function(){return new t},t})()});var yP,TP=Q(()=>{yP=Symbol("BaggageEntryMetadata")});function wP(t){return t===void 0&&(t={}),new EP(new Map(Object.entries(t)))}function OP(t){return typeof t!="string"&&(UQ.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:yP,toString:function(){return t}}}var UQ,$E=Q(()=>{ji();gP();TP();UQ=yt.instance()});function es(t){return Symbol.for(t)}var kQ,Of,yu=Q(()=>{kQ=(function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,s){var a=new t(r._currentContext);return a._currentContext.set(n,s),a},r.deleteValue=function(n){var s=new t(r._currentContext);return s._currentContext.delete(n),s}}return t})(),Of=new kQ});var GE,vP,bP=Q(()=>{GE=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],vP=(function(){function t(){function e(n){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];if(console){var o=console[n];if(typeof o!="function"&&(o=console.log),typeof o=="function")return o.apply(console,s)}}}for(var r=0;r<GE.length;r++)this[GE[r].n]=e(GE[r].c)}return t})()});function AP(){return HE}var ts,BQ,WE,qQ,VQ,FQ,jE,$Q,GQ,WQ,HE,jQ,HQ,YQ,zQ,KQ,QQ,YE=Q(()=>{ts=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),BQ=(function(){function t(){}return t.prototype.createHistogram=function(e,r){return HQ},t.prototype.createCounter=function(e,r){return jQ},t.prototype.createUpDownCounter=function(e,r){return YQ},t.prototype.createObservableGauge=function(e,r){return KQ},t.prototype.createObservableCounter=function(e,r){return zQ},t.prototype.createObservableUpDownCounter=function(e,r){return QQ},t.prototype.addBatchObservableCallback=function(e,r){},t.prototype.removeBatchObservableCallback=function(e){},t})(),WE=(function(){function t(){}return t})(),qQ=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e})(WE),VQ=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e})(WE),FQ=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e})(WE),jE=(function(){function t(){}return t.prototype.addCallback=function(e){},t.prototype.removeCallback=function(e){},t})(),$Q=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(jE),GQ=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(jE),WQ=(function(t){ts(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(jE),HE=new BQ,jQ=new qQ,HQ=new FQ,YQ=new VQ,zQ=new $Q,KQ=new GQ,QQ=new WQ});var vf,RP=Q(()=>{(function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"})(vf||(vf={}))});var bf,Af,zE=Q(()=>{bf={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},Af={set:function(t,e,r){t!=null&&(t[e]=r)}}});var JQ,XQ,NP,PP=Q(()=>{yu();JQ=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},XQ=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))},NP=(function(){function t(){}return t.prototype.active=function(){return Of},t.prototype.with=function(e,r,n){for(var s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return r.call.apply(r,XQ([n],JQ(s),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t})()});var ZQ,e7,KE,t7,Yn,Tu=Q(()=>{PP();Wi();ji();ZQ=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(i){o={error:i}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},e7=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))},KE="context",t7=new NP,Yn=(function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return Jr(KE,e,yt.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var s,a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];return(s=this._getContextManager()).with.apply(s,e7([e,r,n],ZQ(a),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return rr(KE)||t7},t.prototype.disable=function(){this._getContextManager().disable(),Xr(KE,yt.instance())},t})()});var rs,QE=Q(()=>{(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(rs||(rs={}))});var wu,Ou,Rf,Nf=Q(()=>{QE();wu="0000000000000000",Ou="00000000000000000000000000000000",Rf={traceId:Ou,spanId:wu,traceFlags:rs.NONE}});var zn,Pf=Q(()=>{Nf();zn=(function(){function t(e){e===void 0&&(e=Rf),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t})()});function If(t){return t.getValue(JE)||void 0}function IP(){return If(Yn.getInstance().active())}function vu(t,e){return t.setValue(JE,e)}function MP(t){return t.deleteValue(JE)}function LP(t,e){return vu(t,new zn(e))}function Mf(t){var e;return(e=If(t))===null||e===void 0?void 0:e.spanContext()}var JE,XE=Q(()=>{yu();Pf();Tu();JE=es("OpenTelemetry Context Key SPAN")});function ZE(t){return r7.test(t)&&t!==Ou}function eg(t){return n7.test(t)&&t!==wu}function ns(t){return ZE(t.traceId)&&eg(t.spanId)}function CP(t){return new zn(t)}var r7,n7,Lf=Q(()=>{Nf();Pf();r7=/^([0-9a-f]{32})$/i,n7=/^[0-9a-f]{16}$/i});function i7(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var tg,Cf,rg=Q(()=>{Tu();XE();Pf();Lf();tg=Yn.getInstance(),Cf=(function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=tg.active());var s=!!r?.root;if(s)return new zn;var a=n&&Mf(n);return i7(a)&&ns(a)?new zn(a):new zn},t.prototype.startActiveSpan=function(e,r,n,s){var a,o,i;if(!(arguments.length<2)){arguments.length===2?i=r:arguments.length===3?(a=r,i=n):(a=r,o=n,i=s);var u=o??tg.active(),l=this.startSpan(e,a,u),c=vu(u,l);return tg.with(c,i,void 0,l)}},t})()});var o7,Df,ng=Q(()=>{rg();o7=new Cf,Df=(function(){function t(e,r,n,s){this._provider=e,this.name=r,this.version=n,this.options=s}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,s){var a=this._getTracer();return Reflect.apply(a.startActiveSpan,a,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):o7},t})()});var DP,xP=Q(()=>{rg();DP=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new Cf},t})()});var s7,bu,ig=Q(()=>{ng();xP();s7=new DP,bu=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){var s;return(s=this.getDelegateTracer(e,r,n))!==null&&s!==void 0?s:new Df(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:s7},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(e,r,n)},t})()});var xf,UP=Q(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(xf||(xf={}))});var Uf,kP=Q(()=>{(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(Uf||(Uf={}))});var kf,BP=Q(()=>{(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(kf||(kf={}))});function qP(t){return l7.test(t)}function VP(t){return c7.test(t)&&!f7.test(t)}var og,a7,u7,l7,c7,f7,FP=Q(()=>{og="[_0-9a-z-*/]",a7="[a-z]"+og+"{0,255}",u7="[a-z0-9]"+og+"{0,240}@[a-z]"+og+"{0,13}",l7=new RegExp("^(?:"+a7+"|"+u7+")$"),c7=/^[ -~]{0,255}[!-~]$/,f7=/,|=/});var $P,d7,GP,WP,jP,HP=Q(()=>{FP();$P=32,d7=512,GP=",",WP="=",jP=(function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+WP+e.get(n)),r},[]).join(GP)},t.prototype._parse=function(e){e.length>d7||(this._internalState=e.split(GP).reverse().reduce(function(r,n){var s=n.trim(),a=s.indexOf(WP);if(a!==-1){var o=s.slice(0,a),i=s.slice(a+1,n.length);qP(o)&&VP(i)&&r.set(o,i)}return r},new Map),this._internalState.size>$P&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,$P))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t})()});function YP(t){return new jP(t)}var zP=Q(()=>{HP()});var sg,KP=Q(()=>{Tu();sg=Yn.getInstance()});var ag,QP=Q(()=>{ji();ag=yt.instance()});var p7,JP,XP=Q(()=>{YE();p7=(function(){function t(){}return t.prototype.getMeter=function(e,r,n){return HE},t})(),JP=new p7});var ug,ZP,eI=Q(()=>{XP();Wi();ji();ug="metrics",ZP=(function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(e){return Jr(ug,e,yt.instance())},t.prototype.getMeterProvider=function(){return rr(ug)||JP},t.prototype.getMeter=function(e,r,n){return this.getMeterProvider().getMeter(e,r,n)},t.prototype.disable=function(){Xr(ug,yt.instance())},t})()});var lg,tI=Q(()=>{eI();lg=ZP.getInstance()});var rI,nI=Q(()=>{rI=(function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t})()});function fg(t){return t.getValue(cg)||void 0}function iI(){return fg(Yn.getInstance().active())}function oI(t,e){return t.setValue(cg,e)}function sI(t){return t.deleteValue(cg)}var cg,aI=Q(()=>{Tu();yu();cg=es("OpenTelemetry Baggage Key")});var dg,h7,uI,lI=Q(()=>{Wi();nI();zE();aI();$E();ji();dg="propagation",h7=new rI,uI=(function(){function t(){this.createBaggage=wP,this.getBaggage=fg,this.getActiveBaggage=iI,this.setBaggage=oI,this.deleteBaggage=sI}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return Jr(dg,e,yt.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=Af),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=bf),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){Xr(dg,yt.instance())},t.prototype._getGlobalPropagator=function(){return rr(dg)||h7},t})()});var pg,cI=Q(()=>{lI();pg=uI.getInstance()});var hg,fI,dI=Q(()=>{Wi();ig();Lf();XE();ji();hg="trace",fI=(function(){function t(){this._proxyTracerProvider=new bu,this.wrapSpanContext=CP,this.isSpanContextValid=ns,this.deleteSpan=MP,this.getSpan=If,this.getActiveSpan=IP,this.getSpanContext=Mf,this.setSpan=vu,this.setSpanContext=LP}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=Jr(hg,this._proxyTracerProvider,yt.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return rr(hg)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){Xr(hg,yt.instance()),this._proxyTracerProvider=new bu},t})()});var _g,pI=Q(()=>{dI();_g=fI.getInstance()});var U={};J8(U,{DiagConsoleLogger:()=>vP,DiagLogLevel:()=>pt,INVALID_SPANID:()=>wu,INVALID_SPAN_CONTEXT:()=>Rf,INVALID_TRACEID:()=>Ou,ProxyTracer:()=>Df,ProxyTracerProvider:()=>bu,ROOT_CONTEXT:()=>Of,SamplingDecision:()=>xf,SpanKind:()=>Uf,SpanStatusCode:()=>kf,TraceFlags:()=>rs,ValueType:()=>vf,baggageEntryMetadataFromString:()=>OP,context:()=>sg,createContextKey:()=>es,createNoopMeter:()=>AP,createTraceState:()=>YP,default:()=>_7,defaultTextMapGetter:()=>bf,defaultTextMapSetter:()=>Af,diag:()=>ag,isSpanContextValid:()=>ns,isValidSpanId:()=>eg,isValidTraceId:()=>ZE,metrics:()=>lg,propagation:()=>pg,trace:()=>_g});var _7,k=Q(()=>{$E();yu();bP();wf();YE();RP();zE();ng();ig();UP();kP();BP();QE();zP();Lf();Nf();KP();QP();tI();cI();pI();_7={context:sg,diag:ag,metrics:lg,propagation:pg,trace:_g}});var Sg=p(Bf=>{"use strict";Object.defineProperty(Bf,"__esModule",{value:!0});Bf.AbstractAsyncHooksContextManager=void 0;var m7=require("events"),S7=["addListener","on","once","prependListener","prependOnceListener"],mg=class{bind(e,r){return r instanceof m7.EventEmitter?this._bindEventEmitter(e,r):typeof r=="function"?this._bindFunction(e,r):r}_bindFunction(e,r){let n=this,s=function(...a){return n.with(e,()=>r.apply(this,a))};return Object.defineProperty(s,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),s}_bindEventEmitter(e,r){return this._getPatchMap(r)!==void 0||(this._createPatchMap(r),S7.forEach(s=>{r[s]!==void 0&&(r[s]=this._patchAddListener(r,r[s],e))}),typeof r.removeListener=="function"&&(r.removeListener=this._patchRemoveListener(r,r.removeListener)),typeof r.off=="function"&&(r.off=this._patchRemoveListener(r,r.off)),typeof r.removeAllListeners=="function"&&(r.removeAllListeners=this._patchRemoveAllListeners(r,r.removeAllListeners))),r}_patchRemoveListener(e,r){let n=this;return function(s,a){let o=n._getPatchMap(e)?.[s];if(o===void 0)return r.call(this,s,a);let i=o.get(a);return r.call(this,s,i||a)}}_patchRemoveAllListeners(e,r){let n=this;return function(s){let a=n._getPatchMap(e);return a!==void 0&&(arguments.length===0?n._createPatchMap(e):a[s]!==void 0&&delete a[s]),r.apply(this,arguments)}}_patchAddListener(e,r,n){let s=this;return function(a,o){if(s._wrapped)return r.call(this,a,o);let i=s._getPatchMap(e);i===void 0&&(i=s._createPatchMap(e));let u=i[a];u===void 0&&(u=new WeakMap,i[a]=u);let l=s.bind(n,o);u.set(o,l),s._wrapped=!0;try{return r.call(this,a,l)}finally{s._wrapped=!1}}}_createPatchMap(e){let r=Object.create(null);return e[this._kOtListeners]=r,r}_getPatchMap(e){return e[this._kOtListeners]}_kOtListeners=Symbol("OtListeners");_wrapped=!1};Bf.AbstractAsyncHooksContextManager=mg});var hI=p(qf=>{"use strict";Object.defineProperty(qf,"__esModule",{value:!0});qf.AsyncHooksContextManager=void 0;var E7=(k(),B(U)),g7=require("async_hooks"),y7=Sg(),Eg=class extends y7.AbstractAsyncHooksContextManager{_asyncHook;_contexts=new Map;_stack=[];constructor(){super(),this._asyncHook=g7.createHook({init:this._init.bind(this),before:this._before.bind(this),after:this._after.bind(this),destroy:this._destroy.bind(this),promiseResolve:this._destroy.bind(this)})}active(){return this._stack[this._stack.length-1]??E7.ROOT_CONTEXT}with(e,r,n,...s){this._enterContext(e);try{return r.call(n,...s)}finally{this._exitContext()}}enable(){return this._asyncHook.enable(),this}disable(){return this._asyncHook.disable(),this._contexts.clear(),this._stack=[],this}_init(e,r){if(r==="TIMERWRAP")return;let n=this._stack[this._stack.length-1];n!==void 0&&this._contexts.set(e,n)}_destroy(e){this._contexts.delete(e)}_before(e){let r=this._contexts.get(e);r!==void 0&&this._enterContext(r)}_after(){this._exitContext()}_enterContext(e){this._stack.push(e)}_exitContext(){this._stack.pop()}};qf.AsyncHooksContextManager=Eg});var _I=p(Vf=>{"use strict";Object.defineProperty(Vf,"__esModule",{value:!0});Vf.AsyncLocalStorageContextManager=void 0;var T7=(k(),B(U)),w7=require("async_hooks"),O7=Sg(),gg=class extends O7.AbstractAsyncHooksContextManager{_asyncLocalStorage;constructor(){super(),this._asyncLocalStorage=new w7.AsyncLocalStorage}active(){return this._asyncLocalStorage.getStore()??T7.ROOT_CONTEXT}with(e,r,n,...s){let a=n==null?r:r.bind(n);return this._asyncLocalStorage.run(e,a,...s)}enable(){return this}disable(){return this._asyncLocalStorage.disable(),this}};Vf.AsyncLocalStorageContextManager=gg});var mI=p(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.AsyncLocalStorageContextManager=is.AsyncHooksContextManager=void 0;var v7=hI();Object.defineProperty(is,"AsyncHooksContextManager",{enumerable:!0,get:function(){return v7.AsyncHooksContextManager}});var b7=_I();Object.defineProperty(is,"AsyncLocalStorageContextManager",{enumerable:!0,get:function(){return b7.AsyncLocalStorageContextManager}})});var Au=p(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.isTracingSuppressed=Kn.unsuppressTracing=Kn.suppressTracing=void 0;var A7=(k(),B(U)),yg=(0,A7.createContextKey)("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function R7(t){return t.setValue(yg,!0)}Kn.suppressTracing=R7;function N7(t){return t.deleteValue(yg)}Kn.unsuppressTracing=N7;function P7(t){return t.getValue(yg)===!0}Kn.isTracingSuppressed=P7});var Tg=p(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.BAGGAGE_MAX_TOTAL_LENGTH=Tt.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=Tt.BAGGAGE_MAX_NAME_VALUE_PAIRS=Tt.BAGGAGE_HEADER=Tt.BAGGAGE_ITEMS_SEPARATOR=Tt.BAGGAGE_PROPERTIES_SEPARATOR=Tt.BAGGAGE_KEY_PAIR_SEPARATOR=void 0;Tt.BAGGAGE_KEY_PAIR_SEPARATOR="=";Tt.BAGGAGE_PROPERTIES_SEPARATOR=";";Tt.BAGGAGE_ITEMS_SEPARATOR=",";Tt.BAGGAGE_HEADER="baggage";Tt.BAGGAGE_MAX_NAME_VALUE_PAIRS=180;Tt.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096;Tt.BAGGAGE_MAX_TOTAL_LENGTH=8192});var wg=p(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.parseKeyPairsIntoRecord=Zr.parsePairKeyValue=Zr.getKeyPairs=Zr.serializeKeyPairs=void 0;var I7=(k(),B(U)),Hi=Tg();function M7(t){return t.reduce((e,r)=>{let n=`${e}${e!==""?Hi.BAGGAGE_ITEMS_SEPARATOR:""}${r}`;return n.length>Hi.BAGGAGE_MAX_TOTAL_LENGTH?e:n},"")}Zr.serializeKeyPairs=M7;function L7(t){return t.getAllEntries().map(([e,r])=>{let n=`${encodeURIComponent(e)}=${encodeURIComponent(r.value)}`;return r.metadata!==void 0&&(n+=Hi.BAGGAGE_PROPERTIES_SEPARATOR+r.metadata.toString()),n})}Zr.getKeyPairs=L7;function SI(t){let e=t.split(Hi.BAGGAGE_PROPERTIES_SEPARATOR);if(e.length<=0)return;let r=e.shift();if(!r)return;let n=r.indexOf(Hi.BAGGAGE_KEY_PAIR_SEPARATOR);if(n<=0)return;let s=decodeURIComponent(r.substring(0,n).trim()),a=decodeURIComponent(r.substring(n+1).trim()),o;return e.length>0&&(o=(0,I7.baggageEntryMetadataFromString)(e.join(Hi.BAGGAGE_PROPERTIES_SEPARATOR))),{key:s,value:a,metadata:o}}Zr.parsePairKeyValue=SI;function C7(t){return typeof t!="string"||t.length===0?{}:t.split(Hi.BAGGAGE_ITEMS_SEPARATOR).map(e=>SI(e)).filter(e=>e!==void 0&&e.value.length>0).reduce((e,r)=>(e[r.key]=r.value,e),{})}Zr.parseKeyPairsIntoRecord=C7});var EI=p(Ff=>{"use strict";Object.defineProperty(Ff,"__esModule",{value:!0});Ff.W3CBaggagePropagator=void 0;var Og=(k(),B(U)),D7=Au(),Yi=Tg(),vg=wg(),bg=class{inject(e,r,n){let s=Og.propagation.getBaggage(e);if(!s||(0,D7.isTracingSuppressed)(e))return;let a=(0,vg.getKeyPairs)(s).filter(i=>i.length<=Yi.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS).slice(0,Yi.BAGGAGE_MAX_NAME_VALUE_PAIRS),o=(0,vg.serializeKeyPairs)(a);o.length>0&&n.set(r,Yi.BAGGAGE_HEADER,o)}extract(e,r,n){let s=n.get(r,Yi.BAGGAGE_HEADER),a=Array.isArray(s)?s.join(Yi.BAGGAGE_ITEMS_SEPARATOR):s;if(!a)return e;let o={};return a.length===0||(a.split(Yi.BAGGAGE_ITEMS_SEPARATOR).forEach(u=>{let l=(0,vg.parsePairKeyValue)(u);if(l){let c={value:l.value};l.metadata&&(c.metadata=l.metadata),o[l.key]=c}}),Object.entries(o).length===0)?e:Og.propagation.setBaggage(e,Og.propagation.createBaggage(o))}fields(){return[Yi.BAGGAGE_HEADER]}};Ff.W3CBaggagePropagator=bg});var gI=p($f=>{"use strict";Object.defineProperty($f,"__esModule",{value:!0});$f.AnchoredClock=void 0;var Ag=class{constructor(e,r){this._monotonicClock=r,this._epochMillis=e.now(),this._performanceMillis=r.now()}now(){let e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e}};$f.AnchoredClock=Ag});var vI=p(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.isAttributeValue=Qn.isAttributeKey=Qn.sanitizeAttributes=void 0;var yI=(k(),B(U));function x7(t){let e={};if(typeof t!="object"||t==null)return e;for(let[r,n]of Object.entries(t)){if(!TI(r)){yI.diag.warn(`Invalid attribute key: ${r}`);continue}if(!wI(n)){yI.diag.warn(`Invalid attribute value set for key: ${r}`);continue}Array.isArray(n)?e[r]=n.slice():e[r]=n}return e}Qn.sanitizeAttributes=x7;function TI(t){return typeof t=="string"&&t.length>0}Qn.isAttributeKey=TI;function wI(t){return t==null?!0:Array.isArray(t)?U7(t):OI(t)}Qn.isAttributeValue=wI;function U7(t){let e;for(let r of t)if(r!=null){if(!e){if(OI(r)){e=typeof r;continue}return!1}if(typeof r!==e)return!1}return!0}function OI(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}});var Rg=p(Gf=>{"use strict";Object.defineProperty(Gf,"__esModule",{value:!0});Gf.loggingErrorHandler=void 0;var k7=(k(),B(U));function B7(){return t=>{k7.diag.error(q7(t))}}Gf.loggingErrorHandler=B7;function q7(t){return typeof t=="string"?t:JSON.stringify(V7(t))}function V7(t){let e={},r=t;for(;r!==null;)Object.getOwnPropertyNames(r).forEach(n=>{if(e[n])return;let s=r[n];s&&(e[n]=String(s))}),r=Object.getPrototypeOf(r);return e}});var Ng=p(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.globalErrorHandler=os.setGlobalErrorHandler=void 0;var F7=Rg(),bI=(0,F7.loggingErrorHandler)();function $7(t){bI=t}os.setGlobalErrorHandler=$7;function G7(t){try{bI(t)}catch{}}os.globalErrorHandler=G7});var Pg=p(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.TracesSamplerValues=void 0;var W7;(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(W7=Ru.TracesSamplerValues||(Ru.TracesSamplerValues={}))});var AI=p(Wf=>{"use strict";Object.defineProperty(Wf,"__esModule",{value:!0});Wf._globalThis=void 0;Wf._globalThis=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{}});var Mg=p(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.getEnvWithoutDefaults=Pe.parseEnvironment=Pe.DEFAULT_ENVIRONMENT=Pe.DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT=Pe.DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT=Pe.DEFAULT_ATTRIBUTE_COUNT_LIMIT=Pe.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT=void 0;var Jn=(k(),B(U)),j7=Pg(),H7=AI(),Y7=",",z7=["OTEL_SDK_DISABLED"];function K7(t){return z7.indexOf(t)>-1}var Q7=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function J7(t){return Q7.indexOf(t)>-1}var X7=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function Z7(t){return X7.indexOf(t)>-1}Pe.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT=1/0;Pe.DEFAULT_ATTRIBUTE_COUNT_LIMIT=128;Pe.DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT=128;Pe.DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT=128;Pe.DEFAULT_ENVIRONMENT={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:Jn.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:Pe.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,OTEL_ATTRIBUTE_COUNT_LIMIT:Pe.DEFAULT_ATTRIBUTE_COUNT_LIMIT,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:Pe.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:Pe.DEFAULT_ATTRIBUTE_COUNT_LIMIT,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:Pe.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:Pe.DEFAULT_ATTRIBUTE_COUNT_LIMIT,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:Pe.DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:Pe.DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:j7.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function eJ(t,e,r){if(typeof r[t]>"u")return;let n=String(r[t]);e[t]=n.toLowerCase()==="true"}function tJ(t,e,r,n=-1/0,s=1/0){if(typeof r[t]<"u"){let a=Number(r[t]);isNaN(a)||(a<n?e[t]=n:a>s?e[t]=s:e[t]=a)}}function rJ(t,e,r,n=Y7){let s=r[t];typeof s=="string"&&(e[t]=s.split(n).map(a=>a.trim()))}var nJ={ALL:Jn.DiagLogLevel.ALL,VERBOSE:Jn.DiagLogLevel.VERBOSE,DEBUG:Jn.DiagLogLevel.DEBUG,INFO:Jn.DiagLogLevel.INFO,WARN:Jn.DiagLogLevel.WARN,ERROR:Jn.DiagLogLevel.ERROR,NONE:Jn.DiagLogLevel.NONE};function iJ(t,e,r){let n=r[t];if(typeof n=="string"){let s=nJ[n.toUpperCase()];s!=null&&(e[t]=s)}}function Ig(t){let e={};for(let r in Pe.DEFAULT_ENVIRONMENT){let n=r;switch(n){case"OTEL_LOG_LEVEL":iJ(n,e,t);break;default:if(K7(n))eJ(n,e,t);else if(J7(n))tJ(n,e,t);else if(Z7(n))rJ(n,e,t);else{let s=t[n];typeof s<"u"&&s!==null&&(e[n]=String(s))}}}return e}Pe.parseEnvironment=Ig;function oJ(){return typeof process<"u"&&process&&process.env?Ig(process.env):Ig(H7._globalThis)}Pe.getEnvWithoutDefaults=oJ});var NI=p(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.getEnv=void 0;var RI=Mg();function sJ(){let t=(0,RI.parseEnvironment)(process.env);return Object.assign({},RI.DEFAULT_ENVIRONMENT,t)}jf.getEnv=sJ});var PI=p(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf._globalThis=void 0;Hf._globalThis=typeof globalThis=="object"?globalThis:global});var Lg=p(Yf=>{"use strict";Object.defineProperty(Yf,"__esModule",{value:!0});Yf.hexToBinary=void 0;function II(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function aJ(t){let e=new Uint8Array(t.length/2),r=0;for(let n=0;n<t.length;n+=2){let s=II(t.charCodeAt(n)),a=II(t.charCodeAt(n+1));e[r++]=s<<4|a}return e}Yf.hexToBinary=aJ});var MI=p(zf=>{"use strict";Object.defineProperty(zf,"__esModule",{value:!0});zf.hexToBase64=void 0;var uJ=Lg();function lJ(t){return Buffer.from((0,uJ.hexToBinary)(t)).toString("base64")}zf.hexToBase64=lJ});var DI=p(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});Qf.RandomIdGenerator=void 0;var cJ=8,CI=16,Cg=class{constructor(){this.generateTraceId=LI(CI),this.generateSpanId=LI(cJ)}};Qf.RandomIdGenerator=Cg;var Kf=Buffer.allocUnsafe(CI);function LI(t){return function(){for(let r=0;r<t/4;r++)Kf.writeUInt32BE(Math.random()*2**32>>>0,r*4);for(let r=0;r<t&&!(Kf[r]>0);r++)r===t-1&&(Kf[t-1]=1);return Kf.toString("hex",0,t)}}});var xI=p(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.otperformance=void 0;var fJ=require("perf_hooks");Jf.otperformance=fJ.performance});var Dg=p(Xf=>{"use strict";Object.defineProperty(Xf,"__esModule",{value:!0});Xf.VERSION=void 0;Xf.VERSION="1.22.0"});var xg=p(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.createConstMap=void 0;function dJ(t){let e={},r=t.length;for(let n=0;n<r;n++){let s=t[n];s&&(e[String(s).toUpperCase().replace(/[-.]/g,"_")]=s)}return e}Zf.createConstMap=dJ});var b1=p(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.SEMATTRS_NET_HOST_CARRIER_ICC=d.SEMATTRS_NET_HOST_CARRIER_MNC=d.SEMATTRS_NET_HOST_CARRIER_MCC=d.SEMATTRS_NET_HOST_CARRIER_NAME=d.SEMATTRS_NET_HOST_CONNECTION_SUBTYPE=d.SEMATTRS_NET_HOST_CONNECTION_TYPE=d.SEMATTRS_NET_HOST_NAME=d.SEMATTRS_NET_HOST_PORT=d.SEMATTRS_NET_HOST_IP=d.SEMATTRS_NET_PEER_NAME=d.SEMATTRS_NET_PEER_PORT=d.SEMATTRS_NET_PEER_IP=d.SEMATTRS_NET_TRANSPORT=d.SEMATTRS_FAAS_INVOKED_REGION=d.SEMATTRS_FAAS_INVOKED_PROVIDER=d.SEMATTRS_FAAS_INVOKED_NAME=d.SEMATTRS_FAAS_COLDSTART=d.SEMATTRS_FAAS_CRON=d.SEMATTRS_FAAS_TIME=d.SEMATTRS_FAAS_DOCUMENT_NAME=d.SEMATTRS_FAAS_DOCUMENT_TIME=d.SEMATTRS_FAAS_DOCUMENT_OPERATION=d.SEMATTRS_FAAS_DOCUMENT_COLLECTION=d.SEMATTRS_FAAS_EXECUTION=d.SEMATTRS_FAAS_TRIGGER=d.SEMATTRS_EXCEPTION_ESCAPED=d.SEMATTRS_EXCEPTION_STACKTRACE=d.SEMATTRS_EXCEPTION_MESSAGE=d.SEMATTRS_EXCEPTION_TYPE=d.SEMATTRS_DB_SQL_TABLE=d.SEMATTRS_DB_MONGODB_COLLECTION=d.SEMATTRS_DB_REDIS_DATABASE_INDEX=d.SEMATTRS_DB_HBASE_NAMESPACE=d.SEMATTRS_DB_CASSANDRA_COORDINATOR_DC=d.SEMATTRS_DB_CASSANDRA_COORDINATOR_ID=d.SEMATTRS_DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT=d.SEMATTRS_DB_CASSANDRA_IDEMPOTENCE=d.SEMATTRS_DB_CASSANDRA_TABLE=d.SEMATTRS_DB_CASSANDRA_CONSISTENCY_LEVEL=d.SEMATTRS_DB_CASSANDRA_PAGE_SIZE=d.SEMATTRS_DB_CASSANDRA_KEYSPACE=d.SEMATTRS_DB_MSSQL_INSTANCE_NAME=d.SEMATTRS_DB_OPERATION=d.SEMATTRS_DB_STATEMENT=d.SEMATTRS_DB_NAME=d.SEMATTRS_DB_JDBC_DRIVER_CLASSNAME=d.SEMATTRS_DB_USER=d.SEMATTRS_DB_CONNECTION_STRING=d.SEMATTRS_DB_SYSTEM=d.SEMATTRS_AWS_LAMBDA_INVOKED_ARN=void 0;d.SEMATTRS_MESSAGING_DESTINATION_KIND=d.SEMATTRS_MESSAGING_DESTINATION=d.SEMATTRS_MESSAGING_SYSTEM=d.SEMATTRS_AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES=d.SEMATTRS_AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS=d.SEMATTRS_AWS_DYNAMODB_SCANNED_COUNT=d.SEMATTRS_AWS_DYNAMODB_COUNT=d.SEMATTRS_AWS_DYNAMODB_TOTAL_SEGMENTS=d.SEMATTRS_AWS_DYNAMODB_SEGMENT=d.SEMATTRS_AWS_DYNAMODB_SCAN_FORWARD=d.SEMATTRS_AWS_DYNAMODB_TABLE_COUNT=d.SEMATTRS_AWS_DYNAMODB_EXCLUSIVE_START_TABLE=d.SEMATTRS_AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES=d.SEMATTRS_AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES=d.SEMATTRS_AWS_DYNAMODB_SELECT=d.SEMATTRS_AWS_DYNAMODB_INDEX_NAME=d.SEMATTRS_AWS_DYNAMODB_ATTRIBUTES_TO_GET=d.SEMATTRS_AWS_DYNAMODB_LIMIT=d.SEMATTRS_AWS_DYNAMODB_PROJECTION=d.SEMATTRS_AWS_DYNAMODB_CONSISTENT_READ=d.SEMATTRS_AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY=d.SEMATTRS_AWS_DYNAMODB_PROVISIONED_READ_CAPACITY=d.SEMATTRS_AWS_DYNAMODB_ITEM_COLLECTION_METRICS=d.SEMATTRS_AWS_DYNAMODB_CONSUMED_CAPACITY=d.SEMATTRS_AWS_DYNAMODB_TABLE_NAMES=d.SEMATTRS_HTTP_CLIENT_IP=d.SEMATTRS_HTTP_ROUTE=d.SEMATTRS_HTTP_SERVER_NAME=d.SEMATTRS_HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED=d.SEMATTRS_HTTP_RESPONSE_CONTENT_LENGTH=d.SEMATTRS_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED=d.SEMATTRS_HTTP_REQUEST_CONTENT_LENGTH=d.SEMATTRS_HTTP_USER_AGENT=d.SEMATTRS_HTTP_FLAVOR=d.SEMATTRS_HTTP_STATUS_CODE=d.SEMATTRS_HTTP_SCHEME=d.SEMATTRS_HTTP_HOST=d.SEMATTRS_HTTP_TARGET=d.SEMATTRS_HTTP_URL=d.SEMATTRS_HTTP_METHOD=d.SEMATTRS_CODE_LINENO=d.SEMATTRS_CODE_FILEPATH=d.SEMATTRS_CODE_NAMESPACE=d.SEMATTRS_CODE_FUNCTION=d.SEMATTRS_THREAD_NAME=d.SEMATTRS_THREAD_ID=d.SEMATTRS_ENDUSER_SCOPE=d.SEMATTRS_ENDUSER_ROLE=d.SEMATTRS_ENDUSER_ID=d.SEMATTRS_PEER_SERVICE=void 0;d.DBSYSTEMVALUES_FILEMAKER=d.DBSYSTEMVALUES_DERBY=d.DBSYSTEMVALUES_FIREBIRD=d.DBSYSTEMVALUES_ADABAS=d.DBSYSTEMVALUES_CACHE=d.DBSYSTEMVALUES_EDB=d.DBSYSTEMVALUES_FIRSTSQL=d.DBSYSTEMVALUES_INGRES=d.DBSYSTEMVALUES_HANADB=d.DBSYSTEMVALUES_MAXDB=d.DBSYSTEMVALUES_PROGRESS=d.DBSYSTEMVALUES_HSQLDB=d.DBSYSTEMVALUES_CLOUDSCAPE=d.DBSYSTEMVALUES_HIVE=d.DBSYSTEMVALUES_REDSHIFT=d.DBSYSTEMVALUES_POSTGRESQL=d.DBSYSTEMVALUES_DB2=d.DBSYSTEMVALUES_ORACLE=d.DBSYSTEMVALUES_MYSQL=d.DBSYSTEMVALUES_MSSQL=d.DBSYSTEMVALUES_OTHER_SQL=d.SemanticAttributes=d.SEMATTRS_MESSAGE_UNCOMPRESSED_SIZE=d.SEMATTRS_MESSAGE_COMPRESSED_SIZE=d.SEMATTRS_MESSAGE_ID=d.SEMATTRS_MESSAGE_TYPE=d.SEMATTRS_RPC_JSONRPC_ERROR_MESSAGE=d.SEMATTRS_RPC_JSONRPC_ERROR_CODE=d.SEMATTRS_RPC_JSONRPC_REQUEST_ID=d.SEMATTRS_RPC_JSONRPC_VERSION=d.SEMATTRS_RPC_GRPC_STATUS_CODE=d.SEMATTRS_RPC_METHOD=d.SEMATTRS_RPC_SERVICE=d.SEMATTRS_RPC_SYSTEM=d.SEMATTRS_MESSAGING_KAFKA_TOMBSTONE=d.SEMATTRS_MESSAGING_KAFKA_PARTITION=d.SEMATTRS_MESSAGING_KAFKA_CLIENT_ID=d.SEMATTRS_MESSAGING_KAFKA_CONSUMER_GROUP=d.SEMATTRS_MESSAGING_KAFKA_MESSAGE_KEY=d.SEMATTRS_MESSAGING_RABBITMQ_ROUTING_KEY=d.SEMATTRS_MESSAGING_CONSUMER_ID=d.SEMATTRS_MESSAGING_OPERATION=d.SEMATTRS_MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES=d.SEMATTRS_MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES=d.SEMATTRS_MESSAGING_CONVERSATION_ID=d.SEMATTRS_MESSAGING_MESSAGE_ID=d.SEMATTRS_MESSAGING_URL=d.SEMATTRS_MESSAGING_PROTOCOL_VERSION=d.SEMATTRS_MESSAGING_PROTOCOL=d.SEMATTRS_MESSAGING_TEMP_DESTINATION=void 0;d.FAASINVOKEDPROVIDERVALUES_ALIBABA_CLOUD=d.FaasDocumentOperationValues=d.FAASDOCUMENTOPERATIONVALUES_DELETE=d.FAASDOCUMENTOPERATIONVALUES_EDIT=d.FAASDOCUMENTOPERATIONVALUES_INSERT=d.FaasTriggerValues=d.FAASTRIGGERVALUES_OTHER=d.FAASTRIGGERVALUES_TIMER=d.FAASTRIGGERVALUES_PUBSUB=d.FAASTRIGGERVALUES_HTTP=d.FAASTRIGGERVALUES_DATASOURCE=d.DbCassandraConsistencyLevelValues=d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_SERIAL=d.DBCASSANDRACONSISTENCYLEVELVALUES_SERIAL=d.DBCASSANDRACONSISTENCYLEVELVALUES_ANY=d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_ONE=d.DBCASSANDRACONSISTENCYLEVELVALUES_THREE=d.DBCASSANDRACONSISTENCYLEVELVALUES_TWO=d.DBCASSANDRACONSISTENCYLEVELVALUES_ONE=d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_QUORUM=d.DBCASSANDRACONSISTENCYLEVELVALUES_QUORUM=d.DBCASSANDRACONSISTENCYLEVELVALUES_EACH_QUORUM=d.DBCASSANDRACONSISTENCYLEVELVALUES_ALL=d.DbSystemValues=d.DBSYSTEMVALUES_COCKROACHDB=d.DBSYSTEMVALUES_MEMCACHED=d.DBSYSTEMVALUES_ELASTICSEARCH=d.DBSYSTEMVALUES_GEODE=d.DBSYSTEMVALUES_NEO4J=d.DBSYSTEMVALUES_DYNAMODB=d.DBSYSTEMVALUES_COSMOSDB=d.DBSYSTEMVALUES_COUCHDB=d.DBSYSTEMVALUES_COUCHBASE=d.DBSYSTEMVALUES_REDIS=d.DBSYSTEMVALUES_MONGODB=d.DBSYSTEMVALUES_HBASE=d.DBSYSTEMVALUES_CASSANDRA=d.DBSYSTEMVALUES_COLDFUSION=d.DBSYSTEMVALUES_H2=d.DBSYSTEMVALUES_VERTICA=d.DBSYSTEMVALUES_TERADATA=d.DBSYSTEMVALUES_SYBASE=d.DBSYSTEMVALUES_SQLITE=d.DBSYSTEMVALUES_POINTBASE=d.DBSYSTEMVALUES_PERVASIVE=d.DBSYSTEMVALUES_NETEZZA=d.DBSYSTEMVALUES_MARIADB=d.DBSYSTEMVALUES_INTERBASE=d.DBSYSTEMVALUES_INSTANTDB=d.DBSYSTEMVALUES_INFORMIX=void 0;d.MESSAGINGOPERATIONVALUES_RECEIVE=d.MessagingDestinationKindValues=d.MESSAGINGDESTINATIONKINDVALUES_TOPIC=d.MESSAGINGDESTINATIONKINDVALUES_QUEUE=d.HttpFlavorValues=d.HTTPFLAVORVALUES_QUIC=d.HTTPFLAVORVALUES_SPDY=d.HTTPFLAVORVALUES_HTTP_2_0=d.HTTPFLAVORVALUES_HTTP_1_1=d.HTTPFLAVORVALUES_HTTP_1_0=d.NetHostConnectionSubtypeValues=d.NETHOSTCONNECTIONSUBTYPEVALUES_LTE_CA=d.NETHOSTCONNECTIONSUBTYPEVALUES_NRNSA=d.NETHOSTCONNECTIONSUBTYPEVALUES_NR=d.NETHOSTCONNECTIONSUBTYPEVALUES_IWLAN=d.NETHOSTCONNECTIONSUBTYPEVALUES_TD_SCDMA=d.NETHOSTCONNECTIONSUBTYPEVALUES_GSM=d.NETHOSTCONNECTIONSUBTYPEVALUES_HSPAP=d.NETHOSTCONNECTIONSUBTYPEVALUES_EHRPD=d.NETHOSTCONNECTIONSUBTYPEVALUES_LTE=d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_B=d.NETHOSTCONNECTIONSUBTYPEVALUES_IDEN=d.NETHOSTCONNECTIONSUBTYPEVALUES_HSPA=d.NETHOSTCONNECTIONSUBTYPEVALUES_HSUPA=d.NETHOSTCONNECTIONSUBTYPEVALUES_HSDPA=d.NETHOSTCONNECTIONSUBTYPEVALUES_CDMA2000_1XRTT=d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_A=d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_0=d.NETHOSTCONNECTIONSUBTYPEVALUES_CDMA=d.NETHOSTCONNECTIONSUBTYPEVALUES_UMTS=d.NETHOSTCONNECTIONSUBTYPEVALUES_EDGE=d.NETHOSTCONNECTIONSUBTYPEVALUES_GPRS=d.NetHostConnectionTypeValues=d.NETHOSTCONNECTIONTYPEVALUES_UNKNOWN=d.NETHOSTCONNECTIONTYPEVALUES_UNAVAILABLE=d.NETHOSTCONNECTIONTYPEVALUES_CELL=d.NETHOSTCONNECTIONTYPEVALUES_WIRED=d.NETHOSTCONNECTIONTYPEVALUES_WIFI=d.NetTransportValues=d.NETTRANSPORTVALUES_OTHER=d.NETTRANSPORTVALUES_INPROC=d.NETTRANSPORTVALUES_PIPE=d.NETTRANSPORTVALUES_UNIX=d.NETTRANSPORTVALUES_IP=d.NETTRANSPORTVALUES_IP_UDP=d.NETTRANSPORTVALUES_IP_TCP=d.FaasInvokedProviderValues=d.FAASINVOKEDPROVIDERVALUES_GCP=d.FAASINVOKEDPROVIDERVALUES_AZURE=d.FAASINVOKEDPROVIDERVALUES_AWS=void 0;d.MessageTypeValues=d.MESSAGETYPEVALUES_RECEIVED=d.MESSAGETYPEVALUES_SENT=d.RpcGrpcStatusCodeValues=d.RPCGRPCSTATUSCODEVALUES_UNAUTHENTICATED=d.RPCGRPCSTATUSCODEVALUES_DATA_LOSS=d.RPCGRPCSTATUSCODEVALUES_UNAVAILABLE=d.RPCGRPCSTATUSCODEVALUES_INTERNAL=d.RPCGRPCSTATUSCODEVALUES_UNIMPLEMENTED=d.RPCGRPCSTATUSCODEVALUES_OUT_OF_RANGE=d.RPCGRPCSTATUSCODEVALUES_ABORTED=d.RPCGRPCSTATUSCODEVALUES_FAILED_PRECONDITION=d.RPCGRPCSTATUSCODEVALUES_RESOURCE_EXHAUSTED=d.RPCGRPCSTATUSCODEVALUES_PERMISSION_DENIED=d.RPCGRPCSTATUSCODEVALUES_ALREADY_EXISTS=d.RPCGRPCSTATUSCODEVALUES_NOT_FOUND=d.RPCGRPCSTATUSCODEVALUES_DEADLINE_EXCEEDED=d.RPCGRPCSTATUSCODEVALUES_INVALID_ARGUMENT=d.RPCGRPCSTATUSCODEVALUES_UNKNOWN=d.RPCGRPCSTATUSCODEVALUES_CANCELLED=d.RPCGRPCSTATUSCODEVALUES_OK=d.MessagingOperationValues=d.MESSAGINGOPERATIONVALUES_PROCESS=void 0;var hr=xg(),UI="aws.lambda.invoked_arn",kI="db.system",BI="db.connection_string",qI="db.user",VI="db.jdbc.driver_classname",FI="db.name",$I="db.statement",GI="db.operation",WI="db.mssql.instance_name",jI="db.cassandra.keyspace",HI="db.cassandra.page_size",YI="db.cassandra.consistency_level",zI="db.cassandra.table",KI="db.cassandra.idempotence",QI="db.cassandra.speculative_execution_count",JI="db.cassandra.coordinator.id",XI="db.cassandra.coordinator.dc",ZI="db.hbase.namespace",eM="db.redis.database_index",tM="db.mongodb.collection",rM="db.sql.table",nM="exception.type",iM="exception.message",oM="exception.stacktrace",sM="exception.escaped",aM="faas.trigger",uM="faas.execution",lM="faas.document.collection",cM="faas.document.operation",fM="faas.document.time",dM="faas.document.name",pM="faas.time",hM="faas.cron",_M="faas.coldstart",mM="faas.invoked_name",SM="faas.invoked_provider",EM="faas.invoked_region",gM="net.transport",yM="net.peer.ip",TM="net.peer.port",wM="net.peer.name",OM="net.host.ip",vM="net.host.port",bM="net.host.name",AM="net.host.connection.type",RM="net.host.connection.subtype",NM="net.host.carrier.name",PM="net.host.carrier.mcc",IM="net.host.carrier.mnc",MM="net.host.carrier.icc",LM="peer.service",CM="enduser.id",DM="enduser.role",xM="enduser.scope",UM="thread.id",kM="thread.name",BM="code.function",qM="code.namespace",VM="code.filepath",FM="code.lineno",$M="http.method",GM="http.url",WM="http.target",jM="http.host",HM="http.scheme",YM="http.status_code",zM="http.flavor",KM="http.user_agent",QM="http.request_content_length",JM="http.request_content_length_uncompressed",XM="http.response_content_length",ZM="http.response_content_length_uncompressed",eL="http.server_name",tL="http.route",rL="http.client_ip",nL="aws.dynamodb.table_names",iL="aws.dynamodb.consumed_capacity",oL="aws.dynamodb.item_collection_metrics",sL="aws.dynamodb.provisioned_read_capacity",aL="aws.dynamodb.provisioned_write_capacity",uL="aws.dynamodb.consistent_read",lL="aws.dynamodb.projection",cL="aws.dynamodb.limit",fL="aws.dynamodb.attributes_to_get",dL="aws.dynamodb.index_name",pL="aws.dynamodb.select",hL="aws.dynamodb.global_secondary_indexes",_L="aws.dynamodb.local_secondary_indexes",mL="aws.dynamodb.exclusive_start_table",SL="aws.dynamodb.table_count",EL="aws.dynamodb.scan_forward",gL="aws.dynamodb.segment",yL="aws.dynamodb.total_segments",TL="aws.dynamodb.count",wL="aws.dynamodb.scanned_count",OL="aws.dynamodb.attribute_definitions",vL="aws.dynamodb.global_secondary_index_updates",bL="messaging.system",AL="messaging.destination",RL="messaging.destination_kind",NL="messaging.temp_destination",PL="messaging.protocol",IL="messaging.protocol_version",ML="messaging.url",LL="messaging.message_id",CL="messaging.conversation_id",DL="messaging.message_payload_size_bytes",xL="messaging.message_payload_compressed_size_bytes",UL="messaging.operation",kL="messaging.consumer_id",BL="messaging.rabbitmq.routing_key",qL="messaging.kafka.message_key",VL="messaging.kafka.consumer_group",FL="messaging.kafka.client_id",$L="messaging.kafka.partition",GL="messaging.kafka.tombstone",WL="rpc.system",jL="rpc.service",HL="rpc.method",YL="rpc.grpc.status_code",zL="rpc.jsonrpc.version",KL="rpc.jsonrpc.request_id",QL="rpc.jsonrpc.error_code",JL="rpc.jsonrpc.error_message",XL="message.type",ZL="message.id",eC="message.compressed_size",tC="message.uncompressed_size";d.SEMATTRS_AWS_LAMBDA_INVOKED_ARN=UI;d.SEMATTRS_DB_SYSTEM=kI;d.SEMATTRS_DB_CONNECTION_STRING=BI;d.SEMATTRS_DB_USER=qI;d.SEMATTRS_DB_JDBC_DRIVER_CLASSNAME=VI;d.SEMATTRS_DB_NAME=FI;d.SEMATTRS_DB_STATEMENT=$I;d.SEMATTRS_DB_OPERATION=GI;d.SEMATTRS_DB_MSSQL_INSTANCE_NAME=WI;d.SEMATTRS_DB_CASSANDRA_KEYSPACE=jI;d.SEMATTRS_DB_CASSANDRA_PAGE_SIZE=HI;d.SEMATTRS_DB_CASSANDRA_CONSISTENCY_LEVEL=YI;d.SEMATTRS_DB_CASSANDRA_TABLE=zI;d.SEMATTRS_DB_CASSANDRA_IDEMPOTENCE=KI;d.SEMATTRS_DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT=QI;d.SEMATTRS_DB_CASSANDRA_COORDINATOR_ID=JI;d.SEMATTRS_DB_CASSANDRA_COORDINATOR_DC=XI;d.SEMATTRS_DB_HBASE_NAMESPACE=ZI;d.SEMATTRS_DB_REDIS_DATABASE_INDEX=eM;d.SEMATTRS_DB_MONGODB_COLLECTION=tM;d.SEMATTRS_DB_SQL_TABLE=rM;d.SEMATTRS_EXCEPTION_TYPE=nM;d.SEMATTRS_EXCEPTION_MESSAGE=iM;d.SEMATTRS_EXCEPTION_STACKTRACE=oM;d.SEMATTRS_EXCEPTION_ESCAPED=sM;d.SEMATTRS_FAAS_TRIGGER=aM;d.SEMATTRS_FAAS_EXECUTION=uM;d.SEMATTRS_FAAS_DOCUMENT_COLLECTION=lM;d.SEMATTRS_FAAS_DOCUMENT_OPERATION=cM;d.SEMATTRS_FAAS_DOCUMENT_TIME=fM;d.SEMATTRS_FAAS_DOCUMENT_NAME=dM;d.SEMATTRS_FAAS_TIME=pM;d.SEMATTRS_FAAS_CRON=hM;d.SEMATTRS_FAAS_COLDSTART=_M;d.SEMATTRS_FAAS_INVOKED_NAME=mM;d.SEMATTRS_FAAS_INVOKED_PROVIDER=SM;d.SEMATTRS_FAAS_INVOKED_REGION=EM;d.SEMATTRS_NET_TRANSPORT=gM;d.SEMATTRS_NET_PEER_IP=yM;d.SEMATTRS_NET_PEER_PORT=TM;d.SEMATTRS_NET_PEER_NAME=wM;d.SEMATTRS_NET_HOST_IP=OM;d.SEMATTRS_NET_HOST_PORT=vM;d.SEMATTRS_NET_HOST_NAME=bM;d.SEMATTRS_NET_HOST_CONNECTION_TYPE=AM;d.SEMATTRS_NET_HOST_CONNECTION_SUBTYPE=RM;d.SEMATTRS_NET_HOST_CARRIER_NAME=NM;d.SEMATTRS_NET_HOST_CARRIER_MCC=PM;d.SEMATTRS_NET_HOST_CARRIER_MNC=IM;d.SEMATTRS_NET_HOST_CARRIER_ICC=MM;d.SEMATTRS_PEER_SERVICE=LM;d.SEMATTRS_ENDUSER_ID=CM;d.SEMATTRS_ENDUSER_ROLE=DM;d.SEMATTRS_ENDUSER_SCOPE=xM;d.SEMATTRS_THREAD_ID=UM;d.SEMATTRS_THREAD_NAME=kM;d.SEMATTRS_CODE_FUNCTION=BM;d.SEMATTRS_CODE_NAMESPACE=qM;d.SEMATTRS_CODE_FILEPATH=VM;d.SEMATTRS_CODE_LINENO=FM;d.SEMATTRS_HTTP_METHOD=$M;d.SEMATTRS_HTTP_URL=GM;d.SEMATTRS_HTTP_TARGET=WM;d.SEMATTRS_HTTP_HOST=jM;d.SEMATTRS_HTTP_SCHEME=HM;d.SEMATTRS_HTTP_STATUS_CODE=YM;d.SEMATTRS_HTTP_FLAVOR=zM;d.SEMATTRS_HTTP_USER_AGENT=KM;d.SEMATTRS_HTTP_REQUEST_CONTENT_LENGTH=QM;d.SEMATTRS_HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED=JM;d.SEMATTRS_HTTP_RESPONSE_CONTENT_LENGTH=XM;d.SEMATTRS_HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED=ZM;d.SEMATTRS_HTTP_SERVER_NAME=eL;d.SEMATTRS_HTTP_ROUTE=tL;d.SEMATTRS_HTTP_CLIENT_IP=rL;d.SEMATTRS_AWS_DYNAMODB_TABLE_NAMES=nL;d.SEMATTRS_AWS_DYNAMODB_CONSUMED_CAPACITY=iL;d.SEMATTRS_AWS_DYNAMODB_ITEM_COLLECTION_METRICS=oL;d.SEMATTRS_AWS_DYNAMODB_PROVISIONED_READ_CAPACITY=sL;d.SEMATTRS_AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY=aL;d.SEMATTRS_AWS_DYNAMODB_CONSISTENT_READ=uL;d.SEMATTRS_AWS_DYNAMODB_PROJECTION=lL;d.SEMATTRS_AWS_DYNAMODB_LIMIT=cL;d.SEMATTRS_AWS_DYNAMODB_ATTRIBUTES_TO_GET=fL;d.SEMATTRS_AWS_DYNAMODB_INDEX_NAME=dL;d.SEMATTRS_AWS_DYNAMODB_SELECT=pL;d.SEMATTRS_AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES=hL;d.SEMATTRS_AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES=_L;d.SEMATTRS_AWS_DYNAMODB_EXCLUSIVE_START_TABLE=mL;d.SEMATTRS_AWS_DYNAMODB_TABLE_COUNT=SL;d.SEMATTRS_AWS_DYNAMODB_SCAN_FORWARD=EL;d.SEMATTRS_AWS_DYNAMODB_SEGMENT=gL;d.SEMATTRS_AWS_DYNAMODB_TOTAL_SEGMENTS=yL;d.SEMATTRS_AWS_DYNAMODB_COUNT=TL;d.SEMATTRS_AWS_DYNAMODB_SCANNED_COUNT=wL;d.SEMATTRS_AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS=OL;d.SEMATTRS_AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES=vL;d.SEMATTRS_MESSAGING_SYSTEM=bL;d.SEMATTRS_MESSAGING_DESTINATION=AL;d.SEMATTRS_MESSAGING_DESTINATION_KIND=RL;d.SEMATTRS_MESSAGING_TEMP_DESTINATION=NL;d.SEMATTRS_MESSAGING_PROTOCOL=PL;d.SEMATTRS_MESSAGING_PROTOCOL_VERSION=IL;d.SEMATTRS_MESSAGING_URL=ML;d.SEMATTRS_MESSAGING_MESSAGE_ID=LL;d.SEMATTRS_MESSAGING_CONVERSATION_ID=CL;d.SEMATTRS_MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES=DL;d.SEMATTRS_MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES=xL;d.SEMATTRS_MESSAGING_OPERATION=UL;d.SEMATTRS_MESSAGING_CONSUMER_ID=kL;d.SEMATTRS_MESSAGING_RABBITMQ_ROUTING_KEY=BL;d.SEMATTRS_MESSAGING_KAFKA_MESSAGE_KEY=qL;d.SEMATTRS_MESSAGING_KAFKA_CONSUMER_GROUP=VL;d.SEMATTRS_MESSAGING_KAFKA_CLIENT_ID=FL;d.SEMATTRS_MESSAGING_KAFKA_PARTITION=$L;d.SEMATTRS_MESSAGING_KAFKA_TOMBSTONE=GL;d.SEMATTRS_RPC_SYSTEM=WL;d.SEMATTRS_RPC_SERVICE=jL;d.SEMATTRS_RPC_METHOD=HL;d.SEMATTRS_RPC_GRPC_STATUS_CODE=YL;d.SEMATTRS_RPC_JSONRPC_VERSION=zL;d.SEMATTRS_RPC_JSONRPC_REQUEST_ID=KL;d.SEMATTRS_RPC_JSONRPC_ERROR_CODE=QL;d.SEMATTRS_RPC_JSONRPC_ERROR_MESSAGE=JL;d.SEMATTRS_MESSAGE_TYPE=XL;d.SEMATTRS_MESSAGE_ID=ZL;d.SEMATTRS_MESSAGE_COMPRESSED_SIZE=eC;d.SEMATTRS_MESSAGE_UNCOMPRESSED_SIZE=tC;d.SemanticAttributes=(0,hr.createConstMap)([UI,kI,BI,qI,VI,FI,$I,GI,WI,jI,HI,YI,zI,KI,QI,JI,XI,ZI,eM,tM,rM,nM,iM,oM,sM,aM,uM,lM,cM,fM,dM,pM,hM,_M,mM,SM,EM,gM,yM,TM,wM,OM,vM,bM,AM,RM,NM,PM,IM,MM,LM,CM,DM,xM,UM,kM,BM,qM,VM,FM,$M,GM,WM,jM,HM,YM,zM,KM,QM,JM,XM,ZM,eL,tL,rL,nL,iL,oL,sL,aL,uL,lL,cL,fL,dL,pL,hL,_L,mL,SL,EL,gL,yL,TL,wL,OL,vL,bL,AL,RL,NL,PL,IL,ML,LL,CL,DL,xL,UL,kL,BL,qL,VL,FL,$L,GL,WL,jL,HL,YL,zL,KL,QL,JL,XL,ZL,eC,tC]);var rC="other_sql",nC="mssql",iC="mysql",oC="oracle",sC="db2",aC="postgresql",uC="redshift",lC="hive",cC="cloudscape",fC="hsqldb",dC="progress",pC="maxdb",hC="hanadb",_C="ingres",mC="firstsql",SC="edb",EC="cache",gC="adabas",yC="firebird",TC="derby",wC="filemaker",OC="informix",vC="instantdb",bC="interbase",AC="mariadb",RC="netezza",NC="pervasive",PC="pointbase",IC="sqlite",MC="sybase",LC="teradata",CC="vertica",DC="h2",xC="coldfusion",UC="cassandra",kC="hbase",BC="mongodb",qC="redis",VC="couchbase",FC="couchdb",$C="cosmosdb",GC="dynamodb",WC="neo4j",jC="geode",HC="elasticsearch",YC="memcached",zC="cockroachdb";d.DBSYSTEMVALUES_OTHER_SQL=rC;d.DBSYSTEMVALUES_MSSQL=nC;d.DBSYSTEMVALUES_MYSQL=iC;d.DBSYSTEMVALUES_ORACLE=oC;d.DBSYSTEMVALUES_DB2=sC;d.DBSYSTEMVALUES_POSTGRESQL=aC;d.DBSYSTEMVALUES_REDSHIFT=uC;d.DBSYSTEMVALUES_HIVE=lC;d.DBSYSTEMVALUES_CLOUDSCAPE=cC;d.DBSYSTEMVALUES_HSQLDB=fC;d.DBSYSTEMVALUES_PROGRESS=dC;d.DBSYSTEMVALUES_MAXDB=pC;d.DBSYSTEMVALUES_HANADB=hC;d.DBSYSTEMVALUES_INGRES=_C;d.DBSYSTEMVALUES_FIRSTSQL=mC;d.DBSYSTEMVALUES_EDB=SC;d.DBSYSTEMVALUES_CACHE=EC;d.DBSYSTEMVALUES_ADABAS=gC;d.DBSYSTEMVALUES_FIREBIRD=yC;d.DBSYSTEMVALUES_DERBY=TC;d.DBSYSTEMVALUES_FILEMAKER=wC;d.DBSYSTEMVALUES_INFORMIX=OC;d.DBSYSTEMVALUES_INSTANTDB=vC;d.DBSYSTEMVALUES_INTERBASE=bC;d.DBSYSTEMVALUES_MARIADB=AC;d.DBSYSTEMVALUES_NETEZZA=RC;d.DBSYSTEMVALUES_PERVASIVE=NC;d.DBSYSTEMVALUES_POINTBASE=PC;d.DBSYSTEMVALUES_SQLITE=IC;d.DBSYSTEMVALUES_SYBASE=MC;d.DBSYSTEMVALUES_TERADATA=LC;d.DBSYSTEMVALUES_VERTICA=CC;d.DBSYSTEMVALUES_H2=DC;d.DBSYSTEMVALUES_COLDFUSION=xC;d.DBSYSTEMVALUES_CASSANDRA=UC;d.DBSYSTEMVALUES_HBASE=kC;d.DBSYSTEMVALUES_MONGODB=BC;d.DBSYSTEMVALUES_REDIS=qC;d.DBSYSTEMVALUES_COUCHBASE=VC;d.DBSYSTEMVALUES_COUCHDB=FC;d.DBSYSTEMVALUES_COSMOSDB=$C;d.DBSYSTEMVALUES_DYNAMODB=GC;d.DBSYSTEMVALUES_NEO4J=WC;d.DBSYSTEMVALUES_GEODE=jC;d.DBSYSTEMVALUES_ELASTICSEARCH=HC;d.DBSYSTEMVALUES_MEMCACHED=YC;d.DBSYSTEMVALUES_COCKROACHDB=zC;d.DbSystemValues=(0,hr.createConstMap)([rC,nC,iC,oC,sC,aC,uC,lC,cC,fC,dC,pC,hC,_C,mC,SC,EC,gC,yC,TC,wC,OC,vC,bC,AC,RC,NC,PC,IC,MC,LC,CC,DC,xC,UC,kC,BC,qC,VC,FC,$C,GC,WC,jC,HC,YC,zC]);var KC="all",QC="each_quorum",JC="quorum",XC="local_quorum",ZC="one",eD="two",tD="three",rD="local_one",nD="any",iD="serial",oD="local_serial";d.DBCASSANDRACONSISTENCYLEVELVALUES_ALL=KC;d.DBCASSANDRACONSISTENCYLEVELVALUES_EACH_QUORUM=QC;d.DBCASSANDRACONSISTENCYLEVELVALUES_QUORUM=JC;d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_QUORUM=XC;d.DBCASSANDRACONSISTENCYLEVELVALUES_ONE=ZC;d.DBCASSANDRACONSISTENCYLEVELVALUES_TWO=eD;d.DBCASSANDRACONSISTENCYLEVELVALUES_THREE=tD;d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_ONE=rD;d.DBCASSANDRACONSISTENCYLEVELVALUES_ANY=nD;d.DBCASSANDRACONSISTENCYLEVELVALUES_SERIAL=iD;d.DBCASSANDRACONSISTENCYLEVELVALUES_LOCAL_SERIAL=oD;d.DbCassandraConsistencyLevelValues=(0,hr.createConstMap)([KC,QC,JC,XC,ZC,eD,tD,rD,nD,iD,oD]);var sD="datasource",aD="http",uD="pubsub",lD="timer",cD="other";d.FAASTRIGGERVALUES_DATASOURCE=sD;d.FAASTRIGGERVALUES_HTTP=aD;d.FAASTRIGGERVALUES_PUBSUB=uD;d.FAASTRIGGERVALUES_TIMER=lD;d.FAASTRIGGERVALUES_OTHER=cD;d.FaasTriggerValues=(0,hr.createConstMap)([sD,aD,uD,lD,cD]);var fD="insert",dD="edit",pD="delete";d.FAASDOCUMENTOPERATIONVALUES_INSERT=fD;d.FAASDOCUMENTOPERATIONVALUES_EDIT=dD;d.FAASDOCUMENTOPERATIONVALUES_DELETE=pD;d.FaasDocumentOperationValues=(0,hr.createConstMap)([fD,dD,pD]);var hD="alibaba_cloud",_D="aws",mD="azure",SD="gcp";d.FAASINVOKEDPROVIDERVALUES_ALIBABA_CLOUD=hD;d.FAASINVOKEDPROVIDERVALUES_AWS=_D;d.FAASINVOKEDPROVIDERVALUES_AZURE=mD;d.FAASINVOKEDPROVIDERVALUES_GCP=SD;d.FaasInvokedProviderValues=(0,hr.createConstMap)([hD,_D,mD,SD]);var ED="ip_tcp",gD="ip_udp",yD="ip",TD="unix",wD="pipe",OD="inproc",vD="other";d.NETTRANSPORTVALUES_IP_TCP=ED;d.NETTRANSPORTVALUES_IP_UDP=gD;d.NETTRANSPORTVALUES_IP=yD;d.NETTRANSPORTVALUES_UNIX=TD;d.NETTRANSPORTVALUES_PIPE=wD;d.NETTRANSPORTVALUES_INPROC=OD;d.NETTRANSPORTVALUES_OTHER=vD;d.NetTransportValues=(0,hr.createConstMap)([ED,gD,yD,TD,wD,OD,vD]);var bD="wifi",AD="wired",RD="cell",ND="unavailable",PD="unknown";d.NETHOSTCONNECTIONTYPEVALUES_WIFI=bD;d.NETHOSTCONNECTIONTYPEVALUES_WIRED=AD;d.NETHOSTCONNECTIONTYPEVALUES_CELL=RD;d.NETHOSTCONNECTIONTYPEVALUES_UNAVAILABLE=ND;d.NETHOSTCONNECTIONTYPEVALUES_UNKNOWN=PD;d.NetHostConnectionTypeValues=(0,hr.createConstMap)([bD,AD,RD,ND,PD]);var ID="gprs",MD="edge",LD="umts",CD="cdma",DD="evdo_0",xD="evdo_a",UD="cdma2000_1xrtt",kD="hsdpa",BD="hsupa",qD="hspa",VD="iden",FD="evdo_b",$D="lte",GD="ehrpd",WD="hspap",jD="gsm",HD="td_scdma",YD="iwlan",zD="nr",KD="nrnsa",QD="lte_ca";d.NETHOSTCONNECTIONSUBTYPEVALUES_GPRS=ID;d.NETHOSTCONNECTIONSUBTYPEVALUES_EDGE=MD;d.NETHOSTCONNECTIONSUBTYPEVALUES_UMTS=LD;d.NETHOSTCONNECTIONSUBTYPEVALUES_CDMA=CD;d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_0=DD;d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_A=xD;d.NETHOSTCONNECTIONSUBTYPEVALUES_CDMA2000_1XRTT=UD;d.NETHOSTCONNECTIONSUBTYPEVALUES_HSDPA=kD;d.NETHOSTCONNECTIONSUBTYPEVALUES_HSUPA=BD;d.NETHOSTCONNECTIONSUBTYPEVALUES_HSPA=qD;d.NETHOSTCONNECTIONSUBTYPEVALUES_IDEN=VD;d.NETHOSTCONNECTIONSUBTYPEVALUES_EVDO_B=FD;d.NETHOSTCONNECTIONSUBTYPEVALUES_LTE=$D;d.NETHOSTCONNECTIONSUBTYPEVALUES_EHRPD=GD;d.NETHOSTCONNECTIONSUBTYPEVALUES_HSPAP=WD;d.NETHOSTCONNECTIONSUBTYPEVALUES_GSM=jD;d.NETHOSTCONNECTIONSUBTYPEVALUES_TD_SCDMA=HD;d.NETHOSTCONNECTIONSUBTYPEVALUES_IWLAN=YD;d.NETHOSTCONNECTIONSUBTYPEVALUES_NR=zD;d.NETHOSTCONNECTIONSUBTYPEVALUES_NRNSA=KD;d.NETHOSTCONNECTIONSUBTYPEVALUES_LTE_CA=QD;d.NetHostConnectionSubtypeValues=(0,hr.createConstMap)([ID,MD,LD,CD,DD,xD,UD,kD,BD,qD,VD,FD,$D,GD,WD,jD,HD,YD,zD,KD,QD]);var JD="1.0",XD="1.1",ZD="2.0",e1="SPDY",t1="QUIC";d.HTTPFLAVORVALUES_HTTP_1_0=JD;d.HTTPFLAVORVALUES_HTTP_1_1=XD;d.HTTPFLAVORVALUES_HTTP_2_0=ZD;d.HTTPFLAVORVALUES_SPDY=e1;d.HTTPFLAVORVALUES_QUIC=t1;d.HttpFlavorValues={HTTP_1_0:JD,HTTP_1_1:XD,HTTP_2_0:ZD,SPDY:e1,QUIC:t1};var r1="queue",n1="topic";d.MESSAGINGDESTINATIONKINDVALUES_QUEUE=r1;d.MESSAGINGDESTINATIONKINDVALUES_TOPIC=n1;d.MessagingDestinationKindValues=(0,hr.createConstMap)([r1,n1]);var i1="receive",o1="process";d.MESSAGINGOPERATIONVALUES_RECEIVE=i1;d.MESSAGINGOPERATIONVALUES_PROCESS=o1;d.MessagingOperationValues=(0,hr.createConstMap)([i1,o1]);var s1=0,a1=1,u1=2,l1=3,c1=4,f1=5,d1=6,p1=7,h1=8,_1=9,m1=10,S1=11,E1=12,g1=13,y1=14,T1=15,w1=16;d.RPCGRPCSTATUSCODEVALUES_OK=s1;d.RPCGRPCSTATUSCODEVALUES_CANCELLED=a1;d.RPCGRPCSTATUSCODEVALUES_UNKNOWN=u1;d.RPCGRPCSTATUSCODEVALUES_INVALID_ARGUMENT=l1;d.RPCGRPCSTATUSCODEVALUES_DEADLINE_EXCEEDED=c1;d.RPCGRPCSTATUSCODEVALUES_NOT_FOUND=f1;d.RPCGRPCSTATUSCODEVALUES_ALREADY_EXISTS=d1;d.RPCGRPCSTATUSCODEVALUES_PERMISSION_DENIED=p1;d.RPCGRPCSTATUSCODEVALUES_RESOURCE_EXHAUSTED=h1;d.RPCGRPCSTATUSCODEVALUES_FAILED_PRECONDITION=_1;d.RPCGRPCSTATUSCODEVALUES_ABORTED=m1;d.RPCGRPCSTATUSCODEVALUES_OUT_OF_RANGE=S1;d.RPCGRPCSTATUSCODEVALUES_UNIMPLEMENTED=E1;d.RPCGRPCSTATUSCODEVALUES_INTERNAL=g1;d.RPCGRPCSTATUSCODEVALUES_UNAVAILABLE=y1;d.RPCGRPCSTATUSCODEVALUES_DATA_LOSS=T1;d.RPCGRPCSTATUSCODEVALUES_UNAUTHENTICATED=w1;d.RpcGrpcStatusCodeValues={OK:s1,CANCELLED:a1,UNKNOWN:u1,INVALID_ARGUMENT:l1,DEADLINE_EXCEEDED:c1,NOT_FOUND:f1,ALREADY_EXISTS:d1,PERMISSION_DENIED:p1,RESOURCE_EXHAUSTED:h1,FAILED_PRECONDITION:_1,ABORTED:m1,OUT_OF_RANGE:S1,UNIMPLEMENTED:E1,INTERNAL:g1,UNAVAILABLE:y1,DATA_LOSS:T1,UNAUTHENTICATED:w1};var O1="SENT",v1="RECEIVED";d.MESSAGETYPEVALUES_SENT=O1;d.MESSAGETYPEVALUES_RECEIVED=v1;d.MessageTypeValues=(0,hr.createConstMap)([O1,v1])});var A1=p(zi=>{"use strict";var pJ=zi&&zi.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),hJ=zi&&zi.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&pJ(e,t,r)};Object.defineProperty(zi,"__esModule",{value:!0});hJ(b1(),zi)});var JU=p(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.SEMRESATTRS_K8S_STATEFULSET_NAME=y.SEMRESATTRS_K8S_STATEFULSET_UID=y.SEMRESATTRS_K8S_DEPLOYMENT_NAME=y.SEMRESATTRS_K8S_DEPLOYMENT_UID=y.SEMRESATTRS_K8S_REPLICASET_NAME=y.SEMRESATTRS_K8S_REPLICASET_UID=y.SEMRESATTRS_K8S_CONTAINER_NAME=y.SEMRESATTRS_K8S_POD_NAME=y.SEMRESATTRS_K8S_POD_UID=y.SEMRESATTRS_K8S_NAMESPACE_NAME=y.SEMRESATTRS_K8S_NODE_UID=y.SEMRESATTRS_K8S_NODE_NAME=y.SEMRESATTRS_K8S_CLUSTER_NAME=y.SEMRESATTRS_HOST_IMAGE_VERSION=y.SEMRESATTRS_HOST_IMAGE_ID=y.SEMRESATTRS_HOST_IMAGE_NAME=y.SEMRESATTRS_HOST_ARCH=y.SEMRESATTRS_HOST_TYPE=y.SEMRESATTRS_HOST_NAME=y.SEMRESATTRS_HOST_ID=y.SEMRESATTRS_FAAS_MAX_MEMORY=y.SEMRESATTRS_FAAS_INSTANCE=y.SEMRESATTRS_FAAS_VERSION=y.SEMRESATTRS_FAAS_ID=y.SEMRESATTRS_FAAS_NAME=y.SEMRESATTRS_DEVICE_MODEL_NAME=y.SEMRESATTRS_DEVICE_MODEL_IDENTIFIER=y.SEMRESATTRS_DEVICE_ID=y.SEMRESATTRS_DEPLOYMENT_ENVIRONMENT=y.SEMRESATTRS_CONTAINER_IMAGE_TAG=y.SEMRESATTRS_CONTAINER_IMAGE_NAME=y.SEMRESATTRS_CONTAINER_RUNTIME=y.SEMRESATTRS_CONTAINER_ID=y.SEMRESATTRS_CONTAINER_NAME=y.SEMRESATTRS_AWS_LOG_STREAM_ARNS=y.SEMRESATTRS_AWS_LOG_STREAM_NAMES=y.SEMRESATTRS_AWS_LOG_GROUP_ARNS=y.SEMRESATTRS_AWS_LOG_GROUP_NAMES=y.SEMRESATTRS_AWS_EKS_CLUSTER_ARN=y.SEMRESATTRS_AWS_ECS_TASK_REVISION=y.SEMRESATTRS_AWS_ECS_TASK_FAMILY=y.SEMRESATTRS_AWS_ECS_TASK_ARN=y.SEMRESATTRS_AWS_ECS_LAUNCHTYPE=y.SEMRESATTRS_AWS_ECS_CLUSTER_ARN=y.SEMRESATTRS_AWS_ECS_CONTAINER_ARN=y.SEMRESATTRS_CLOUD_PLATFORM=y.SEMRESATTRS_CLOUD_AVAILABILITY_ZONE=y.SEMRESATTRS_CLOUD_REGION=y.SEMRESATTRS_CLOUD_ACCOUNT_ID=y.SEMRESATTRS_CLOUD_PROVIDER=void 0;y.CLOUDPLATFORMVALUES_GCP_COMPUTE_ENGINE=y.CLOUDPLATFORMVALUES_AZURE_APP_SERVICE=y.CLOUDPLATFORMVALUES_AZURE_FUNCTIONS=y.CLOUDPLATFORMVALUES_AZURE_AKS=y.CLOUDPLATFORMVALUES_AZURE_CONTAINER_INSTANCES=y.CLOUDPLATFORMVALUES_AZURE_VM=y.CLOUDPLATFORMVALUES_AWS_ELASTIC_BEANSTALK=y.CLOUDPLATFORMVALUES_AWS_LAMBDA=y.CLOUDPLATFORMVALUES_AWS_EKS=y.CLOUDPLATFORMVALUES_AWS_ECS=y.CLOUDPLATFORMVALUES_AWS_EC2=y.CLOUDPLATFORMVALUES_ALIBABA_CLOUD_FC=y.CLOUDPLATFORMVALUES_ALIBABA_CLOUD_ECS=y.CloudProviderValues=y.CLOUDPROVIDERVALUES_GCP=y.CLOUDPROVIDERVALUES_AZURE=y.CLOUDPROVIDERVALUES_AWS=y.CLOUDPROVIDERVALUES_ALIBABA_CLOUD=y.SemanticResourceAttributes=y.SEMRESATTRS_WEBENGINE_DESCRIPTION=y.SEMRESATTRS_WEBENGINE_VERSION=y.SEMRESATTRS_WEBENGINE_NAME=y.SEMRESATTRS_TELEMETRY_AUTO_VERSION=y.SEMRESATTRS_TELEMETRY_SDK_VERSION=y.SEMRESATTRS_TELEMETRY_SDK_LANGUAGE=y.SEMRESATTRS_TELEMETRY_SDK_NAME=y.SEMRESATTRS_SERVICE_VERSION=y.SEMRESATTRS_SERVICE_INSTANCE_ID=y.SEMRESATTRS_SERVICE_NAMESPACE=y.SEMRESATTRS_SERVICE_NAME=y.SEMRESATTRS_PROCESS_RUNTIME_DESCRIPTION=y.SEMRESATTRS_PROCESS_RUNTIME_VERSION=y.SEMRESATTRS_PROCESS_RUNTIME_NAME=y.SEMRESATTRS_PROCESS_OWNER=y.SEMRESATTRS_PROCESS_COMMAND_ARGS=y.SEMRESATTRS_PROCESS_COMMAND_LINE=y.SEMRESATTRS_PROCESS_COMMAND=y.SEMRESATTRS_PROCESS_EXECUTABLE_PATH=y.SEMRESATTRS_PROCESS_EXECUTABLE_NAME=y.SEMRESATTRS_PROCESS_PID=y.SEMRESATTRS_OS_VERSION=y.SEMRESATTRS_OS_NAME=y.SEMRESATTRS_OS_DESCRIPTION=y.SEMRESATTRS_OS_TYPE=y.SEMRESATTRS_K8S_CRONJOB_NAME=y.SEMRESATTRS_K8S_CRONJOB_UID=y.SEMRESATTRS_K8S_JOB_NAME=y.SEMRESATTRS_K8S_JOB_UID=y.SEMRESATTRS_K8S_DAEMONSET_NAME=y.SEMRESATTRS_K8S_DAEMONSET_UID=void 0;y.TelemetrySdkLanguageValues=y.TELEMETRYSDKLANGUAGEVALUES_WEBJS=y.TELEMETRYSDKLANGUAGEVALUES_RUBY=y.TELEMETRYSDKLANGUAGEVALUES_PYTHON=y.TELEMETRYSDKLANGUAGEVALUES_PHP=y.TELEMETRYSDKLANGUAGEVALUES_NODEJS=y.TELEMETRYSDKLANGUAGEVALUES_JAVA=y.TELEMETRYSDKLANGUAGEVALUES_GO=y.TELEMETRYSDKLANGUAGEVALUES_ERLANG=y.TELEMETRYSDKLANGUAGEVALUES_DOTNET=y.TELEMETRYSDKLANGUAGEVALUES_CPP=y.OsTypeValues=y.OSTYPEVALUES_Z_OS=y.OSTYPEVALUES_SOLARIS=y.OSTYPEVALUES_AIX=y.OSTYPEVALUES_HPUX=y.OSTYPEVALUES_DRAGONFLYBSD=y.OSTYPEVALUES_OPENBSD=y.OSTYPEVALUES_NETBSD=y.OSTYPEVALUES_FREEBSD=y.OSTYPEVALUES_DARWIN=y.OSTYPEVALUES_LINUX=y.OSTYPEVALUES_WINDOWS=y.HostArchValues=y.HOSTARCHVALUES_X86=y.HOSTARCHVALUES_PPC64=y.HOSTARCHVALUES_PPC32=y.HOSTARCHVALUES_IA64=y.HOSTARCHVALUES_ARM64=y.HOSTARCHVALUES_ARM32=y.HOSTARCHVALUES_AMD64=y.AwsEcsLaunchtypeValues=y.AWSECSLAUNCHTYPEVALUES_FARGATE=y.AWSECSLAUNCHTYPEVALUES_EC2=y.CloudPlatformValues=y.CLOUDPLATFORMVALUES_GCP_APP_ENGINE=y.CLOUDPLATFORMVALUES_GCP_CLOUD_FUNCTIONS=y.CLOUDPLATFORMVALUES_GCP_KUBERNETES_ENGINE=y.CLOUDPLATFORMVALUES_GCP_CLOUD_RUN=void 0;var Ki=xg(),R1="cloud.provider",N1="cloud.account.id",P1="cloud.region",I1="cloud.availability_zone",M1="cloud.platform",L1="aws.ecs.container.arn",C1="aws.ecs.cluster.arn",D1="aws.ecs.launchtype",x1="aws.ecs.task.arn",U1="aws.ecs.task.family",k1="aws.ecs.task.revision",B1="aws.eks.cluster.arn",q1="aws.log.group.names",V1="aws.log.group.arns",F1="aws.log.stream.names",$1="aws.log.stream.arns",G1="container.name",W1="container.id",j1="container.runtime",H1="container.image.name",Y1="container.image.tag",z1="deployment.environment",K1="device.id",Q1="device.model.identifier",J1="device.model.name",X1="faas.name",Z1="faas.id",ex="faas.version",tx="faas.instance",rx="faas.max_memory",nx="host.id",ix="host.name",ox="host.type",sx="host.arch",ax="host.image.name",ux="host.image.id",lx="host.image.version",cx="k8s.cluster.name",fx="k8s.node.name",dx="k8s.node.uid",px="k8s.namespace.name",hx="k8s.pod.uid",_x="k8s.pod.name",mx="k8s.container.name",Sx="k8s.replicaset.uid",Ex="k8s.replicaset.name",gx="k8s.deployment.uid",yx="k8s.deployment.name",Tx="k8s.statefulset.uid",wx="k8s.statefulset.name",Ox="k8s.daemonset.uid",vx="k8s.daemonset.name",bx="k8s.job.uid",Ax="k8s.job.name",Rx="k8s.cronjob.uid",Nx="k8s.cronjob.name",Px="os.type",Ix="os.description",Mx="os.name",Lx="os.version",Cx="process.pid",Dx="process.executable.name",xx="process.executable.path",Ux="process.command",kx="process.command_line",Bx="process.command_args",qx="process.owner",Vx="process.runtime.name",Fx="process.runtime.version",$x="process.runtime.description",Gx="service.name",Wx="service.namespace",jx="service.instance.id",Hx="service.version",Yx="telemetry.sdk.name",zx="telemetry.sdk.language",Kx="telemetry.sdk.version",Qx="telemetry.auto.version",Jx="webengine.name",Xx="webengine.version",Zx="webengine.description";y.SEMRESATTRS_CLOUD_PROVIDER=R1;y.SEMRESATTRS_CLOUD_ACCOUNT_ID=N1;y.SEMRESATTRS_CLOUD_REGION=P1;y.SEMRESATTRS_CLOUD_AVAILABILITY_ZONE=I1;y.SEMRESATTRS_CLOUD_PLATFORM=M1;y.SEMRESATTRS_AWS_ECS_CONTAINER_ARN=L1;y.SEMRESATTRS_AWS_ECS_CLUSTER_ARN=C1;y.SEMRESATTRS_AWS_ECS_LAUNCHTYPE=D1;y.SEMRESATTRS_AWS_ECS_TASK_ARN=x1;y.SEMRESATTRS_AWS_ECS_TASK_FAMILY=U1;y.SEMRESATTRS_AWS_ECS_TASK_REVISION=k1;y.SEMRESATTRS_AWS_EKS_CLUSTER_ARN=B1;y.SEMRESATTRS_AWS_LOG_GROUP_NAMES=q1;y.SEMRESATTRS_AWS_LOG_GROUP_ARNS=V1;y.SEMRESATTRS_AWS_LOG_STREAM_NAMES=F1;y.SEMRESATTRS_AWS_LOG_STREAM_ARNS=$1;y.SEMRESATTRS_CONTAINER_NAME=G1;y.SEMRESATTRS_CONTAINER_ID=W1;y.SEMRESATTRS_CONTAINER_RUNTIME=j1;y.SEMRESATTRS_CONTAINER_IMAGE_NAME=H1;y.SEMRESATTRS_CONTAINER_IMAGE_TAG=Y1;y.SEMRESATTRS_DEPLOYMENT_ENVIRONMENT=z1;y.SEMRESATTRS_DEVICE_ID=K1;y.SEMRESATTRS_DEVICE_MODEL_IDENTIFIER=Q1;y.SEMRESATTRS_DEVICE_MODEL_NAME=J1;y.SEMRESATTRS_FAAS_NAME=X1;y.SEMRESATTRS_FAAS_ID=Z1;y.SEMRESATTRS_FAAS_VERSION=ex;y.SEMRESATTRS_FAAS_INSTANCE=tx;y.SEMRESATTRS_FAAS_MAX_MEMORY=rx;y.SEMRESATTRS_HOST_ID=nx;y.SEMRESATTRS_HOST_NAME=ix;y.SEMRESATTRS_HOST_TYPE=ox;y.SEMRESATTRS_HOST_ARCH=sx;y.SEMRESATTRS_HOST_IMAGE_NAME=ax;y.SEMRESATTRS_HOST_IMAGE_ID=ux;y.SEMRESATTRS_HOST_IMAGE_VERSION=lx;y.SEMRESATTRS_K8S_CLUSTER_NAME=cx;y.SEMRESATTRS_K8S_NODE_NAME=fx;y.SEMRESATTRS_K8S_NODE_UID=dx;y.SEMRESATTRS_K8S_NAMESPACE_NAME=px;y.SEMRESATTRS_K8S_POD_UID=hx;y.SEMRESATTRS_K8S_POD_NAME=_x;y.SEMRESATTRS_K8S_CONTAINER_NAME=mx;y.SEMRESATTRS_K8S_REPLICASET_UID=Sx;y.SEMRESATTRS_K8S_REPLICASET_NAME=Ex;y.SEMRESATTRS_K8S_DEPLOYMENT_UID=gx;y.SEMRESATTRS_K8S_DEPLOYMENT_NAME=yx;y.SEMRESATTRS_K8S_STATEFULSET_UID=Tx;y.SEMRESATTRS_K8S_STATEFULSET_NAME=wx;y.SEMRESATTRS_K8S_DAEMONSET_UID=Ox;y.SEMRESATTRS_K8S_DAEMONSET_NAME=vx;y.SEMRESATTRS_K8S_JOB_UID=bx;y.SEMRESATTRS_K8S_JOB_NAME=Ax;y.SEMRESATTRS_K8S_CRONJOB_UID=Rx;y.SEMRESATTRS_K8S_CRONJOB_NAME=Nx;y.SEMRESATTRS_OS_TYPE=Px;y.SEMRESATTRS_OS_DESCRIPTION=Ix;y.SEMRESATTRS_OS_NAME=Mx;y.SEMRESATTRS_OS_VERSION=Lx;y.SEMRESATTRS_PROCESS_PID=Cx;y.SEMRESATTRS_PROCESS_EXECUTABLE_NAME=Dx;y.SEMRESATTRS_PROCESS_EXECUTABLE_PATH=xx;y.SEMRESATTRS_PROCESS_COMMAND=Ux;y.SEMRESATTRS_PROCESS_COMMAND_LINE=kx;y.SEMRESATTRS_PROCESS_COMMAND_ARGS=Bx;y.SEMRESATTRS_PROCESS_OWNER=qx;y.SEMRESATTRS_PROCESS_RUNTIME_NAME=Vx;y.SEMRESATTRS_PROCESS_RUNTIME_VERSION=Fx;y.SEMRESATTRS_PROCESS_RUNTIME_DESCRIPTION=$x;y.SEMRESATTRS_SERVICE_NAME=Gx;y.SEMRESATTRS_SERVICE_NAMESPACE=Wx;y.SEMRESATTRS_SERVICE_INSTANCE_ID=jx;y.SEMRESATTRS_SERVICE_VERSION=Hx;y.SEMRESATTRS_TELEMETRY_SDK_NAME=Yx;y.SEMRESATTRS_TELEMETRY_SDK_LANGUAGE=zx;y.SEMRESATTRS_TELEMETRY_SDK_VERSION=Kx;y.SEMRESATTRS_TELEMETRY_AUTO_VERSION=Qx;y.SEMRESATTRS_WEBENGINE_NAME=Jx;y.SEMRESATTRS_WEBENGINE_VERSION=Xx;y.SEMRESATTRS_WEBENGINE_DESCRIPTION=Zx;y.SemanticResourceAttributes=(0,Ki.createConstMap)([R1,N1,P1,I1,M1,L1,C1,D1,x1,U1,k1,B1,q1,V1,F1,$1,G1,W1,j1,H1,Y1,z1,K1,Q1,J1,X1,Z1,ex,tx,rx,nx,ix,ox,sx,ax,ux,lx,cx,fx,dx,px,hx,_x,mx,Sx,Ex,gx,yx,Tx,wx,Ox,vx,bx,Ax,Rx,Nx,Px,Ix,Mx,Lx,Cx,Dx,xx,Ux,kx,Bx,qx,Vx,Fx,$x,Gx,Wx,jx,Hx,Yx,zx,Kx,Qx,Jx,Xx,Zx]);var eU="alibaba_cloud",tU="aws",rU="azure",nU="gcp";y.CLOUDPROVIDERVALUES_ALIBABA_CLOUD=eU;y.CLOUDPROVIDERVALUES_AWS=tU;y.CLOUDPROVIDERVALUES_AZURE=rU;y.CLOUDPROVIDERVALUES_GCP=nU;y.CloudProviderValues=(0,Ki.createConstMap)([eU,tU,rU,nU]);var iU="alibaba_cloud_ecs",oU="alibaba_cloud_fc",sU="aws_ec2",aU="aws_ecs",uU="aws_eks",lU="aws_lambda",cU="aws_elastic_beanstalk",fU="azure_vm",dU="azure_container_instances",pU="azure_aks",hU="azure_functions",_U="azure_app_service",mU="gcp_compute_engine",SU="gcp_cloud_run",EU="gcp_kubernetes_engine",gU="gcp_cloud_functions",yU="gcp_app_engine";y.CLOUDPLATFORMVALUES_ALIBABA_CLOUD_ECS=iU;y.CLOUDPLATFORMVALUES_ALIBABA_CLOUD_FC=oU;y.CLOUDPLATFORMVALUES_AWS_EC2=sU;y.CLOUDPLATFORMVALUES_AWS_ECS=aU;y.CLOUDPLATFORMVALUES_AWS_EKS=uU;y.CLOUDPLATFORMVALUES_AWS_LAMBDA=lU;y.CLOUDPLATFORMVALUES_AWS_ELASTIC_BEANSTALK=cU;y.CLOUDPLATFORMVALUES_AZURE_VM=fU;y.CLOUDPLATFORMVALUES_AZURE_CONTAINER_INSTANCES=dU;y.CLOUDPLATFORMVALUES_AZURE_AKS=pU;y.CLOUDPLATFORMVALUES_AZURE_FUNCTIONS=hU;y.CLOUDPLATFORMVALUES_AZURE_APP_SERVICE=_U;y.CLOUDPLATFORMVALUES_GCP_COMPUTE_ENGINE=mU;y.CLOUDPLATFORMVALUES_GCP_CLOUD_RUN=SU;y.CLOUDPLATFORMVALUES_GCP_KUBERNETES_ENGINE=EU;y.CLOUDPLATFORMVALUES_GCP_CLOUD_FUNCTIONS=gU;y.CLOUDPLATFORMVALUES_GCP_APP_ENGINE=yU;y.CloudPlatformValues=(0,Ki.createConstMap)([iU,oU,sU,aU,uU,lU,cU,fU,dU,pU,hU,_U,mU,SU,EU,gU,yU]);var TU="ec2",wU="fargate";y.AWSECSLAUNCHTYPEVALUES_EC2=TU;y.AWSECSLAUNCHTYPEVALUES_FARGATE=wU;y.AwsEcsLaunchtypeValues=(0,Ki.createConstMap)([TU,wU]);var OU="amd64",vU="arm32",bU="arm64",AU="ia64",RU="ppc32",NU="ppc64",PU="x86";y.HOSTARCHVALUES_AMD64=OU;y.HOSTARCHVALUES_ARM32=vU;y.HOSTARCHVALUES_ARM64=bU;y.HOSTARCHVALUES_IA64=AU;y.HOSTARCHVALUES_PPC32=RU;y.HOSTARCHVALUES_PPC64=NU;y.HOSTARCHVALUES_X86=PU;y.HostArchValues=(0,Ki.createConstMap)([OU,vU,bU,AU,RU,NU,PU]);var IU="windows",MU="linux",LU="darwin",CU="freebsd",DU="netbsd",xU="openbsd",UU="dragonflybsd",kU="hpux",BU="aix",qU="solaris",VU="z_os";y.OSTYPEVALUES_WINDOWS=IU;y.OSTYPEVALUES_LINUX=MU;y.OSTYPEVALUES_DARWIN=LU;y.OSTYPEVALUES_FREEBSD=CU;y.OSTYPEVALUES_NETBSD=DU;y.OSTYPEVALUES_OPENBSD=xU;y.OSTYPEVALUES_DRAGONFLYBSD=UU;y.OSTYPEVALUES_HPUX=kU;y.OSTYPEVALUES_AIX=BU;y.OSTYPEVALUES_SOLARIS=qU;y.OSTYPEVALUES_Z_OS=VU;y.OsTypeValues=(0,Ki.createConstMap)([IU,MU,LU,CU,DU,xU,UU,kU,BU,qU,VU]);var FU="cpp",$U="dotnet",GU="erlang",WU="go",jU="java",HU="nodejs",YU="php",zU="python",KU="ruby",QU="webjs";y.TELEMETRYSDKLANGUAGEVALUES_CPP=FU;y.TELEMETRYSDKLANGUAGEVALUES_DOTNET=$U;y.TELEMETRYSDKLANGUAGEVALUES_ERLANG=GU;y.TELEMETRYSDKLANGUAGEVALUES_GO=WU;y.TELEMETRYSDKLANGUAGEVALUES_JAVA=jU;y.TELEMETRYSDKLANGUAGEVALUES_NODEJS=HU;y.TELEMETRYSDKLANGUAGEVALUES_PHP=YU;y.TELEMETRYSDKLANGUAGEVALUES_PYTHON=zU;y.TELEMETRYSDKLANGUAGEVALUES_RUBY=KU;y.TELEMETRYSDKLANGUAGEVALUES_WEBJS=QU;y.TelemetrySdkLanguageValues=(0,Ki.createConstMap)([FU,$U,GU,WU,jU,HU,YU,zU,KU,QU])});var XU=p(Qi=>{"use strict";var _J=Qi&&Qi.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),mJ=Qi&&Qi.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&_J(e,t,r)};Object.defineProperty(Qi,"__esModule",{value:!0});mJ(JU(),Qi)});var vn=p(Xn=>{"use strict";var SJ=Xn&&Xn.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),ZU=Xn&&Xn.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&SJ(e,t,r)};Object.defineProperty(Xn,"__esModule",{value:!0});ZU(A1(),Xn);ZU(XU(),Xn)});var ek=p(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});ed.SDK_INFO=void 0;var EJ=Dg(),Nu=vn();ed.SDK_INFO={[Nu.SemanticResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[Nu.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[Nu.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]:Nu.TelemetrySdkLanguageValues.NODEJS,[Nu.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]:EJ.VERSION}});var tk=p(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.unrefTimer=void 0;function gJ(t){t.unref()}td.unrefTimer=gJ});var rk=p(nr=>{"use strict";var yJ=nr&&nr.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Ji=nr&&nr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&yJ(e,t,r)};Object.defineProperty(nr,"__esModule",{value:!0});Ji(NI(),nr);Ji(PI(),nr);Ji(MI(),nr);Ji(DI(),nr);Ji(xI(),nr);Ji(ek(),nr);Ji(tk(),nr)});var Ug=p(Xi=>{"use strict";var TJ=Xi&&Xi.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),wJ=Xi&&Xi.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&TJ(e,t,r)};Object.defineProperty(Xi,"__esModule",{value:!0});wJ(rk(),Xi)});var sk=p(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.addHrTimes=Ne.isTimeInput=Ne.isTimeInputHrTime=Ne.hrTimeToMicroseconds=Ne.hrTimeToMilliseconds=Ne.hrTimeToNanoseconds=Ne.hrTimeToTimeStamp=Ne.hrTimeDuration=Ne.timeInputToHrTime=Ne.hrTime=Ne.getTimeOrigin=Ne.millisToHrTime=void 0;var kg=Ug(),nk=9,OJ=6,vJ=Math.pow(10,OJ),rd=Math.pow(10,nk);function Pu(t){let e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*vJ);return[r,n]}Ne.millisToHrTime=Pu;function Bg(){let t=kg.otperformance.timeOrigin;if(typeof t!="number"){let e=kg.otperformance;t=e.timing&&e.timing.fetchStart}return t}Ne.getTimeOrigin=Bg;function ik(t){let e=Pu(Bg()),r=Pu(typeof t=="number"?t:kg.otperformance.now());return ok(e,r)}Ne.hrTime=ik;function bJ(t){if(qg(t))return t;if(typeof t=="number")return t<Bg()?ik(t):Pu(t);if(t instanceof Date)return Pu(t.getTime());throw TypeError("Invalid input type")}Ne.timeInputToHrTime=bJ;function AJ(t,e){let r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=rd),[r,n]}Ne.hrTimeDuration=AJ;function RJ(t){let e=nk,r=`${"0".repeat(e)}${t[1]}Z`,n=r.substr(r.length-e-1);return new Date(t[0]*1e3).toISOString().replace("000Z",n)}Ne.hrTimeToTimeStamp=RJ;function NJ(t){return t[0]*rd+t[1]}Ne.hrTimeToNanoseconds=NJ;function PJ(t){return t[0]*1e3+t[1]/1e6}Ne.hrTimeToMilliseconds=PJ;function IJ(t){return t[0]*1e6+t[1]/1e3}Ne.hrTimeToMicroseconds=IJ;function qg(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}Ne.isTimeInputHrTime=qg;function MJ(t){return qg(t)||typeof t=="number"||t instanceof Date}Ne.isTimeInput=MJ;function ok(t,e){let r=[t[0]+e[0],t[1]+e[1]];return r[1]>=rd&&(r[1]-=rd,r[0]+=1),r}Ne.addHrTimes=ok});var uk=p(ak=>{"use strict";Object.defineProperty(ak,"__esModule",{value:!0})});var lk=p(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.ExportResultCode=void 0;var LJ;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(LJ=Iu.ExportResultCode||(Iu.ExportResultCode={}))});var fk=p(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.CompositePropagator=void 0;var ck=(k(),B(U)),Vg=class{constructor(e={}){var r;this._propagators=(r=e.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(n=>typeof n.fields=="function"?n.fields():[]).reduce((n,s)=>n.concat(s),[])))}inject(e,r,n){for(let s of this._propagators)try{s.inject(e,r,n)}catch(a){ck.diag.warn(`Failed to inject with ${s.constructor.name}. Err: ${a.message}`)}}extract(e,r,n){return this._propagators.reduce((s,a)=>{try{return a.extract(s,r,n)}catch(o){ck.diag.warn(`Failed to inject with ${a.constructor.name}. Err: ${o.message}`)}return s},e)}fields(){return this._fields.slice()}};nd.CompositePropagator=Vg});var dk=p(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.validateValue=ss.validateKey=void 0;var Fg="[_0-9a-z-*/]",CJ=`[a-z]${Fg}{0,255}`,DJ=`[a-z0-9]${Fg}{0,240}@[a-z]${Fg}{0,13}`,xJ=new RegExp(`^(?:${CJ}|${DJ})$`),UJ=/^[ -~]{0,255}[!-~]$/,kJ=/,|=/;function BJ(t){return xJ.test(t)}ss.validateKey=BJ;function qJ(t){return UJ.test(t)&&!kJ.test(t)}ss.validateValue=qJ});var Gg=p(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});id.TraceState=void 0;var pk=dk(),hk=32,VJ=512,_k=",",mk="=",$g=class t{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,r){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n}unset(e){let r=this._clone();return r._internalState.delete(e),r}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,r)=>(e.push(r+mk+this.get(r)),e),[]).join(_k)}_parse(e){e.length>VJ||(this._internalState=e.split(_k).reverse().reduce((r,n)=>{let s=n.trim(),a=s.indexOf(mk);if(a!==-1){let o=s.slice(0,a),i=s.slice(a+1,n.length);(0,pk.validateKey)(o)&&(0,pk.validateValue)(i)&&r.set(o,i)}return r},new Map),this._internalState.size>hk&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,hk))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new t;return e._internalState=new Map(this._internalState),e}};id.TraceState=$g});var Ek=p(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.W3CTraceContextPropagator=wt.parseTraceParent=wt.TRACE_STATE_HEADER=wt.TRACE_PARENT_HEADER=void 0;var od=(k(),B(U)),FJ=Au(),$J=Gg();wt.TRACE_PARENT_HEADER="traceparent";wt.TRACE_STATE_HEADER="tracestate";var GJ="00",WJ="(?!ff)[\\da-f]{2}",jJ="(?![0]{32})[\\da-f]{32}",HJ="(?![0]{16})[\\da-f]{16}",YJ="[\\da-f]{2}",zJ=new RegExp(`^\\s?(${WJ})-(${jJ})-(${HJ})-(${YJ})(-.*)?\\s?$`);function Sk(t){let e=zJ.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}wt.parseTraceParent=Sk;var Wg=class{inject(e,r,n){let s=od.trace.getSpanContext(e);if(!s||(0,FJ.isTracingSuppressed)(e)||!(0,od.isSpanContextValid)(s))return;let a=`${GJ}-${s.traceId}-${s.spanId}-0${Number(s.traceFlags||od.TraceFlags.NONE).toString(16)}`;n.set(r,wt.TRACE_PARENT_HEADER,a),s.traceState&&n.set(r,wt.TRACE_STATE_HEADER,s.traceState.serialize())}extract(e,r,n){let s=n.get(r,wt.TRACE_PARENT_HEADER);if(!s)return e;let a=Array.isArray(s)?s[0]:s;if(typeof a!="string")return e;let o=Sk(a);if(!o)return e;o.isRemote=!0;let i=n.get(r,wt.TRACE_STATE_HEADER);if(i){let u=Array.isArray(i)?i.join(","):i;o.traceState=new $J.TraceState(typeof u=="string"?u:void 0)}return od.trace.setSpanContext(e,o)}fields(){return[wt.TRACE_PARENT_HEADER,wt.TRACE_STATE_HEADER]}};wt.W3CTraceContextPropagator=Wg});var yk=p(gk=>{"use strict";Object.defineProperty(gk,"__esModule",{value:!0})});var Tk=p(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.getRPCMetadata=Lr.deleteRPCMetadata=Lr.setRPCMetadata=Lr.RPCType=void 0;var KJ=(k(),B(U)),jg=(0,KJ.createContextKey)("OpenTelemetry SDK Context Key RPC_METADATA"),QJ;(function(t){t.HTTP="http"})(QJ=Lr.RPCType||(Lr.RPCType={}));function JJ(t,e){return t.setValue(jg,e)}Lr.setRPCMetadata=JJ;function XJ(t){return t.deleteValue(jg)}Lr.deleteRPCMetadata=XJ;function ZJ(t){return t.getValue(jg)}Lr.getRPCMetadata=ZJ});var Yg=p(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.AlwaysOffSampler=void 0;var eX=(k(),B(U)),Hg=class{shouldSample(){return{decision:eX.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};sd.AlwaysOffSampler=Hg});var Kg=p(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.AlwaysOnSampler=void 0;var tX=(k(),B(U)),zg=class{shouldSample(){return{decision:tX.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};ad.AlwaysOnSampler=zg});var Ok=p(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});ld.ParentBasedSampler=void 0;var ud=(k(),B(U)),rX=Ng(),wk=Yg(),Qg=Kg(),Jg=class{constructor(e){var r,n,s,a;this._root=e.root,this._root||((0,rX.globalErrorHandler)(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Qg.AlwaysOnSampler),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new Qg.AlwaysOnSampler,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new wk.AlwaysOffSampler,this._localParentSampled=(s=e.localParentSampled)!==null&&s!==void 0?s:new Qg.AlwaysOnSampler,this._localParentNotSampled=(a=e.localParentNotSampled)!==null&&a!==void 0?a:new wk.AlwaysOffSampler}shouldSample(e,r,n,s,a,o){let i=ud.trace.getSpanContext(e);return!i||!(0,ud.isSpanContextValid)(i)?this._root.shouldSample(e,r,n,s,a,o):i.isRemote?i.traceFlags&ud.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,s,a,o):this._remoteParentNotSampled.shouldSample(e,r,n,s,a,o):i.traceFlags&ud.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(e,r,n,s,a,o):this._localParentNotSampled.shouldSample(e,r,n,s,a,o)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};ld.ParentBasedSampler=Jg});var vk=p(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});cd.TraceIdRatioBasedSampler=void 0;var Xg=(k(),B(U)),Zg=class{constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(e,r){return{decision:(0,Xg.isValidTraceId)(r)&&this._accumulate(r)<this._upperBound?Xg.SamplingDecision.RECORD_AND_SAMPLED:Xg.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let r=0;for(let n=0;n<e.length/8;n++){let s=n*8,a=parseInt(e.slice(s,s+8),16);r=(r^a)>>>0}return r}};cd.TraceIdRatioBasedSampler=Zg});var Pk=p(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.isPlainObject=void 0;var nX="[object Object]",iX="[object Null]",oX="[object Undefined]",sX=Function.prototype,bk=sX.toString,aX=bk.call(Object),uX=lX(Object.getPrototypeOf,Object),Ak=Object.prototype,Rk=Ak.hasOwnProperty,Zi=Symbol?Symbol.toStringTag:void 0,Nk=Ak.toString;function lX(t,e){return function(r){return t(e(r))}}function cX(t){if(!fX(t)||dX(t)!==nX)return!1;let e=uX(t);if(e===null)return!0;let r=Rk.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&bk.call(r)===aX}fd.isPlainObject=cX;function fX(t){return t!=null&&typeof t=="object"}function dX(t){return t==null?t===void 0?oX:iX:Zi&&Zi in Object(t)?pX(t):hX(t)}function pX(t){let e=Rk.call(t,Zi),r=t[Zi],n=!1;try{t[Zi]=void 0,n=!0}catch{}let s=Nk.call(t);return n&&(e?t[Zi]=r:delete t[Zi]),s}function hX(t){return Nk.call(t)}});var Dk=p(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.merge=void 0;var Ik=Pk(),_X=20;function mX(...t){let e=t.shift(),r=new WeakMap;for(;t.length>0;)e=Lk(e,t.shift(),0,r);return e}hd.merge=mX;function ey(t){return pd(t)?t.slice():t}function Lk(t,e,r=0,n){let s;if(!(r>_X)){if(r++,dd(t)||dd(e)||Ck(e))s=ey(e);else if(pd(t)){if(s=t.slice(),pd(e))for(let a=0,o=e.length;a<o;a++)s.push(ey(e[a]));else if(Mu(e)){let a=Object.keys(e);for(let o=0,i=a.length;o<i;o++){let u=a[o];s[u]=ey(e[u])}}}else if(Mu(t))if(Mu(e)){if(!SX(t,e))return e;s=Object.assign({},t);let a=Object.keys(e);for(let o=0,i=a.length;o<i;o++){let u=a[o],l=e[u];if(dd(l))typeof l>"u"?delete s[u]:s[u]=l;else{let c=s[u],f=l;if(Mk(t,u,n)||Mk(e,u,n))delete s[u];else{if(Mu(c)&&Mu(f)){let h=n.get(c)||[],S=n.get(f)||[];h.push({obj:t,key:u}),S.push({obj:e,key:u}),n.set(c,h),n.set(f,S)}s[u]=Lk(s[u],l,r,n)}}}}else s=e;return s}}function Mk(t,e,r){let n=r.get(t[e])||[];for(let s=0,a=n.length;s<a;s++){let o=n[s];if(o.key===e&&o.obj===t)return!0}return!1}function pd(t){return Array.isArray(t)}function Ck(t){return typeof t=="function"}function Mu(t){return!dd(t)&&!pd(t)&&!Ck(t)&&typeof t=="object"}function dd(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function SX(t,e){return!(!(0,Ik.isPlainObject)(t)||!(0,Ik.isPlainObject)(e))}});var xk=p(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.callWithTimeout=as.TimeoutError=void 0;var _d=class t extends Error{constructor(e){super(e),Object.setPrototypeOf(this,t.prototype)}};as.TimeoutError=_d;function EX(t,e){let r,n=new Promise(function(a,o){r=setTimeout(function(){o(new _d("Operation timed out."))},e)});return Promise.race([t,n]).then(s=>(clearTimeout(r),s),s=>{throw clearTimeout(r),s})}as.callWithTimeout=EX});var kk=p(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.isUrlIgnored=us.urlMatches=void 0;function Uk(t,e){return typeof e=="string"?t===e:!!t.match(e)}us.urlMatches=Uk;function gX(t,e){if(!e)return!1;for(let r of e)if(Uk(t,r))return!0;return!1}us.isUrlIgnored=gX});var Bk=p(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.isWrapped=void 0;function yX(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}md.isWrapped=yX});var qk=p(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.Deferred=void 0;var ty=class{constructor(){this._promise=new Promise((e,r)=>{this._resolve=e,this._reject=r})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}};Sd.Deferred=ty});var Vk=p(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});Ed.BindOnceFuture=void 0;var TX=qk(),ry=class{constructor(e,r){this._callback=e,this._that=r,this._isCalled=!1,this._deferred=new TX.Deferred}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(r=>this._deferred.resolve(r),r=>this._deferred.reject(r))}catch(r){this._deferred.reject(r)}}return this._deferred.promise}};Ed.BindOnceFuture=ry});var $k=p(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd._export=void 0;var Fk=(k(),B(U)),wX=Au();function OX(t,e){return new Promise(r=>{Fk.context.with((0,wX.suppressTracing)(Fk.context.active()),()=>{t.export(e,n=>{r(n)})})})}gd._export=OX});var te=p(oe=>{"use strict";var vX=oe&&oe.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),ve=oe&&oe.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&vX(e,t,r)};Object.defineProperty(oe,"__esModule",{value:!0});oe.internal=oe.baggageUtils=void 0;ve(EI(),oe);ve(gI(),oe);ve(vI(),oe);ve(Ng(),oe);ve(Rg(),oe);ve(sk(),oe);ve(uk(),oe);ve(Lg(),oe);ve(lk(),oe);oe.baggageUtils=wg();ve(Ug(),oe);ve(fk(),oe);ve(Ek(),oe);ve(yk(),oe);ve(Tk(),oe);ve(Yg(),oe);ve(Kg(),oe);ve(Ok(),oe);ve(vk(),oe);ve(Au(),oe);ve(Gg(),oe);ve(Mg(),oe);ve(Dk(),oe);ve(Pg(),oe);ve(xk(),oe);ve(kk(),oe);ve(Bk(),oe);ve(Vk(),oe);ve(Dg(),oe);var bX=$k();oe.internal={_export:bX._export}});var Gk=p(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.ExceptionEventName=void 0;yd.ExceptionEventName="exception"});var iy=p(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});Td.Span=void 0;var Cr=(k(),B(U)),Ot=te(),eo=vn(),AX=Gk(),ny=class{constructor(e,r,n,s,a,o,i=[],u,l,c){this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Cr.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=s,this.parentSpanId=o,this.kind=a,this.links=i;let f=Date.now();this._performanceStartTime=Ot.otperformance.now(),this._performanceOffset=f-(this._performanceStartTime+(0,Ot.getTimeOrigin)()),this._startTimeProvided=u!=null,this.startTime=this._getTime(u??f),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,c!=null&&this.setAttributes(c),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r)}spanContext(){return this._spanContext}setAttribute(e,r){return r==null||this._isSpanEnded()?this:e.length===0?(Cr.diag.warn(`Invalid attribute key: ${e}`),this):(0,Ot.isAttributeValue)(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this):(Cr.diag.warn(`Invalid attribute value set for key: ${e}`),this)}setAttributes(e){for(let[r,n]of Object.entries(e))this.setAttribute(r,n);return this}addEvent(e,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return Cr.diag.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(this._droppedEventsCount===0&&Cr.diag.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),(0,Ot.isTimeInput)(r)&&((0,Ot.isTimeInput)(n)||(n=r),r=void 0);let s=(0,Ot.sanitizeAttributes)(r);return this.events.push({name:e,attributes:s,time:this._getTime(n),droppedAttributesCount:0}),this}setStatus(e){return this._isSpanEnded()?this:(this.status=e,this)}updateName(e){return this._isSpanEnded()?this:(this.name=e,this)}end(e){if(this._isSpanEnded()){Cr.diag.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this._ended=!0,this.endTime=this._getTime(e),this._duration=(0,Ot.hrTimeDuration)(this.startTime,this.endTime),this._duration[0]<0&&(Cr.diag.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Cr.diag.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this)}_getTime(e){if(typeof e=="number"&&e<Ot.otperformance.now())return(0,Ot.hrTime)(e+this._performanceOffset);if(typeof e=="number")return(0,Ot.millisToHrTime)(e);if(e instanceof Date)return(0,Ot.millisToHrTime)(e.getTime());if((0,Ot.isTimeInputHrTime)(e))return e;if(this._startTimeProvided)return(0,Ot.millisToHrTime)(Date.now());let r=Ot.otperformance.now()-this._performanceStartTime;return(0,Ot.addHrTimes)(this.startTime,(0,Ot.millisToHrTime)(r))}isRecording(){return this._ended===!1}recordException(e,r){let n={};typeof e=="string"?n[eo.SemanticAttributes.EXCEPTION_MESSAGE]=e:e&&(e.code?n[eo.SemanticAttributes.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[eo.SemanticAttributes.EXCEPTION_TYPE]=e.name),e.message&&(n[eo.SemanticAttributes.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[eo.SemanticAttributes.EXCEPTION_STACKTRACE]=e.stack)),n[eo.SemanticAttributes.EXCEPTION_TYPE]||n[eo.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(AX.ExceptionEventName,n,r):Cr.diag.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){return this._ended&&Cr.diag.warn(`Can not execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`),this._ended}_truncateToLimitUtil(e,r){return e.length<=r?e:e.substr(0,r)}_truncateToSize(e){let r=this._attributeValueLengthLimit;return r<=0?(Cr.diag.warn(`Attribute value limit must be positive, got ${r}`),e):typeof e=="string"?this._truncateToLimitUtil(e,r):Array.isArray(e)?e.map(n=>typeof n=="string"?this._truncateToLimitUtil(n,r):n):e}};Td.Span=ny});var Cu=p(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.SamplingDecision=void 0;var RX;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(RX=Lu.SamplingDecision||(Lu.SamplingDecision={}))});var Od=p(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});wd.AlwaysOffSampler=void 0;var NX=Cu(),oy=class{shouldSample(){return{decision:NX.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};wd.AlwaysOffSampler=oy});var bd=p(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});vd.AlwaysOnSampler=void 0;var PX=Cu(),sy=class{shouldSample(){return{decision:PX.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};vd.AlwaysOnSampler=sy});var ly=p(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});Rd.ParentBasedSampler=void 0;var Ad=(k(),B(U)),IX=te(),Wk=Od(),ay=bd(),uy=class{constructor(e){var r,n,s,a;this._root=e.root,this._root||((0,IX.globalErrorHandler)(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new ay.AlwaysOnSampler),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new ay.AlwaysOnSampler,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new Wk.AlwaysOffSampler,this._localParentSampled=(s=e.localParentSampled)!==null&&s!==void 0?s:new ay.AlwaysOnSampler,this._localParentNotSampled=(a=e.localParentNotSampled)!==null&&a!==void 0?a:new Wk.AlwaysOffSampler}shouldSample(e,r,n,s,a,o){let i=Ad.trace.getSpanContext(e);return!i||!(0,Ad.isSpanContextValid)(i)?this._root.shouldSample(e,r,n,s,a,o):i.isRemote?i.traceFlags&Ad.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,s,a,o):this._remoteParentNotSampled.shouldSample(e,r,n,s,a,o):i.traceFlags&Ad.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(e,r,n,s,a,o):this._localParentNotSampled.shouldSample(e,r,n,s,a,o)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};Rd.ParentBasedSampler=uy});var fy=p(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.TraceIdRatioBasedSampler=void 0;var MX=(k(),B(U)),jk=Cu(),cy=class{constructor(e=0){this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(e,r){return{decision:(0,MX.isValidTraceId)(r)&&this._accumulate(r)<this._upperBound?jk.SamplingDecision.RECORD_AND_SAMPLED:jk.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let r=0;for(let n=0;n<e.length/8;n++){let s=n*8,a=parseInt(e.slice(s,s+8),16);r=(r^a)>>>0}return r}};Nd.TraceIdRatioBasedSampler=cy});var hy=p(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.buildSamplerFromEnv=cs.loadDefaultConfig=void 0;var Pd=(k(),B(U)),ht=te(),Hk=Od(),dy=bd(),py=ly(),Yk=fy(),LX=(0,ht.getEnv)(),CX=ht.TracesSamplerValues.AlwaysOn,ls=1;function DX(){return{sampler:Kk(LX),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:(0,ht.getEnv)().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:(0,ht.getEnv)().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:(0,ht.getEnv)().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:(0,ht.getEnv)().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:(0,ht.getEnv)().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:(0,ht.getEnv)().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:(0,ht.getEnv)().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:(0,ht.getEnv)().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}cs.loadDefaultConfig=DX;function Kk(t=(0,ht.getEnv)()){switch(t.OTEL_TRACES_SAMPLER){case ht.TracesSamplerValues.AlwaysOn:return new dy.AlwaysOnSampler;case ht.TracesSamplerValues.AlwaysOff:return new Hk.AlwaysOffSampler;case ht.TracesSamplerValues.ParentBasedAlwaysOn:return new py.ParentBasedSampler({root:new dy.AlwaysOnSampler});case ht.TracesSamplerValues.ParentBasedAlwaysOff:return new py.ParentBasedSampler({root:new Hk.AlwaysOffSampler});case ht.TracesSamplerValues.TraceIdRatio:return new Yk.TraceIdRatioBasedSampler(zk(t));case ht.TracesSamplerValues.ParentBasedTraceIdRatio:return new py.ParentBasedSampler({root:new Yk.TraceIdRatioBasedSampler(zk(t))});default:return Pd.diag.error(`OTEL_TRACES_SAMPLER value "${t.OTEL_TRACES_SAMPLER} invalid, defaulting to ${CX}".`),new dy.AlwaysOnSampler}}cs.buildSamplerFromEnv=Kk;function zk(t){if(t.OTEL_TRACES_SAMPLER_ARG===void 0||t.OTEL_TRACES_SAMPLER_ARG==="")return Pd.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${ls}.`),ls;let e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(Pd.diag.error(`OTEL_TRACES_SAMPLER_ARG=${t.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${ls}.`),ls):e<0||e>1?(Pd.diag.error(`OTEL_TRACES_SAMPLER_ARG=${t.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${ls}.`),ls):e}});var my=p(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.reconfigureLimits=fs.mergeConfig=void 0;var Qk=hy(),_y=te();function xX(t){let e={sampler:(0,Qk.buildSamplerFromEnv)()},r=(0,Qk.loadDefaultConfig)(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}fs.mergeConfig=xX;function UX(t){var e,r,n,s,a,o,i,u,l,c,f,h;let S=Object.assign({},t.spanLimits),g=(0,_y.getEnvWithoutDefaults)();return S.attributeCountLimit=(o=(a=(s=(r=(e=t.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&r!==void 0?r:(n=t.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&s!==void 0?s:g.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:g.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&o!==void 0?o:_y.DEFAULT_ATTRIBUTE_COUNT_LIMIT,S.attributeValueLengthLimit=(h=(f=(c=(u=(i=t.spanLimits)===null||i===void 0?void 0:i.attributeValueLengthLimit)!==null&&u!==void 0?u:(l=t.generalLimits)===null||l===void 0?void 0:l.attributeValueLengthLimit)!==null&&c!==void 0?c:g.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:g.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&h!==void 0?h:_y.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,Object.assign({},t,{spanLimits:S})}fs.reconfigureLimits=UX});var Jk=p(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});Id.BatchSpanProcessorBase=void 0;var ds=(k(),B(U)),to=te(),Sy=class{constructor(e,r){this._exporter=e,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;let n=(0,to.getEnv)();this._maxExportBatchSize=typeof r?.maxExportBatchSize=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof r?.maxQueueSize=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof r?.scheduledDelayMillis=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof r?.exportTimeoutMillis=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new to.BindOnceFuture(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(ds.diag.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(e,r){}onEnd(e){this._shutdownOnce.isCalled||(e.spanContext().traceFlags&ds.TraceFlags.SAMPLED)!==0&&this._addToBuffer(e)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&ds.diag.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(ds.diag.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()}_flushAll(){return new Promise((e,r)=>{let n=[],s=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let a=0,o=s;a<o;a++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{e()}).catch(r)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((e,r)=>{let n=setTimeout(()=>{r(new Error("Timeout"))},this._exportTimeoutMillis);ds.context.with((0,to.suppressTracing)(ds.context.active()),()=>{let s=this._finishedSpans.splice(0,this._maxExportBatchSize),a=()=>this._exporter.export(s,i=>{var u;clearTimeout(n),i.code===to.ExportResultCode.SUCCESS?e():r((u=i.error)!==null&&u!==void 0?u:new Error("BatchSpanProcessor: span export failed"))}),o=s.map(i=>i.resource).filter(i=>i.asyncAttributesPending);o.length===0?a():Promise.all(o.map(i=>{var u;return(u=i.waitForAsyncAttributes)===null||u===void 0?void 0:u.call(i)})).then(a,i=>{(0,to.globalErrorHandler)(i),r(i)})})})}_maybeStartTimer(){if(this._isExporting)return;let e=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(r=>{this._isExporting=!1,(0,to.globalErrorHandler)(r)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();this._timer===void 0&&(this._timer=setTimeout(()=>e(),this._scheduledDelayMillis),(0,to.unrefTimer)(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}};Id.BatchSpanProcessorBase=Sy});var Xk=p(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});Md.BatchSpanProcessor=void 0;var kX=Jk(),Ey=class extends kX.BatchSpanProcessorBase{onShutdown(){}};Md.BatchSpanProcessor=Ey});var tB=p(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});Cd.RandomIdGenerator=void 0;var BX=8,eB=16,gy=class{constructor(){this.generateTraceId=Zk(eB),this.generateSpanId=Zk(BX)}};Cd.RandomIdGenerator=gy;var Ld=Buffer.allocUnsafe(eB);function Zk(t){return function(){for(let r=0;r<t/4;r++)Ld.writeUInt32BE(Math.random()*2**32>>>0,r*4);for(let r=0;r<t&&!(Ld[r]>0);r++)r===t-1&&(Ld[t-1]=1);return Ld.toString("hex",0,t)}}});var nB=p(Zn=>{"use strict";var qX=Zn&&Zn.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),rB=Zn&&Zn.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&qX(e,t,r)};Object.defineProperty(Zn,"__esModule",{value:!0});rB(Xk(),Zn);rB(tB(),Zn)});var Dd=p(ro=>{"use strict";var VX=ro&&ro.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),FX=ro&&ro.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&VX(e,t,r)};Object.defineProperty(ro,"__esModule",{value:!0});FX(nB(),ro)});var iB=p(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.Tracer=void 0;var _t=(k(),B(U)),xd=te(),$X=iy(),GX=my(),WX=Dd(),yy=class{constructor(e,r,n){this._tracerProvider=n;let s=(0,GX.mergeConfig)(r);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=r.idGenerator||new WX.RandomIdGenerator,this.resource=n.resource,this.instrumentationLibrary=e}startSpan(e,r={},n=_t.context.active()){var s,a,o;r.root&&(n=_t.trace.deleteSpan(n));let i=_t.trace.getSpan(n);if((0,xd.isTracingSuppressed)(n))return _t.diag.debug("Instrumentation suppressed, returning Noop Span"),_t.trace.wrapSpanContext(_t.INVALID_SPAN_CONTEXT);let u=i?.spanContext(),l=this._idGenerator.generateSpanId(),c,f,h;!u||!_t.trace.isSpanContextValid(u)?c=this._idGenerator.generateTraceId():(c=u.traceId,f=u.traceState,h=u.spanId);let S=(s=r.kind)!==null&&s!==void 0?s:_t.SpanKind.INTERNAL,g=((a=r.links)!==null&&a!==void 0?a:[]).map(I=>({context:I.context,attributes:(0,xd.sanitizeAttributes)(I.attributes)})),E=(0,xd.sanitizeAttributes)(r.attributes),T=this._sampler.shouldSample(n,c,e,S,E,g);f=(o=T.traceState)!==null&&o!==void 0?o:f;let O=T.decision===_t.SamplingDecision.RECORD_AND_SAMPLED?_t.TraceFlags.SAMPLED:_t.TraceFlags.NONE,v={traceId:c,spanId:l,traceFlags:O,traceState:f};if(T.decision===_t.SamplingDecision.NOT_RECORD)return _t.diag.debug("Recording is off, propagating context in a non-recording span"),_t.trace.wrapSpanContext(v);let b=(0,xd.sanitizeAttributes)(Object.assign(E,T.attributes));return new $X.Span(this,n,e,v,S,h,g,r.startTime,void 0,b)}startActiveSpan(e,r,n,s){let a,o,i;if(arguments.length<2)return;arguments.length===2?i=r:arguments.length===3?(a=r,i=n):(a=r,o=n,i=s);let u=o??_t.context.active(),l=this.startSpan(e,a,u),c=_t.trace.setSpan(u,l);return _t.context.with(c,i,void 0,l)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}};Ud.Tracer=yy});var oB=p(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});kd.defaultServiceName=void 0;function jX(){return`unknown_service:${process.argv0}`}kd.defaultServiceName=jX});var Ty=p(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.normalizeType=ps.normalizeArch=void 0;var HX=t=>{switch(t){case"arm":return"arm32";case"ppc":return"ppc32";case"x64":return"amd64";default:return t}};ps.normalizeArch=HX;var YX=t=>{switch(t){case"sunos":return"solaris";case"win32":return"windows";default:return t}};ps.normalizeType=YX});var qd=p(Bd=>{"use strict";Object.defineProperty(Bd,"__esModule",{value:!0});Bd.execAsync=void 0;var zX=require("child_process"),KX=require("util");Bd.execAsync=KX.promisify(zX.exec)});var sB=p(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.getMachineId=void 0;var QX=qd(),JX=(k(),B(U));async function XX(){try{let e=(await(0,QX.execAsync)('ioreg -rd1 -c "IOPlatformExpertDevice"')).stdout.split(`
`).find(n=>n.includes("IOPlatformUUID"));if(!e)return"";let r=e.split('" = "');if(r.length===2)return r[1].slice(0,-1)}catch(t){JX.diag.debug(`error reading machine id: ${t}`)}return""}Vd.getMachineId=XX});var aB=p(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.getMachineId=void 0;var ZX=require("fs"),eZ=(k(),B(U));async function tZ(){let t=["/etc/machine-id","/var/lib/dbus/machine-id"];for(let e of t)try{return(await ZX.promises.readFile(e,{encoding:"utf8"})).trim()}catch(r){eZ.diag.debug(`error reading machine id: ${r}`)}return""}Fd.getMachineId=tZ});var lB=p($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});$d.getMachineId=void 0;var rZ=require("fs"),nZ=qd(),uB=(k(),B(U));async function iZ(){try{return(await rZ.promises.readFile("/etc/hostid",{encoding:"utf8"})).trim()}catch(t){uB.diag.debug(`error reading machine id: ${t}`)}try{return(await(0,nZ.execAsync)("kenv -q smbios.system.uuid")).stdout.trim()}catch(t){uB.diag.debug(`error reading machine id: ${t}`)}return""}$d.getMachineId=iZ});var fB=p(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.getMachineId=void 0;var cB=require("process"),oZ=qd(),sZ=(k(),B(U));async function aZ(){let t="QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",e="%windir%\\System32\\REG.exe";cB.arch==="ia32"&&"PROCESSOR_ARCHITEW6432"in cB.env&&(e="%windir%\\sysnative\\cmd.exe /c "+e);try{let n=(await(0,oZ.execAsync)(`${e} ${t}`)).stdout.split("REG_SZ");if(n.length===2)return n[1].trim()}catch(r){sZ.diag.debug(`error reading machine id: ${r}`)}return""}Gd.getMachineId=aZ});var dB=p(Wd=>{"use strict";Object.defineProperty(Wd,"__esModule",{value:!0});Wd.getMachineId=void 0;var uZ=(k(),B(U));async function lZ(){return uZ.diag.debug("could not read machine-id: unsupported platform"),""}Wd.getMachineId=lZ});var pB=p(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.getMachineId=void 0;var cZ=require("process"),hs;bn.getMachineId=hs;switch(cZ.platform){case"darwin":bn.getMachineId=hs=sB().getMachineId;break;case"linux":bn.getMachineId=hs=aB().getMachineId;break;case"freebsd":bn.getMachineId=hs=lB().getMachineId;break;case"win32":bn.getMachineId=hs=fB().getMachineId;break;default:bn.getMachineId=hs=dB().getMachineId}});var vy=p(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.hostDetectorSync=void 0;var wy=vn(),fZ=no(),hB=require("os"),dZ=Ty(),pZ=pB(),Oy=class{detect(e){let r={[wy.SemanticResourceAttributes.HOST_NAME]:(0,hB.hostname)(),[wy.SemanticResourceAttributes.HOST_ARCH]:(0,dZ.normalizeArch)((0,hB.arch)())};return new fZ.Resource(r,this._getAsyncAttributes())}_getAsyncAttributes(){return(0,pZ.getMachineId)().then(e=>{let r={};return e&&(r[wy.SemanticResourceAttributes.HOST_ID]=e),r})}};jd.hostDetectorSync=new Oy});var _B=p(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.hostDetector=void 0;var hZ=vy(),by=class{detect(e){return Promise.resolve(hZ.hostDetectorSync.detect(e))}};Hd.hostDetector=new by});var Ry=p(Yd=>{"use strict";Object.defineProperty(Yd,"__esModule",{value:!0});Yd.osDetectorSync=void 0;var mB=vn(),_Z=no(),SB=require("os"),mZ=Ty(),Ay=class{detect(e){let r={[mB.SemanticResourceAttributes.OS_TYPE]:(0,mZ.normalizeType)((0,SB.platform)()),[mB.SemanticResourceAttributes.OS_VERSION]:(0,SB.release)()};return new _Z.Resource(r)}};Yd.osDetectorSync=new Ay});var EB=p(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.osDetector=void 0;var SZ=Ry(),Ny=class{detect(e){return Promise.resolve(SZ.osDetectorSync.detect(e))}};zd.osDetector=new Ny});var Iy=p(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});Kd.processDetectorSync=void 0;var EZ=(k(),B(U)),An=vn(),gZ=no(),yZ=require("os"),Py=class{detect(e){let r={[An.SemanticResourceAttributes.PROCESS_PID]:process.pid,[An.SemanticResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title,[An.SemanticResourceAttributes.PROCESS_EXECUTABLE_PATH]:process.execPath,[An.SemanticResourceAttributes.PROCESS_COMMAND_ARGS]:[process.argv[0],...process.execArgv,...process.argv.slice(1)],[An.SemanticResourceAttributes.PROCESS_RUNTIME_VERSION]:process.versions.node,[An.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]:"nodejs",[An.SemanticResourceAttributes.PROCESS_RUNTIME_DESCRIPTION]:"Node.js"};process.argv.length>1&&(r[An.SemanticResourceAttributes.PROCESS_COMMAND]=process.argv[1]);try{let n=yZ.userInfo();r[An.SemanticResourceAttributes.PROCESS_OWNER]=n.username}catch(n){EZ.diag.debug(`error obtaining process owner: ${n}`)}return new gZ.Resource(r)}};Kd.processDetectorSync=new Py});var gB=p(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.processDetector=void 0;var TZ=Iy(),My=class{detect(e){return Promise.resolve(TZ.processDetectorSync.detect(e))}};Qd.processDetector=new My});var yB=p(ir=>{"use strict";var wZ=ir&&ir.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),io=ir&&ir.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&wZ(e,t,r)};Object.defineProperty(ir,"__esModule",{value:!0});io(oB(),ir);io(_B(),ir);io(EB(),ir);io(vy(),ir);io(Ry(),ir);io(gB(),ir);io(Iy(),ir)});var Ly=p(oo=>{"use strict";var OZ=oo&&oo.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),vZ=oo&&oo.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&OZ(e,t,r)};Object.defineProperty(oo,"__esModule",{value:!0});vZ(yB(),oo)});var no=p(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.Resource=void 0;var TB=(k(),B(U)),so=vn(),Cy=te(),bZ=Ly(),Du=class t{constructor(e,r){var n;this._attributes=e,this.asyncAttributesPending=r!=null,this._syncAttributes=(n=this._attributes)!==null&&n!==void 0?n:{},this._asyncAttributesPromise=r?.then(s=>(this._attributes=Object.assign({},this._attributes,s),this.asyncAttributesPending=!1,s),s=>(TB.diag.debug("a resource's async attributes promise rejected: %s",s),this.asyncAttributesPending=!1,{}))}static empty(){return t.EMPTY}static default(){return new t({[so.SemanticResourceAttributes.SERVICE_NAME]:(0,bZ.defaultServiceName)(),[so.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]:Cy.SDK_INFO[so.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],[so.SemanticResourceAttributes.TELEMETRY_SDK_NAME]:Cy.SDK_INFO[so.SemanticResourceAttributes.TELEMETRY_SDK_NAME],[so.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]:Cy.SDK_INFO[so.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]})}get attributes(){var e;return this.asyncAttributesPending&&TB.diag.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}}async waitForAsyncAttributes(){this.asyncAttributesPending&&await this._asyncAttributesPromise}merge(e){var r;if(!e)return this;let n=Object.assign(Object.assign({},this._syncAttributes),(r=e._syncAttributes)!==null&&r!==void 0?r:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(n);let s=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(([a,o])=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign({},this._syncAttributes),a),(i=e._syncAttributes)!==null&&i!==void 0?i:e.attributes),o)});return new t(n,s)}};Jd.Resource=Du;Du.EMPTY=new Du({})});var OB=p(wB=>{"use strict";Object.defineProperty(wB,"__esModule",{value:!0})});var bB=p(vB=>{"use strict";Object.defineProperty(vB,"__esModule",{value:!0})});var RB=p(AB=>{"use strict";Object.defineProperty(AB,"__esModule",{value:!0})});var NB=p(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.browserDetector=void 0;var AZ=_s(),Dy=class{detect(e){return Promise.resolve(AZ.browserDetectorSync.detect(e))}};Xd.browserDetector=new Dy});var Uy=p(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.envDetectorSync=void 0;var RZ=(k(),B(U)),NZ=te(),PZ=vn(),IZ=no(),xy=class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}detect(e){let r={},n=(0,NZ.getEnv)(),s=n.OTEL_RESOURCE_ATTRIBUTES,a=n.OTEL_SERVICE_NAME;if(s)try{let o=this._parseResourceAttributes(s);Object.assign(r,o)}catch(o){RZ.diag.debug(`EnvDetector failed: ${o.message}`)}return a&&(r[PZ.SemanticResourceAttributes.SERVICE_NAME]=a),new IZ.Resource(r)}_parseResourceAttributes(e){if(!e)return{};let r={},n=e.split(this._COMMA_SEPARATOR,-1);for(let s of n){let a=s.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(a.length!==2)continue;let[o,i]=a;if(o=o.trim(),i=i.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(o))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(i))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);r[o]=decodeURIComponent(i)}return r}_isValid(e){return e.length<=this._MAX_LENGTH&&this._isBaggageOctetString(e)}_isBaggageOctetString(e){for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<33||n===44||n===59||n===92||n>126)return!1}return!0}_isValidAndNotEmpty(e){return e.length>0&&this._isValid(e)}};Zd.envDetectorSync=new xy});var PB=p(ep=>{"use strict";Object.defineProperty(ep,"__esModule",{value:!0});ep.envDetector=void 0;var MZ=Uy(),ky=class{detect(e){return Promise.resolve(MZ.envDetectorSync.detect(e))}};ep.envDetector=new ky});var IB=p(rp=>{"use strict";Object.defineProperty(rp,"__esModule",{value:!0});rp.browserDetectorSync=void 0;var tp=vn(),By=_s(),LZ=(k(),B(U)),qy=class{detect(e){if(!(typeof navigator<"u"))return By.Resource.empty();let n={[tp.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]:"browser",[tp.SemanticResourceAttributes.PROCESS_RUNTIME_DESCRIPTION]:"Web Browser",[tp.SemanticResourceAttributes.PROCESS_RUNTIME_VERSION]:navigator.userAgent};return this._getResourceAttributes(n,e)}_getResourceAttributes(e,r){return e[tp.SemanticResourceAttributes.PROCESS_RUNTIME_VERSION]===""?(LZ.diag.debug("BrowserDetector failed: Unable to find required browser resources. "),By.Resource.empty()):new By.Resource(Object.assign({},e))}};rp.browserDetectorSync=new qy});var MB=p(en=>{"use strict";var CZ=en&&en.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),np=en&&en.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&CZ(e,t,r)};Object.defineProperty(en,"__esModule",{value:!0});np(NB(),en);np(PB(),en);np(IB(),en);np(Uy(),en)});var LB=p(ip=>{"use strict";Object.defineProperty(ip,"__esModule",{value:!0});ip.isPromiseLike=void 0;var DZ=t=>t!==null&&typeof t=="object"&&typeof t.then=="function";ip.isPromiseLike=DZ});var DB=p(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.detectResourcesSync=Ss.detectResources=void 0;var xu=no(),ms=(k(),B(U)),xZ=LB(),UZ=async(t={})=>{let e=await Promise.all((t.detectors||[]).map(async r=>{try{let n=await r.detect(t);return ms.diag.debug(`${r.constructor.name} found resource.`,n),n}catch(n){return ms.diag.debug(`${r.constructor.name} failed: ${n.message}`),xu.Resource.empty()}}));return CB(e),e.reduce((r,n)=>r.merge(n),xu.Resource.empty())};Ss.detectResources=UZ;var kZ=(t={})=>{var e;let r=((e=t.detectors)!==null&&e!==void 0?e:[]).map(s=>{try{let a=s.detect(t),o;if((0,xZ.isPromiseLike)(a)){let i=async()=>(await a).attributes;o=new xu.Resource({},i())}else o=a;return o.waitForAsyncAttributes?o.waitForAsyncAttributes().then(()=>ms.diag.debug(`${s.constructor.name} found resource.`,o)):ms.diag.debug(`${s.constructor.name} found resource.`,o),o}catch(a){return ms.diag.error(`${s.constructor.name} failed: ${a.message}`),xu.Resource.empty()}}),n=r.reduce((s,a)=>s.merge(a),xu.Resource.empty());return n.waitForAsyncAttributes&&n.waitForAsyncAttributes().then(()=>{CB(r)}),n};Ss.detectResourcesSync=kZ;var CB=t=>{t.forEach(e=>{if(Object.keys(e.attributes).length>0){let r=JSON.stringify(e.attributes,null,4);ms.diag.verbose(r)}})}});var _s=p(or=>{"use strict";var BZ=or&&or.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),ao=or&&or.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&BZ(e,t,r)};Object.defineProperty(or,"__esModule",{value:!0});ao(no(),or);ao(OB(),or);ao(Ly(),or);ao(bB(),or);ao(RB(),or);ao(MB(),or);ao(DB(),or)});var xB=p(op=>{"use strict";Object.defineProperty(op,"__esModule",{value:!0});op.MultiSpanProcessor=void 0;var qZ=te(),Vy=class{constructor(e){this._spanProcessors=e}forceFlush(){let e=[];for(let r of this._spanProcessors)e.push(r.forceFlush());return new Promise(r=>{Promise.all(e).then(()=>{r()}).catch(n=>{(0,qZ.globalErrorHandler)(n||new Error("MultiSpanProcessor: forceFlush failed")),r()})})}onStart(e,r){for(let n of this._spanProcessors)n.onStart(e,r)}onEnd(e){for(let r of this._spanProcessors)r.onEnd(e)}shutdown(){let e=[];for(let r of this._spanProcessors)e.push(r.shutdown());return new Promise((r,n)=>{Promise.all(e).then(()=>{r()},n)})}};op.MultiSpanProcessor=Vy});var $y=p(sp=>{"use strict";Object.defineProperty(sp,"__esModule",{value:!0});sp.NoopSpanProcessor=void 0;var Fy=class{onStart(e,r){}onEnd(e){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}};sp.NoopSpanProcessor=Fy});var kB=p(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.BasicTracerProvider=uo.ForceFlushState=void 0;var Es=(k(),B(U)),ys=te(),UB=_s(),VZ=ap(),FZ=hy(),$Z=xB(),GZ=$y(),WZ=Dd(),jZ=my(),gs;(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(gs=uo.ForceFlushState||(uo.ForceFlushState={}));var Uu=class{constructor(e={}){var r;this._registeredSpanProcessors=[],this._tracers=new Map;let n=(0,ys.merge)({},(0,FZ.loadDefaultConfig)(),(0,jZ.reconfigureLimits)(e));this.resource=(r=n.resource)!==null&&r!==void 0?r:UB.Resource.empty(),this.resource=UB.Resource.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});let s=this._buildExporterFromEnv();if(s!==void 0){let a=new WZ.BatchSpanProcessor(s);this.activeSpanProcessor=a}else this.activeSpanProcessor=new GZ.NoopSpanProcessor}getTracer(e,r,n){let s=`${e}@${r||""}:${n?.schemaUrl||""}`;return this._tracers.has(s)||this._tracers.set(s,new VZ.Tracer({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this)),this._tracers.get(s)}addSpanProcessor(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(r=>Es.diag.error("Error while trying to shutdown current span processor",r)),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new $Z.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(e={}){Es.trace.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Es.context.setGlobalContextManager(e.contextManager),e.propagator&&Es.propagation.setGlobalPropagator(e.propagator)}forceFlush(){let e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(n=>new Promise(s=>{let a,o=setTimeout(()=>{s(new Error(`Span processor did not completed within timeout period of ${e} ms`)),a=gs.timeout},e);n.forceFlush().then(()=>{clearTimeout(o),a!==gs.timeout&&(a=gs.resolved,s(a))}).catch(i=>{clearTimeout(o),a=gs.error,s(i)})}));return new Promise((n,s)=>{Promise.all(r).then(a=>{let o=a.filter(i=>i!==gs.resolved);o.length>0?s(o):n()}).catch(a=>s([a]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(e){var r;return(r=this.constructor._registeredPropagators.get(e))===null||r===void 0?void 0:r()}_getSpanExporter(e){var r;return(r=this.constructor._registeredExporters.get(e))===null||r===void 0?void 0:r()}_buildPropagatorFromEnv(){let e=Array.from(new Set((0,ys.getEnv)().OTEL_PROPAGATORS)),n=e.map(s=>{let a=this._getPropagator(s);return a||Es.diag.warn(`Propagator "${s}" requested through environment variable is unavailable.`),a}).reduce((s,a)=>(a&&s.push(a),s),[]);if(n.length!==0)return e.length===1?n[0]:new ys.CompositePropagator({propagators:n})}_buildExporterFromEnv(){let e=(0,ys.getEnv)().OTEL_TRACES_EXPORTER;if(e==="none"||e==="")return;let r=this._getSpanExporter(e);return r||Es.diag.error(`Exporter "${e}" requested through environment variable is unavailable.`),r}};uo.BasicTracerProvider=Uu;Uu._registeredPropagators=new Map([["tracecontext",()=>new ys.W3CTraceContextPropagator],["baggage",()=>new ys.W3CBaggagePropagator]]);Uu._registeredExporters=new Map});var BB=p(up=>{"use strict";Object.defineProperty(up,"__esModule",{value:!0});up.ConsoleSpanExporter=void 0;var Gy=te(),Wy=class{export(e,r){return this._sendSpans(e,r)}shutdown(){return this._sendSpans([]),this.forceFlush()}forceFlush(){return Promise.resolve()}_exportInfo(e){var r;return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,traceState:(r=e.spanContext().traceState)===null||r===void 0?void 0:r.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:(0,Gy.hrTimeToMicroseconds)(e.startTime),duration:(0,Gy.hrTimeToMicroseconds)(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}}_sendSpans(e,r){for(let n of e)console.dir(this._exportInfo(n),{depth:3});if(r)return r({code:Gy.ExportResultCode.SUCCESS})}};up.ConsoleSpanExporter=Wy});var VB=p(lp=>{"use strict";Object.defineProperty(lp,"__esModule",{value:!0});lp.InMemorySpanExporter=void 0;var qB=te(),jy=class{constructor(){this._finishedSpans=[],this._stopped=!1}export(e,r){if(this._stopped)return r({code:qB.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...e),setTimeout(()=>r({code:qB.ExportResultCode.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()}forceFlush(){return Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}};lp.InMemorySpanExporter=jy});var $B=p(FB=>{"use strict";Object.defineProperty(FB,"__esModule",{value:!0})});var GB=p(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0});cp.SimpleSpanProcessor=void 0;var HZ=(k(),B(U)),Ts=te(),Hy=class{constructor(e){this._exporter=e,this._shutdownOnce=new Ts.BindOnceFuture(this._shutdown,this),this._unresolvedExports=new Set}async forceFlush(){await Promise.all(Array.from(this._unresolvedExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(e,r){}onEnd(e){var r,n;if(this._shutdownOnce.isCalled||(e.spanContext().traceFlags&HZ.TraceFlags.SAMPLED)===0)return;let s=()=>Ts.internal._export(this._exporter,[e]).then(a=>{var o;a.code!==Ts.ExportResultCode.SUCCESS&&(0,Ts.globalErrorHandler)((o=a.error)!==null&&o!==void 0?o:new Error(`SimpleSpanProcessor: span export failed (status ${a})`))}).catch(a=>{(0,Ts.globalErrorHandler)(a)});if(e.resource.asyncAttributesPending){let a=(n=(r=e.resource).waitForAsyncAttributes)===null||n===void 0?void 0:n.call(r).then(()=>(a!=null&&this._unresolvedExports.delete(a),s()),o=>(0,Ts.globalErrorHandler)(o));a!=null&&this._unresolvedExports.add(a)}else s()}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}};cp.SimpleSpanProcessor=Hy});var jB=p(WB=>{"use strict";Object.defineProperty(WB,"__esModule",{value:!0})});var YB=p(HB=>{"use strict";Object.defineProperty(HB,"__esModule",{value:!0})});var KB=p(zB=>{"use strict";Object.defineProperty(zB,"__esModule",{value:!0})});var JB=p(QB=>{"use strict";Object.defineProperty(QB,"__esModule",{value:!0})});var ZB=p(XB=>{"use strict";Object.defineProperty(XB,"__esModule",{value:!0})});var ap=p(Ie=>{"use strict";var YZ=Ie&&Ie.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),tt=Ie&&Ie.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&YZ(e,t,r)};Object.defineProperty(Ie,"__esModule",{value:!0});tt(iB(),Ie);tt(kB(),Ie);tt(Dd(),Ie);tt(BB(),Ie);tt(VB(),Ie);tt($B(),Ie);tt(GB(),Ie);tt(jB(),Ie);tt($y(),Ie);tt(Od(),Ie);tt(bd(),Ie);tt(ly(),Ie);tt(fy(),Ie);tt(Cu(),Ie);tt(iy(),Ie);tt(YB(),Ie);tt(KB(),Ie);tt(JB(),Ie);tt(ZB(),Ie)});var zy=p(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.Tracer=qt.installTraceContextManager=qt.isTraceContextWorking=qt.getActiveSpan=qt.runWithTrace=qt.SpanStatusCode=void 0;var Dr=gt(),e2;(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(e2||(qt.SpanStatusCode=e2={}));var fp=class{attributes={};setStatus(e){return this}setAttribute(e,r){return this}addEvent(e,r,n){return this}};function zZ(t,e){if(!Dr.globalParams.enableOTLP)return e();let{context:r,trace:n}=(k(),B(U));return r.with(n.setSpan(r.active(),t),e)}qt.runWithTrace=zZ;function KZ(){if(!Dr.globalParams.enableOTLP)return;let{trace:t}=(k(),B(U));return t.getActiveSpan()}qt.getActiveSpan=KZ;function QZ(){if(!Dr.globalParams.enableOTLP)return!1;let{context:t,trace:e}=(k(),B(U)),r=e.getTracer("otel-bootstrap-check").startSpan("probe"),n=e.setSpan(t.active(),r),s;return t.with(n,()=>{s=e.getSpan(t.active())===r}),r.end?.(),s===!0}qt.isTraceContextWorking=QZ;function JZ(t="dbos"){if(!Dr.globalParams.enableOTLP)return;let{AsyncLocalStorageContextManager:e}=mI(),{context:r,trace:n}=(k(),B(U)),{BasicTracerProvider:s}=ap(),a=new e;a.enable(),r.setGlobalContextManager(a);let o=new s({resource:{attributes:{"service.name":t}}});n.setGlobalTracerProvider(o)}qt.installTraceContextManager=JZ;var Yy=class{telemetryCollector;applicationID;executorID;constructor(e,r="dbos"){if(this.telemetryCollector=e,this.applicationID=Dr.globalParams.appID,this.executorID=Dr.globalParams.executorID,!Dr.globalParams.enableOTLP)return;let{trace:n}=(k(),B(U)),{BasicTracerProvider:s}=ap(),a=new s({resource:{attributes:{"service.name":r}}});n.setGlobalTracerProvider(a)}startSpanWithContext(e,r,n){if(!Dr.globalParams.enableOTLP)return new fp;let s=(k(),B(U)),a=s.trace.getTracer("dbos-tracer"),o=s.trace.setSpanContext(s.context.active(),e);return a.startSpan(r,{startTime:performance.now(),attributes:n},o)}startSpan(e,r,n){if(!Dr.globalParams.enableOTLP)return new fp;let s=n,a=(k(),B(U)),{hrTime:o}=te(),i=a.trace.getTracer("dbos-tracer"),u=o(performance.now());if(s){let l=a.trace.setSpan(a.context.active(),s);return i.startSpan(e,{startTime:u,attributes:r},l)}else return i.startSpan(e,{startTime:u,attributes:r})}endSpan(e){if(!Dr.globalParams.enableOTLP)return;let{hrTime:r}=te(),n=e;n.setAttributes({applicationID:this.applicationID,applicationVersion:Dr.globalParams.appVersion}),n.attributes&&!("executorID"in n.attributes)&&n.setAttribute("executorID",this.executorID),n.end(r(performance.now())),this.telemetryCollector.push(n)}};qt.Tracer=Yy});var r2=p((g0e,t2)=>{t2.exports=require("util").deprecate});var Ky=p((y0e,n2)=>{n2.exports=require("stream")});var Jy=p((T0e,o2)=>{"use strict";function XZ(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return n||s?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Qy,this,t)):process.nextTick(Qy,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(a){!e&&a?r._writableState?r._writableState.errorEmitted?process.nextTick(dp,r):(r._writableState.errorEmitted=!0,process.nextTick(i2,r,a)):process.nextTick(i2,r,a):e?(process.nextTick(dp,r),e(a)):process.nextTick(dp,r)}),this)}function i2(t,e){Qy(t,e),dp(t)}function dp(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function ZZ(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Qy(t,e){t.emit("error",e)}function eee(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}o2.exports={destroy:XZ,undestroy:ZZ,errorOrDestroy:eee}});var ei=p((w0e,u2)=>{"use strict";var a2={};function _r(t,e,r){r||(r=Error);function n(a,o,i){return typeof e=="string"?e:e(a,o,i)}class s extends r{constructor(o,i,u){super(n(o,i,u))}}s.prototype.name=r.name,s.prototype.code=t,a2[t]=s}function s2(t,e){if(Array.isArray(t)){let r=t.length;return t=t.map(n=>String(n)),r>2?`one of ${e} ${t.slice(0,r-1).join(", ")}, or `+t[r-1]:r===2?`one of ${e} ${t[0]} or ${t[1]}`:`of ${e} ${t[0]}`}else return`of ${e} ${String(t)}`}function tee(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function ree(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function nee(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}_r("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);_r("ERR_INVALID_ARG_TYPE",function(t,e,r){let n;typeof e=="string"&&tee(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";let s;if(ree(t," argument"))s=`The ${t} ${n} ${s2(e,"type")}`;else{let a=nee(t,".")?"property":"argument";s=`The "${t}" ${a} ${n} ${s2(e,"type")}`}return s+=`. Received type ${typeof r}`,s},TypeError);_r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");_r("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});_r("ERR_STREAM_PREMATURE_CLOSE","Premature close");_r("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});_r("ERR_MULTIPLE_CALLBACK","Callback called multiple times");_r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");_r("ERR_STREAM_WRITE_AFTER_END","write after end");_r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);_r("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);_r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");u2.exports.codes=a2});var Xy=p((O0e,l2)=>{"use strict";var iee=ei().codes.ERR_INVALID_OPT_VALUE;function oee(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function see(t,e,r,n){var s=oee(e,n,r);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var a=n?r:"highWaterMark";throw new iee(a,s)}return Math.floor(s)}return t.objectMode?16:16*1024}l2.exports={getHighWaterMark:see}});var c2=p((v0e,Zy)=>{typeof Object.create=="function"?Zy.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Zy.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var ws=p((b0e,tT)=>{try{if(eT=require("util"),typeof eT.inherits!="function")throw"";tT.exports=eT.inherits}catch{tT.exports=c2()}var eT});var m2=p((A0e,_2)=>{"use strict";function f2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function d2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f2(Object(r),!0).forEach(function(n){aee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f2(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aee(t,e,r){return e=h2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p2(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h2(n.key),n)}}function lee(t,e,r){return e&&p2(t.prototype,e),r&&p2(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h2(t){var e=cee(t,"string");return typeof e=="symbol"?e:String(e)}function cee(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fee=require("buffer"),pp=fee.Buffer,dee=require("util"),rT=dee.inspect,pee=rT&&rT.custom||"inspect";function hee(t,e,r){pp.prototype.copy.call(t,e,r)}_2.exports=(function(){function t(){uee(this,t),this.head=null,this.tail=null,this.length=0}return lee(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,s=""+n.data;n=n.next;)s+=r+n.data;return s}},{key:"concat",value:function(r){if(this.length===0)return pp.alloc(0);for(var n=pp.allocUnsafe(r>>>0),s=this.head,a=0;s;)hee(s.data,n,a),a+=s.data.length,s=s.next;return n}},{key:"consume",value:function(r,n){var s;return r<this.head.data.length?(s=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?s=this.shift():s=n?this._getString(r):this._getBuffer(r),s}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,s=1,a=n.data;for(r-=a.length;n=n.next;){var o=n.data,i=r>o.length?o.length:r;if(i===o.length?a+=o:a+=o.slice(0,r),r-=i,r===0){i===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(i));break}++s}return this.length-=s,a}},{key:"_getBuffer",value:function(r){var n=pp.allocUnsafe(r),s=this.head,a=1;for(s.data.copy(n),r-=s.data.length;s=s.next;){var o=s.data,i=r>o.length?o.length:r;if(o.copy(n,n.length-r,0,i),r-=i,r===0){i===o.length?(++a,s.next?this.head=s.next:this.head=this.tail=null):(this.head=s,s.data=o.slice(i));break}++a}return this.length-=a,n}},{key:pee,value:function(r,n){return rT(this,d2(d2({},n),{},{depth:0,customInspect:!1}))}}]),t})()});var g2=p((nT,E2)=>{var hp=require("buffer"),tn=hp.Buffer;function S2(t,e){for(var r in t)e[r]=t[r]}tn.from&&tn.alloc&&tn.allocUnsafe&&tn.allocUnsafeSlow?E2.exports=hp:(S2(hp,nT),nT.Buffer=lo);function lo(t,e,r){return tn(t,e,r)}lo.prototype=Object.create(tn.prototype);S2(tn,lo);lo.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return tn(t,e,r)};lo.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=tn(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};lo.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return tn(t)};lo.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return hp.SlowBuffer(t)}});var sT=p(T2=>{"use strict";var oT=g2().Buffer,y2=oT.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _ee(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function mee(t){var e=_ee(t);if(typeof e!="string"&&(oT.isEncoding===y2||!y2(t)))throw new Error("Unknown encoding: "+t);return e||t}T2.StringDecoder=ku;function ku(t){this.encoding=mee(t);var e;switch(this.encoding){case"utf16le":this.text=wee,this.end=Oee,e=4;break;case"utf8":this.fillLast=gee,e=4;break;case"base64":this.text=vee,this.end=bee,e=3;break;default:this.write=Aee,this.end=Ree;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=oT.allocUnsafe(e)}ku.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};ku.prototype.end=Tee;ku.prototype.text=yee;ku.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function iT(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function See(t,e,r){var n=e.length-1;if(n<r)return 0;var s=iT(e[n]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--n<r||s===-2?0:(s=iT(e[n]),s>=0?(s>0&&(t.lastNeed=s-2),s):--n<r||s===-2?0:(s=iT(e[n]),s>=0?(s>0&&(s===2?s=0:t.lastNeed=s-3),s):0))}function Eee(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function gee(t){var e=this.lastTotal-this.lastNeed,r=Eee(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function yee(t,e){var r=See(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function Tee(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function wee(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Oee(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function vee(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function bee(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Aee(t){return t.toString(this.encoding)}function Ree(t){return t&&t.length?this.write(t):""}});var _p=p((N0e,v2)=>{"use strict";var w2=ei().codes.ERR_STREAM_PREMATURE_CLOSE;function Nee(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];t.apply(this,n)}}}function Pee(){}function Iee(t){return t.setHeader&&typeof t.abort=="function"}function O2(t,e,r){if(typeof e=="function")return O2(t,null,e);e||(e={}),r=Nee(r||Pee);var n=e.readable||e.readable!==!1&&t.readable,s=e.writable||e.writable!==!1&&t.writable,a=function(){t.writable||i()},o=t._writableState&&t._writableState.finished,i=function(){s=!1,o=!0,n||r.call(t)},u=t._readableState&&t._readableState.endEmitted,l=function(){n=!1,u=!0,s||r.call(t)},c=function(g){r.call(t,g)},f=function(){var g;if(n&&!u)return(!t._readableState||!t._readableState.ended)&&(g=new w2),r.call(t,g);if(s&&!o)return(!t._writableState||!t._writableState.ended)&&(g=new w2),r.call(t,g)},h=function(){t.req.on("finish",i)};return Iee(t)?(t.on("complete",i),t.on("abort",f),t.req?h():t.on("request",h)):s&&!t._writableState&&(t.on("end",a),t.on("close",a)),t.on("end",l),t.on("finish",i),e.error!==!1&&t.on("error",c),t.on("close",f),function(){t.removeListener("complete",i),t.removeListener("abort",f),t.removeListener("request",h),t.req&&t.req.removeListener("finish",i),t.removeListener("end",a),t.removeListener("close",a),t.removeListener("finish",i),t.removeListener("end",l),t.removeListener("error",c),t.removeListener("close",f)}}v2.exports=O2});var A2=p((P0e,b2)=>{"use strict";var mp;function ti(t,e,r){return e=Mee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mee(t){var e=Lee(t,"string");return typeof e=="symbol"?e:String(e)}function Lee(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cee=_p(),ri=Symbol("lastResolve"),co=Symbol("lastReject"),Bu=Symbol("error"),Sp=Symbol("ended"),fo=Symbol("lastPromise"),aT=Symbol("handlePromise"),po=Symbol("stream");function ni(t,e){return{value:t,done:e}}function Dee(t){var e=t[ri];if(e!==null){var r=t[po].read();r!==null&&(t[fo]=null,t[ri]=null,t[co]=null,e(ni(r,!1)))}}function xee(t){process.nextTick(Dee,t)}function Uee(t,e){return function(r,n){t.then(function(){if(e[Sp]){r(ni(void 0,!0));return}e[aT](r,n)},n)}}var kee=Object.getPrototypeOf(function(){}),Bee=Object.setPrototypeOf((mp={get stream(){return this[po]},next:function(){var e=this,r=this[Bu];if(r!==null)return Promise.reject(r);if(this[Sp])return Promise.resolve(ni(void 0,!0));if(this[po].destroyed)return new Promise(function(o,i){process.nextTick(function(){e[Bu]?i(e[Bu]):o(ni(void 0,!0))})});var n=this[fo],s;if(n)s=new Promise(Uee(n,this));else{var a=this[po].read();if(a!==null)return Promise.resolve(ni(a,!1));s=new Promise(this[aT])}return this[fo]=s,s}},ti(mp,Symbol.asyncIterator,function(){return this}),ti(mp,"return",function(){var e=this;return new Promise(function(r,n){e[po].destroy(null,function(s){if(s){n(s);return}r(ni(void 0,!0))})})}),mp),kee),qee=function(e){var r,n=Object.create(Bee,(r={},ti(r,po,{value:e,writable:!0}),ti(r,ri,{value:null,writable:!0}),ti(r,co,{value:null,writable:!0}),ti(r,Bu,{value:null,writable:!0}),ti(r,Sp,{value:e._readableState.endEmitted,writable:!0}),ti(r,aT,{value:function(a,o){var i=n[po].read();i?(n[fo]=null,n[ri]=null,n[co]=null,a(ni(i,!1))):(n[ri]=a,n[co]=o)},writable:!0}),r));return n[fo]=null,Cee(e,function(s){if(s&&s.code!=="ERR_STREAM_PREMATURE_CLOSE"){var a=n[co];a!==null&&(n[fo]=null,n[ri]=null,n[co]=null,a(s)),n[Bu]=s;return}var o=n[ri];o!==null&&(n[fo]=null,n[ri]=null,n[co]=null,o(ni(void 0,!0))),n[Sp]=!0}),e.on("readable",xee.bind(null,n)),n};b2.exports=qee});var I2=p((I0e,P2)=>{"use strict";function R2(t,e,r,n,s,a,o){try{var i=t[a](o),u=i.value}catch(l){r(l);return}i.done?e(u):Promise.resolve(u).then(n,s)}function Vee(t){return function(){var e=this,r=arguments;return new Promise(function(n,s){var a=t.apply(e,r);function o(u){R2(a,n,s,o,i,"next",u)}function i(u){R2(a,n,s,o,i,"throw",u)}o(void 0)})}}function N2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Fee(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?N2(Object(r),!0).forEach(function(n){$ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N2(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $ee(t,e,r){return e=Gee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:String(e)}function Wee(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jee=ei().codes.ERR_INVALID_ARG_TYPE;function Hee(t,e,r){var n;if(e&&typeof e.next=="function")n=e;else if(e&&e[Symbol.asyncIterator])n=e[Symbol.asyncIterator]();else if(e&&e[Symbol.iterator])n=e[Symbol.iterator]();else throw new jee("iterable",["Iterable"],e);var s=new t(Fee({objectMode:!0},r)),a=!1;s._read=function(){a||(a=!0,o())};function o(){return i.apply(this,arguments)}function i(){return i=Vee(function*(){try{var u=yield n.next(),l=u.value,c=u.done;c?s.push(null):s.push(yield l)?o():a=!1}catch(f){s.destroy(f)}}),i.apply(this,arguments)}return s}P2.exports=Hee});var ST=p((L0e,V2)=>{"use strict";V2.exports=he;var Os;he.ReadableState=D2;var M0e=require("events").EventEmitter,C2=function(e,r){return e.listeners(r).length},Vu=Ky(),Ep=require("buffer").Buffer,Yee=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function zee(t){return Ep.from(t)}function Kee(t){return Ep.isBuffer(t)||t instanceof Yee}var uT=require("util"),se;uT&&uT.debuglog?se=uT.debuglog("stream"):se=function(){};var Qee=m2(),_T=Jy(),Jee=Xy(),Xee=Jee.getHighWaterMark,gp=ei().codes,Zee=gp.ERR_INVALID_ARG_TYPE,ete=gp.ERR_STREAM_PUSH_AFTER_EOF,tte=gp.ERR_METHOD_NOT_IMPLEMENTED,rte=gp.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,vs,lT,cT;ws()(he,Vu);var qu=_T.errorOrDestroy,fT=["error","close","destroy","pause","resume"];function nte(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function D2(t,e,r){Os=Os||ho(),t=t||{},typeof r!="boolean"&&(r=e instanceof Os),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=Xee(this,t,"readableHighWaterMark",r),this.buffer=new Qee,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(vs||(vs=sT().StringDecoder),this.decoder=new vs(t.encoding),this.encoding=t.encoding)}function he(t){if(Os=Os||ho(),!(this instanceof he))return new he(t);var e=this instanceof Os;this._readableState=new D2(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Vu.call(this)}Object.defineProperty(he.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});he.prototype.destroy=_T.destroy;he.prototype._undestroy=_T.undestroy;he.prototype._destroy=function(t,e){e(t)};he.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=Ep.from(t,e),e=""),n=!0),x2(this,t,e,!1,n)};he.prototype.unshift=function(t){return x2(this,t,null,!0,!1)};function x2(t,e,r,n,s){se("readableAddChunk",e);var a=t._readableState;if(e===null)a.reading=!1,ste(t,a);else{var o;if(s||(o=ite(a,e)),o)qu(t,o);else if(a.objectMode||e&&e.length>0)if(typeof e!="string"&&!a.objectMode&&Object.getPrototypeOf(e)!==Ep.prototype&&(e=zee(e)),n)a.endEmitted?qu(t,new rte):dT(t,a,e,!0);else if(a.ended)qu(t,new ete);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(e=a.decoder.write(e),a.objectMode||e.length!==0?dT(t,a,e,!1):hT(t,a)):dT(t,a,e,!1)}else n||(a.reading=!1,hT(t,a))}return!a.ended&&(a.length<a.highWaterMark||a.length===0)}function dT(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&yp(t)),hT(t,e)}function ite(t,e){var r;return!Kee(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new Zee("chunk",["string","Buffer","Uint8Array"],e)),r}he.prototype.isPaused=function(){return this._readableState.flowing===!1};he.prototype.setEncoding=function(t){vs||(vs=sT().StringDecoder);var e=new vs(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var M2=1073741824;function ote(t){return t>=M2?t=M2:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function L2(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=ote(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}he.prototype.read=function(t){se("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return se("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?pT(this):yp(this),null;if(t=L2(t,e),t===0&&e.ended)return e.length===0&&pT(this),null;var n=e.needReadable;se("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,se("length less than watermark",n)),e.ended||e.reading?(n=!1,se("reading or ended",n)):n&&(se("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=L2(r,e)));var s;return t>0?s=B2(t,e):s=null,s===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&pT(this)),s!==null&&this.emit("data",s),s};function ste(t,e){if(se("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?yp(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,U2(t)))}}function yp(t){var e=t._readableState;se("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(se("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(U2,t))}function U2(t){var e=t._readableState;se("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,mT(t)}function hT(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(ate,t,e))}function ate(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(se("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}he.prototype._read=function(t){qu(this,new tte("_read()"))};he.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,se("pipe count=%d opts=%j",n.pipesCount,e);var s=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,a=s?i:E;n.endEmitted?process.nextTick(a):r.once("end",a),t.on("unpipe",o);function o(T,O){se("onunpipe"),T===r&&O&&O.hasUnpiped===!1&&(O.hasUnpiped=!0,c())}function i(){se("onend"),t.end()}var u=ute(r);t.on("drain",u);var l=!1;function c(){se("cleanup"),t.removeListener("close",S),t.removeListener("finish",g),t.removeListener("drain",u),t.removeListener("error",h),t.removeListener("unpipe",o),r.removeListener("end",i),r.removeListener("end",E),r.removeListener("data",f),l=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}r.on("data",f);function f(T){se("ondata");var O=t.write(T);se("dest.write",O),O===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&q2(n.pipes,t)!==-1)&&!l&&(se("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function h(T){se("onerror",T),E(),t.removeListener("error",h),C2(t,"error")===0&&qu(t,T)}nte(t,"error",h);function S(){t.removeListener("finish",g),E()}t.once("close",S);function g(){se("onfinish"),t.removeListener("close",S),E()}t.once("finish",g);function E(){se("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(se("pipe resume"),r.resume()),t};function ute(t){return function(){var r=t._readableState;se("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&C2(t,"data")&&(r.flowing=!0,mT(t))}}he.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,s=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<s;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=q2(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};he.prototype.on=function(t,e){var r=Vu.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,se("on readable",n.length,n.reading),n.length?yp(this):n.reading||process.nextTick(lte,this)),r};he.prototype.addListener=he.prototype.on;he.prototype.removeListener=function(t,e){var r=Vu.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(k2,this),r};he.prototype.removeAllListeners=function(t){var e=Vu.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(k2,this),e};function k2(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function lte(t){se("readable nexttick read 0"),t.read(0)}he.prototype.resume=function(){var t=this._readableState;return t.flowing||(se("resume"),t.flowing=!t.readableListening,cte(this,t)),t.paused=!1,this};function cte(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(fte,t,e))}function fte(t,e){se("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),mT(t),e.flowing&&!e.reading&&t.read(0)}he.prototype.pause=function(){return se("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(se("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function mT(t){var e=t._readableState;for(se("flow",e.flowing);e.flowing&&t.read()!==null;);}he.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(se("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if(se("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var i=e.push(o);i||(n=!0,t.pause())}});for(var s in t)this[s]===void 0&&typeof t[s]=="function"&&(this[s]=(function(i){return function(){return t[i].apply(t,arguments)}})(s));for(var a=0;a<fT.length;a++)t.on(fT[a],this.emit.bind(this,fT[a]));return this._read=function(o){se("wrapped _read",o),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(he.prototype[Symbol.asyncIterator]=function(){return lT===void 0&&(lT=A2()),lT(this)});Object.defineProperty(he.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(he.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(he.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});he._fromList=B2;Object.defineProperty(he.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function B2(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function pT(t){var e=t._readableState;se("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(dte,e,t))}function dte(t,e){if(se("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(he.from=function(t,e){return cT===void 0&&(cT=I2()),cT(he,t,e)});function q2(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var ho=p((C0e,$2)=>{"use strict";var pte=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};$2.exports=rn;var F2=ST(),gT=Fu();ws()(rn,F2);for(ET=pte(gT.prototype),Tp=0;Tp<ET.length;Tp++)wp=ET[Tp],rn.prototype[wp]||(rn.prototype[wp]=gT.prototype[wp]);var ET,wp,Tp;function rn(t){if(!(this instanceof rn))return new rn(t);F2.call(this,t),gT.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",hte)))}Object.defineProperty(rn.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(rn.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(rn.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function hte(){this._writableState.ended||process.nextTick(_te,this)}function _te(t){t.end()}Object.defineProperty(rn.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Fu=p((D0e,z2)=>{"use strict";z2.exports=$e;function W2(t){var e=this;this.next=null,this.entry=null,this.finish=function(){$te(e,t)}}var bs;$e.WritableState=Gu;var mte={deprecate:r2()},j2=Ky(),vp=require("buffer").Buffer,Ste=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Ete(t){return vp.from(t)}function gte(t){return vp.isBuffer(t)||t instanceof Ste}var TT=Jy(),yte=Xy(),Tte=yte.getHighWaterMark,ii=ei().codes,wte=ii.ERR_INVALID_ARG_TYPE,Ote=ii.ERR_METHOD_NOT_IMPLEMENTED,vte=ii.ERR_MULTIPLE_CALLBACK,bte=ii.ERR_STREAM_CANNOT_PIPE,Ate=ii.ERR_STREAM_DESTROYED,Rte=ii.ERR_STREAM_NULL_VALUES,Nte=ii.ERR_STREAM_WRITE_AFTER_END,Pte=ii.ERR_UNKNOWN_ENCODING,As=TT.errorOrDestroy;ws()($e,j2);function Ite(){}function Gu(t,e,r){bs=bs||ho(),t=t||{},typeof r!="boolean"&&(r=e instanceof bs),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=Tte(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(s){kte(e,s)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new W2(this)}Gu.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Gu.prototype,"buffer",{get:mte.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Op;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Op=Function.prototype[Symbol.hasInstance],Object.defineProperty($e,Symbol.hasInstance,{value:function(e){return Op.call(this,e)?!0:this!==$e?!1:e&&e._writableState instanceof Gu}})):Op=function(e){return e instanceof this};function $e(t){bs=bs||ho();var e=this instanceof bs;if(!e&&!Op.call($e,this))return new $e(t);this._writableState=new Gu(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),j2.call(this)}$e.prototype.pipe=function(){As(this,new bte)};function Mte(t,e){var r=new Nte;As(t,r),process.nextTick(e,r)}function Lte(t,e,r,n){var s;return r===null?s=new Rte:typeof r!="string"&&!e.objectMode&&(s=new wte("chunk",["string","Buffer"],r)),s?(As(t,s),process.nextTick(n,s),!1):!0}$e.prototype.write=function(t,e,r){var n=this._writableState,s=!1,a=!n.objectMode&&gte(t);return a&&!vp.isBuffer(t)&&(t=Ete(t)),typeof e=="function"&&(r=e,e=null),a?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=Ite),n.ending?Mte(this,r):(a||Lte(this,n,t,r))&&(n.pendingcb++,s=Dte(this,n,a,t,e,r)),s};$e.prototype.cork=function(){this._writableState.corked++};$e.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&H2(this,t))};$e.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new Pte(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty($e.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Cte(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=vp.from(e,r)),e}Object.defineProperty($e.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Dte(t,e,r,n,s,a){if(!r){var o=Cte(e,n,s);n!==o&&(r=!0,s="buffer",n=o)}var i=e.objectMode?1:n.length;e.length+=i;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:s,isBuf:r,callback:a,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else yT(t,e,!1,i,n,s,a);return u}function yT(t,e,r,n,s,a,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new Ate("write")):r?t._writev(s,e.onwrite):t._write(s,a,e.onwrite),e.sync=!1}function xte(t,e,r,n,s){--e.pendingcb,r?(process.nextTick(s,n),process.nextTick($u,t,e),t._writableState.errorEmitted=!0,As(t,n)):(s(n),t._writableState.errorEmitted=!0,As(t,n),$u(t,e))}function Ute(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function kte(t,e){var r=t._writableState,n=r.sync,s=r.writecb;if(typeof s!="function")throw new vte;if(Ute(r),e)xte(t,r,n,e,s);else{var a=Y2(r)||t.destroyed;!a&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&H2(t,r),n?process.nextTick(G2,t,r,a,s):G2(t,r,a,s)}}function G2(t,e,r,n){r||Bte(t,e),e.pendingcb--,n(),$u(t,e)}function Bte(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function H2(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,s=new Array(n),a=e.corkedRequestsFree;a.entry=r;for(var o=0,i=!0;r;)s[o]=r,r.isBuf||(i=!1),r=r.next,o+=1;s.allBuffers=i,yT(t,e,!0,e.length,s,"",a.finish),e.pendingcb++,e.lastBufferedRequest=null,a.next?(e.corkedRequestsFree=a.next,a.next=null):e.corkedRequestsFree=new W2(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,c=r.callback,f=e.objectMode?1:u.length;if(yT(t,e,!1,f,u,l,c),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}$e.prototype._write=function(t,e,r){r(new Ote("_write()"))};$e.prototype._writev=null;$e.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||Fte(this,n,r),this};Object.defineProperty($e.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Y2(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function qte(t,e){t._final(function(r){e.pendingcb--,r&&As(t,r),e.prefinished=!0,t.emit("prefinish"),$u(t,e)})}function Vte(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(qte,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function $u(t,e){var r=Y2(e);if(r&&(Vte(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function Fte(t,e,r){e.ending=!0,$u(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function $te(t,e,r){var n=t.entry;for(t.entry=null;n;){var s=n.callback;e.pendingcb--,s(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty($e.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});$e.prototype.destroy=TT.destroy;$e.prototype._undestroy=TT.undestroy;$e.prototype._destroy=function(t,e){e(t)}});var K2=p(wT=>{"use strict";wT.levels={error:0,warn:1,help:2,data:3,info:4,debug:5,prompt:6,verbose:7,input:8,silly:9};wT.colors={error:"red",warn:"yellow",help:"cyan",data:"grey",info:"green",debug:"blue",prompt:"grey",verbose:"cyan",input:"grey",silly:"magenta"}});var Q2=p(OT=>{"use strict";OT.levels={error:0,warn:1,info:2,http:3,verbose:4,debug:5,silly:6};OT.colors={error:"red",warn:"yellow",info:"green",http:"green",verbose:"cyan",debug:"blue",silly:"magenta"}});var J2=p(vT=>{"use strict";vT.levels={emerg:0,alert:1,crit:2,error:3,warning:4,notice:5,info:6,debug:7};vT.colors={emerg:"red",alert:"yellow",crit:"red",error:"red",warning:"red",notice:"yellow",info:"green",debug:"blue"}});var X2=p(bp=>{"use strict";Object.defineProperty(bp,"cli",{value:K2()});Object.defineProperty(bp,"npm",{value:Q2()});Object.defineProperty(bp,"syslog",{value:J2()})});var Ge=p(Wu=>{"use strict";Object.defineProperty(Wu,"LEVEL",{value:Symbol.for("level")});Object.defineProperty(Wu,"MESSAGE",{value:Symbol.for("message")});Object.defineProperty(Wu,"SPLAT",{value:Symbol.for("splat")});Object.defineProperty(Wu,"configs",{value:X2()})});var bT=p((V0e,tq)=>{"use strict";var Gte=require("util"),Z2=Fu(),{LEVEL:eq}=Ge(),ju=tq.exports=function(e={}){Z2.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this.format=e.format,this.level=e.level,this.handleExceptions=e.handleExceptions,this.handleRejections=e.handleRejections,this.silent=e.silent,e.log&&(this.log=e.log),e.logv&&(this.logv=e.logv),e.close&&(this.close=e.close),this.once("pipe",r=>{this.levels=r.levels,this.parent=r}),this.once("unpipe",r=>{r===this.parent&&(this.parent=null,this.close&&this.close())})};Gte.inherits(ju,Z2);ju.prototype._write=function(e,r,n){if(this.silent||e.exception===!0&&!this.handleExceptions)return n(null);let s=this.level||this.parent&&this.parent.level;if(!s||this.levels[s]>=this.levels[e[eq]]){if(e&&!this.format)return this.log(e,n);let a,o;try{o=this.format.transform(Object.assign({},e),this.format.options)}catch(i){a=i}if(a||!o){if(n(),a)throw a;return}return this.log(o,n)}return this._writableState.sync=!1,n(null)};ju.prototype._writev=function(e,r){if(this.logv){let n=e.filter(this._accept,this);return n.length?this.logv(n,r):r(null)}for(let n=0;n<e.length;n++){if(!this._accept(e[n]))continue;if(e[n].chunk&&!this.format){this.log(e[n].chunk,e[n].callback);continue}let s,a;try{a=this.format.transform(Object.assign({},e[n].chunk),this.format.options)}catch(o){s=o}if(s||!a){if(e[n].callback(),s)throw r(null),s}else this.log(a,e[n].callback)}return r(null)};ju.prototype._accept=function(e){let r=e.chunk;if(this.silent)return!1;let n=this.level||this.parent&&this.parent.level;return!!((r.exception===!0||!n||this.levels[n]>=this.levels[r[eq]])&&(this.handleExceptions||r.exception!==!0))};ju.prototype._nop=function(){}});var iq=p((F0e,nq)=>{"use strict";var Wte=require("util"),{LEVEL:AT}=Ge(),rq=bT(),Hu=nq.exports=function(e={}){if(rq.call(this,e),!e.transport||typeof e.transport.log!="function")throw new Error("Invalid transport, must be an object with a log method.");this.transport=e.transport,this.level=this.level||e.transport.level,this.handleExceptions=this.handleExceptions||e.transport.handleExceptions,this._deprecated();function r(n){this.emit("error",n,this.transport)}this.transport.__winstonError||(this.transport.__winstonError=r.bind(this),this.transport.on("error",this.transport.__winstonError))};Wte.inherits(Hu,rq);Hu.prototype._write=function(e,r,n){if(this.silent||e.exception===!0&&!this.handleExceptions)return n(null);(!this.level||this.levels[this.level]>=this.levels[e[AT]])&&this.transport.log(e[AT],e.message,e,this._nop),n(null)};Hu.prototype._writev=function(e,r){for(let n=0;n<e.length;n++)this._accept(e[n])&&(this.transport.log(e[n].chunk[AT],e[n].chunk.message,e[n].chunk,this._nop),e[n].callback());return r(null)};Hu.prototype._deprecated=function(){console.error([`${this.transport.name} is a legacy winston transport. Consider upgrading: `,"- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md"].join(`
`))};Hu.prototype.close=function(){this.transport.close&&this.transport.close(),this.transport.__winstonError&&(this.transport.removeListener("error",this.transport.__winstonError),this.transport.__winstonError=null)}});var oq=p(($0e,RT)=>{"use strict";RT.exports=bT();RT.exports.LegacyTransportStream=iq()});var aq=p(sq=>{"use strict";Object.defineProperty(sq,"__esModule",{value:!0})});var lq=p(uq=>{"use strict";Object.defineProperty(uq,"__esModule",{value:!0})});var cq=p(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.SeverityNumber=void 0;var jte;(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRACE=1]="TRACE",t[t.TRACE2=2]="TRACE2",t[t.TRACE3=3]="TRACE3",t[t.TRACE4=4]="TRACE4",t[t.DEBUG=5]="DEBUG",t[t.DEBUG2=6]="DEBUG2",t[t.DEBUG3=7]="DEBUG3",t[t.DEBUG4=8]="DEBUG4",t[t.INFO=9]="INFO",t[t.INFO2=10]="INFO2",t[t.INFO3=11]="INFO3",t[t.INFO4=12]="INFO4",t[t.WARN=13]="WARN",t[t.WARN2=14]="WARN2",t[t.WARN3=15]="WARN3",t[t.WARN4=16]="WARN4",t[t.ERROR=17]="ERROR",t[t.ERROR2=18]="ERROR2",t[t.ERROR3=19]="ERROR3",t[t.ERROR4=20]="ERROR4",t[t.FATAL=21]="FATAL",t[t.FATAL2=22]="FATAL2",t[t.FATAL3=23]="FATAL3",t[t.FATAL4=24]="FATAL4"})(jte=Yu.SeverityNumber||(Yu.SeverityNumber={}))});var dq=p(fq=>{"use strict";Object.defineProperty(fq,"__esModule",{value:!0})});var NT=p(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.NOOP_LOGGER=Rs.NoopLogger=void 0;var Ap=class{emit(e){}};Rs.NoopLogger=Ap;Rs.NOOP_LOGGER=new Ap});var PT=p(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.NOOP_LOGGER_PROVIDER=Ns.NoopLoggerProvider=void 0;var Hte=NT(),Rp=class{getLogger(e,r,n){return new Hte.NoopLogger}};Ns.NoopLoggerProvider=Rp;Ns.NOOP_LOGGER_PROVIDER=new Rp});var pq=p(Np=>{"use strict";Object.defineProperty(Np,"__esModule",{value:!0});Np._globalThis=void 0;Np._globalThis=typeof globalThis=="object"?globalThis:global});var hq=p(_o=>{"use strict";var Yte=_o&&_o.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),zte=_o&&_o.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Yte(e,t,r)};Object.defineProperty(_o,"__esModule",{value:!0});zte(pq(),_o)});var _q=p(mo=>{"use strict";var Kte=mo&&mo.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Qte=mo&&mo.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Kte(e,t,r)};Object.defineProperty(mo,"__esModule",{value:!0});Qte(hq(),mo)});var mq=p(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.API_BACKWARDS_COMPATIBILITY_VERSION=nn.makeGetter=nn._global=nn.GLOBAL_LOGS_API_KEY=void 0;var Jte=_q();nn.GLOBAL_LOGS_API_KEY=Symbol.for("io.opentelemetry.js.api.logs");nn._global=Jte._globalThis;function Xte(t,e,r){return n=>n===t?e:r}nn.makeGetter=Xte;nn.API_BACKWARDS_COMPATIBILITY_VERSION=1});var Eq=p(Pp=>{"use strict";Object.defineProperty(Pp,"__esModule",{value:!0});Pp.LogsAPI=void 0;var mr=mq(),Sq=PT(),IT=class t{constructor(){}static getInstance(){return this._instance||(this._instance=new t),this._instance}setGlobalLoggerProvider(e){return mr._global[mr.GLOBAL_LOGS_API_KEY]?this.getLoggerProvider():(mr._global[mr.GLOBAL_LOGS_API_KEY]=(0,mr.makeGetter)(mr.API_BACKWARDS_COMPATIBILITY_VERSION,e,Sq.NOOP_LOGGER_PROVIDER),e)}getLoggerProvider(){var e,r;return(r=(e=mr._global[mr.GLOBAL_LOGS_API_KEY])===null||e===void 0?void 0:e.call(mr._global,mr.API_BACKWARDS_COMPATIBILITY_VERSION))!==null&&r!==void 0?r:Sq.NOOP_LOGGER_PROVIDER}getLogger(e,r,n){return this.getLoggerProvider().getLogger(e,r,n)}disable(){delete mr._global[mr.GLOBAL_LOGS_API_KEY]}};Pp.LogsAPI=IT});var gq=p(Vt=>{"use strict";var Zte=Vt&&Vt.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Ps=Vt&&Vt.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Zte(e,t,r)};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.logs=void 0;Ps(aq(),Vt);Ps(lq(),Vt);Ps(cq(),Vt);Ps(dq(),Vt);Ps(NT(),Vt);Ps(PT(),Vt);var ere=Eq();Vt.logs=ere.LogsAPI.getInstance()});var LT=p(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});Mp.LogRecord=void 0;var tre=(k(),B(U)),zu=(k(),B(U)),Ip=te(),MT=class{constructor(e,r,n){this.attributes={},this.totalAttributesCount=0,this._isReadonly=!1;let{timestamp:s,observedTimestamp:a,severityNumber:o,severityText:i,body:u,attributes:l={},context:c}=n,f=Date.now();if(this.hrTime=(0,Ip.timeInputToHrTime)(s??f),this.hrTimeObserved=(0,Ip.timeInputToHrTime)(a??f),c){let h=zu.trace.getSpanContext(c);h&&zu.isSpanContextValid(h)&&(this.spanContext=h)}this.severityNumber=o,this.severityText=i,this.body=u,this.resource=e.resource,this.instrumentationScope=r,this._logRecordLimits=e.logRecordLimits,this.setAttributes(l)}set severityText(e){this._isLogRecordReadonly()||(this._severityText=e)}get severityText(){return this._severityText}set severityNumber(e){this._isLogRecordReadonly()||(this._severityNumber=e)}get severityNumber(){return this._severityNumber}set body(e){this._isLogRecordReadonly()||(this._body=e)}get body(){return this._body}get droppedAttributesCount(){return this.totalAttributesCount-Object.keys(this.attributes).length}setAttribute(e,r){return this._isLogRecordReadonly()?this:r===null?this:e.length===0?(zu.diag.warn(`Invalid attribute key: ${e}`),this):!(0,Ip.isAttributeValue)(r)&&!(typeof r=="object"&&!Array.isArray(r)&&Object.keys(r).length>0)?(zu.diag.warn(`Invalid attribute value set for key: ${e}`),this):(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?this:((0,Ip.isAttributeValue)(r)?this.attributes[e]=this._truncateToSize(r):this.attributes[e]=r,this))}setAttributes(e){for(let[r,n]of Object.entries(e))this.setAttribute(r,n);return this}setBody(e){return this.body=e,this}setSeverityNumber(e){return this.severityNumber=e,this}setSeverityText(e){return this.severityText=e,this}_makeReadonly(){this._isReadonly=!0}_truncateToSize(e){let r=this._logRecordLimits.attributeValueLengthLimit;return r<=0?(zu.diag.warn(`Attribute value limit must be positive, got ${r}`),e):typeof e=="string"?this._truncateToLimitUtil(e,r):Array.isArray(e)?e.map(n=>typeof n=="string"?this._truncateToLimitUtil(n,r):n):e}_truncateToLimitUtil(e,r){return e.length<=r?e:e.substring(0,r)}_isLogRecordReadonly(){return this._isReadonly&&tre.diag.warn("Can not execute the operation on emitted log record"),this._isReadonly}};Mp.LogRecord=MT});var yq=p(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});Lp.Logger=void 0;var rre=(k(),B(U)),nre=LT(),CT=class{constructor(e,r){this.instrumentationScope=e,this._sharedState=r}emit(e){let r=e.context||rre.context.active(),n=new nre.LogRecord(this._sharedState,this.instrumentationScope,Object.assign({context:r},e));this._sharedState.activeProcessor.onEmit(n,r),n._makeReadonly()}};Lp.Logger=CT});var Tq=p(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.reconfigureLimits=Is.loadDefaultConfig=void 0;var Ku=te();function ire(){return{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:(0,Ku.getEnv)().OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:(0,Ku.getEnv)().OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT},includeTraceContext:!0}}Is.loadDefaultConfig=ire;function ore(t){var e,r,n,s,a,o;let i=(0,Ku.getEnvWithoutDefaults)();return{attributeCountLimit:(n=(r=(e=t.attributeCountLimit)!==null&&e!==void 0?e:i.OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT)!==null&&r!==void 0?r:i.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&n!==void 0?n:Ku.DEFAULT_ATTRIBUTE_COUNT_LIMIT,attributeValueLengthLimit:(o=(a=(s=t.attributeValueLengthLimit)!==null&&s!==void 0?s:i.OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&a!==void 0?a:i.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&o!==void 0?o:Ku.DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT}}Is.reconfigureLimits=ore});var wq=p(Cp=>{"use strict";Object.defineProperty(Cp,"__esModule",{value:!0});Cp.MultiLogRecordProcessor=void 0;var sre=te(),DT=class{constructor(e,r){this.processors=e,this.forceFlushTimeoutMillis=r}async forceFlush(){let e=this.forceFlushTimeoutMillis;await Promise.all(this.processors.map(r=>(0,sre.callWithTimeout)(r.forceFlush(),e)))}onEmit(e,r){this.processors.forEach(n=>n.onEmit(e,r))}async shutdown(){await Promise.all(this.processors.map(e=>e.shutdown()))}};Cp.MultiLogRecordProcessor=DT});var UT=p(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});Dp.NoopLogRecordProcessor=void 0;var xT=class{forceFlush(){return Promise.resolve()}onEmit(e,r){}shutdown(){return Promise.resolve()}};Dp.NoopLogRecordProcessor=xT});var Oq=p(xp=>{"use strict";Object.defineProperty(xp,"__esModule",{value:!0});xp.LoggerProviderSharedState=void 0;var are=UT(),kT=class{constructor(e,r,n){this.resource=e,this.forceFlushTimeoutMillis=r,this.logRecordLimits=n,this.loggers=new Map,this.registeredLogRecordProcessors=[],this.activeProcessor=new are.NoopLogRecordProcessor}};xp.LoggerProviderSharedState=kT});var Aq=p(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.LoggerProvider=So.DEFAULT_LOGGER_NAME=void 0;var Qu=(k(),B(U)),ure=gq(),lre=_s(),vq=te(),cre=yq(),bq=Tq(),fre=wq(),dre=Oq();So.DEFAULT_LOGGER_NAME="unknown";var BT=class{constructor(e={}){let{resource:r=lre.Resource.default(),logRecordLimits:n,forceFlushTimeoutMillis:s}=(0,vq.merge)({},(0,bq.loadDefaultConfig)(),e);this._sharedState=new dre.LoggerProviderSharedState(r,s,(0,bq.reconfigureLimits)(n)),this._shutdownOnce=new vq.BindOnceFuture(this._shutdown,this)}getLogger(e,r,n){if(this._shutdownOnce.isCalled)return Qu.diag.warn("A shutdown LoggerProvider cannot provide a Logger"),ure.NOOP_LOGGER;e||Qu.diag.warn("Logger requested without instrumentation scope name.");let s=e||So.DEFAULT_LOGGER_NAME,a=`${s}@${r||""}:${n?.schemaUrl||""}`;return this._sharedState.loggers.has(a)||this._sharedState.loggers.set(a,new cre.Logger({name:s,version:r,schemaUrl:n?.schemaUrl},this._sharedState)),this._sharedState.loggers.get(a)}addLogRecordProcessor(e){this._sharedState.registeredLogRecordProcessors.length===0&&this._sharedState.activeProcessor.shutdown().catch(r=>Qu.diag.error("Error while trying to shutdown current log record processor",r)),this._sharedState.registeredLogRecordProcessors.push(e),this._sharedState.activeProcessor=new fre.MultiLogRecordProcessor(this._sharedState.registeredLogRecordProcessors,this._sharedState.forceFlushTimeoutMillis)}forceFlush(){return this._shutdownOnce.isCalled?(Qu.diag.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()}shutdown(){return this._shutdownOnce.isCalled?(Qu.diag.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()}_shutdown(){return this._sharedState.activeProcessor.shutdown()}};So.LoggerProvider=BT});var Rq=p(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});Up.ConsoleLogRecordExporter=void 0;var pre=te(),hre=te(),qT=class{export(e,r){this._sendLogRecords(e,r)}shutdown(){return Promise.resolve()}_exportInfo(e){var r,n,s;return{timestamp:(0,pre.hrTimeToMicroseconds)(e.hrTime),traceId:(r=e.spanContext)===null||r===void 0?void 0:r.traceId,spanId:(n=e.spanContext)===null||n===void 0?void 0:n.spanId,traceFlags:(s=e.spanContext)===null||s===void 0?void 0:s.traceFlags,severityText:e.severityText,severityNumber:e.severityNumber,body:e.body,attributes:e.attributes}}_sendLogRecords(e,r){for(let n of e)console.dir(this._exportInfo(n),{depth:3});r?.({code:hre.ExportResultCode.SUCCESS})}};Up.ConsoleLogRecordExporter=qT});var Nq=p(kp=>{"use strict";Object.defineProperty(kp,"__esModule",{value:!0});kp.SimpleLogRecordProcessor=void 0;var Ms=te(),VT=class{constructor(e){this._exporter=e,this._shutdownOnce=new Ms.BindOnceFuture(this._shutdown,this),this._unresolvedExports=new Set}onEmit(e){var r,n;if(this._shutdownOnce.isCalled)return;let s=()=>Ms.internal._export(this._exporter,[e]).then(a=>{var o;a.code!==Ms.ExportResultCode.SUCCESS&&(0,Ms.globalErrorHandler)((o=a.error)!==null&&o!==void 0?o:new Error(`SimpleLogRecordProcessor: log record export failed (status ${a})`))}).catch(Ms.globalErrorHandler);if(e.resource.asyncAttributesPending){let a=(n=(r=e.resource).waitForAsyncAttributes)===null||n===void 0?void 0:n.call(r).then(()=>(this._unresolvedExports.delete(a),s()),Ms.globalErrorHandler);a!=null&&this._unresolvedExports.add(a)}else s()}async forceFlush(){await Promise.all(Array.from(this._unresolvedExports))}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}};kp.SimpleLogRecordProcessor=VT});var Iq=p(Bp=>{"use strict";Object.defineProperty(Bp,"__esModule",{value:!0});Bp.InMemoryLogRecordExporter=void 0;var Pq=te(),FT=class{constructor(){this._finishedLogRecords=[],this._stopped=!1}export(e,r){if(this._stopped)return r({code:Pq.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedLogRecords.push(...e),r({code:Pq.ExportResultCode.SUCCESS})}shutdown(){return this._stopped=!0,this.reset(),Promise.resolve()}getFinishedLogRecords(){return this._finishedLogRecords}reset(){this._finishedLogRecords=[]}};Bp.InMemoryLogRecordExporter=FT});var Mq=p(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});qp.BatchLogRecordProcessorBase=void 0;var _re=(k(),B(U)),on=te(),$T=class{constructor(e,r){var n,s,a,o;this._exporter=e,this._finishedLogRecords=[];let i=(0,on.getEnv)();this._maxExportBatchSize=(n=r?.maxExportBatchSize)!==null&&n!==void 0?n:i.OTEL_BLRP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=(s=r?.maxQueueSize)!==null&&s!==void 0?s:i.OTEL_BLRP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=(a=r?.scheduledDelayMillis)!==null&&a!==void 0?a:i.OTEL_BLRP_SCHEDULE_DELAY,this._exportTimeoutMillis=(o=r?.exportTimeoutMillis)!==null&&o!==void 0?o:i.OTEL_BLRP_EXPORT_TIMEOUT,this._shutdownOnce=new on.BindOnceFuture(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(_re.diag.warn("BatchLogRecordProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}onEmit(e){this._shutdownOnce.isCalled||this._addToBuffer(e)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}shutdown(){return this._shutdownOnce.call()}async _shutdown(){this.onShutdown(),await this._flushAll(),await this._exporter.shutdown()}_addToBuffer(e){this._finishedLogRecords.length>=this._maxQueueSize||(this._finishedLogRecords.push(e),this._maybeStartTimer())}_flushAll(){return new Promise((e,r)=>{let n=[],s=Math.ceil(this._finishedLogRecords.length/this._maxExportBatchSize);for(let a=0;a<s;a++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{e()}).catch(r)})}_flushOneBatch(){return this._clearTimer(),this._finishedLogRecords.length===0?Promise.resolve():new Promise((e,r)=>{(0,on.callWithTimeout)(this._export(this._finishedLogRecords.splice(0,this._maxExportBatchSize)),this._exportTimeoutMillis).then(()=>e()).catch(r)})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedLogRecords.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(e=>{(0,on.globalErrorHandler)(e)})},this._scheduledDelayMillis),(0,on.unrefTimer)(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}_export(e){let r=()=>on.internal._export(this._exporter,e).then(s=>{var a;s.code!==on.ExportResultCode.SUCCESS&&(0,on.globalErrorHandler)((a=s.error)!==null&&a!==void 0?a:new Error(`BatchLogRecordProcessor: log record export failed (status ${s})`))}).catch(on.globalErrorHandler),n=e.map(s=>s.resource).filter(s=>s.asyncAttributesPending);return n.length===0?r():Promise.all(n.map(s=>{var a;return(a=s.waitForAsyncAttributes)===null||a===void 0?void 0:a.call(s)})).then(r,on.globalErrorHandler)}};qp.BatchLogRecordProcessorBase=$T});var Lq=p(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});Vp.BatchLogRecordProcessor=void 0;var mre=Mq(),GT=class extends mre.BatchLogRecordProcessorBase{onShutdown(){}};Vp.BatchLogRecordProcessor=GT});var Cq=p(Fp=>{"use strict";Object.defineProperty(Fp,"__esModule",{value:!0});Fp.BatchLogRecordProcessor=void 0;var Sre=Lq();Object.defineProperty(Fp,"BatchLogRecordProcessor",{enumerable:!0,get:function(){return Sre.BatchLogRecordProcessor}})});var Dq=p($p=>{"use strict";Object.defineProperty($p,"__esModule",{value:!0});$p.BatchLogRecordProcessor=void 0;var Ere=Cq();Object.defineProperty($p,"BatchLogRecordProcessor",{enumerable:!0,get:function(){return Ere.BatchLogRecordProcessor}})});var xq=p(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.BatchLogRecordProcessor=vt.InMemoryLogRecordExporter=vt.SimpleLogRecordProcessor=vt.ConsoleLogRecordExporter=vt.NoopLogRecordProcessor=vt.LogRecord=vt.LoggerProvider=void 0;var gre=Aq();Object.defineProperty(vt,"LoggerProvider",{enumerable:!0,get:function(){return gre.LoggerProvider}});var yre=LT();Object.defineProperty(vt,"LogRecord",{enumerable:!0,get:function(){return yre.LogRecord}});var Tre=UT();Object.defineProperty(vt,"NoopLogRecordProcessor",{enumerable:!0,get:function(){return Tre.NoopLogRecordProcessor}});var wre=Rq();Object.defineProperty(vt,"ConsoleLogRecordExporter",{enumerable:!0,get:function(){return wre.ConsoleLogRecordExporter}});var Ore=Nq();Object.defineProperty(vt,"SimpleLogRecordProcessor",{enumerable:!0,get:function(){return Ore.SimpleLogRecordProcessor}});var vre=Iq();Object.defineProperty(vt,"InMemoryLogRecordExporter",{enumerable:!0,get:function(){return vre.InMemoryLogRecordExporter}});var bre=Dq();Object.defineProperty(vt,"BatchLogRecordProcessor",{enumerable:!0,get:function(){return bre.BatchLogRecordProcessor}})});var Ft=p((mRe,Uq)=>{"use strict";var WT=class t extends Error{constructor(e){super(`Format functions must be synchronous taking a two arguments: (info, opts)
Found: ${e.toString().split(`
`)[0]}
`),Error.captureStackTrace(this,t)}};Uq.exports=t=>{if(t.length>2)throw new WT(t);function e(n={}){this.options=n}e.prototype.transform=t;function r(n){return new e(n)}return r.Format=e,r}});var Vq=p((SRe,qq)=>{var Bq={};qq.exports=Bq;var kq={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(kq).forEach(function(t){var e=kq[t],r=Bq[t]=[];r.open="\x1B["+e[0]+"m",r.close="\x1B["+e[1]+"m"})});var $q=p((ERe,Fq)=>{"use strict";Fq.exports=function(t,e){e=e||process.argv||[];var r=e.indexOf("--"),n=/^-{1,2}/.test(t)?"":"--",s=e.indexOf(n+t);return s!==-1&&(r===-1?!0:s<r)}});var Wq=p((gRe,Gq)=>{"use strict";var Are=require("os"),xr=$q(),Lt=process.env,Ls=void 0;xr("no-color")||xr("no-colors")||xr("color=false")?Ls=!1:(xr("color")||xr("colors")||xr("color=true")||xr("color=always"))&&(Ls=!0);"FORCE_COLOR"in Lt&&(Ls=Lt.FORCE_COLOR.length===0||parseInt(Lt.FORCE_COLOR,10)!==0);function Rre(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Nre(t){if(Ls===!1)return 0;if(xr("color=16m")||xr("color=full")||xr("color=truecolor"))return 3;if(xr("color=256"))return 2;if(t&&!t.isTTY&&Ls!==!0)return 0;var e=Ls?1:0;if(process.platform==="win32"){var r=Are.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in Lt)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(function(s){return s in Lt})||Lt.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in Lt)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Lt.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in Lt){var n=parseInt((Lt.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Lt.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Lt.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(Lt.TERM)||"COLORTERM"in Lt?1:(Lt.TERM==="dumb",e)}function jT(t){var e=Nre(t);return Rre(e)}Gq.exports={supportsColor:jT,stdout:jT(process.stdout),stderr:jT(process.stderr)}});var Hq=p((yRe,jq)=>{jq.exports=function(e,r){var n="";e=e||"Run the trap, drop the bass",e=e.split("");var s={a:["@","\u0104","\u023A","\u0245","\u0394","\u039B","\u0414"],b:["\xDF","\u0181","\u0243","\u026E","\u03B2","\u0E3F"],c:["\xA9","\u023B","\u03FE"],d:["\xD0","\u018A","\u0500","\u0501","\u0502","\u0503"],e:["\xCB","\u0115","\u018E","\u0258","\u03A3","\u03BE","\u04BC","\u0A6C"],f:["\u04FA"],g:["\u0262"],h:["\u0126","\u0195","\u04A2","\u04BA","\u04C7","\u050A"],i:["\u0F0F"],j:["\u0134"],k:["\u0138","\u04A0","\u04C3","\u051E"],l:["\u0139"],m:["\u028D","\u04CD","\u04CE","\u0520","\u0521","\u0D69"],n:["\xD1","\u014B","\u019D","\u0376","\u03A0","\u048A"],o:["\xD8","\xF5","\xF8","\u01FE","\u0298","\u047A","\u05DD","\u06DD","\u0E4F"],p:["\u01F7","\u048E"],q:["\u09CD"],r:["\xAE","\u01A6","\u0210","\u024C","\u0280","\u042F"],s:["\xA7","\u03DE","\u03DF","\u03E8"],t:["\u0141","\u0166","\u0373"],u:["\u01B1","\u054D"],v:["\u05D8"],w:["\u0428","\u0460","\u047C","\u0D70"],x:["\u04B2","\u04FE","\u04FC","\u04FD"],y:["\xA5","\u04B0","\u04CB"],z:["\u01B5","\u0240"]};return e.forEach(function(a){a=a.toLowerCase();var o=s[a]||[" "],i=Math.floor(Math.random()*o.length);typeof s[a]<"u"?n+=s[a][i]:n+=a}),n}});var zq=p((TRe,Yq)=>{Yq.exports=function(e,r){e=e||"   he is here   ";var n={up:["\u030D","\u030E","\u0304","\u0305","\u033F","\u0311","\u0306","\u0310","\u0352","\u0357","\u0351","\u0307","\u0308","\u030A","\u0342","\u0313","\u0308","\u034A","\u034B","\u034C","\u0303","\u0302","\u030C","\u0350","\u0300","\u0301","\u030B","\u030F","\u0312","\u0313","\u0314","\u033D","\u0309","\u0363","\u0364","\u0365","\u0366","\u0367","\u0368","\u0369","\u036A","\u036B","\u036C","\u036D","\u036E","\u036F","\u033E","\u035B","\u0346","\u031A"],down:["\u0316","\u0317","\u0318","\u0319","\u031C","\u031D","\u031E","\u031F","\u0320","\u0324","\u0325","\u0326","\u0329","\u032A","\u032B","\u032C","\u032D","\u032E","\u032F","\u0330","\u0331","\u0332","\u0333","\u0339","\u033A","\u033B","\u033C","\u0345","\u0347","\u0348","\u0349","\u034D","\u034E","\u0353","\u0354","\u0355","\u0356","\u0359","\u035A","\u0323"],mid:["\u0315","\u031B","\u0300","\u0301","\u0358","\u0321","\u0322","\u0327","\u0328","\u0334","\u0335","\u0336","\u035C","\u035D","\u035E","\u035F","\u0360","\u0362","\u0338","\u0337","\u0361"," \u0489"]},s=[].concat(n.up,n.down,n.mid);function a(u){var l=Math.floor(Math.random()*u);return l}function o(u){var l=!1;return s.filter(function(c){l=c===u}),l}function i(u,l){var c="",f,h;l=l||{},l.up=typeof l.up<"u"?l.up:!0,l.mid=typeof l.mid<"u"?l.mid:!0,l.down=typeof l.down<"u"?l.down:!0,l.size=typeof l.size<"u"?l.size:"maxi",u=u.split("");for(h in u)if(!o(h)){switch(c=c+u[h],f={up:0,down:0,mid:0},l.size){case"mini":f.up=a(8),f.mid=a(2),f.down=a(8);break;case"maxi":f.up=a(16)+3,f.mid=a(4)+1,f.down=a(64)+3;break;default:f.up=a(8)+1,f.mid=a(6)/2,f.down=a(8)+1;break}var S=["up","mid","down"];for(var g in S)for(var E=S[g],T=0;T<=f[E];T++)l[E]&&(c=c+n[E][a(n[E].length)])}return c}return i(e,r)}});var Qq=p((wRe,Kq)=>{Kq.exports=function(t){return function(e,r,n){if(e===" ")return e;switch(r%3){case 0:return t.red(e);case 1:return t.white(e);case 2:return t.blue(e)}}}});var Xq=p((ORe,Jq)=>{Jq.exports=function(t){return function(e,r,n){return r%2===0?e:t.inverse(e)}}});var eV=p((vRe,Zq)=>{Zq.exports=function(t){var e=["red","yellow","green","blue","magenta"];return function(r,n,s){return r===" "?r:t[e[n++%e.length]](r)}}});var rV=p((bRe,tV)=>{tV.exports=function(t){var e=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(r,n,s){return r===" "?r:t[e[Math.round(Math.random()*(e.length-2))]](r)}}});var uV=p((RRe,aV)=>{var le={};aV.exports=le;le.themes={};var Pre=require("util"),Eo=le.styles=Vq(),iV=Object.defineProperties,Ire=new RegExp(/[\r\n]+/g);le.supportsColor=Wq().supportsColor;typeof le.enabled>"u"&&(le.enabled=le.supportsColor()!==!1);le.enable=function(){le.enabled=!0};le.disable=function(){le.enabled=!1};le.stripColors=le.strip=function(t){return(""+t).replace(/\x1B\[\d+m/g,"")};var ARe=le.stylize=function(e,r){if(!le.enabled)return e+"";var n=Eo[r];return!n&&r in le?le[r](e):n.open+e+n.close},Mre=/[|\\{}()[\]^$+*?.]/g,Lre=function(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(Mre,"\\$&")};function oV(t){var e=function r(){return Dre.apply(r,arguments)};return e._styles=t,e.__proto__=Cre,e}var sV=(function(){var t={};return Eo.grey=Eo.gray,Object.keys(Eo).forEach(function(e){Eo[e].closeRe=new RegExp(Lre(Eo[e].close),"g"),t[e]={get:function(){return oV(this._styles.concat(e))}}}),t})(),Cre=iV(function(){},sV);function Dre(){var t=Array.prototype.slice.call(arguments),e=t.map(function(o){return o!=null&&o.constructor===String?o:Pre.inspect(o)}).join(" ");if(!le.enabled||!e)return e;for(var r=e.indexOf(`
`)!=-1,n=this._styles,s=n.length;s--;){var a=Eo[n[s]];e=a.open+e.replace(a.closeRe,a.open)+a.close,r&&(e=e.replace(Ire,function(o){return a.close+o+a.open}))}return e}le.setTheme=function(t){if(typeof t=="string"){console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));");return}for(var e in t)(function(r){le[r]=function(n){if(typeof t[r]=="object"){var s=n;for(var a in t[r])s=le[t[r][a]](s);return s}return le[t[r]](n)}})(e)};function xre(){var t={};return Object.keys(sV).forEach(function(e){t[e]={get:function(){return oV([e])}}}),t}var Ure=function(e,r){var n=r.split("");return n=n.map(e),n.join("")};le.trap=Hq();le.zalgo=zq();le.maps={};le.maps.america=Qq()(le);le.maps.zebra=Xq()(le);le.maps.rainbow=eV()(le);le.maps.random=rV()(le);for(nV in le.maps)(function(t){le[t]=function(e){return Ure(le.maps[t],e)}})(nV);var nV;iV(le,xre())});var HT=p((NRe,lV)=>{var kre=uV();lV.exports=kre});var jp=p((PRe,Wp)=>{"use strict";var KT=HT(),{LEVEL:YT,MESSAGE:zT}=Ge();KT.enabled=!0;var cV=/\s+/,Gp=class t{constructor(e={}){e.colors&&this.addColors(e.colors),this.options=e}static addColors(e){let r=Object.keys(e).reduce((n,s)=>(n[s]=cV.test(e[s])?e[s].split(cV):e[s],n),{});return t.allColors=Object.assign({},t.allColors||{},r),t.allColors}addColors(e){return t.addColors(e)}colorize(e,r,n){if(typeof n>"u"&&(n=r),!Array.isArray(t.allColors[e]))return KT[t.allColors[e]](n);for(let s=0,a=t.allColors[e].length;s<a;s++)n=KT[t.allColors[e][s]](n);return n}transform(e,r){return r.all&&typeof e[zT]=="string"&&(e[zT]=this.colorize(e[YT],e.level,e[zT])),(r.level||r.all||!r.message)&&(e.level=this.colorize(e[YT],e.level)),(r.all||r.message)&&(e.message=this.colorize(e[YT],e.level,e.message)),e}};Wp.exports=t=>new Gp(t);Wp.exports.Colorizer=Wp.exports.Format=Gp});var dV=p((IRe,fV)=>{"use strict";var{Colorizer:Bre}=jp();fV.exports=t=>(Bre.addColors(t.colors||t),t)});var hV=p((MRe,pV)=>{"use strict";var qre=Ft();pV.exports=qre(t=>(t.message=`	${t.message}`,t))});var SV=p((LRe,mV)=>{"use strict";var Vre=Ft(),{LEVEL:_V,MESSAGE:QT}=Ge();mV.exports=Vre((t,{stack:e,cause:r})=>{if(t instanceof Error){let s=Object.assign({},t,{level:t.level,[_V]:t[_V]||t.level,message:t.message,[QT]:t[QT]||t.message});return e&&(s.stack=t.stack),r&&(s.cause=t.cause),s}if(!(t.message instanceof Error))return t;let n=t.message;return Object.assign(t,n),t.message=n.message,t[QT]=n.message,e&&(t.stack=n.stack),r&&(t.cause=n.cause),t})});var XT=p((CRe,Yp)=>{"use strict";var{configs:Fre,LEVEL:EV,MESSAGE:JT}=Ge(),Hp=class t{constructor(e={levels:Fre.npm.levels}){this.paddings=t.paddingForLevels(e.levels,e.filler),this.options=e}static getLongestLevel(e){let r=Object.keys(e).map(n=>n.length);return Math.max(...r)}static paddingForLevel(e,r,n){let s=n+1-e.length,a=Math.floor(s/r.length);return`${r}${r.repeat(a)}`.slice(0,s)}static paddingForLevels(e,r=" "){let n=t.getLongestLevel(e);return Object.keys(e).reduce((s,a)=>(s[a]=t.paddingForLevel(a,r,n),s),{})}transform(e,r){return e.message=`${this.paddings[e[EV]]}${e.message}`,e[JT]&&(e[JT]=`${this.paddings[e[EV]]}${e[JT]}`),e}};Yp.exports=t=>new Hp(t);Yp.exports.Padder=Yp.exports.Format=Hp});var gV=p((DRe,ZT)=>{"use strict";var{Colorizer:$re}=jp(),{Padder:Gre}=XT(),{configs:Wre,MESSAGE:jre}=Ge(),zp=class{constructor(e={}){e.levels||(e.levels=Wre.cli.levels),this.colorizer=new $re(e),this.padder=new Gre(e),this.options=e}transform(e,r){return this.colorizer.transform(this.padder.transform(e,r),r),e[jre]=`${e.level}:${e.message}`,e}};ZT.exports=t=>new zp(t);ZT.exports.Format=zp});var TV=p((xRe,ew)=>{"use strict";var Hre=Ft();function yV(t){if(t.every(Yre))return e=>{let r=e;for(let n=0;n<t.length;n++)if(r=t[n].transform(r,t[n].options),!r)return!1;return r}}function Yre(t){if(typeof t.transform!="function")throw new Error(["No transform function found on format. Did you create a format instance?","const myFormat = format(formatFn);","const instance = myFormat();"].join(`
`));return!0}ew.exports=(...t)=>{let e=Hre(yV(t)),r=e();return r.Format=e.Format,r};ew.exports.cascade=yV});var Ju=p((iw,bV)=>{"use strict";var{hasOwnProperty:Kp}=Object.prototype,yo=nw();yo.configure=nw;yo.stringify=yo;yo.default=yo;iw.stringify=yo;iw.configure=nw;bV.exports=yo;var zre=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;function oi(t){return t.length<5e3&&!zre.test(t)?`"${t}"`:JSON.stringify(t)}function tw(t){if(t.length>200)return t.sort();for(let e=1;e<t.length;e++){let r=t[e],n=e;for(;n!==0&&t[n-1]>r;)t[n]=t[n-1],n--;t[n]=r}return t}var Kre=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function rw(t){return Kre.call(t)!==void 0&&t.length!==0}function wV(t,e,r){t.length<r&&(r=t.length);let n=e===","?"":" ",s=`"0":${n}${t[0]}`;for(let a=1;a<r;a++)s+=`${e}"${a}":${n}${t[a]}`;return s}function Qre(t){if(Kp.call(t,"circularValue")){let e=t.circularValue;if(typeof e=="string")return`"${e}"`;if(e==null)return e;if(e===Error||e===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function OV(t,e){let r;if(Kp.call(t,e)&&(r=t[e],typeof r!="boolean"))throw new TypeError(`The "${e}" argument must be of type boolean`);return r===void 0?!0:r}function vV(t,e){let r;if(Kp.call(t,e)){if(r=t[e],typeof r!="number")throw new TypeError(`The "${e}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${e}" argument must be an integer`);if(r<1)throw new RangeError(`The "${e}" argument must be >= 1`)}return r===void 0?1/0:r}function go(t){return t===1?"1 item":`${t} items`}function Jre(t){let e=new Set;for(let r of t)(typeof r=="string"||typeof r=="number")&&e.add(String(r));return e}function Xre(t){if(Kp.call(t,"strict")){let e=t.strict;if(typeof e!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(e)return r=>{let n=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(n+=` (${r.toString()})`),new Error(n)}}}function nw(t){t={...t};let e=Xre(t);e&&(t.bigint===void 0&&(t.bigint=!1),"circularValue"in t||(t.circularValue=Error));let r=Qre(t),n=OV(t,"bigint"),s=OV(t,"deterministic"),a=vV(t,"maximumDepth"),o=vV(t,"maximumBreadth");function i(h,S,g,E,T,O){let v=S[h];switch(typeof v=="object"&&v!==null&&typeof v.toJSON=="function"&&(v=v.toJSON(h)),v=E.call(S,h,v),typeof v){case"string":return oi(v);case"object":{if(v===null)return"null";if(g.indexOf(v)!==-1)return r;let b="",N=",",I=O;if(Array.isArray(v)){if(v.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(v),T!==""&&(O+=T,b+=`
${O}`,N=`,
${O}`);let H=Math.min(v.length,o),ue=0;for(;ue<H-1;ue++){let fe=i(String(ue),v,g,E,T,O);b+=fe!==void 0?fe:"null",b+=N}let ot=i(String(ue),v,g,E,T,O);if(b+=ot!==void 0?ot:"null",v.length-1>o){let fe=v.length-o-1;b+=`${N}"... ${go(fe)} not stringified"`}return T!==""&&(b+=`
${I}`),g.pop(),`[${b}]`}let R=Object.keys(v),x=R.length;if(x===0)return"{}";if(a<g.length+1)return'"[Object]"';let C="",j="";T!==""&&(O+=T,N=`,
${O}`,C=" ");let ye=Math.min(x,o);s&&!rw(v)&&(R=tw(R)),g.push(v);for(let H=0;H<ye;H++){let ue=R[H],ot=i(ue,v,g,E,T,O);ot!==void 0&&(b+=`${j}${oi(ue)}:${C}${ot}`,j=N)}if(x>o){let H=x-o;b+=`${j}"...":${C}"${go(H)} not stringified"`,j=N}return T!==""&&j.length>1&&(b=`
${O}${b}
${I}`),g.pop(),`{${b}}`}case"number":return isFinite(v)?String(v):e?e(v):"null";case"boolean":return v===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(v);default:return e?e(v):void 0}}function u(h,S,g,E,T,O){switch(typeof S=="object"&&S!==null&&typeof S.toJSON=="function"&&(S=S.toJSON(h)),typeof S){case"string":return oi(S);case"object":{if(S===null)return"null";if(g.indexOf(S)!==-1)return r;let v=O,b="",N=",";if(Array.isArray(S)){if(S.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(S),T!==""&&(O+=T,b+=`
${O}`,N=`,
${O}`);let x=Math.min(S.length,o),C=0;for(;C<x-1;C++){let ye=u(String(C),S[C],g,E,T,O);b+=ye!==void 0?ye:"null",b+=N}let j=u(String(C),S[C],g,E,T,O);if(b+=j!==void 0?j:"null",S.length-1>o){let ye=S.length-o-1;b+=`${N}"... ${go(ye)} not stringified"`}return T!==""&&(b+=`
${v}`),g.pop(),`[${b}]`}g.push(S);let I="";T!==""&&(O+=T,N=`,
${O}`,I=" ");let R="";for(let x of E){let C=u(x,S[x],g,E,T,O);C!==void 0&&(b+=`${R}${oi(x)}:${I}${C}`,R=N)}return T!==""&&R.length>1&&(b=`
${O}${b}
${v}`),g.pop(),`{${b}}`}case"number":return isFinite(S)?String(S):e?e(S):"null";case"boolean":return S===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(S);default:return e?e(S):void 0}}function l(h,S,g,E,T){switch(typeof S){case"string":return oi(S);case"object":{if(S===null)return"null";if(typeof S.toJSON=="function"){if(S=S.toJSON(h),typeof S!="object")return l(h,S,g,E,T);if(S===null)return"null"}if(g.indexOf(S)!==-1)return r;let O=T;if(Array.isArray(S)){if(S.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(S),T+=E;let C=`
${T}`,j=`,
${T}`,ye=Math.min(S.length,o),H=0;for(;H<ye-1;H++){let ot=l(String(H),S[H],g,E,T);C+=ot!==void 0?ot:"null",C+=j}let ue=l(String(H),S[H],g,E,T);if(C+=ue!==void 0?ue:"null",S.length-1>o){let ot=S.length-o-1;C+=`${j}"... ${go(ot)} not stringified"`}return C+=`
${O}`,g.pop(),`[${C}]`}let v=Object.keys(S),b=v.length;if(b===0)return"{}";if(a<g.length+1)return'"[Object]"';T+=E;let N=`,
${T}`,I="",R="",x=Math.min(b,o);rw(S)&&(I+=wV(S,N,o),v=v.slice(S.length),x-=S.length,R=N),s&&(v=tw(v)),g.push(S);for(let C=0;C<x;C++){let j=v[C],ye=l(j,S[j],g,E,T);ye!==void 0&&(I+=`${R}${oi(j)}: ${ye}`,R=N)}if(b>o){let C=b-o;I+=`${R}"...": "${go(C)} not stringified"`,R=N}return R!==""&&(I=`
${T}${I}
${O}`),g.pop(),`{${I}}`}case"number":return isFinite(S)?String(S):e?e(S):"null";case"boolean":return S===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(S);default:return e?e(S):void 0}}function c(h,S,g){switch(typeof S){case"string":return oi(S);case"object":{if(S===null)return"null";if(typeof S.toJSON=="function"){if(S=S.toJSON(h),typeof S!="object")return c(h,S,g);if(S===null)return"null"}if(g.indexOf(S)!==-1)return r;let E="";if(Array.isArray(S)){if(S.length===0)return"[]";if(a<g.length+1)return'"[Array]"';g.push(S);let N=Math.min(S.length,o),I=0;for(;I<N-1;I++){let x=c(String(I),S[I],g);E+=x!==void 0?x:"null",E+=","}let R=c(String(I),S[I],g);if(E+=R!==void 0?R:"null",S.length-1>o){let x=S.length-o-1;E+=`,"... ${go(x)} not stringified"`}return g.pop(),`[${E}]`}let T=Object.keys(S),O=T.length;if(O===0)return"{}";if(a<g.length+1)return'"[Object]"';let v="",b=Math.min(O,o);rw(S)&&(E+=wV(S,",",o),T=T.slice(S.length),b-=S.length,v=","),s&&(T=tw(T)),g.push(S);for(let N=0;N<b;N++){let I=T[N],R=c(I,S[I],g);R!==void 0&&(E+=`${v}${oi(I)}:${R}`,v=",")}if(O>o){let N=O-o;E+=`${v}"...":"${go(N)} not stringified"`}return g.pop(),`{${E}}`}case"number":return isFinite(S)?String(S):e?e(S):"null";case"boolean":return S===!0?"true":"false";case"undefined":return;case"bigint":if(n)return String(S);default:return e?e(S):void 0}}function f(h,S,g){if(arguments.length>1){let E="";if(typeof g=="number"?E=" ".repeat(Math.min(g,10)):typeof g=="string"&&(E=g.slice(0,10)),S!=null){if(typeof S=="function")return i("",{"":h},[],S,E,"");if(Array.isArray(S))return u("",h,[],Jre(S),E,"")}if(E.length!==0)return l("",h,[],E,"")}return c("",h,[])}return f}});var ow=p((URe,AV)=>{"use strict";var Zre=Ft(),{MESSAGE:ene}=Ge(),tne=Ju();function rne(t,e){return typeof e=="bigint"?e.toString():e}AV.exports=Zre((t,e)=>{let r=tne.configure(e);return t[ene]=r(t,e.replacer||rne,e.space),t})});var NV=p((kRe,RV)=>{"use strict";var nne=Ft();RV.exports=nne((t,e)=>e.message?(t.message=`[${e.label}] ${t.message}`,t):(t.label=e.label,t))});var IV=p((BRe,PV)=>{"use strict";var ine=Ft(),{MESSAGE:one}=Ge(),sne=Ju();PV.exports=ine(t=>{let e={};return t.message&&(e["@message"]=t.message,delete t.message),t.timestamp&&(e["@timestamp"]=t.timestamp,delete t.timestamp),e["@fields"]=t,t[one]=sne(e),t})});var LV=p((qRe,MV)=>{"use strict";var ane=Ft();function une(t,e,r){let n=e.reduce((a,o)=>(a[o]=t[o],delete t[o],a),{}),s=Object.keys(t).reduce((a,o)=>(a[o]=t[o],delete t[o],a),{});return Object.assign(t,n,{[r]:s}),t}function lne(t,e,r){return t[r]=e.reduce((n,s)=>(n[s]=t[s],delete t[s],n),{}),t}MV.exports=ane((t,e={})=>{let r="metadata";e.key&&(r=e.key);let n=[];return!e.fillExcept&&!e.fillWith&&(n.push("level"),n.push("message")),e.fillExcept&&(n=e.fillExcept),n.length>0?une(t,n,r):e.fillWith?lne(t,e.fillWith,r):t})});var DV=p((VRe,CV)=>{var Cs=1e3,Ds=Cs*60,xs=Ds*60,To=xs*24,cne=To*7,fne=To*365.25;CV.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return dne(t);if(r==="number"&&isFinite(t))return e.long?hne(t):pne(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function dne(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*fne;case"weeks":case"week":case"w":return r*cne;case"days":case"day":case"d":return r*To;case"hours":case"hour":case"hrs":case"hr":case"h":return r*xs;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ds;case"seconds":case"second":case"secs":case"sec":case"s":return r*Cs;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function pne(t){var e=Math.abs(t);return e>=To?Math.round(t/To)+"d":e>=xs?Math.round(t/xs)+"h":e>=Ds?Math.round(t/Ds)+"m":e>=Cs?Math.round(t/Cs)+"s":t+"ms"}function hne(t){var e=Math.abs(t);return e>=To?Qp(t,e,To,"day"):e>=xs?Qp(t,e,xs,"hour"):e>=Ds?Qp(t,e,Ds,"minute"):e>=Cs?Qp(t,e,Cs,"second"):t+" ms"}function Qp(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}});var UV=p((Xu,xV)=>{"use strict";var _ne=Ft(),mne=DV();xV.exports=_ne(t=>{let e=+new Date;return Xu.diff=e-(Xu.prevTime||e),Xu.prevTime=e,t.ms=`+${mne(Xu.diff)}`,t})});var qV=p((FRe,BV)=>{"use strict";var Sne=require("util").inspect,Ene=Ft(),{LEVEL:gne,MESSAGE:kV,SPLAT:yne}=Ge();BV.exports=Ene((t,e={})=>{let r=Object.assign({},t);return delete r[gne],delete r[kV],delete r[yne],t[kV]=Sne(r,!1,e.depth||null,e.colorize),t})});var VV=p(($Re,Xp)=>{"use strict";var{MESSAGE:Tne}=Ge(),Jp=class{constructor(e){this.template=e}transform(e){return e[Tne]=this.template(e),e}};Xp.exports=t=>new Jp(t);Xp.exports.Printf=Xp.exports.Format=Jp});var GV=p((GRe,$V)=>{"use strict";var wne=Ft(),{MESSAGE:FV}=Ge(),One=Ju();$V.exports=wne(t=>{let e=One(Object.assign({},t,{level:void 0,message:void 0,splat:void 0})),r=t.padding&&t.padding[t.level]||"";return e!=="{}"?t[FV]=`${t.level}:${r} ${t.message} ${e}`:t[FV]=`${t.level}:${r} ${t.message}`,t})});var HV=p((WRe,jV)=>{"use strict";var vne=require("util"),{SPLAT:WV}=Ge(),bne=/%[scdjifoO%]/g,Ane=/%%/g,sw=class{constructor(e){this.options=e}_splat(e,r){let n=e.message,s=e[WV]||e.splat||[],a=n.match(Ane),o=a&&a.length||0,u=r.length-o-s.length,l=u<0?s.splice(u,-1*u):[],c=l.length;if(c)for(let f=0;f<c;f++)Object.assign(e,l[f]);return e.message=vne.format(n,...s),e}transform(e){let r=e.message,n=e[WV]||e.splat;if(!n||!n.length)return e;let s=r&&r.match&&r.match(bne);if(!s&&(n||n.length)){let a=n.length>1?n.splice(0):n,o=a.length;if(o)for(let i=0;i<o;i++)Object.assign(e,a[i]);return e}return s?this._splat(e,s):e}};jV.exports=t=>new sw(t)});var zV=p((Zp,YV)=>{(function(t,e){typeof Zp=="object"&&typeof YV<"u"?e(Zp):typeof define=="function"&&define.amd?define(["exports"],e):e(t.fecha={})})(Zp,(function(t){"use strict";var e=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,r="\\d\\d?",n="\\d\\d",s="\\d{3}",a="\\d{4}",o="[^\\s]+",i=/\[([^]*?)\]/gm;function u(A,D){for(var me=[],st=0,G=A.length;st<G;st++)me.push(A[st].substr(0,D));return me}var l=function(A){return function(D,me){var st=me[A].map(function(It){return It.toLowerCase()}),G=st.indexOf(D.toLowerCase());return G>-1?G:null}};function c(A){for(var D=[],me=1;me<arguments.length;me++)D[me-1]=arguments[me];for(var st=0,G=D;st<G.length;st++){var It=G[st];for(var gn in It)A[gn]=It[gn]}return A}var f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"],S=u(h,3),g=u(f,3),E={dayNamesShort:g,dayNames:f,monthNamesShort:S,monthNames:h,amPm:["am","pm"],DoFn:function(A){return A+["th","st","nd","rd"][A%10>3?0:(A-A%10!==10?1:0)*A%10]}},T=c({},E),O=function(A){return T=c(T,A)},v=function(A){return A.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},b=function(A,D){for(D===void 0&&(D=2),A=String(A);A.length<D;)A="0"+A;return A},N={D:function(A){return String(A.getDate())},DD:function(A){return b(A.getDate())},Do:function(A,D){return D.DoFn(A.getDate())},d:function(A){return String(A.getDay())},dd:function(A){return b(A.getDay())},ddd:function(A,D){return D.dayNamesShort[A.getDay()]},dddd:function(A,D){return D.dayNames[A.getDay()]},M:function(A){return String(A.getMonth()+1)},MM:function(A){return b(A.getMonth()+1)},MMM:function(A,D){return D.monthNamesShort[A.getMonth()]},MMMM:function(A,D){return D.monthNames[A.getMonth()]},YY:function(A){return b(String(A.getFullYear()),4).substr(2)},YYYY:function(A){return b(A.getFullYear(),4)},h:function(A){return String(A.getHours()%12||12)},hh:function(A){return b(A.getHours()%12||12)},H:function(A){return String(A.getHours())},HH:function(A){return b(A.getHours())},m:function(A){return String(A.getMinutes())},mm:function(A){return b(A.getMinutes())},s:function(A){return String(A.getSeconds())},ss:function(A){return b(A.getSeconds())},S:function(A){return String(Math.round(A.getMilliseconds()/100))},SS:function(A){return b(Math.round(A.getMilliseconds()/10),2)},SSS:function(A){return b(A.getMilliseconds(),3)},a:function(A,D){return A.getHours()<12?D.amPm[0]:D.amPm[1]},A:function(A,D){return A.getHours()<12?D.amPm[0].toUpperCase():D.amPm[1].toUpperCase()},ZZ:function(A){var D=A.getTimezoneOffset();return(D>0?"-":"+")+b(Math.floor(Math.abs(D)/60)*100+Math.abs(D)%60,4)},Z:function(A){var D=A.getTimezoneOffset();return(D>0?"-":"+")+b(Math.floor(Math.abs(D)/60),2)+":"+b(Math.abs(D)%60,2)}},I=function(A){return+A-1},R=[null,r],x=[null,o],C=["isPm",o,function(A,D){var me=A.toLowerCase();return me===D.amPm[0]?0:me===D.amPm[1]?1:null}],j=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(A){var D=(A+"").match(/([+-]|\d\d)/gi);if(D){var me=+D[1]*60+parseInt(D[2],10);return D[0]==="+"?me:-me}return 0}],ye={D:["day",r],DD:["day",n],Do:["day",r+o,function(A){return parseInt(A,10)}],M:["month",r,I],MM:["month",n,I],YY:["year",n,function(A){var D=new Date,me=+(""+D.getFullYear()).substr(0,2);return+(""+(+A>68?me-1:me)+A)}],h:["hour",r,void 0,"isPm"],hh:["hour",n,void 0,"isPm"],H:["hour",r],HH:["hour",n],m:["minute",r],mm:["minute",n],s:["second",r],ss:["second",n],YYYY:["year",a],S:["millisecond","\\d",function(A){return+A*100}],SS:["millisecond",n,function(A){return+A*10}],SSS:["millisecond",s],d:R,dd:R,ddd:x,dddd:x,MMM:["month",o,l("monthNamesShort")],MMMM:["month",o,l("monthNames")],a:C,A:C,ZZ:j,Z:j},H={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},ue=function(A){return c(H,A)},ot=function(A,D,me){if(D===void 0&&(D=H.default),me===void 0&&(me={}),typeof A=="number"&&(A=new Date(A)),Object.prototype.toString.call(A)!=="[object Date]"||isNaN(A.getTime()))throw new Error("Invalid Date pass to format");D=H[D]||D;var st=[];D=D.replace(i,function(It,gn){return st.push(gn),"@@@"});var G=c(c({},T),me);return D=D.replace(e,function(It){return N[It](A,G)}),D.replace(/@@@/g,function(){return st.shift()})};function fe(A,D,me){if(me===void 0&&(me={}),typeof D!="string")throw new Error("Invalid format in fecha parse");if(D=H[D]||D,A.length>1e3)return null;var st=new Date,G={year:st.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},It=[],gn=[],Fn=D.replace(i,function(Wn,jn){return gn.push(v(jn)),"@@@"}),qi={},Jc={};Fn=v(Fn).replace(e,function(Wn){var jn=ye[Wn],du=jn[0],tf=jn[1],rf=jn[3];if(qi[du])throw new Error("Invalid format. "+du+" specified twice in format");return qi[du]=!0,rf&&(Jc[rf]=!0),It.push(jn),"("+tf+")"}),Object.keys(Jc).forEach(function(Wn){if(!qi[Wn])throw new Error("Invalid format. "+Wn+" is required in specified format")}),Fn=Fn.replace(/@@@/g,function(){return gn.shift()});var $n=A.match(new RegExp(Fn,"i"));if(!$n)return null;for(var Xc=c(c({},T),me),Zt=1;Zt<$n.length;Zt++){var Gn=It[Zt-1],Zc=Gn[0],ef=Gn[2],Yr=ef?ef($n[Zt],Xc):+$n[Zt];if(Yr==null)return null;G[Zc]=Yr}G.isPm===1&&G.hour!=null&&+G.hour!=12?G.hour=+G.hour+12:G.isPm===0&&+G.hour==12&&(G.hour=0);var Vi;if(G.timezoneOffset==null){Vi=new Date(G.year,G.month,G.day,G.hour,G.minute,G.second,G.millisecond);for(var Yo=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],Zt=0,fu=Yo.length;Zt<fu;Zt++)if(qi[Yo[Zt][0]]&&G[Yo[Zt][0]]!==Vi[Yo[Zt][1]]())return null}else if(Vi=new Date(Date.UTC(G.year,G.month,G.day,G.hour,G.minute-G.timezoneOffset,G.second,G.millisecond)),G.month>11||G.month<0||G.day>31||G.day<1||G.hour>23||G.hour<0||G.minute>59||G.minute<0||G.second>59||G.second<0)return null;return Vi}var ke={format:ot,parse:fe,defaultI18n:E,setGlobalDateI18n:O,setGlobalDateMasks:ue};t.assign=c,t.default=ke,t.format=ot,t.parse=fe,t.defaultI18n=E,t.setGlobalDateI18n=O,t.setGlobalDateMasks=ue,Object.defineProperty(t,"__esModule",{value:!0})}))});var QV=p((jRe,KV)=>{"use strict";var Rne=zV(),Nne=Ft();KV.exports=Nne((t,e={})=>(e.format&&(t.timestamp=typeof e.format=="function"?e.format():Rne.format(new Date,e.format)),t.timestamp||(t.timestamp=new Date().toISOString()),e.alias&&(t[e.alias]=t.timestamp),t))});var XV=p((HRe,JV)=>{"use strict";var aw=HT(),Pne=Ft(),{MESSAGE:uw}=Ge();JV.exports=Pne((t,e)=>(e.level!==!1&&(t.level=aw.strip(t.level)),e.message!==!1&&(t.message=aw.strip(String(t.message))),e.raw!==!1&&t[uw]&&(t[uw]=aw.strip(String(t[uw]))),t))});var cw=p(lw=>{"use strict";var Ine=lw.format=Ft();lw.levels=dV();function mt(t,e){Object.defineProperty(Ine,t,{get(){return e()},configurable:!0})}mt("align",function(){return hV()});mt("errors",function(){return SV()});mt("cli",function(){return gV()});mt("combine",function(){return TV()});mt("colorize",function(){return jp()});mt("json",function(){return ow()});mt("label",function(){return NV()});mt("logstash",function(){return IV()});mt("metadata",function(){return LV()});mt("ms",function(){return UV()});mt("padLevels",function(){return XT()});mt("prettyPrint",function(){return qV()});mt("printf",function(){return VV()});mt("simple",function(){return GV()});mt("splat",function(){return HV()});mt("timestamp",function(){return QV()});mt("uncolorize",function(){return XV()})});var fw=p(eh=>{"use strict";var{format:ZV}=require("util");eh.warn={deprecated(t){return()=>{throw new Error(ZV("{ %s } was removed in winston@3.0.0.",t))}},useFormat(t){return()=>{throw new Error([ZV("{ %s } was removed in winston@3.0.0.",t),"Use a custom winston.format = winston.format(function) instead."].join(`
`))}},forFunctions(t,e,r){r.forEach(n=>{t[n]=eh.warn[e](n)})},forProperties(t,e,r){r.forEach(n=>{let s=eh.warn[e](n);Object.defineProperty(t,n,{get:s,set:s})})}}});var eF=p((KRe,Mne)=>{Mne.exports={name:"winston",description:"A logger for just about everything.",version:"3.17.0",author:"Charlie Robbins <charlie.robbins@gmail.com>",maintainers:["David Hyde <dabh@alumni.stanford.edu>"],repository:{type:"git",url:"https://github.com/winstonjs/winston.git"},keywords:["winston","logger","logging","logs","sysadmin","bunyan","pino","loglevel","tools","json","stream"],dependencies:{"@dabh/diagnostics":"^2.0.2","@colors/colors":"^1.6.0",async:"^3.2.3","is-stream":"^2.0.0",logform:"^2.7.0","one-time":"^1.0.0","readable-stream":"^3.4.0","safe-stable-stringify":"^2.3.1","stack-trace":"0.0.x","triple-beam":"^1.3.0","winston-transport":"^4.9.0"},devDependencies:{"@babel/cli":"^7.23.9","@babel/core":"^7.24.0","@babel/preset-env":"^7.24.0","@dabh/eslint-config-populist":"^4.4.0","@types/node":"^20.11.24","abstract-winston-transport":"^0.5.1",assume:"^2.2.0","cross-spawn-async":"^2.2.5",eslint:"^8.57.0",hock:"^1.4.1",mocha:"^10.3.0",nyc:"^17.1.0",rimraf:"5.0.1",split2:"^4.1.0","std-mocks":"^2.0.0",through2:"^4.0.2","winston-compat":"^0.1.5"},main:"./lib/winston.js",browser:"./dist/winston",types:"./index.d.ts",scripts:{lint:"eslint lib/*.js lib/winston/*.js lib/winston/**/*.js --resolve-plugins-relative-to ./node_modules/@dabh/eslint-config-populist",test:"rimraf test/fixtures/logs/* && mocha","test:coverage":"nyc npm run test:unit","test:unit":"mocha test/unit","test:integration":"mocha test/integration",build:"rimraf dist && babel lib -d dist",prepublishOnly:"npm run build"},engines:{node:">= 12.0.0"},license:"MIT"}});var dw=p((QRe,nF)=>{"use strict";var Lne=require("util"),tF=Fu(),{LEVEL:rF}=Ge(),Zu=nF.exports=function(e={}){tF.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this.format=e.format,this.level=e.level,this.handleExceptions=e.handleExceptions,this.handleRejections=e.handleRejections,this.silent=e.silent,e.log&&(this.log=e.log),e.logv&&(this.logv=e.logv),e.close&&(this.close=e.close),this.once("pipe",r=>{this.levels=r.levels,this.parent=r}),this.once("unpipe",r=>{r===this.parent&&(this.parent=null,this.close&&this.close())})};Lne.inherits(Zu,tF);Zu.prototype._write=function(e,r,n){if(this.silent||e.exception===!0&&!this.handleExceptions)return n(null);let s=this.level||this.parent&&this.parent.level;if(!s||this.levels[s]>=this.levels[e[rF]]){if(e&&!this.format)return this.log(e,n);let a,o;try{o=this.format.transform(Object.assign({},e),this.format.options)}catch(i){a=i}if(a||!o){if(n(),a)throw a;return}return this.log(o,n)}return this._writableState.sync=!1,n(null)};Zu.prototype._writev=function(e,r){if(this.logv){let n=e.filter(this._accept,this);return n.length?this.logv(n,r):r(null)}for(let n=0;n<e.length;n++){if(!this._accept(e[n]))continue;if(e[n].chunk&&!this.format){this.log(e[n].chunk,e[n].callback);continue}let s,a;try{a=this.format.transform(Object.assign({},e[n].chunk),this.format.options)}catch(o){s=o}if(s||!a){if(e[n].callback(),s)throw r(null),s}else this.log(a,e[n].callback)}return r(null)};Zu.prototype._accept=function(e){let r=e.chunk;if(this.silent)return!1;let n=this.level||this.parent&&this.parent.level;return!!((r.exception===!0||!n||this.levels[n]>=this.levels[r[rF]])&&(this.handleExceptions||r.exception!==!0))};Zu.prototype._nop=function(){}});var hw=p((JRe,oF)=>{"use strict";var Cne=require("util"),{LEVEL:pw}=Ge(),iF=dw(),el=oF.exports=function(e={}){if(iF.call(this,e),!e.transport||typeof e.transport.log!="function")throw new Error("Invalid transport, must be an object with a log method.");this.transport=e.transport,this.level=this.level||e.transport.level,this.handleExceptions=this.handleExceptions||e.transport.handleExceptions,this._deprecated();function r(n){this.emit("error",n,this.transport)}this.transport.__winstonError||(this.transport.__winstonError=r.bind(this),this.transport.on("error",this.transport.__winstonError))};Cne.inherits(el,iF);el.prototype._write=function(e,r,n){if(this.silent||e.exception===!0&&!this.handleExceptions)return n(null);(!this.level||this.levels[this.level]>=this.levels[e[pw]])&&this.transport.log(e[pw],e.message,e,this._nop),n(null)};el.prototype._writev=function(e,r){for(let n=0;n<e.length;n++)this._accept(e[n])&&(this.transport.log(e[n].chunk[pw],e[n].chunk.message,e[n].chunk,this._nop),e[n].callback());return r(null)};el.prototype._deprecated=function(){console.error([`${this.transport.name} is a legacy winston transport. Consider upgrading: `,"- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md"].join(`
`))};el.prototype.close=function(){this.transport.close&&this.transport.close(),this.transport.__winstonError&&(this.transport.removeListener("error",this.transport.__winstonError),this.transport.__winstonError=null)}});var Us=p((XRe,_w)=>{"use strict";_w.exports=dw();_w.exports.LegacyTransportStream=hw()});var uF=p((eNe,aF)=>{"use strict";var Dne=require("os"),{LEVEL:sF,MESSAGE:ks}=Ge(),xne=Us();aF.exports=class extends xne{constructor(e={}){super(e),this.name=e.name||"console",this.stderrLevels=this._stringArrayToSet(e.stderrLevels),this.consoleWarnLevels=this._stringArrayToSet(e.consoleWarnLevels),this.eol=typeof e.eol=="string"?e.eol:Dne.EOL,this.forceConsole=e.forceConsole||!1,this._consoleLog=console.log.bind(console),this._consoleWarn=console.warn.bind(console),this._consoleError=console.error.bind(console),this.setMaxListeners(30)}log(e,r){if(setImmediate(()=>this.emit("logged",e)),this.stderrLevels[e[sF]]){console._stderr&&!this.forceConsole?console._stderr.write(`${e[ks]}${this.eol}`):this._consoleError(e[ks]),r&&r();return}else if(this.consoleWarnLevels[e[sF]]){console._stderr&&!this.forceConsole?console._stderr.write(`${e[ks]}${this.eol}`):this._consoleWarn(e[ks]),r&&r();return}console._stdout&&!this.forceConsole?console._stdout.write(`${e[ks]}${this.eol}`):this._consoleLog(e[ks]),r&&r()}_stringArrayToSet(e,r){if(!e)return{};if(r=r||"Cannot make set from type other than Array of string elements",!Array.isArray(e))throw new Error(r);return e.reduce((n,s)=>{if(typeof s!="string")throw new Error(r);return n[s]=!0,n},{})}}});var rh=p((th,lF)=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.default=Une;function Une(t){return t&&typeof t.length=="number"&&t.length>=0&&t.length%1===0}lF.exports=th.default});var fF=p((nh,cF)=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});nh.default=function(t){return function(...e){var r=e.pop();return t.call(this,e,r)}};cF.exports=nh.default});var hF=p(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.fallback=dF;si.wrap=pF;var kne=si.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Bne=si.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,qne=si.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function dF(t){setTimeout(t,0)}function pF(t){return(e,...r)=>t(()=>e(...r))}var tl;kne?tl=queueMicrotask:Bne?tl=setImmediate:qne?tl=process.nextTick:tl=dF;si.default=pF(tl)});var gF=p((ih,EF)=>{"use strict";Object.defineProperty(ih,"__esModule",{value:!0});ih.default=jne;var Vne=fF(),Fne=SF(Vne),$ne=hF(),Gne=SF($ne),Wne=wo();function SF(t){return t&&t.__esModule?t:{default:t}}function jne(t){return(0,Wne.isAsync)(t)?function(...e){let r=e.pop(),n=t.apply(this,e);return _F(n,r)}:(0,Fne.default)(function(e,r){var n;try{n=t.apply(this,e)}catch(s){return r(s)}if(n&&typeof n.then=="function")return _F(n,r);r(null,n)})}function _F(t,e){return t.then(r=>{mF(e,null,r)},r=>{mF(e,r&&(r instanceof Error||r.message)?r:new Error(r))})}function mF(t,e,r){try{t(e,r)}catch(n){(0,Gne.default)(s=>{throw s},n)}}EF.exports=ih.default});var wo=p(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.isAsyncIterable=Rn.isAsyncGenerator=Rn.isAsync=void 0;var Hne=gF(),Yne=zne(Hne);function zne(t){return t&&t.__esModule?t:{default:t}}function yF(t){return t[Symbol.toStringTag]==="AsyncFunction"}function Kne(t){return t[Symbol.toStringTag]==="AsyncGenerator"}function Qne(t){return typeof t[Symbol.asyncIterator]=="function"}function Jne(t){if(typeof t!="function")throw new Error("expected a function");return yF(t)?(0,Yne.default)(t):t}Rn.default=Jne;Rn.isAsync=yF;Rn.isAsyncGenerator=Kne;Rn.isAsyncIterable=Qne});var Bs=p((oh,TF)=>{"use strict";Object.defineProperty(oh,"__esModule",{value:!0});oh.default=Xne;function Xne(t,e){if(e||(e=t.length),!e)throw new Error("arity is undefined");function r(...n){return typeof n[e-1]=="function"?t.apply(this,n):new Promise((s,a)=>{n[e-1]=(o,...i)=>{if(o)return a(o);s(i.length>1?i:i[0])},t.apply(this,n)})}return r}TF.exports=oh.default});var OF=p((sh,wF)=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});var Zne=rh(),eie=mw(Zne),tie=wo(),rie=mw(tie),nie=Bs(),iie=mw(nie);function mw(t){return t&&t.__esModule?t:{default:t}}sh.default=(0,iie.default)((t,e,r)=>{var n=(0,eie.default)(e)?[]:{};t(e,(s,a,o)=>{(0,rie.default)(s)((i,...u)=>{u.length<2&&([u]=u),n[a]=u,o(i)})},s=>r(s,n))},3);wF.exports=sh.default});var Sw=p((ah,vF)=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.default=oie;function oie(t){function e(...r){if(t!==null){var n=t;t=null,n.apply(this,r)}}return Object.assign(e,t),e}vF.exports=ah.default});var AF=p((uh,bF)=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()};bF.exports=uh.default});var PF=p((lh,NF)=>{"use strict";Object.defineProperty(lh,"__esModule",{value:!0});lh.default=pie;var sie=rh(),aie=RF(sie),uie=AF(),lie=RF(uie);function RF(t){return t&&t.__esModule?t:{default:t}}function cie(t){var e=-1,r=t.length;return function(){return++e<r?{value:t[e],key:e}:null}}function fie(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}function die(t){var e=t?Object.keys(t):[],r=-1,n=e.length;return function s(){var a=e[++r];return a==="__proto__"?s():r<n?{value:t[a],key:a}:null}}function pie(t){if((0,aie.default)(t))return cie(t);var e=(0,lie.default)(t);return e?fie(e):die(t)}NF.exports=lh.default});var Ew=p((ch,IF)=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});ch.default=hie;function hie(t){return function(...e){if(t===null)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,e)}}IF.exports=ch.default});var dh=p((fh,MF)=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});var _ie={};fh.default=_ie;MF.exports=fh.default});var CF=p((ph,LF)=>{"use strict";Object.defineProperty(ph,"__esModule",{value:!0});ph.default=gie;var mie=dh(),Sie=Eie(mie);function Eie(t){return t&&t.__esModule?t:{default:t}}function gie(t,e,r,n){let s=!1,a=!1,o=!1,i=0,u=0;function l(){i>=e||o||s||(o=!0,t.next().then(({value:h,done:S})=>{if(!(a||s)){if(o=!1,S){s=!0,i<=0&&n(null);return}i++,r(h,u,c),u++,l()}}).catch(f))}function c(h,S){if(i-=1,!a){if(h)return f(h);if(h===!1){s=!0,a=!0;return}if(S===Sie.default||s&&i<=0)return s=!0,n(null);l()}}function f(h){a||(o=!1,s=!0,n(h))}l()}LF.exports=ph.default});var kF=p((hh,UF)=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});var yie=Sw(),Tie=rl(yie),wie=PF(),Oie=rl(wie),vie=Ew(),bie=rl(vie),DF=wo(),Aie=CF(),xF=rl(Aie),Rie=dh(),Nie=rl(Rie);function rl(t){return t&&t.__esModule?t:{default:t}}hh.default=t=>(e,r,n)=>{if(n=(0,Tie.default)(n),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return n(null);if((0,DF.isAsyncGenerator)(e))return(0,xF.default)(e,t,r,n);if((0,DF.isAsyncIterable)(e))return(0,xF.default)(e[Symbol.asyncIterator](),t,r,n);var s=(0,Oie.default)(e),a=!1,o=!1,i=0,u=!1;function l(f,h){if(!o)if(i-=1,f)a=!0,n(f);else if(f===!1)a=!0,o=!0;else{if(h===Nie.default||a&&i<=0)return a=!0,n(null);u||c()}}function c(){for(u=!0;i<t&&!a;){var f=s();if(f===null){a=!0,i<=0&&n(null);return}i+=1,r(f.value,f.key,(0,bie.default)(l))}u=!1}c()};UF.exports=hh.default});var yw=p((_h,BF)=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});var Pie=kF(),Iie=gw(Pie),Mie=wo(),Lie=gw(Mie),Cie=Bs(),Die=gw(Cie);function gw(t){return t&&t.__esModule?t:{default:t}}function xie(t,e,r,n){return(0,Iie.default)(e)(t,(0,Lie.default)(r),n)}_h.default=(0,Die.default)(xie,4);BF.exports=_h.default});var FF=p((mh,VF)=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});var Uie=yw(),kie=qF(Uie),Bie=Bs(),qie=qF(Bie);function qF(t){return t&&t.__esModule?t:{default:t}}function Vie(t,e,r){return(0,kie.default)(t,1,e,r)}mh.default=(0,qie.default)(Vie,3);VF.exports=mh.default});var WF=p((Sh,GF)=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.default=jie;var Fie=OF(),$ie=$F(Fie),Gie=FF(),Wie=$F(Gie);function $F(t){return t&&t.__esModule?t:{default:t}}function jie(t,e){return(0,$ie.default)(Wie.default,t,e)}GF.exports=Sh.default});var Tw=p((nNe,HF)=>{"use strict";HF.exports=Nn;var Eh=ei().codes,Hie=Eh.ERR_METHOD_NOT_IMPLEMENTED,Yie=Eh.ERR_MULTIPLE_CALLBACK,zie=Eh.ERR_TRANSFORM_ALREADY_TRANSFORMING,Kie=Eh.ERR_TRANSFORM_WITH_LENGTH_0,gh=ho();ws()(Nn,gh);function Qie(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new Yie);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function Nn(t){if(!(this instanceof Nn))return new Nn(t);gh.call(this,t),this._transformState={afterTransform:Qie.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Jie)}function Jie(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){jF(t,e,r)}):jF(this,null,null)}Nn.prototype.push=function(t,e){return this._transformState.needTransform=!1,gh.prototype.push.call(this,t,e)};Nn.prototype._transform=function(t,e,r){r(new Hie("_transform()"))};Nn.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var s=this._readableState;(n.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}};Nn.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Nn.prototype._destroy=function(t,e){gh.prototype._destroy.call(this,t,function(r){e(r)})};function jF(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Kie;if(t._transformState.transforming)throw new zie;return t.push(null)}});var KF=p((iNe,zF)=>{"use strict";zF.exports=nl;var YF=Tw();ws()(nl,YF);function nl(t){if(!(this instanceof nl))return new nl(t);YF.call(this,t)}nl.prototype._transform=function(t,e,r){r(null,t)}});var e$=p((oNe,ZF)=>{"use strict";var ww;function Xie(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var XF=ei().codes,Zie=XF.ERR_MISSING_ARGS,eoe=XF.ERR_STREAM_DESTROYED;function QF(t){if(t)throw t}function toe(t){return t.setHeader&&typeof t.abort=="function"}function roe(t,e,r,n){n=Xie(n);var s=!1;t.on("close",function(){s=!0}),ww===void 0&&(ww=_p()),ww(t,{readable:e,writable:r},function(o){if(o)return n(o);s=!0,n()});var a=!1;return function(o){if(!s&&!a){if(a=!0,toe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(o||new eoe("pipe"))}}}function JF(t){t()}function noe(t,e){return t.pipe(e)}function ioe(t){return!t.length||typeof t[t.length-1]!="function"?QF:t.pop()}function ooe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=ioe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Zie("streams");var s,a=e.map(function(o,i){var u=i<e.length-1,l=i>0;return roe(o,u,l,function(c){s||(s=c),c&&a.forEach(JF),!u&&(a.forEach(JF),n(s))})});return e.reduce(noe)}ZF.exports=ooe});var Oo=p((Sr,ol)=>{var il=require("stream");process.env.READABLE_STREAM==="disable"&&il?(ol.exports=il.Readable,Object.assign(ol.exports,il),ol.exports.Stream=il):(Sr=ol.exports=ST(),Sr.Stream=il||Sr,Sr.Readable=Sr,Sr.Writable=Fu(),Sr.Duplex=ho(),Sr.Transform=Tw(),Sr.PassThrough=KF(),Sr.finished=_p(),Sr.pipeline=e$())});var Pw=p((sNe,r$)=>{var qs=[],sl=[],Ow=function(){};function bw(t){return~qs.indexOf(t)?!1:(qs.push(t),!0)}function Aw(t){Ow=t}function soe(t){for(var e=[],r=0;r<qs.length;r++){if(qs[r].async){e.push(qs[r]);continue}if(qs[r](t))return!0}return e.length?new Promise(function(s){Promise.all(e.map(function(o){return o(t)})).then(function(o){s(o.some(Boolean))})}):!1}function Rw(t){return~sl.indexOf(t)?!1:(sl.push(t),!0)}function vw(){Ow.apply(Ow,arguments)}function t$(t){for(var e=0;e<sl.length;e++)t=sl[e].apply(sl[e],arguments);return t}function Nw(t,e){var r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&(t[n]=e[n]);return t}function aoe(t){return t.enabled=!1,t.modify=Rw,t.set=Aw,t.use=bw,Nw(function(){return!1},t)}function uoe(t){function e(){var r=Array.prototype.slice.call(arguments,0);return vw.call(vw,t,t$(r,t)),!0}return t.enabled=!0,t.modify=Rw,t.set=Aw,t.use=bw,Nw(e,t)}r$.exports=function(e){return e.introduce=Nw,e.enabled=soe,e.process=t$,e.modify=Rw,e.write=vw,e.nope=aoe,e.yep=uoe,e.set=Aw,e.use=bw,e}});var i$=p((aNe,n$)=>{var loe=Pw(),coe=loe(function t(e,r){return r=r||{},r.namespace=e,r.prod=!0,r.dev=!1,r.force||t.force?t.yep(r):t.nope(r)});n$.exports=coe});var s$=p((uNe,o$)=>{"use strict";o$.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var u$=p((lNe,a$)=>{a$.exports=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}});var f$=p((cNe,c$)=>{"use strict";var foe=u$(),doe=Array.prototype.concat,poe=Array.prototype.slice,l$=c$.exports=function(e){for(var r=[],n=0,s=e.length;n<s;n++){var a=e[n];foe(a)?r=doe.call(r,poe.call(a)):r.push(a)}return r};l$.wrap=function(t){return function(){return t(l$(arguments))}}});var _$=p((fNe,h$)=>{var al=s$(),ul=f$(),d$=Object.hasOwnProperty,p$=Object.create(null);for(yh in al)d$.call(al,yh)&&(p$[al[yh]]=yh);var yh,sr=h$.exports={to:{},get:{}};sr.get=function(t){var e=t.substring(0,3).toLowerCase(),r,n;switch(e){case"hsl":r=sr.get.hsl(t),n="hsl";break;case"hwb":r=sr.get.hwb(t),n="hwb";break;default:r=sr.get.rgb(t),n="rgb";break}return r?{model:n,value:r}:null};sr.get.rgb=function(t){if(!t)return null;var e=/^#([a-f0-9]{3,4})$/i,r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,n=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^(\w+)$/,o=[0,0,0,1],i,u,l;if(i=t.match(r)){for(l=i[2],i=i[1],u=0;u<3;u++){var c=u*2;o[u]=parseInt(i.slice(c,c+2),16)}l&&(o[3]=parseInt(l,16)/255)}else if(i=t.match(e)){for(i=i[1],l=i[3],u=0;u<3;u++)o[u]=parseInt(i[u]+i[u],16);l&&(o[3]=parseInt(l+l,16)/255)}else if(i=t.match(n)){for(u=0;u<3;u++)o[u]=parseInt(i[u+1],0);i[4]&&(i[5]?o[3]=parseFloat(i[4])*.01:o[3]=parseFloat(i[4]))}else if(i=t.match(s)){for(u=0;u<3;u++)o[u]=Math.round(parseFloat(i[u+1])*2.55);i[4]&&(i[5]?o[3]=parseFloat(i[4])*.01:o[3]=parseFloat(i[4]))}else return(i=t.match(a))?i[1]==="transparent"?[0,0,0,0]:d$.call(al,i[1])?(o=al[i[1]],o[3]=1,o):null:null;for(u=0;u<3;u++)o[u]=ai(o[u],0,255);return o[3]=ai(o[3],0,1),o};sr.get.hsl=function(t){if(!t)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=t.match(e);if(r){var n=parseFloat(r[4]),s=(parseFloat(r[1])%360+360)%360,a=ai(parseFloat(r[2]),0,100),o=ai(parseFloat(r[3]),0,100),i=ai(isNaN(n)?1:n,0,1);return[s,a,o,i]}return null};sr.get.hwb=function(t){if(!t)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,r=t.match(e);if(r){var n=parseFloat(r[4]),s=(parseFloat(r[1])%360+360)%360,a=ai(parseFloat(r[2]),0,100),o=ai(parseFloat(r[3]),0,100),i=ai(isNaN(n)?1:n,0,1);return[s,a,o,i]}return null};sr.to.hex=function(){var t=ul(arguments);return"#"+Th(t[0])+Th(t[1])+Th(t[2])+(t[3]<1?Th(Math.round(t[3]*255)):"")};sr.to.rgb=function(){var t=ul(arguments);return t.length<4||t[3]===1?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"};sr.to.rgb.percent=function(){var t=ul(arguments),e=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||t[3]===1?"rgb("+e+"%, "+r+"%, "+n+"%)":"rgba("+e+"%, "+r+"%, "+n+"%, "+t[3]+")"};sr.to.hsl=function(){var t=ul(arguments);return t.length<4||t[3]===1?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"};sr.to.hwb=function(){var t=ul(arguments),e="";return t.length>=4&&t[3]!==1&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"};sr.to.keyword=function(t){return p$[t.slice(0,3)]};function ai(t,e,r){return Math.min(Math.max(e,t),r)}function Th(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}});var S$=p((dNe,m$)=>{"use strict";m$.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var Iw=p((pNe,T$)=>{var vo=S$(),y$={};for(wh in vo)vo.hasOwnProperty(wh)&&(y$[vo[wh]]=wh);var wh,F=T$.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(Ct in F)if(F.hasOwnProperty(Ct)){if(!("channels"in F[Ct]))throw new Error("missing channels property: "+Ct);if(!("labels"in F[Ct]))throw new Error("missing channel labels property: "+Ct);if(F[Ct].labels.length!==F[Ct].channels)throw new Error("channel and label counts mismatch: "+Ct);E$=F[Ct].channels,g$=F[Ct].labels,delete F[Ct].channels,delete F[Ct].labels,Object.defineProperty(F[Ct],"channels",{value:E$}),Object.defineProperty(F[Ct],"labels",{value:g$})}var E$,g$,Ct;F.rgb.hsl=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.min(e,r,n),a=Math.max(e,r,n),o=a-s,i,u,l;return a===s?i=0:e===a?i=(r-n)/o:r===a?i=2+(n-e)/o:n===a&&(i=4+(e-r)/o),i=Math.min(i*60,360),i<0&&(i+=360),l=(s+a)/2,a===s?u=0:l<=.5?u=o/(a+s):u=o/(2-a-s),[i,u*100,l*100]};F.rgb.hsv=function(t){var e,r,n,s,a,o=t[0]/255,i=t[1]/255,u=t[2]/255,l=Math.max(o,i,u),c=l-Math.min(o,i,u),f=function(h){return(l-h)/6/c+1/2};return c===0?s=a=0:(a=c/l,e=f(o),r=f(i),n=f(u),o===l?s=n-r:i===l?s=1/3+e-n:u===l&&(s=2/3+r-e),s<0?s+=1:s>1&&(s-=1)),[s*360,a*100,l*100]};F.rgb.hwb=function(t){var e=t[0],r=t[1],n=t[2],s=F.rgb.hsl(t)[0],a=1/255*Math.min(e,Math.min(r,n));return n=1-1/255*Math.max(e,Math.max(r,n)),[s,a*100,n*100]};F.rgb.cmyk=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s,a,o,i;return i=Math.min(1-e,1-r,1-n),s=(1-e-i)/(1-i)||0,a=(1-r-i)/(1-i)||0,o=(1-n-i)/(1-i)||0,[s*100,a*100,o*100,i*100]};function hoe(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2)}F.rgb.keyword=function(t){var e=y$[t];if(e)return e;var r=1/0,n;for(var s in vo)if(vo.hasOwnProperty(s)){var a=vo[s],o=hoe(t,a);o<r&&(r=o,n=s)}return n};F.keyword.rgb=function(t){return vo[t]};F.rgb.xyz=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var s=e*.4124+r*.3576+n*.1805,a=e*.2126+r*.7152+n*.0722,o=e*.0193+r*.1192+n*.9505;return[s*100,a*100,o*100]};F.rgb.lab=function(t){var e=F.rgb.xyz(t),r=e[0],n=e[1],s=e[2],a,o,i;return r/=95.047,n/=100,s/=108.883,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,a=116*n-16,o=500*(r-n),i=200*(n-s),[a,o,i]};F.hsl.rgb=function(t){var e=t[0]/360,r=t[1]/100,n=t[2]/100,s,a,o,i,u;if(r===0)return u=n*255,[u,u,u];n<.5?a=n*(1+r):a=n+r-n*r,s=2*n-a,i=[0,0,0];for(var l=0;l<3;l++)o=e+1/3*-(l-1),o<0&&o++,o>1&&o--,6*o<1?u=s+(a-s)*6*o:2*o<1?u=a:3*o<2?u=s+(a-s)*(2/3-o)*6:u=s,i[l]=u*255;return i};F.hsl.hsv=function(t){var e=t[0],r=t[1]/100,n=t[2]/100,s=r,a=Math.max(n,.01),o,i;return n*=2,r*=n<=1?n:2-n,s*=a<=1?a:2-a,i=(n+r)/2,o=n===0?2*s/(a+s):2*r/(n+r),[e,o*100,i*100]};F.hsv.rgb=function(t){var e=t[0]/60,r=t[1]/100,n=t[2]/100,s=Math.floor(e)%6,a=e-Math.floor(e),o=255*n*(1-r),i=255*n*(1-r*a),u=255*n*(1-r*(1-a));switch(n*=255,s){case 0:return[n,u,o];case 1:return[i,n,o];case 2:return[o,n,u];case 3:return[o,i,n];case 4:return[u,o,n];case 5:return[n,o,i]}};F.hsv.hsl=function(t){var e=t[0],r=t[1]/100,n=t[2]/100,s=Math.max(n,.01),a,o,i;return i=(2-r)*n,a=(2-r)*s,o=r*s,o/=a<=1?a:2-a,o=o||0,i/=2,[e,o*100,i*100]};F.hwb.rgb=function(t){var e=t[0]/360,r=t[1]/100,n=t[2]/100,s=r+n,a,o,i,u;s>1&&(r/=s,n/=s),a=Math.floor(6*e),o=1-n,i=6*e-a,(a&1)!==0&&(i=1-i),u=r+i*(o-r);var l,c,f;switch(a){default:case 6:case 0:l=o,c=u,f=r;break;case 1:l=u,c=o,f=r;break;case 2:l=r,c=o,f=u;break;case 3:l=r,c=u,f=o;break;case 4:l=u,c=r,f=o;break;case 5:l=o,c=r,f=u;break}return[l*255,c*255,f*255]};F.cmyk.rgb=function(t){var e=t[0]/100,r=t[1]/100,n=t[2]/100,s=t[3]/100,a,o,i;return a=1-Math.min(1,e*(1-s)+s),o=1-Math.min(1,r*(1-s)+s),i=1-Math.min(1,n*(1-s)+s),[a*255,o*255,i*255]};F.xyz.rgb=function(t){var e=t[0]/100,r=t[1]/100,n=t[2]/100,s,a,o;return s=e*3.2406+r*-1.5372+n*-.4986,a=e*-.9689+r*1.8758+n*.0415,o=e*.0557+r*-.204+n*1.057,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*12.92,s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),[s*255,a*255,o*255]};F.xyz.lab=function(t){var e=t[0],r=t[1],n=t[2],s,a,o;return e/=95.047,r/=100,n/=108.883,e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,s=116*r-16,a=500*(e-r),o=200*(r-n),[s,a,o]};F.lab.xyz=function(t){var e=t[0],r=t[1],n=t[2],s,a,o;a=(e+16)/116,s=r/500+a,o=a-n/200;var i=Math.pow(a,3),u=Math.pow(s,3),l=Math.pow(o,3);return a=i>.008856?i:(a-16/116)/7.787,s=u>.008856?u:(s-16/116)/7.787,o=l>.008856?l:(o-16/116)/7.787,s*=95.047,a*=100,o*=108.883,[s,a,o]};F.lab.lch=function(t){var e=t[0],r=t[1],n=t[2],s,a,o;return s=Math.atan2(n,r),a=s*360/2/Math.PI,a<0&&(a+=360),o=Math.sqrt(r*r+n*n),[e,o,a]};F.lch.lab=function(t){var e=t[0],r=t[1],n=t[2],s,a,o;return o=n/360*2*Math.PI,s=r*Math.cos(o),a=r*Math.sin(o),[e,s,a]};F.rgb.ansi16=function(t){var e=t[0],r=t[1],n=t[2],s=1 in arguments?arguments[1]:F.rgb.hsv(t)[2];if(s=Math.round(s/50),s===0)return 30;var a=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(e/255));return s===2&&(a+=60),a};F.hsv.ansi16=function(t){return F.rgb.ansi16(F.hsv.rgb(t),t[2])};F.rgb.ansi256=function(t){var e=t[0],r=t[1],n=t[2];if(e===r&&r===n)return e<8?16:e>248?231:Math.round((e-8)/247*24)+232;var s=16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5);return s};F.ansi16.rgb=function(t){var e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];var r=(~~(t>50)+1)*.5,n=(e&1)*r*255,s=(e>>1&1)*r*255,a=(e>>2&1)*r*255;return[n,s,a]};F.ansi256.rgb=function(t){if(t>=232){var e=(t-232)*10+8;return[e,e,e]}t-=16;var r,n=Math.floor(t/36)/5*255,s=Math.floor((r=t%36)/6)/5*255,a=r%6/5*255;return[n,s,a]};F.rgb.hex=function(t){var e=((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255),r=e.toString(16).toUpperCase();return"000000".substring(r.length)+r};F.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var r=e[0];e[0].length===3&&(r=r.split("").map(function(i){return i+i}).join(""));var n=parseInt(r,16),s=n>>16&255,a=n>>8&255,o=n&255;return[s,a,o]};F.rgb.hcg=function(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(Math.max(e,r),n),a=Math.min(Math.min(e,r),n),o=s-a,i,u;return o<1?i=a/(1-o):i=0,o<=0?u=0:s===e?u=(r-n)/o%6:s===r?u=2+(n-e)/o:u=4+(e-r)/o+4,u/=6,u%=1,[u*360,o*100,i*100]};F.hsl.hcg=function(t){var e=t[1]/100,r=t[2]/100,n=1,s=0;return r<.5?n=2*e*r:n=2*e*(1-r),n<1&&(s=(r-.5*n)/(1-n)),[t[0],n*100,s*100]};F.hsv.hcg=function(t){var e=t[1]/100,r=t[2]/100,n=e*r,s=0;return n<1&&(s=(r-n)/(1-n)),[t[0],n*100,s*100]};F.hcg.rgb=function(t){var e=t[0]/360,r=t[1]/100,n=t[2]/100;if(r===0)return[n*255,n*255,n*255];var s=[0,0,0],a=e%1*6,o=a%1,i=1-o,u=0;switch(Math.floor(a)){case 0:s[0]=1,s[1]=o,s[2]=0;break;case 1:s[0]=i,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=o;break;case 3:s[0]=0,s[1]=i,s[2]=1;break;case 4:s[0]=o,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=i}return u=(1-r)*n,[(r*s[0]+u)*255,(r*s[1]+u)*255,(r*s[2]+u)*255]};F.hcg.hsv=function(t){var e=t[1]/100,r=t[2]/100,n=e+r*(1-e),s=0;return n>0&&(s=e/n),[t[0],s*100,n*100]};F.hcg.hsl=function(t){var e=t[1]/100,r=t[2]/100,n=r*(1-e)+.5*e,s=0;return n>0&&n<.5?s=e/(2*n):n>=.5&&n<1&&(s=e/(2*(1-n))),[t[0],s*100,n*100]};F.hcg.hwb=function(t){var e=t[1]/100,r=t[2]/100,n=e+r*(1-e);return[t[0],(n-e)*100,(1-n)*100]};F.hwb.hcg=function(t){var e=t[1]/100,r=t[2]/100,n=1-r,s=n-e,a=0;return s<1&&(a=(n-s)/(1-s)),[t[0],s*100,a*100]};F.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};F.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};F.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};F.gray.hsl=F.gray.hsv=function(t){return[0,0,t[0]]};F.gray.hwb=function(t){return[0,100,t[0]]};F.gray.cmyk=function(t){return[0,0,0,t[0]]};F.gray.lab=function(t){return[t[0],0,0]};F.gray.hex=function(t){var e=Math.round(t[0]/100*255)&255,r=(e<<16)+(e<<8)+e,n=r.toString(16).toUpperCase();return"000000".substring(n.length)+n};F.rgb.gray=function(t){var e=(t[0]+t[1]+t[2])/3;return[e/255*100]}});var O$=p((hNe,w$)=>{var Oh=Iw();function _oe(){for(var t={},e=Object.keys(Oh),r=e.length,n=0;n<r;n++)t[e[n]]={distance:-1,parent:null};return t}function moe(t){var e=_oe(),r=[t];for(e[t].distance=0;r.length;)for(var n=r.pop(),s=Object.keys(Oh[n]),a=s.length,o=0;o<a;o++){var i=s[o],u=e[i];u.distance===-1&&(u.distance=e[n].distance+1,u.parent=n,r.unshift(i))}return e}function Soe(t,e){return function(r){return e(t(r))}}function Eoe(t,e){for(var r=[e[t].parent,t],n=Oh[e[t].parent][t],s=e[t].parent;e[s].parent;)r.unshift(e[s].parent),n=Soe(Oh[e[s].parent][s],n),s=e[s].parent;return n.conversion=r,n}w$.exports=function(t){for(var e=moe(t),r={},n=Object.keys(e),s=n.length,a=0;a<s;a++){var o=n[a],i=e[o];i.parent!==null&&(r[o]=Eoe(o,e))}return r}});var b$=p((_Ne,v$)=>{var Mw=Iw(),goe=O$(),Vs={},yoe=Object.keys(Mw);function Toe(t){var e=function(r){return r==null?r:(arguments.length>1&&(r=Array.prototype.slice.call(arguments)),t(r))};return"conversion"in t&&(e.conversion=t.conversion),e}function woe(t){var e=function(r){if(r==null)return r;arguments.length>1&&(r=Array.prototype.slice.call(arguments));var n=t(r);if(typeof n=="object")for(var s=n.length,a=0;a<s;a++)n[a]=Math.round(n[a]);return n};return"conversion"in t&&(e.conversion=t.conversion),e}yoe.forEach(function(t){Vs[t]={},Object.defineProperty(Vs[t],"channels",{value:Mw[t].channels}),Object.defineProperty(Vs[t],"labels",{value:Mw[t].labels});var e=goe(t),r=Object.keys(e);r.forEach(function(n){var s=e[n];Vs[t][n]=woe(s),Vs[t][n].raw=Toe(s)})});v$.exports=Vs});var N$=p((mNe,R$)=>{"use strict";var ll=_$(),ar=b$(),Dw=[].slice,A$=["keyword","gray","hex"],Lw={};Object.keys(ar).forEach(function(t){Lw[Dw.call(ar[t].labels).sort().join("")]=t});var vh={};function St(t,e){if(!(this instanceof St))return new St(t,e);if(e&&e in A$&&(e=null),e&&!(e in ar))throw new Error("Unknown model: "+e);var r,n;if(t==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof St)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if(typeof t=="string"){var s=ll.get(t);if(s===null)throw new Error("Unable to parse color from string: "+t);this.model=s.model,n=ar[this.model].channels,this.color=s.value.slice(0,n),this.valpha=typeof s.value[n]=="number"?s.value[n]:1}else if(t.length){this.model=e||"rgb",n=ar[this.model].channels;var a=Dw.call(t,0,n);this.color=Cw(a,n),this.valpha=typeof t[n]=="number"?t[n]:1}else if(typeof t=="number")t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{this.valpha=1;var o=Object.keys(t);"alpha"in t&&(o.splice(o.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0);var i=o.sort().join("");if(!(i in Lw))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=Lw[i];var u=ar[this.model].labels,l=[];for(r=0;r<u.length;r++)l.push(t[u[r]]);this.color=Cw(l)}if(vh[this.model])for(n=ar[this.model].channels,r=0;r<n;r++){var c=vh[this.model][r];c&&(this.color[r]=c(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}St.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in ll.to?this:this.rgb();e=e.round(typeof t=="number"?t:1);var r=e.valpha===1?e.color:e.color.concat(this.valpha);return ll.to[e.model](r)},percentString:function(t){var e=this.rgb().round(typeof t=="number"?t:1),r=e.valpha===1?e.color:e.color.concat(this.valpha);return ll.to.rgb.percent(r)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=ar[this.model].channels,r=ar[this.model].labels,n=0;n<e;n++)t[r[n]]=this.color[n];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new St(this.color.map(voe(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new St(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:We("rgb",0,rt(255)),green:We("rgb",1,rt(255)),blue:We("rgb",2,rt(255)),hue:We(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:We("hsl",1,rt(100)),lightness:We("hsl",2,rt(100)),saturationv:We("hsv",1,rt(100)),value:We("hsv",2,rt(100)),chroma:We("hcg",1,rt(100)),gray:We("hcg",2,rt(100)),white:We("hwb",1,rt(100)),wblack:We("hwb",2,rt(100)),cyan:We("cmyk",0,rt(100)),magenta:We("cmyk",1,rt(100)),yellow:We("cmyk",2,rt(100)),black:We("cmyk",3,rt(100)),x:We("xyz",0,rt(100)),y:We("xyz",1,rt(100)),z:We("xyz",2,rt(100)),l:We("lab",0,rt(100)),a:We("lab",1),b:We("lab",2),keyword:function(t){return arguments.length?new St(t):ar[this.model].keyword(this.color)},hex:function(t){return arguments.length?new St(t):ll.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity:function(){for(var t=this.rgb().color,e=[],r=0;r<t.length;r++){var n=t[r]/255;e[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),r=t.luminosity();return e>r?(e+.05)/(r+.05):(r+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},isDark:function(){var t=this.rgb().color,e=(t[0]*299+t[1]*587+t[2]*114)/1e3;return e<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=this.rgb().color,e=t[0]*.3+t[1]*.59+t[2]*.11;return St.rgb(e,e,e)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),r=e.color[0];return r=(r+t)%360,r=r<0?360+r:r,e.color[0]=r,e},mix:function(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var r=t.rgb(),n=this.rgb(),s=e===void 0?.5:e,a=2*s-1,o=r.alpha()-n.alpha(),i=((a*o===-1?a:(a+o)/(1+a*o))+1)/2,u=1-i;return St.rgb(i*r.red()+u*n.red(),i*r.green()+u*n.green(),i*r.blue()+u*n.blue(),r.alpha()*s+n.alpha()*(1-s))}};Object.keys(ar).forEach(function(t){if(A$.indexOf(t)===-1){var e=ar[t].channels;St.prototype[t]=function(){if(this.model===t)return new St(this);if(arguments.length)return new St(arguments,t);var r=typeof arguments[e]=="number"?e:this.valpha;return new St(boe(ar[this.model][t].raw(this.color)).concat(r),t)},St[t]=function(r){return typeof r=="number"&&(r=Cw(Dw.call(arguments),e)),new St(r,t)}}});function Ooe(t,e){return Number(t.toFixed(e))}function voe(t){return function(e){return Ooe(e,t)}}function We(t,e,r){return t=Array.isArray(t)?t:[t],t.forEach(function(n){(vh[n]||(vh[n]=[]))[e]=r}),t=t[0],function(n){var s;return arguments.length?(r&&(n=r(n)),s=this[t](),s.color[e]=n,s):(s=this[t]().color[e],r&&(s=r(s)),s)}}function rt(t){return function(e){return Math.max(0,Math.min(t,e))}}function boe(t){return Array.isArray(t)?t:[t]}function Cw(t,e){for(var r=0;r<e;r++)typeof t[r]!="number"&&(t[r]=0);return t}R$.exports=St});var I$=p((SNe,P$)=>{"use strict";P$.exports=function(e){for(var r=0,n=0;r<e.length;n=e.charCodeAt(r++)+((n<<5)-n));var s=Math.floor(Math.abs(Math.sin(n)*1e4%1*16777216)).toString(16);return"#"+Array(6-s.length+1).join("0")+s}});var D$=p((ENe,C$)=>{"use strict";var M$=N$(),L$=I$();C$.exports=function(e,r){var n=e.split(r||":"),s=L$(n[0]);if(!n.length)return s;for(var a=0,o=n.length-1;a<o;a++)s=M$(s).mix(M$(L$(n[a+1]))).saturate(1).hex();return s}});var U$=p((gNe,x$)=>{"use strict";function Ur(t,e){if(e)return new Ur(t).style(e);if(!(this instanceof Ur))return new Ur(t);this.text=t}Ur.prototype.prefix="\x1B[";Ur.prototype.suffix="m";Ur.prototype.hex=function(e){e=e[0]==="#"?e.substring(1):e,e.length===3&&(e=e.split(""),e[5]=e[2],e[4]=e[2],e[3]=e[1],e[2]=e[1],e[1]=e[0],e=e.join(""));var r=e.substring(0,2),n=e.substring(2,4),s=e.substring(4,6);return[parseInt(r,16),parseInt(n,16),parseInt(s,16)]};Ur.prototype.rgb=function(e,r,n){var s=e/255*5,a=r/255*5,o=n/255*5;return this.ansi(s,a,o)};Ur.prototype.ansi=function(e,r,n){var s=Math.round(e),a=Math.round(r),o=Math.round(n);return 16+s*36+a*6+o};Ur.prototype.reset=function(){return this.prefix+"39;49"+this.suffix};Ur.prototype.style=function(e){return this.prefix+"38;5;"+this.rgb.apply(this,this.hex(e))+this.suffix+this.text+this.reset()};x$.exports=Ur});var B$=p((yNe,k$)=>{var Aoe=D$(),Roe=U$();k$.exports=function(e,r){var n=r.namespace,s=r.colors!==!1?Roe(n+":",Aoe(n)):n+":";return e[0]=s+" "+e[0],e}});var V$=p((TNe,q$)=>{"use strict";q$.exports=function(e,r){if(!r)return!1;for(var n=r.split(/[\s,]+/),s=0;s<n.length;s++){if(r=n[s].replace("*",".*?"),r.charAt(0)==="-"){if(new RegExp("^"+r.substr(1)+"$").test(e))return!1;continue}if(new RegExp("^"+r+"$").test(e))return!0}return!1}});var $$=p((wNe,F$)=>{var Noe=V$();F$.exports=function(e){return function(n){try{return Noe(n,e())}catch{}return!1}}});var W$=p((ONe,G$)=>{var Poe=$$();G$.exports=Poe(function(){return process.env.DEBUG||process.env.DIAGNOSTICS})});var H$=p((vNe,j$)=>{j$.exports=function(t,e){try{Function.prototype.apply.call(console.log,console,e)}catch{}}});var z$=p((bNe,Y$)=>{var Ioe=Pw(),Moe=require("tty").isatty(1),bh=Ioe(function t(e,r){return r=r||{},r.colors="colors"in r?r.colors:Moe,r.namespace=e,r.prod=!1,r.dev=!0,!t.enabled(e)&&!(r.force||t.force)?t.nope(r):t.yep(r)});bh.modify(B$());bh.use(W$());bh.set(H$());Y$.exports=bh});var cl=p((ANe,xw)=>{process.env.NODE_ENV==="production"?xw.exports=i$():xw.exports=z$()});var Q$=p((RNe,K$)=>{"use strict";var Uw=require("fs"),{StringDecoder:Loe}=require("string_decoder"),{Stream:Coe}=Oo();function Doe(){}K$.exports=(t,e)=>{let r=Buffer.alloc(65536),n=new Loe("utf8"),s=new Coe,a="",o=0,i=0;return t.start===-1&&delete t.start,s.readable=!0,s.destroy=()=>{s.destroyed=!0,s.emit("end"),s.emit("close")},Uw.open(t.file,"a+","0644",(u,l)=>{if(u){e?e(u):s.emit("error",u),s.destroy();return}(function c(){if(s.destroyed){Uw.close(l,Doe);return}return Uw.read(l,r,0,r.length,o,(f,h)=>{if(f){e?e(f):s.emit("error",f),s.destroy();return}if(!h)return a&&((t.start==null||i>t.start)&&(e?e(null,a):s.emit("line",a)),i++,a=""),setTimeout(c,1e3);let S=n.write(r.slice(0,h));e||s.emit("data",S),S=(a+S).split(/\n+/);let g=S.length-1,E=0;for(;E<g;E++)(t.start==null||i>t.start)&&(e?e(null,S[E]):s.emit("line",S[E])),i++;return a=S[g],o+=h,c()})})()}),e?s.destroy:s}});var eG=p((PNe,Z$)=>{"use strict";var $t=require("fs"),at=require("path"),J$=WF(),xoe=require("zlib"),{MESSAGE:Uoe}=Ge(),{Stream:koe,PassThrough:X$}=Oo(),Boe=Us(),kr=cl()("winston:file"),qoe=require("os"),Voe=Q$();Z$.exports=class extends Boe{constructor(e={}){super(e),this.name=e.name||"file";function r(n,...s){s.slice(1).forEach(a=>{if(e[a])throw new Error(`Cannot set ${a} and ${n} together`)})}if(this._stream=new X$,this._stream.setMaxListeners(30),this._onError=this._onError.bind(this),e.filename||e.dirname)r("filename or dirname","stream"),this._basename=this.filename=e.filename?at.basename(e.filename):"winston.log",this.dirname=e.dirname||at.dirname(e.filename),this.options=e.options||{flags:"a"};else if(e.stream)console.warn("options.stream will be removed in winston@4. Use winston.transports.Stream"),r("stream","filename","maxsize"),this._dest=this._stream.pipe(this._setupStream(e.stream)),this.dirname=at.dirname(this._dest.path);else throw new Error("Cannot log to file without filename or stream.");this.maxsize=e.maxsize||null,this.rotationFormat=e.rotationFormat||!1,this.zippedArchive=e.zippedArchive||!1,this.maxFiles=e.maxFiles||null,this.eol=typeof e.eol=="string"?e.eol:qoe.EOL,this.tailable=e.tailable||!1,this.lazy=e.lazy||!1,this._size=0,this._pendingSize=0,this._created=0,this._drain=!1,this._opening=!1,this._ending=!1,this._fileExist=!1,this.dirname&&this._createLogDirIfNotExist(this.dirname),this.lazy||this.open()}finishIfEnding(){this._ending&&(this._opening?this.once("open",()=>{this._stream.once("finish",()=>this.emit("finish")),setImmediate(()=>this._stream.end())}):(this._stream.once("finish",()=>this.emit("finish")),setImmediate(()=>this._stream.end())))}log(e,r=()=>{}){if(this.silent)return r(),!0;if(this._drain){this._stream.once("drain",()=>{this._drain=!1,this.log(e,r)});return}if(this._rotate){this._stream.once("rotate",()=>{this._rotate=!1,this.log(e,r)});return}if(this.lazy){if(!this._fileExist){this._opening||this.open(),this.once("open",()=>{this._fileExist=!0,this.log(e,r)});return}if(this._needsNewFile(this._pendingSize)){this._dest.once("close",()=>{this._opening||this.open(),this.once("open",()=>{this.log(e,r)})});return}}let n=`${e[Uoe]}${this.eol}`,s=Buffer.byteLength(n);function a(){if(this._size+=s,this._pendingSize-=s,kr("logged %s %s",this._size,n),this.emit("logged",e),!this._rotate&&!this._opening&&this._needsNewFile()){if(this.lazy){this._endStream(()=>{this.emit("fileclosed")});return}this._rotate=!0,this._endStream(()=>this._rotateFile())}}this._pendingSize+=s,this._opening&&!this.rotatedWhileOpening&&this._needsNewFile(this._size+this._pendingSize)&&(this.rotatedWhileOpening=!0);let o=this._stream.write(n,a.bind(this));return o?r():(this._drain=!0,this._stream.once("drain",()=>{this._drain=!1,r()})),kr("written",o,this._drain),this.finishIfEnding(),o}query(e,r){typeof e=="function"&&(r=e,e={}),e=f(e);let n=at.join(this.dirname,this.filename),s="",a=[],o=0,i=$t.createReadStream(n,{encoding:"utf8"});i.on("error",h=>{if(i.readable&&i.destroy(),!!r)return h.code!=="ENOENT"?r(h):r(null,a)}),i.on("data",h=>{h=(s+h).split(/\n+/);let S=h.length-1,g=0;for(;g<S;g++)(!e.start||o>=e.start)&&u(h[g]),o++;s=h[S]}),i.on("close",()=>{s&&u(s,!0),e.order==="desc"&&(a=a.reverse()),r&&r(null,a)});function u(h,S){try{let g=JSON.parse(h);c(g)&&l(g)}catch(g){S||i.emit("error",g)}}function l(h){if(e.rows&&a.length>=e.rows&&e.order!=="desc"){i.readable&&i.destroy();return}e.fields&&(h=e.fields.reduce((S,g)=>(S[g]=h[g],S),{})),e.order==="desc"&&a.length>=e.rows&&a.shift(),a.push(h)}function c(h){if(!h||typeof h!="object")return;let S=new Date(h.timestamp);if(!(e.from&&S<e.from||e.until&&S>e.until||e.level&&e.level!==h.level))return!0}function f(h){return h=h||{},h.rows=h.rows||h.limit||10,h.start=h.start||0,h.until=h.until||new Date,typeof h.until!="object"&&(h.until=new Date(h.until)),h.from=h.from||h.until-1440*60*1e3,typeof h.from!="object"&&(h.from=new Date(h.from)),h.order=h.order||"desc",h}}stream(e={}){let r=at.join(this.dirname,this.filename),n=new koe,s={file:r,start:e.start};return n.destroy=Voe(s,(a,o)=>{if(a)return n.emit("error",a);try{n.emit("data",o),o=JSON.parse(o),n.emit("log",o)}catch(i){n.emit("error",i)}}),n}open(){this.filename&&(this._opening||(this._opening=!0,this.stat((e,r)=>{if(e)return this.emit("error",e);kr("stat done: %s { size: %s }",this.filename,r),this._size=r,this._dest=this._createStream(this._stream),this._opening=!1,this.once("open",()=>{this._stream.emit("rotate")||(this._rotate=!1)})})))}stat(e){let r=this._getFile(),n=at.join(this.dirname,r);$t.stat(n,(s,a)=>{if(s&&s.code==="ENOENT")return kr("ENOENT\xA0ok",n),this.filename=r,e(null,0);if(s)return kr(`err ${s.code} ${n}`),e(s);if(!a||this._needsNewFile(a.size))return this._incFile(()=>this.stat(e));this.filename=r,e(null,a.size)})}close(e){this._stream&&this._stream.end(()=>{e&&e(),this.emit("flush"),this.emit("closed")})}_needsNewFile(e){return e=e||this._size,this.maxsize&&e>=this.maxsize}_onError(e){this.emit("error",e)}_setupStream(e){return e.on("error",this._onError),e}_cleanupStream(e){return e.removeListener("error",this._onError),e.destroy(),e}_rotateFile(){this._incFile(()=>this.open())}_endStream(e=()=>{}){this._dest?(this._stream.unpipe(this._dest),this._dest.end(()=>{this._cleanupStream(this._dest),e()})):e()}_createStream(e){let r=at.join(this.dirname,this.filename);kr("create stream start",r,this.options);let n=$t.createWriteStream(r,this.options).on("error",s=>kr(s)).on("close",()=>kr("close",n.path,n.bytesWritten)).on("open",()=>{kr("file open ok",r),this.emit("open",r),e.pipe(n),this.rotatedWhileOpening&&(this._stream=new X$,this._stream.setMaxListeners(30),this._rotateFile(),this.rotatedWhileOpening=!1,this._cleanupStream(n),e.end())});return kr("create stream ok",r),n}_incFile(e){kr("_incFile",this.filename);let r=at.extname(this._basename),n=at.basename(this._basename,r),s=[];this.zippedArchive&&s.push(function(a){let o=this._created>0&&!this.tailable?this._created:"";this._compressFile(at.join(this.dirname,`${n}${o}${r}`),at.join(this.dirname,`${n}${o}${r}.gz`),a)}.bind(this)),s.push(function(a){this.tailable?this._checkMaxFilesTailable(r,n,a):(this._created+=1,this._checkMaxFilesIncrementing(r,n,a))}.bind(this)),J$(s,e)}_getFile(){let e=at.extname(this._basename),r=at.basename(this._basename,e),n=this.rotationFormat?this.rotationFormat():this._created;return!this.tailable&&this._created?`${r}${n}${e}`:`${r}${e}`}_checkMaxFilesIncrementing(e,r,n){if(!this.maxFiles||this._created<this.maxFiles)return setImmediate(n);let s=this._created-this.maxFiles,a=s!==0?s:"",o=this.zippedArchive?".gz":"",i=`${r}${a}${e}${o}`,u=at.join(this.dirname,i);$t.unlink(u,n)}_checkMaxFilesTailable(e,r,n){let s=[];if(!this.maxFiles)return;let a=this.zippedArchive?".gz":"";for(let o=this.maxFiles-1;o>1;o--)s.push(function(i,u){let l=`${r}${i-1}${e}${a}`,c=at.join(this.dirname,l);$t.exists(c,f=>{if(!f)return u(null);l=`${r}${i}${e}${a}`,$t.rename(c,at.join(this.dirname,l),u)})}.bind(this,o));J$(s,()=>{$t.rename(at.join(this.dirname,`${r}${e}${a}`),at.join(this.dirname,`${r}1${e}${a}`),n)})}_compressFile(e,r,n){$t.access(e,$t.F_OK,s=>{if(s)return n();var a=xoe.createGzip(),o=$t.createReadStream(e),i=$t.createWriteStream(r);i.on("finish",()=>{$t.unlink(e,n)}),o.pipe(a).pipe(i)})}_createLogDirIfNotExist(e){$t.existsSync(e)||$t.mkdirSync(e,{recursive:!0})}}});var rG=p((MNe,tG)=>{"use strict";var Foe=require("http"),$oe=require("https"),{Stream:Goe}=Oo(),Woe=Us(),{configure:joe}=Ju();tG.exports=class extends Woe{constructor(e={}){super(e),this.options=e,this.name=e.name||"http",this.ssl=!!e.ssl,this.host=e.host||"localhost",this.port=e.port,this.auth=e.auth,this.path=e.path||"",this.maximumDepth=e.maximumDepth,this.agent=e.agent,this.headers=e.headers||{},this.headers["content-type"]="application/json",this.batch=e.batch||!1,this.batchInterval=e.batchInterval||5e3,this.batchCount=e.batchCount||10,this.batchOptions=[],this.batchTimeoutID=-1,this.batchCallback={},this.port||(this.port=this.ssl?443:80)}log(e,r){this._request(e,null,null,(n,s)=>{s&&s.statusCode!==200&&(n=new Error(`Invalid HTTP Status Code: ${s.statusCode}`)),n?this.emit("warn",n):this.emit("logged",e)}),r&&setImmediate(r)}query(e,r){typeof e=="function"&&(r=e,e={}),e={method:"query",params:this.normalizeQuery(e)};let n=e.params.auth||null;delete e.params.auth;let s=e.params.path||null;delete e.params.path,this._request(e,n,s,(a,o,i)=>{if(o&&o.statusCode!==200&&(a=new Error(`Invalid HTTP Status Code: ${o.statusCode}`)),a)return r(a);if(typeof i=="string")try{i=JSON.parse(i)}catch(u){return r(u)}r(null,i)})}stream(e={}){let r=new Goe;e={method:"stream",params:e};let n=e.params.path||null;delete e.params.path;let s=e.params.auth||null;delete e.params.auth;let a="",o=this._request(e,s,n);return r.destroy=()=>o.destroy(),o.on("data",i=>{i=(a+i).split(/\n+/);let u=i.length-1,l=0;for(;l<u;l++)try{r.emit("log",JSON.parse(i[l]))}catch(c){r.emit("error",c)}a=i[u]}),o.on("error",i=>r.emit("error",i)),r}_request(e,r,n,s){e=e||{},r=r||this.auth,n=n||this.path||"",this.batch?this._doBatch(e,s,r,n):this._doRequest(e,s,r,n)}_doBatch(e,r,n,s){if(this.batchOptions.push(e),this.batchOptions.length===1){let a=this;this.batchCallback=r,this.batchTimeoutID=setTimeout(function(){a.batchTimeoutID=-1,a._doBatchRequest(a.batchCallback,n,s)},this.batchInterval)}this.batchOptions.length===this.batchCount&&this._doBatchRequest(this.batchCallback,n,s)}_doBatchRequest(e,r,n){this.batchTimeoutID>0&&(clearTimeout(this.batchTimeoutID),this.batchTimeoutID=-1);let s=this.batchOptions.slice();this.batchOptions=[],this._doRequest(s,e,r,n)}_doRequest(e,r,n,s){let a=Object.assign({},this.headers);n&&n.bearer&&(a.Authorization=`Bearer ${n.bearer}`);let o=(this.ssl?$oe:Foe).request({...this.options,method:"POST",host:this.host,port:this.port,path:`/${s.replace(/^\//,"")}`,headers:a,auth:n&&n.username&&n.password?`${n.username}:${n.password}`:"",agent:this.agent});o.on("error",r),o.on("response",u=>u.on("end",()=>r(null,u)).resume());let i=joe({...this.maximumDepth&&{maximumDepth:this.maximumDepth}});o.end(Buffer.from(i(e,this.options.replacer),"utf8"))}}});var kw=p((LNe,nG)=>{"use strict";var sn=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";sn.writable=t=>sn(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object";sn.readable=t=>sn(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object";sn.duplex=t=>sn.writable(t)&&sn.readable(t);sn.transform=t=>sn.duplex(t)&&typeof t._transform=="function";nG.exports=sn});var oG=p((DNe,iG)=>{"use strict";var Hoe=kw(),{MESSAGE:Yoe}=Ge(),zoe=require("os"),Koe=Us();iG.exports=class extends Koe{constructor(e={}){if(super(e),!e.stream||!Hoe(e.stream))throw new Error("options.stream is required.");this._stream=e.stream,this._stream.setMaxListeners(1/0),this.isObjectMode=e.stream._writableState.objectMode,this.eol=typeof e.eol=="string"?e.eol:zoe.EOL}log(e,r){if(setImmediate(()=>this.emit("logged",e)),this.isObjectMode){this._stream.write(e),r&&r();return}this._stream.write(`${e[Yoe]}${this.eol}`),r&&r()}}});var sG=p(fl=>{"use strict";Object.defineProperty(fl,"Console",{configurable:!0,enumerable:!0,get(){return uF()}});Object.defineProperty(fl,"File",{configurable:!0,enumerable:!0,get(){return eG()}});Object.defineProperty(fl,"Http",{configurable:!0,enumerable:!0,get(){return rG()}});Object.defineProperty(fl,"Stream",{configurable:!0,enumerable:!0,get(){return oG()}})});var Rh=p(dl=>{"use strict";var Ah=cw(),{configs:Bw}=Ge();dl.cli=Ah.levels(Bw.cli);dl.npm=Ah.levels(Bw.npm);dl.syslog=Ah.levels(Bw.syslog);dl.addColors=Ah.levels});var uG=p((Nh,aG)=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});var Qoe=rh(),Joe=bo(Qoe),Xoe=dh(),Zoe=bo(Xoe),ese=yw(),tse=bo(ese),rse=Sw(),nse=bo(rse),ise=Ew(),ose=bo(ise),sse=wo(),ase=bo(sse),use=Bs(),lse=bo(use);function bo(t){return t&&t.__esModule?t:{default:t}}function cse(t,e,r){r=(0,nse.default)(r);var n=0,s=0,{length:a}=t,o=!1;a===0&&r(null);function i(u,l){u===!1&&(o=!0),o!==!0&&(u?r(u):(++s===a||l===Zoe.default)&&r(null))}for(;n<a;n++)e(t[n],n,(0,ose.default)(i))}function fse(t,e,r){return(0,tse.default)(t,1/0,e,r)}function dse(t,e,r){var n=(0,Joe.default)(t)?cse:fse;return n(t,(0,ase.default)(e),r)}Nh.default=(0,lse.default)(dse,3);aG.exports=Nh.default});var cG=p((Ph,lG)=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.default=pse;function pse(t){return(e,r,n)=>t(e,n)}lG.exports=Ph.default});var Lh=p((Mh,fG)=>{"use strict";Object.defineProperty(Mh,"__esModule",{value:!0});var hse=uG(),_se=Ih(hse),mse=cG(),Sse=Ih(mse),Ese=wo(),gse=Ih(Ese),yse=Bs(),Tse=Ih(yse);function Ih(t){return t&&t.__esModule?t:{default:t}}function wse(t,e,r){return(0,_se.default)(t,(0,Sse.default)((0,gse.default)(e)),r)}Mh.default=(0,Tse.default)(wse,3);fG.exports=Mh.default});var pG=p((kNe,dG)=>{"use strict";var Ose=Object.prototype.toString;dG.exports=function(e){if(typeof e.displayName=="string"&&e.constructor.name)return e.displayName;if(typeof e.name=="string"&&e.name)return e.name;if(typeof e=="object"&&e.constructor&&typeof e.constructor.name=="string")return e.constructor.name;var r=e.toString(),n=Ose.call(e).slice(8,-1);return n==="Function"?r=r.substring(r.indexOf("(")+1,r.indexOf(")")):r=n,r||"anonymous"}});var qw=p((BNe,hG)=>{"use strict";var vse=pG();hG.exports=function(e){var r=0,n;function s(){return r||(r=1,n=e.apply(this,arguments),e=null),n}return s.displayName=vse(e),s}});var Vw=p(hl=>{hl.get=function(t){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var r={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(a,o){return o},Error.captureStackTrace(r,t||hl.get);var s=r.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,s};hl.parse=function(t){if(!t.stack)return[];var e=this,r=t.stack.split(`
`).slice(1);return r.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var s=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(s){var a=null,o=null,i=null,u=null,l=null,c=s[5]==="native";if(s[1]){i=s[1];var f=i.lastIndexOf(".");if(i[f-1]=="."&&f--,f>0){a=i.substr(0,f),o=i.substr(f+1);var h=a.indexOf(".Module");h>0&&(i=i.substr(h+1),a=a.substr(0,h))}u=null}o&&(u=a,l=o),o==="<anonymous>"&&(l=null,i=null);var S={fileName:s[2]||null,lineNumber:parseInt(s[3],10)||null,functionName:i,typeName:u,methodName:l,columnNumber:parseInt(s[4],10)||null,native:c};return e._createParsedCallSite(S)}}).filter(function(n){return!!n})};function pl(t){for(var e in t)this[e]=t[e]}var bse=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],Ase=["topLevel","eval","native","constructor"];bse.forEach(function(t){pl.prototype[t]=null,pl.prototype["get"+t[0].toUpperCase()+t.substr(1)]=function(){return this[t]}});Ase.forEach(function(t){pl.prototype[t]=!1,pl.prototype["is"+t[0].toUpperCase()+t.substr(1)]=function(){return this[t]}});hl._createParsedCallSite=function(t){return new pl(t)}});var mG=p((FNe,_G)=>{"use strict";var{Writable:Rse}=Oo();_G.exports=class extends Rse{constructor(e){if(super({objectMode:!0}),!e)throw new Error("ExceptionStream requires a TransportStream instance.");this.handleExceptions=!0,this.transport=e}_write(e,r,n){return e.exception?this.transport.log(e,n):(n(),!0)}}});var $w=p((GNe,gG)=>{"use strict";var SG=require("os"),Nse=Lh(),Fw=cl()("winston:exception"),Pse=qw(),EG=Vw(),Ise=mG();gG.exports=class{constructor(e){if(!e)throw new Error("Logger is required to handle exceptions");this.logger=e,this.handlers=new Map}handle(...e){e.forEach(r=>{if(Array.isArray(r))return r.forEach(n=>this._addHandler(n));this._addHandler(r)}),this.catcher||(this.catcher=this._uncaughtException.bind(this),process.on("uncaughtException",this.catcher))}unhandle(){this.catcher&&(process.removeListener("uncaughtException",this.catcher),this.catcher=!1,Array.from(this.handlers.values()).forEach(e=>this.logger.unpipe(e)))}getAllInfo(e){let r=null;return e&&(r=typeof e=="string"?e:e.message),{error:e,level:"error",message:[`uncaughtException: ${r||"(no error message)"}`,e&&e.stack||"  No stack trace"].join(`
`),stack:e&&e.stack,exception:!0,date:new Date().toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:SG.loadavg(),uptime:SG.uptime()}}getTrace(e){return(e?EG.parse(e):EG.get()).map(n=>({column:n.getColumnNumber(),file:n.getFileName(),function:n.getFunctionName(),line:n.getLineNumber(),method:n.getMethodName(),native:n.isNative()}))}_addHandler(e){if(!this.handlers.has(e)){e.handleExceptions=!0;let r=new Ise(e);this.handlers.set(e,r),this.logger.pipe(r)}}_uncaughtException(e){let r=this.getAllInfo(e),n=this._getExceptionHandlers(),s=typeof this.logger.exitOnError=="function"?this.logger.exitOnError(e):this.logger.exitOnError,a;!n.length&&s&&(console.warn("winston: exitOnError cannot be true with no exception handlers."),console.warn("winston: not exiting process."),s=!1);function o(){Fw("doExit",s),Fw("process._exiting",process._exiting),s&&!process._exiting&&(a&&clearTimeout(a),process.exit(1))}if(!n||n.length===0)return process.nextTick(o);Nse(n,(i,u)=>{let l=Pse(u),c=i.transport||i;function f(h){return()=>{Fw(h),l()}}c._ending=!0,c.once("finish",f("finished")),c.once("error",f("error"))},()=>s&&o()),this.logger.log(r),s&&(a=setTimeout(o,3e3))}_getExceptionHandlers(){return this.logger.transports.filter(e=>(e.transport||e).handleExceptions)}}});var TG=p((jNe,yG)=>{"use strict";var{Writable:Mse}=Oo();yG.exports=class extends Mse{constructor(e){if(super({objectMode:!0}),!e)throw new Error("RejectionStream requires a TransportStream instance.");this.handleRejections=!0,this.transport=e}_write(e,r,n){return e.rejection?this.transport.log(e,n):(n(),!0)}}});var Ww=p((YNe,vG)=>{"use strict";var wG=require("os"),Lse=Lh(),Gw=cl()("winston:rejection"),Cse=qw(),OG=Vw(),Dse=TG();vG.exports=class{constructor(e){if(!e)throw new Error("Logger is required to handle rejections");this.logger=e,this.handlers=new Map}handle(...e){e.forEach(r=>{if(Array.isArray(r))return r.forEach(n=>this._addHandler(n));this._addHandler(r)}),this.catcher||(this.catcher=this._unhandledRejection.bind(this),process.on("unhandledRejection",this.catcher))}unhandle(){this.catcher&&(process.removeListener("unhandledRejection",this.catcher),this.catcher=!1,Array.from(this.handlers.values()).forEach(e=>this.logger.unpipe(e)))}getAllInfo(e){let r=null;return e&&(r=typeof e=="string"?e:e.message),{error:e,level:"error",message:[`unhandledRejection: ${r||"(no error message)"}`,e&&e.stack||"  No stack trace"].join(`
`),stack:e&&e.stack,rejection:!0,date:new Date().toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:wG.loadavg(),uptime:wG.uptime()}}getTrace(e){return(e?OG.parse(e):OG.get()).map(n=>({column:n.getColumnNumber(),file:n.getFileName(),function:n.getFunctionName(),line:n.getLineNumber(),method:n.getMethodName(),native:n.isNative()}))}_addHandler(e){if(!this.handlers.has(e)){e.handleRejections=!0;let r=new Dse(e);this.handlers.set(e,r),this.logger.pipe(r)}}_unhandledRejection(e){let r=this.getAllInfo(e),n=this._getRejectionHandlers(),s=typeof this.logger.exitOnError=="function"?this.logger.exitOnError(e):this.logger.exitOnError,a;!n.length&&s&&(console.warn("winston: exitOnError cannot be true with no rejection handlers."),console.warn("winston: not exiting process."),s=!1);function o(){Gw("doExit",s),Gw("process._exiting",process._exiting),s&&!process._exiting&&(a&&clearTimeout(a),process.exit(1))}if(!n||n.length===0)return process.nextTick(o);Lse(n,(i,u)=>{let l=Cse(u),c=i.transport||i;function f(h){return()=>{Gw(h),l()}}c._ending=!0,c.once("finish",f("finished")),c.once("error",f("error"))},()=>s&&o()),this.logger.log(r),s&&(a=setTimeout(o,3e3))}_getRejectionHandlers(){return this.logger.transports.filter(e=>(e.transport||e).handleRejections)}}});var AG=p((zNe,bG)=>{"use strict";var jw=class{constructor(e){let r=Ch();if(typeof e!="object"||Array.isArray(e)||!(e instanceof r))throw new Error("Logger is required for profiling");this.logger=e,this.start=Date.now()}done(...e){typeof e[e.length-1]=="function"&&(console.warn("Callback function no longer supported as of winston@3.0.0"),e.pop());let r=typeof e[e.length-1]=="object"?e.pop():{};return r.level=r.level||"info",r.durationMs=Date.now()-this.start,this.logger.write(r)}};bG.exports=jw});var Ch=p((KNe,IG)=>{"use strict";var{Stream:xse,Transform:Use}=Oo(),RG=Lh(),{LEVEL:an,SPLAT:NG}=Ge(),PG=kw(),kse=$w(),Bse=Ww(),qse=hw(),Vse=AG(),{warn:Fse}=fw(),$se=Rh(),Gse=/%[scdjifoO%]/g,Dh=class extends Use{constructor(e){super({objectMode:!0}),this.configure(e)}child(e){let r=this;return Object.create(r,{write:{value:function(n){let s=Object.assign({},e,n);n instanceof Error&&(s.stack=n.stack,s.message=n.message),r.write(s)}}})}configure({silent:e,format:r,defaultMeta:n,levels:s,level:a="info",exitOnError:o=!0,transports:i,colors:u,emitErrs:l,formatters:c,padLevels:f,rewriters:h,stripColors:S,exceptionHandlers:g,rejectionHandlers:E}={}){if(this.transports.length&&this.clear(),this.silent=e,this.format=r||this.format||ow()(),this.defaultMeta=n||null,this.levels=s||this.levels||$se.npm.levels,this.level=a,this.exceptions&&this.exceptions.unhandle(),this.rejections&&this.rejections.unhandle(),this.exceptions=new kse(this),this.rejections=new Bse(this),this.profilers={},this.exitOnError=o,i&&(i=Array.isArray(i)?i:[i],i.forEach(T=>this.add(T))),u||l||c||f||h||S)throw new Error(["{ colors, emitErrs, formatters, padLevels, rewriters, stripColors } were removed in winston@3.0.0.","Use a custom winston.format(function) instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join(`
`));g&&this.exceptions.handle(g),E&&this.rejections.handle(E)}isLevelEnabled(e){let r=Hw(this.levels,e);if(r===null)return!1;let n=Hw(this.levels,this.level);return n===null?!1:!this.transports||this.transports.length===0?n>=r:this.transports.findIndex(a=>{let o=Hw(this.levels,a.level);return o===null&&(o=n),o>=r})!==-1}log(e,r,...n){if(arguments.length===1)return e[an]=e.level,this._addDefaultMeta(e),this.write(e),this;if(arguments.length===2)return r&&typeof r=="object"?(r[an]=r.level=e,this._addDefaultMeta(r),this.write(r),this):(r={[an]:e,level:e,message:r},this._addDefaultMeta(r),this.write(r),this);let[s]=n;if(typeof s=="object"&&s!==null&&!(r&&r.match&&r.match(Gse))){let o=Object.assign({},this.defaultMeta,s,{[an]:e,[NG]:n,level:e,message:r});return s.message&&(o.message=`${o.message} ${s.message}`),s.stack&&(o.stack=s.stack),s.cause&&(o.cause=s.cause),this.write(o),this}return this.write(Object.assign({},this.defaultMeta,{[an]:e,[NG]:n,level:e,message:r})),this}_transform(e,r,n){if(this.silent)return n();e[an]||(e[an]=e.level),!this.levels[e[an]]&&this.levels[e[an]]!==0&&console.error("[winston] Unknown logger level: %s",e[an]),this._readableState.pipes||console.error("[winston] Attempt to write logs with no transports, which can increase memory usage: %j",e);try{this.push(this.format.transform(e,this.format.options))}finally{this._writableState.sync=!1,n()}}_final(e){let r=this.transports.slice();RG(r,(n,s)=>{if(!n||n.finished)return setImmediate(s);n.once("finish",s),n.end()},e)}add(e){let r=!PG(e)||e.log.length>2?new qse({transport:e}):e;if(!r._writableState||!r._writableState.objectMode)throw new Error("Transports must WritableStreams in objectMode. Set { objectMode: true }.");return this._onEvent("error",r),this._onEvent("warn",r),this.pipe(r),e.handleExceptions&&this.exceptions.handle(),e.handleRejections&&this.rejections.handle(),this}remove(e){if(!e)return this;let r=e;return(!PG(e)||e.log.length>2)&&(r=this.transports.filter(n=>n.transport===e)[0]),r&&this.unpipe(r),this}clear(){return this.unpipe(),this}close(){return this.exceptions.unhandle(),this.rejections.unhandle(),this.clear(),this.emit("close"),this}setLevels(){Fse.deprecated("setLevels")}query(e,r){typeof e=="function"&&(r=e,e={}),e=e||{};let n={},s=Object.assign({},e.query||{});function a(i,u){e.query&&typeof i.formatQuery=="function"&&(e.query=i.formatQuery(s)),i.query(e,(l,c)=>{if(l)return u(l);typeof i.formatResults=="function"&&(c=i.formatResults(c,e.format)),u(null,c)})}function o(i,u){a(i,(l,c)=>{u&&(c=l||c,c&&(n[i.name]=c),u()),u=null})}RG(this.transports.filter(i=>!!i.query),o,()=>r(null,n))}stream(e={}){let r=new xse,n=[];return r._streams=n,r.destroy=()=>{let s=n.length;for(;s--;)n[s].destroy()},this.transports.filter(s=>!!s.stream).forEach(s=>{let a=s.stream(e);a&&(n.push(a),a.on("log",o=>{o.transport=o.transport||[],o.transport.push(s.name),r.emit("log",o)}),a.on("error",o=>{o.transport=o.transport||[],o.transport.push(s.name),r.emit("error",o)}))}),r}startTimer(){return new Vse(this)}profile(e,...r){let n=Date.now();if(this.profilers[e]){let s=this.profilers[e];delete this.profilers[e],typeof r[r.length-2]=="function"&&(console.warn("Callback function no longer supported as of winston@3.0.0"),r.pop());let a=typeof r[r.length-1]=="object"?r.pop():{};return a.level=a.level||"info",a.durationMs=n-s,a.message=a.message||e,this.write(a)}return this.profilers[e]=n,this}handleExceptions(...e){console.warn("Deprecated: .handleExceptions() will be removed in winston@4. Use .exceptions.handle()"),this.exceptions.handle(...e)}unhandleExceptions(...e){console.warn("Deprecated: .unhandleExceptions() will be removed in winston@4. Use .exceptions.unhandle()"),this.exceptions.unhandle(...e)}cli(){throw new Error(["Logger.cli() was removed in winston@3.0.0","Use a custom winston.formats.cli() instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join(`
`))}_onEvent(e,r){function n(s){e==="error"&&!this.transports.includes(r)&&this.add(r),this.emit(e,s,r)}r["__winston"+e]||(r["__winston"+e]=n.bind(this),r.on(e,r["__winston"+e]))}_addDefaultMeta(e){this.defaultMeta&&Object.assign(e,this.defaultMeta)}};function Hw(t,e){let r=t[e];return!r&&r!==0?null:r}Object.defineProperty(Dh.prototype,"transports",{configurable:!1,enumerable:!0,get(){let{pipes:t}=this._readableState;return Array.isArray(t)?t:[t].filter(Boolean)}});IG.exports=Dh});var Yw=p((QNe,MG)=>{"use strict";var{LEVEL:Wse}=Ge(),jse=Rh(),Hse=Ch(),Yse=cl()("winston:create-logger");function zse(t){return"is"+t.charAt(0).toUpperCase()+t.slice(1)+"Enabled"}MG.exports=function(t={}){t.levels=t.levels||jse.npm.levels;class e extends Hse{constructor(s){super(s)}}let r=new e(t);return Object.keys(t.levels).forEach(function(n){if(Yse('Define prototype method for "%s"',n),n==="log"){console.warn('Level "log" not defined: conflicts with the method "log". Use a different level name.');return}e.prototype[n]=function(...s){let a=this||r;if(s.length===1){let[o]=s,i=o&&o.message&&o||{message:o};return i.level=i[Wse]=n,a._addDefaultMeta(i),a.write(i),this||r}return s.length===0?(a.log(n,""),a):a.log(n,...s)},e.prototype[zse(n)]=function(){return(this||r).isLevelEnabled(n)}}),r}});var CG=p((XNe,LG)=>{"use strict";var Kse=Yw();LG.exports=class{constructor(e={}){this.loggers=new Map,this.options=e}add(e,r){if(!this.loggers.has(e)){r=Object.assign({},r||this.options);let n=r.transports||this.options.transports;n?r.transports=Array.isArray(n)?n.slice():[n]:r.transports=[];let s=Kse(r);s.on("close",()=>this._delete(e)),this.loggers.set(e,s)}return this.loggers.get(e)}get(e,r){return this.add(e,r)}has(e){return!!this.loggers.has(e)}close(e){if(e)return this._removeLogger(e);this.loggers.forEach((r,n)=>this._removeLogger(n))}_removeLogger(e){if(!this.loggers.has(e))return;this.loggers.get(e).close(),this._delete(e)}_delete(e){this.loggers.delete(e)}}});var zw=p(Ae=>{"use strict";var DG=cw(),{warn:_l}=fw();Ae.version=eF().version;Ae.transports=sG();Ae.config=Rh();Ae.addColors=DG.levels;Ae.format=DG.format;Ae.createLogger=Yw();Ae.Logger=Ch();Ae.ExceptionHandler=$w();Ae.RejectionHandler=Ww();Ae.Container=CG();Ae.Transport=Us();Ae.loggers=new Ae.Container;var un=Ae.createLogger();Object.keys(Ae.config.npm.levels).concat(["log","query","stream","add","remove","clear","profile","startTimer","handleExceptions","unhandleExceptions","handleRejections","unhandleRejections","configure","child"]).forEach(t=>Ae[t]=(...e)=>un[t](...e));Object.defineProperty(Ae,"level",{get(){return un.level},set(t){un.level=t}});Object.defineProperty(Ae,"exceptions",{get(){return un.exceptions}});Object.defineProperty(Ae,"rejections",{get(){return un.rejections}});["exitOnError"].forEach(t=>{Object.defineProperty(Ae,t,{get(){return un[t]},set(e){un[t]=e}})});Object.defineProperty(Ae,"default",{get(){return{exceptionHandlers:un.exceptionHandlers,rejectionHandlers:un.rejectionHandlers,transports:un.transports}}});_l.deprecated(Ae,"setLevels");_l.forFunctions(Ae,"useFormat",["cli"]);_l.forProperties(Ae,"useFormat",["padLevels","stripColors"]);_l.forFunctions(Ae,"deprecated",["addRewriter","addFilter","clone","extend"]);_l.forProperties(Ae,"deprecated",["emitErrs","levelLength"])});var Uh=p(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.DBOSConsoleLogger=li.DBOSContextualLogger=li.GlobalLogger=void 0;var ui=gt(),Fs=wn(),$s;(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRACE=1]="TRACE",t[t.TRACE2=2]="TRACE2",t[t.TRACE3=3]="TRACE3",t[t.TRACE4=4]="TRACE4",t[t.DEBUG=5]="DEBUG",t[t.DEBUG2=6]="DEBUG2",t[t.DEBUG3=7]="DEBUG3",t[t.DEBUG4=8]="DEBUG4",t[t.INFO=9]="INFO",t[t.INFO2=10]="INFO2",t[t.INFO3=11]="INFO3",t[t.INFO4=12]="INFO4",t[t.WARN=13]="WARN",t[t.WARN2=14]="WARN2",t[t.WARN3=15]="WARN3",t[t.WARN4=16]="WARN4",t[t.ERROR=17]="ERROR",t[t.ERROR2=18]="ERROR2",t[t.ERROR3=19]="ERROR3",t[t.ERROR4=20]="ERROR4",t[t.FATAL=21]="FATAL",t[t.FATAL2=22]="FATAL2",t[t.FATAL3=23]="FATAL3",t[t.FATAL4=24]="FATAL4"})($s||($s={}));var Kw=class{telemetryCollector;logger;addContextMetadata;isLogging=!1;constructor(e,r,n="dbos"){if(this.telemetryCollector=e,this.addContextMetadata=r?.addContextMetadata||!1,!ui.globalParams.enableOTLP){this.logger=new xh(r??{});return}let s=oq();class a extends s{telemetryCollector;name="OTLPLogQueueTransport";otelLogger;applicationID;executorID;constructor(f,h){super(),this.telemetryCollector=f,this.level=h;let{LoggerProvider:S}=xq(),g={forceFlush:async()=>{},onEmit(T){f.push(T)},shutdown:async()=>{}},E=new S({resource:{attributes:{"service.name":n}},processors:[g]});this.otelLogger=E.getLogger("dbos-logger"),this.applicationID=ui.globalParams.appID,this.executorID=ui.globalParams.executorID}log(f,h){let{level:S,message:g,stack:E,span:T}=f,O={error:$s.ERROR,warn:$s.WARN,info:$s.INFO,debug:$s.DEBUG};this.otelLogger.emit({severityNumber:O[S],severityText:S,body:g,timestamp:performance.now(),observedTimestamp:performance.now(),attributes:{...T?.attributes,traceId:T?.spanContext()?.traceId,spanId:T?.spanContext()?.spanId,stack:E,applicationID:this.applicationID,applicationVersion:ui.globalParams.appVersion,executorID:this.executorID}}),h()}}let{transports:o,createLogger:i}=zw(),u=[];u.push(new o.Console({format:Qse(),level:r?.logLevel||"info",silent:r?.silent||!1,forceConsole:r?.forceConsole||!1}));let l;ui.globalParams.enableOTLP&&this.telemetryCollector?.exporter&&(l=new a(this.telemetryCollector,r?.logLevel||"info"),u.push(l)),this.logger=i({transports:u}),ui.globalParams.enableOTLP&&process.env.DBOS__CAPTURE_STD!=="false"&&this.telemetryCollector?.exporter&&(0,ui.interceptStreams)((c,f)=>{f==="stdout"?this.isLogging||l?.log({level:"info",message:c.trim()},()=>{}):this.isLogging||l?.log({level:"error",message:c.trim(),stack:new Error().stack},()=>{})})}info(e,r){this.isLogging=!0,typeof e=="string"?this.logger.info(e,r):this.logger.info(Fs.DBOSJSON.stringify(e),r),this.isLogging=!1}debug(e,r){this.isLogging=!0,typeof e=="string"?this.logger.debug(e,r):this.logger.debug(Fs.DBOSJSON.stringify(e),r),this.isLogging=!1}warn(e,r){this.isLogging=!0,typeof e=="string"?this.logger.warn(e,r):this.logger.warn(Fs.DBOSJSON.stringify(e),r),this.isLogging=!1}error(e,r){this.isLogging=!0,e instanceof Error?this.logger.error(e.message,{...r,stack:e.stack}):typeof e=="string"?this.logger.error(e,{...r,stack:new Error().stack}):this.logger.error(Fs.DBOSJSON.stringify(e),{...r,stack:new Error().stack}),this.isLogging=!1}async destroy(){await this.telemetryCollector?.destroy()}};li.GlobalLogger=Kw;var Qw=class{globalLogger;ctx;includeContextMetadata;constructor(e,r){this.globalLogger=e,this.ctx=r,this.includeContextMetadata=this.globalLogger.addContextMetadata}info(e,r){this.globalLogger.info(e,{includeContextMetadata:this.includeContextMetadata,span:this.ctx(),...r})}debug(e,r){this.globalLogger.debug(e,{includeContextMetadata:this.includeContextMetadata,span:this.ctx(),...r})}warn(e,r){this.globalLogger.warn(e,{includeContextMetadata:this.includeContextMetadata,span:this.ctx(),...r})}error(e,r){this.globalLogger.error(e,{includeContextMetadata:this.includeContextMetadata,span:this.ctx(),...r})}};li.DBOSContextualLogger=Qw;var xh=class{config;constructor(e){this.config=e}info(e,r){console.log(e)}debug(e,r){this.config.logLevel==="debug"&&console.debug(e)}warn(e,r){console.warn(e)}error(e,r){e instanceof Error?console.error(e):r?.stack?console.error(e,`
`,r.stack):console.error(e)}};li.DBOSConsoleLogger=xh;function Qse(){let{format:t}=zw();return t.combine(t.errors({stack:!0}),t.timestamp(),t.colorize(),t.printf(e=>{let{timestamp:r,level:n,message:s,stack:a}=e,o=ui.globalParams.appVersion,i=typeof r=="string"?r.slice(0,19).replace("T"," "):void 0,u=typeof a=="string"?a?.split(`
`).slice(1).join(`
`):void 0,c=`${typeof s=="string"?s:Fs.DBOSJSON.stringify(s)}${e.includeContextMetadata?` ${Fs.DBOSJSON.stringify(e.span?.attributes)}`:""}`,f=o?` [version ${o}]`:"";return`${i}${f} [${n}]: ${c} ${a?`
`+u:""}`}))}});var Ao=p(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.parseRetryAfterToMills=Ce.isExportRetryable=Ce.invalidTimeout=Ce.configureExporterTimeout=Ce.appendRootPathToUrlIfNeeded=Ce.appendResourcePathToUrl=Ce.parseHeaders=Ce.DEFAULT_EXPORT_BACKOFF_MULTIPLIER=Ce.DEFAULT_EXPORT_MAX_BACKOFF=Ce.DEFAULT_EXPORT_INITIAL_BACKOFF=Ce.DEFAULT_EXPORT_MAX_ATTEMPTS=void 0;var Jw=(k(),B(U)),xG=te(),UG=1e4;Ce.DEFAULT_EXPORT_MAX_ATTEMPTS=5;Ce.DEFAULT_EXPORT_INITIAL_BACKOFF=1e3;Ce.DEFAULT_EXPORT_MAX_BACKOFF=5e3;Ce.DEFAULT_EXPORT_BACKOFF_MULTIPLIER=1.5;function Jse(t={}){let e={};return Object.entries(t).forEach(([r,n])=>{typeof n<"u"?e[r]=String(n):Jw.diag.warn(`Header "${r}" has wrong value and will be ignored`)}),e}Ce.parseHeaders=Jse;function Xse(t,e){return t.endsWith("/")||(t=t+"/"),t+e}Ce.appendResourcePathToUrl=Xse;function Zse(t){try{let e=new URL(t);return e.pathname===""&&(e.pathname=e.pathname+"/"),e.toString()}catch{return Jw.diag.warn(`Could not parse export URL: '${t}'`),t}}Ce.appendRootPathToUrlIfNeeded=Zse;function eae(t){return typeof t=="number"?t<=0?Xw(t,UG):t:tae()}Ce.configureExporterTimeout=eae;function tae(){var t;let e=Number((t=(0,xG.getEnv)().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)!==null&&t!==void 0?t:(0,xG.getEnv)().OTEL_EXPORTER_OTLP_TIMEOUT);return e<=0?Xw(e,UG):e}function Xw(t,e){return Jw.diag.warn("Timeout must be greater than 0",t),e}Ce.invalidTimeout=Xw;function rae(t){return[429,502,503,504].includes(t)}Ce.isExportRetryable=rae;function nae(t){if(t==null)return-1;let e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?e*1e3:-1;let r=new Date(t).getTime()-Date.now();return r>=0?r:0}Ce.parseRetryAfterToMills=nae});var Bh=p(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.OTLPExporterBase=void 0;var kG=(k(),B(U)),ml=te(),iae=Ao(),Zw=class{constructor(e={}){this._sendingPromises=[],this.url=this.getDefaultUrl(e),typeof e.hostname=="string"&&(this.hostname=e.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new ml.BindOnceFuture(this._shutdown,this),this._concurrencyLimit=typeof e.concurrencyLimit=="number"?e.concurrencyLimit:30,this.timeoutMillis=(0,iae.configureExporterTimeout)(e.timeoutMillis),this.onInit(e)}export(e,r){if(this._shutdownOnce.isCalled){r({code:ml.ExportResultCode.FAILED,error:new Error("Exporter has been shutdown")});return}if(this._sendingPromises.length>=this._concurrencyLimit){r({code:ml.ExportResultCode.FAILED,error:new Error("Concurrent export limit reached")});return}this._export(e).then(()=>{r({code:ml.ExportResultCode.SUCCESS})}).catch(n=>{r({code:ml.ExportResultCode.FAILED,error:n})})}_export(e){return new Promise((r,n)=>{try{kG.diag.debug("items to be sent",e),this.send(e,r,n)}catch(s){n(s)}})}shutdown(){return this._shutdownOnce.call()}forceFlush(){return Promise.all(this._sendingPromises).then(()=>{})}_shutdown(){return kG.diag.debug("shutdown started"),this.onShutdown(),this.forceFlush()}};kh.OTLPExporterBase=Zw});var eO=p(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.CompressionAlgorithm=void 0;var oae;(function(t){t.NONE="none",t.GZIP="gzip"})(oae=Sl.CompressionAlgorithm||(Sl.CompressionAlgorithm={}))});var Vh=p(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});qh.OTLPExporterError=void 0;var tO=class extends Error{constructor(e,r,n){super(e),this.name="OTLPExporterError",this.data=n,this.code=r}};qh.OTLPExporterError=tO});var nO=p(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.configureCompression=ci.createHttpAgent=ci.sendWithHttp=void 0;var qG=require("url"),VG=require("http"),FG=require("https"),sae=require("zlib"),aae=require("stream"),rO=(k(),B(U)),Fh=eO(),BG=te(),El=Vh(),Gs=Ao();function uae(t,e,r,n,s){let a=t.timeoutMillis,o=new qG.URL(t.url),i=Number(process.versions.node.split(".")[0]),u,l,c=!1,f=setTimeout(()=>{if(clearTimeout(u),c=!0,l.destroyed){let E=new El.OTLPExporterError("Request Timeout");s(E)}else i>=14?l.destroy():l.abort()},a),h={hostname:o.hostname,port:o.port,path:o.pathname,method:"POST",headers:Object.assign({"Content-Type":r},t.headers),agent:t.agent},S=o.protocol==="http:"?VG.request:FG.request,g=(E=Gs.DEFAULT_EXPORT_MAX_ATTEMPTS,T=Gs.DEFAULT_EXPORT_INITIAL_BACKOFF)=>{l=S(h,O=>{let v="";O.on("data",b=>v+=b),O.on("aborted",()=>{if(c){let b=new El.OTLPExporterError("Request Timeout");s(b)}}),O.on("end",()=>{if(c===!1)if(O.statusCode&&O.statusCode<299)rO.diag.debug(`statusCode: ${O.statusCode}`,v),n(),clearTimeout(f),clearTimeout(u);else if(O.statusCode&&(0,Gs.isExportRetryable)(O.statusCode)&&E>0){let b;T=Gs.DEFAULT_EXPORT_BACKOFF_MULTIPLIER*T,O.headers["retry-after"]?b=(0,Gs.parseRetryAfterToMills)(O.headers["retry-after"]):b=Math.round(Math.random()*(Gs.DEFAULT_EXPORT_MAX_BACKOFF-T)+T),u=setTimeout(()=>{g(E-1,T)},b)}else{let b=new El.OTLPExporterError(O.statusMessage,O.statusCode,v);s(b),clearTimeout(f),clearTimeout(u)}})}),l.on("error",O=>{if(c){let v=new El.OTLPExporterError("Request Timeout",O.code);s(v)}else s(O);clearTimeout(f),clearTimeout(u)}),l.on("abort",()=>{if(c){let O=new El.OTLPExporterError("Request Timeout");s(O)}clearTimeout(f),clearTimeout(u)}),t.compression===Fh.CompressionAlgorithm.GZIP?(l.setHeader("Content-Encoding","gzip"),lae(e).on("error",s).pipe(sae.createGzip()).on("error",s).pipe(l)):l.end(e)};g()}ci.sendWithHttp=uae;function lae(t){let e=new aae.Readable;return e.push(t),e.push(null),e}function cae(t){if(t.httpAgentOptions&&t.keepAlive===!1){rO.diag.warn("httpAgentOptions is used only when keepAlive is true");return}if(!(t.keepAlive===!1||!t.url))try{let r=new qG.URL(t.url).protocol==="http:"?VG.Agent:FG.Agent;return new r(Object.assign({keepAlive:!0},t.httpAgentOptions))}catch(e){rO.diag.error(`collector exporter failed to create http agent. err: ${e.message}`);return}}ci.createHttpAgent=cae;function fae(t){return t||(((0,BG.getEnv)().OTEL_EXPORTER_OTLP_TRACES_COMPRESSION||(0,BG.getEnv)().OTEL_EXPORTER_OTLP_COMPRESSION)===Fh.CompressionAlgorithm.GZIP?Fh.CompressionAlgorithm.GZIP:Fh.CompressionAlgorithm.NONE)}ci.configureCompression=fae});var WG=p($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.OTLPExporterNodeBase=void 0;var dae=Bh(),pae=Ao(),iO=nO(),$G=(k(),B(U)),GG=te(),oO=class extends dae.OTLPExporterBase{constructor(e={}){super(e),this.DEFAULT_HEADERS={},e.metadata&&$G.diag.warn("Metadata cannot be set when using http"),this.headers=Object.assign(this.DEFAULT_HEADERS,(0,pae.parseHeaders)(e.headers),GG.baggageUtils.parseKeyPairsIntoRecord((0,GG.getEnv)().OTEL_EXPORTER_OTLP_HEADERS)),this.agent=(0,iO.createHttpAgent)(e),this.compression=(0,iO.configureCompression)(e.compression)}onInit(e){}send(e,r,n){if(this._shutdownOnce.isCalled){$G.diag.debug("Shutdown already started. Cannot send objects");return}let s=this.convert(e),a=new Promise((i,u)=>{(0,iO.sendWithHttp)(this,JSON.stringify(s),"application/json",i,u)}).then(r,n);this._sendingPromises.push(a);let o=()=>{let i=this._sendingPromises.indexOf(a);this._sendingPromises.splice(i,1)};a.then(o,o)}onShutdown(){}};$h.OTLPExporterNodeBase=oO});var jG=p(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.CompressionAlgorithm=Er.configureCompression=Er.createHttpAgent=Er.sendWithHttp=Er.OTLPExporterNodeBase=void 0;var hae=WG();Object.defineProperty(Er,"OTLPExporterNodeBase",{enumerable:!0,get:function(){return hae.OTLPExporterNodeBase}});var sO=nO();Object.defineProperty(Er,"sendWithHttp",{enumerable:!0,get:function(){return sO.sendWithHttp}});Object.defineProperty(Er,"createHttpAgent",{enumerable:!0,get:function(){return sO.createHttpAgent}});Object.defineProperty(Er,"configureCompression",{enumerable:!0,get:function(){return sO.configureCompression}});var _ae=eO();Object.defineProperty(Er,"CompressionAlgorithm",{enumerable:!0,get:function(){return _ae.CompressionAlgorithm}})});var aO=p(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.sendWithXhr=js.sendWithBeacon=void 0;var HG=(k(),B(U)),gl=Vh(),Ws=Ao();function mae(t,e,r,n,s){if(navigator.sendBeacon(e,new Blob([t],r)))HG.diag.debug("sendBeacon - can send",t),n();else{let a=new gl.OTLPExporterError(`sendBeacon - cannot send ${t}`);s(a)}}js.sendWithBeacon=mae;function Sae(t,e,r,n,s,a){let o,i,u=!1,l=setTimeout(()=>{if(clearTimeout(o),u=!0,i.readyState===XMLHttpRequest.DONE){let f=new gl.OTLPExporterError("Request Timeout");a(f)}else i.abort()},n),c=(f=Ws.DEFAULT_EXPORT_MAX_ATTEMPTS,h=Ws.DEFAULT_EXPORT_INITIAL_BACKOFF)=>{i=new XMLHttpRequest,i.open("POST",e),Object.entries(Object.assign(Object.assign({},{Accept:"application/json","Content-Type":"application/json"}),r)).forEach(([g,E])=>{i.setRequestHeader(g,E)}),i.send(t),i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE&&u===!1)if(i.status>=200&&i.status<=299)HG.diag.debug("xhr success",t),s(),clearTimeout(l),clearTimeout(o);else if(i.status&&(0,Ws.isExportRetryable)(i.status)&&f>0){let g;h=Ws.DEFAULT_EXPORT_BACKOFF_MULTIPLIER*h,i.getResponseHeader("Retry-After")?g=(0,Ws.parseRetryAfterToMills)(i.getResponseHeader("Retry-After")):g=Math.round(Math.random()*(Ws.DEFAULT_EXPORT_MAX_BACKOFF-h)+h),o=setTimeout(()=>{c(f-1,h)},g)}else{let g=new gl.OTLPExporterError(`Failed to export with XHR (status: ${i.status})`,i.status);a(g),clearTimeout(l),clearTimeout(o)}},i.onabort=()=>{if(u){let g=new gl.OTLPExporterError("Request Timeout");a(g)}clearTimeout(l),clearTimeout(o)},i.onerror=()=>{if(u){let g=new gl.OTLPExporterError("Request Timeout");a(g)}clearTimeout(l),clearTimeout(o)}};c()}js.sendWithXhr=Sae});var KG=p(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.OTLPExporterBrowserBase=void 0;var Eae=Bh(),gae=Ao(),YG=aO(),yae=(k(),B(U)),zG=te(),uO=class extends Eae.OTLPExporterBase{constructor(e={}){super(e),this._useXHR=!1,this._useXHR=!!e.headers||typeof navigator.sendBeacon!="function",this._useXHR?this._headers=Object.assign({},(0,gae.parseHeaders)(e.headers),zG.baggageUtils.parseKeyPairsIntoRecord((0,zG.getEnv)().OTEL_EXPORTER_OTLP_HEADERS)):this._headers={}}onInit(){}onShutdown(){}send(e,r,n){if(this._shutdownOnce.isCalled){yae.diag.debug("Shutdown already started. Cannot send objects");return}let s=this.convert(e),a=JSON.stringify(s),o=new Promise((u,l)=>{this._useXHR?(0,YG.sendWithXhr)(a,this.url,this._headers,this.timeoutMillis,u,l):(0,YG.sendWithBeacon)(a,this.url,{type:"application/json"},u,l)}).then(r,n);this._sendingPromises.push(o);let i=()=>{let u=this._sendingPromises.indexOf(o);this._sendingPromises.splice(u,1)};o.then(i,i)}};Gh.OTLPExporterBrowserBase=uO});var QG=p(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.sendWithXhr=Hs.OTLPExporterBrowserBase=void 0;var Tae=KG();Object.defineProperty(Hs,"OTLPExporterBrowserBase",{enumerable:!0,get:function(){return Tae.OTLPExporterBrowserBase}});var wae=aO();Object.defineProperty(Hs,"sendWithXhr",{enumerable:!0,get:function(){return wae.sendWithXhr}})});var XG=p(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.sendWithXhr=bt.OTLPExporterBrowserBase=bt.CompressionAlgorithm=bt.configureCompression=bt.createHttpAgent=bt.sendWithHttp=bt.OTLPExporterNodeBase=void 0;var yl=jG();Object.defineProperty(bt,"OTLPExporterNodeBase",{enumerable:!0,get:function(){return yl.OTLPExporterNodeBase}});Object.defineProperty(bt,"sendWithHttp",{enumerable:!0,get:function(){return yl.sendWithHttp}});Object.defineProperty(bt,"createHttpAgent",{enumerable:!0,get:function(){return yl.createHttpAgent}});Object.defineProperty(bt,"configureCompression",{enumerable:!0,get:function(){return yl.configureCompression}});Object.defineProperty(bt,"CompressionAlgorithm",{enumerable:!0,get:function(){return yl.CompressionAlgorithm}});var JG=QG();Object.defineProperty(bt,"OTLPExporterBrowserBase",{enumerable:!0,get:function(){return JG.OTLPExporterBrowserBase}});Object.defineProperty(bt,"sendWithXhr",{enumerable:!0,get:function(){return JG.sendWithXhr}})});var Ys=p(Ke=>{"use strict";var Oae=Ke&&Ke.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),vae=Ke&&Ke.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Oae(e,t,r)};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.invalidTimeout=Ke.configureExporterTimeout=Ke.appendRootPathToUrlIfNeeded=Ke.appendResourcePathToUrl=Ke.parseHeaders=Ke.OTLPExporterError=Ke.OTLPExporterBase=void 0;vae(XG(),Ke);var bae=Bh();Object.defineProperty(Ke,"OTLPExporterBase",{enumerable:!0,get:function(){return bae.OTLPExporterBase}});var Aae=Vh();Object.defineProperty(Ke,"OTLPExporterError",{enumerable:!0,get:function(){return Aae.OTLPExporterError}});var Tl=Ao();Object.defineProperty(Ke,"parseHeaders",{enumerable:!0,get:function(){return Tl.parseHeaders}});Object.defineProperty(Ke,"appendResourcePathToUrl",{enumerable:!0,get:function(){return Tl.appendResourcePathToUrl}});Object.defineProperty(Ke,"appendRootPathToUrlIfNeeded",{enumerable:!0,get:function(){return Tl.appendRootPathToUrlIfNeeded}});Object.defineProperty(Ke,"configureExporterTimeout",{enumerable:!0,get:function(){return Tl.configureExporterTimeout}});Object.defineProperty(Ke,"invalidTimeout",{enumerable:!0,get:function(){return Tl.invalidTimeout}})});var eW=p((pPe,ZG)=>{"use strict";ZG.exports=Rae;function Rae(t,e){for(var r=new Array(arguments.length-1),n=0,s=2,a=!0;s<arguments.length;)r[n++]=arguments[s++];return new Promise(function(i,u){r[n]=function(c){if(a)if(a=!1,c)u(c);else{for(var f=new Array(arguments.length-1),h=0;h<f.length;)f[h++]=arguments[h];i.apply(null,f)}};try{t.apply(e||null,r)}catch(l){a&&(a=!1,u(l))}})}});var iW=p(nW=>{"use strict";var Wh=nW;Wh.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var zs=new Array(64),rW=new Array(123);for(Br=0;Br<64;)rW[zs[Br]=Br<26?Br+65:Br<52?Br+71:Br<62?Br-4:Br-59|43]=Br++;var Br;Wh.encode=function(e,r,n){for(var s=null,a=[],o=0,i=0,u;r<n;){var l=e[r++];switch(i){case 0:a[o++]=zs[l>>2],u=(l&3)<<4,i=1;break;case 1:a[o++]=zs[u|l>>4],u=(l&15)<<2,i=2;break;case 2:a[o++]=zs[u|l>>6],a[o++]=zs[l&63],i=0;break}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0)}return i&&(a[o++]=zs[u],a[o++]=61,i===1&&(a[o++]=61)),s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var tW="invalid encoding";Wh.decode=function(e,r,n){for(var s=n,a=0,o,i=0;i<e.length;){var u=e.charCodeAt(i++);if(u===61&&a>1)break;if((u=rW[u])===void 0)throw Error(tW);switch(a){case 0:o=u,a=1;break;case 1:r[n++]=o<<2|(u&48)>>4,o=u,a=2;break;case 2:r[n++]=(o&15)<<4|(u&60)>>2,o=u,a=3;break;case 3:r[n++]=(o&3)<<6|u,a=0;break}}if(a===1)throw Error(tW);return n-s};Wh.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var sW=p((_Pe,oW)=>{"use strict";oW.exports=jh;function jh(){this._listeners={}}jh.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};jh.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],s=0;s<n.length;)n[s].fn===r?n.splice(s,1):++s;return this};jh.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],s=1;s<arguments.length;)n.push(arguments[s++]);for(s=0;s<r.length;)r[s].fn.apply(r[s++].ctx,n)}return this}});var pW=p((mPe,dW)=>{"use strict";dW.exports=aW(aW);function aW(t){return typeof Float32Array<"u"?(function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function s(u,l,c){e[0]=u,l[c]=r[0],l[c+1]=r[1],l[c+2]=r[2],l[c+3]=r[3]}function a(u,l,c){e[0]=u,l[c]=r[3],l[c+1]=r[2],l[c+2]=r[1],l[c+3]=r[0]}t.writeFloatLE=n?s:a,t.writeFloatBE=n?a:s;function o(u,l){return r[0]=u[l],r[1]=u[l+1],r[2]=u[l+2],r[3]=u[l+3],e[0]}function i(u,l){return r[3]=u[l],r[2]=u[l+1],r[1]=u[l+2],r[0]=u[l+3],e[0]}t.readFloatLE=n?o:i,t.readFloatBE=n?i:o})():(function(){function e(n,s,a,o){var i=s<0?1:0;if(i&&(s=-s),s===0)n(1/s>0?0:2147483648,a,o);else if(isNaN(s))n(2143289344,a,o);else if(s>34028234663852886e22)n((i<<31|2139095040)>>>0,a,o);else if(s<11754943508222875e-54)n((i<<31|Math.round(s/1401298464324817e-60))>>>0,a,o);else{var u=Math.floor(Math.log(s)/Math.LN2),l=Math.round(s*Math.pow(2,-u)*8388608)&8388607;n((i<<31|u+127<<23|l)>>>0,a,o)}}t.writeFloatLE=e.bind(null,uW),t.writeFloatBE=e.bind(null,lW);function r(n,s,a){var o=n(s,a),i=(o>>31)*2+1,u=o>>>23&255,l=o&8388607;return u===255?l?NaN:i*(1/0):u===0?i*1401298464324817e-60*l:i*Math.pow(2,u-150)*(l+8388608)}t.readFloatLE=r.bind(null,cW),t.readFloatBE=r.bind(null,fW)})(),typeof Float64Array<"u"?(function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function s(u,l,c){e[0]=u,l[c]=r[0],l[c+1]=r[1],l[c+2]=r[2],l[c+3]=r[3],l[c+4]=r[4],l[c+5]=r[5],l[c+6]=r[6],l[c+7]=r[7]}function a(u,l,c){e[0]=u,l[c]=r[7],l[c+1]=r[6],l[c+2]=r[5],l[c+3]=r[4],l[c+4]=r[3],l[c+5]=r[2],l[c+6]=r[1],l[c+7]=r[0]}t.writeDoubleLE=n?s:a,t.writeDoubleBE=n?a:s;function o(u,l){return r[0]=u[l],r[1]=u[l+1],r[2]=u[l+2],r[3]=u[l+3],r[4]=u[l+4],r[5]=u[l+5],r[6]=u[l+6],r[7]=u[l+7],e[0]}function i(u,l){return r[7]=u[l],r[6]=u[l+1],r[5]=u[l+2],r[4]=u[l+3],r[3]=u[l+4],r[2]=u[l+5],r[1]=u[l+6],r[0]=u[l+7],e[0]}t.readDoubleLE=n?o:i,t.readDoubleBE=n?i:o})():(function(){function e(n,s,a,o,i,u){var l=o<0?1:0;if(l&&(o=-o),o===0)n(0,i,u+s),n(1/o>0?0:2147483648,i,u+a);else if(isNaN(o))n(0,i,u+s),n(2146959360,i,u+a);else if(o>17976931348623157e292)n(0,i,u+s),n((l<<31|2146435072)>>>0,i,u+a);else{var c;if(o<22250738585072014e-324)c=o/5e-324,n(c>>>0,i,u+s),n((l<<31|c/4294967296)>>>0,i,u+a);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),c=o*Math.pow(2,-f),n(c*4503599627370496>>>0,i,u+s),n((l<<31|f+1023<<20|c*1048576&1048575)>>>0,i,u+a)}}}t.writeDoubleLE=e.bind(null,uW,0,4),t.writeDoubleBE=e.bind(null,lW,4,0);function r(n,s,a,o,i){var u=n(o,i+s),l=n(o,i+a),c=(l>>31)*2+1,f=l>>>20&2047,h=4294967296*(l&1048575)+u;return f===2047?h?NaN:c*(1/0):f===0?c*5e-324*h:c*Math.pow(2,f-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,cW,0,4),t.readDoubleBE=r.bind(null,fW,4,0)})(),t}function uW(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function lW(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function cW(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function fW(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var hW=p((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var mW=p(_W=>{"use strict";var lO=_W;lO.length=function(e){for(var r=0,n=0,s=0;s<e.length;++s)n=e.charCodeAt(s),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(s+1)&64512)===56320?(++s,r+=4):r+=3;return r};lO.read=function(e,r,n){var s=n-r;if(s<1)return"";for(var a=null,o=[],i=0,u;r<n;)u=e[r++],u<128?o[i++]=u:u>191&&u<224?o[i++]=(u&31)<<6|e[r++]&63:u>239&&u<365?(u=((u&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[i++]=55296+(u>>10),o[i++]=56320+(u&1023)):o[i++]=(u&15)<<12|(e[r++]&63)<<6|e[r++]&63,i>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),i=0);return a?(i&&a.push(String.fromCharCode.apply(String,o.slice(0,i))),a.join("")):String.fromCharCode.apply(String,o.slice(0,i))};lO.write=function(e,r,n){for(var s=n,a,o,i=0;i<e.length;++i)a=e.charCodeAt(i),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((o=e.charCodeAt(i+1))&64512)===56320?(a=65536+((a&1023)<<10)+(o&1023),++i,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-s}});var EW=p((EPe,SW)=>{"use strict";SW.exports=Nae;function Nae(t,e,r){var n=r||8192,s=n>>>1,a=null,o=n;return function(u){if(u<1||u>s)return t(u);o+u>n&&(a=t(n),o=0);var l=e.call(a,o,o+=u);return o&7&&(o=(o|7)+1),l}}});var yW=p((gPe,gW)=>{"use strict";gW.exports=ut;var wl=di();function ut(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ro=ut.zero=new ut(0,0);Ro.toNumber=function(){return 0};Ro.zzEncode=Ro.zzDecode=function(){return this};Ro.length=function(){return 1};var Pae=ut.zeroHash="\0\0\0\0\0\0\0\0";ut.fromNumber=function(e){if(e===0)return Ro;var r=e<0;r&&(e=-e);var n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new ut(n,s)};ut.from=function(e){if(typeof e=="number")return ut.fromNumber(e);if(wl.isString(e))if(wl.Long)e=wl.Long.fromString(e);else return ut.fromNumber(parseInt(e,10));return e.low||e.high?new ut(e.low>>>0,e.high>>>0):Ro};ut.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};ut.prototype.toLong=function(e){return wl.Long?new wl.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var fi=String.prototype.charCodeAt;ut.fromHash=function(e){return e===Pae?Ro:new ut((fi.call(e,0)|fi.call(e,1)<<8|fi.call(e,2)<<16|fi.call(e,3)<<24)>>>0,(fi.call(e,4)|fi.call(e,5)<<8|fi.call(e,6)<<16|fi.call(e,7)<<24)>>>0)};ut.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ut.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ut.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ut.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var di=p(cO=>{"use strict";var $=cO;$.asPromise=eW();$.base64=iW();$.EventEmitter=sW();$.float=pW();$.inquire=hW();$.utf8=mW();$.pool=EW();$.LongBits=yW();$.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);$.global=$.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||cO;$.emptyArray=Object.freeze?Object.freeze([]):[];$.emptyObject=Object.freeze?Object.freeze({}):{};$.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};$.isString=function(e){return typeof e=="string"||e instanceof String};$.isObject=function(e){return e&&typeof e=="object"};$.isset=$.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};$.Buffer=(function(){try{var t=$.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}})();$._Buffer_from=null;$._Buffer_allocUnsafe=null;$.newBuffer=function(e){return typeof e=="number"?$.Buffer?$._Buffer_allocUnsafe(e):new $.Array(e):$.Buffer?$._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};$.Array=typeof Uint8Array<"u"?Uint8Array:Array;$.Long=$.global.dcodeIO&&$.global.dcodeIO.Long||$.global.Long||$.inquire("long");$.key2Re=/^true|false|0|1$/;$.key32Re=/^-?(?:0|[1-9][0-9]*)$/;$.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;$.longToHash=function(e){return e?$.LongBits.from(e).toHash():$.LongBits.zeroHash};$.longFromHash=function(e,r){var n=$.LongBits.fromHash(e);return $.Long?$.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function TW(t,e,r){for(var n=Object.keys(e),s=0;s<n.length;++s)(t[n[s]]===void 0||!r)&&(t[n[s]]=e[n[s]]);return t}$.merge=TW;$.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function wW(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&TW(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}$.newError=wW;$.ProtocolError=wW("ProtocolError");$.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var s=Object.keys(this),a=s.length-1;a>-1;--a)if(r[s[a]]===1&&this[s[a]]!==void 0&&this[s[a]]!==null)return s[a]}};$.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};$.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};$._configure=function(){var t=$.Buffer;if(!t){$._Buffer_from=$._Buffer_allocUnsafe=null;return}$._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},$._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var SO=p((TPe,AW)=>{"use strict";AW.exports=_e;var gr=di(),fO,Hh=gr.LongBits,OW=gr.base64,vW=gr.utf8;function Ol(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function pO(){}function Iae(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function _e(){this.len=0,this.head=new Ol(pO,0,0),this.tail=this.head,this.states=null}var bW=function(){return gr.Buffer?function(){return(_e.create=function(){return new fO})()}:function(){return new _e}};_e.create=bW();_e.alloc=function(e){return new gr.Array(e)};gr.Array!==Array&&(_e.alloc=gr.pool(_e.alloc,gr.Array.prototype.subarray));_e.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Ol(e,r,n),this.len+=r,this};function hO(t,e,r){e[r]=t&255}function Mae(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function _O(t,e){this.len=t,this.next=void 0,this.val=e}_O.prototype=Object.create(Ol.prototype);_O.prototype.fn=Mae;_e.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new _O((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};_e.prototype.int32=function(e){return e<0?this._push(mO,10,Hh.fromNumber(e)):this.uint32(e)};_e.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function mO(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}_e.prototype.uint64=function(e){var r=Hh.from(e);return this._push(mO,r.length(),r)};_e.prototype.int64=_e.prototype.uint64;_e.prototype.sint64=function(e){var r=Hh.from(e).zzEncode();return this._push(mO,r.length(),r)};_e.prototype.bool=function(e){return this._push(hO,1,e?1:0)};function dO(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}_e.prototype.fixed32=function(e){return this._push(dO,4,e>>>0)};_e.prototype.sfixed32=_e.prototype.fixed32;_e.prototype.fixed64=function(e){var r=Hh.from(e);return this._push(dO,4,r.lo)._push(dO,4,r.hi)};_e.prototype.sfixed64=_e.prototype.fixed64;_e.prototype.float=function(e){return this._push(gr.float.writeFloatLE,4,e)};_e.prototype.double=function(e){return this._push(gr.float.writeDoubleLE,8,e)};var Lae=gr.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var s=0;s<e.length;++s)r[n+s]=e[s]};_e.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(hO,1,0);if(gr.isString(e)){var n=_e.alloc(r=OW.length(e));OW.decode(e,n,0),e=n}return this.uint32(r)._push(Lae,r,e)};_e.prototype.string=function(e){var r=vW.length(e);return r?this.uint32(r)._push(vW.write,r,e):this._push(hO,1,0)};_e.prototype.fork=function(){return this.states=new Iae(this),this.head=this.tail=new Ol(pO,0,0),this.len=0,this};_e.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ol(pO,0,0),this.len=0),this};_e.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};_e.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};_e._configure=function(t){fO=t,_e.create=bW(),fO._configure()}});var PW=p((wPe,NW)=>{"use strict";NW.exports=ln;var RW=SO();(ln.prototype=Object.create(RW.prototype)).constructor=ln;var pi=di();function ln(){RW.call(this)}ln._configure=function(){ln.alloc=pi._Buffer_allocUnsafe,ln.writeBytesBuffer=pi.Buffer&&pi.Buffer.prototype instanceof Uint8Array&&pi.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var s=0;s<e.length;)r[n++]=e[s++]}};ln.prototype.bytes=function(e){pi.isString(e)&&(e=pi._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ln.writeBytesBuffer,r,e),this};function Cae(t,e,r){t.length<40?pi.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ln.prototype.string=function(e){var r=pi.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Cae,r,e),this};ln._configure()});var yO=p((OPe,DW)=>{"use strict";DW.exports=Qe;var qr=di(),gO,LW=qr.LongBits,Dae=qr.utf8;function Vr(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Qe(t){this.buf=t,this.pos=0,this.len=t.length}var IW=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Qe(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Qe(e);throw Error("illegal buffer")},CW=function(){return qr.Buffer?function(r){return(Qe.create=function(s){return qr.Buffer.isBuffer(s)?new gO(s):IW(s)})(r)}:IW};Qe.create=CW();Qe.prototype._slice=qr.Array.prototype.subarray||qr.Array.prototype.slice;Qe.prototype.uint32=(function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Vr(this,10);return e}})();Qe.prototype.int32=function(){return this.uint32()|0};Qe.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function EO(){var t=new LW(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Vr(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Vr(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Qe.prototype.bool=function(){return this.uint32()!==0};function Yh(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Qe.prototype.fixed32=function(){if(this.pos+4>this.len)throw Vr(this,4);return Yh(this.buf,this.pos+=4)};Qe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Vr(this,4);return Yh(this.buf,this.pos+=4)|0};function MW(){if(this.pos+8>this.len)throw Vr(this,8);return new LW(Yh(this.buf,this.pos+=4),Yh(this.buf,this.pos+=4))}Qe.prototype.float=function(){if(this.pos+4>this.len)throw Vr(this,4);var e=qr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Qe.prototype.double=function(){if(this.pos+8>this.len)throw Vr(this,4);var e=qr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Qe.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Vr(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var s=qr.Buffer;return s?s.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};Qe.prototype.string=function(){var e=this.bytes();return Dae.read(e,0,e.length)};Qe.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Vr(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Vr(this);while(this.buf[this.pos++]&128);return this};Qe.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Qe._configure=function(t){gO=t,Qe.create=CW(),gO._configure();var e=qr.Long?"toLong":"toNumber";qr.merge(Qe.prototype,{int64:function(){return EO.call(this)[e](!1)},uint64:function(){return EO.call(this)[e](!0)},sint64:function(){return EO.call(this).zzDecode()[e](!1)},fixed64:function(){return MW.call(this)[e](!0)},sfixed64:function(){return MW.call(this)[e](!1)}})}});var BW=p((vPe,kW)=>{"use strict";kW.exports=No;var UW=yO();(No.prototype=Object.create(UW.prototype)).constructor=No;var xW=di();function No(t){UW.call(this,t)}No._configure=function(){xW.Buffer&&(No.prototype._slice=xW.Buffer.prototype.slice)};No.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};No._configure()});var VW=p((bPe,qW)=>{"use strict";qW.exports=vl;var TO=di();(vl.prototype=Object.create(TO.EventEmitter.prototype)).constructor=vl;function vl(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");TO.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!r}vl.prototype.rpcCall=function t(e,r,n,s,a){if(!s)throw TypeError("request must be specified");var o=this;if(!a)return TO.asPromise(t,o,e,r,n,s);if(!o.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(u,l){if(u)return o.emit("error",u,e),a(u);if(l===null){o.end(!0);return}if(!(l instanceof n))try{l=n[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(c){return o.emit("error",c,e),a(c)}return o.emit("data",l,e),a(null,l)})}catch(i){o.emit("error",i,e),setTimeout(function(){a(i)},0);return}};vl.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var $W=p(FW=>{"use strict";var xae=FW;xae.Service=VW()});var WW=p((RPe,GW)=>{"use strict";GW.exports={}});var YW=p(HW=>{"use strict";var Gt=HW;Gt.build="minimal";Gt.Writer=SO();Gt.BufferWriter=PW();Gt.Reader=yO();Gt.BufferReader=BW();Gt.util=di();Gt.rpc=$W();Gt.roots=WW();Gt.configure=jW;function jW(){Gt.util._configure(),Gt.Writer._configure(Gt.BufferWriter),Gt.Reader._configure(Gt.BufferReader)}jW()});var KW=p((PPe,zW)=>{"use strict";zW.exports=YW()});var JW=p((IPe,QW)=>{"use strict";var W=KW(),w=W.Reader,ee=W.Writer,m=W.util,_=W.roots.default||(W.roots.default={});_.opentelemetry=(function(){var t={};return t.proto=(function(){var e={};return e.common=(function(){var r={};return r.v1=(function(){var n={};return n.AnyValue=(function(){function s(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.stringValue=null,s.prototype.boolValue=null,s.prototype.intValue=null,s.prototype.doubleValue=null,s.prototype.arrayValue=null,s.prototype.kvlistValue=null,s.prototype.bytesValue=null;var a;return Object.defineProperty(s.prototype,"value",{get:m.oneOfGetter(a=["stringValue","boolValue","intValue","doubleValue","arrayValue","kvlistValue","bytesValue"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){return u||(u=ee.create()),i.stringValue!=null&&Object.hasOwnProperty.call(i,"stringValue")&&u.uint32(10).string(i.stringValue),i.boolValue!=null&&Object.hasOwnProperty.call(i,"boolValue")&&u.uint32(16).bool(i.boolValue),i.intValue!=null&&Object.hasOwnProperty.call(i,"intValue")&&u.uint32(24).int64(i.intValue),i.doubleValue!=null&&Object.hasOwnProperty.call(i,"doubleValue")&&u.uint32(33).double(i.doubleValue),i.arrayValue!=null&&Object.hasOwnProperty.call(i,"arrayValue")&&_.opentelemetry.proto.common.v1.ArrayValue.encode(i.arrayValue,u.uint32(42).fork()).ldelim(),i.kvlistValue!=null&&Object.hasOwnProperty.call(i,"kvlistValue")&&_.opentelemetry.proto.common.v1.KeyValueList.encode(i.kvlistValue,u.uint32(50).fork()).ldelim(),i.bytesValue!=null&&Object.hasOwnProperty.call(i,"bytesValue")&&u.uint32(58).bytes(i.bytesValue),u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.common.v1.AnyValue;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.stringValue=i.string();break}case 2:{c.boolValue=i.bool();break}case 3:{c.intValue=i.int64();break}case 4:{c.doubleValue=i.double();break}case 5:{c.arrayValue=_.opentelemetry.proto.common.v1.ArrayValue.decode(i,i.uint32());break}case 6:{c.kvlistValue=_.opentelemetry.proto.common.v1.KeyValueList.decode(i,i.uint32());break}case 7:{c.bytesValue=i.bytes();break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.stringValue!=null&&i.hasOwnProperty("stringValue")&&(u.value=1,!m.isString(i.stringValue)))return"stringValue: string expected";if(i.boolValue!=null&&i.hasOwnProperty("boolValue")){if(u.value===1)return"value: multiple values";if(u.value=1,typeof i.boolValue!="boolean")return"boolValue: boolean expected"}if(i.intValue!=null&&i.hasOwnProperty("intValue")){if(u.value===1)return"value: multiple values";if(u.value=1,!m.isInteger(i.intValue)&&!(i.intValue&&m.isInteger(i.intValue.low)&&m.isInteger(i.intValue.high)))return"intValue: integer|Long expected"}if(i.doubleValue!=null&&i.hasOwnProperty("doubleValue")){if(u.value===1)return"value: multiple values";if(u.value=1,typeof i.doubleValue!="number")return"doubleValue: number expected"}if(i.arrayValue!=null&&i.hasOwnProperty("arrayValue")){if(u.value===1)return"value: multiple values";u.value=1;{var l=_.opentelemetry.proto.common.v1.ArrayValue.verify(i.arrayValue);if(l)return"arrayValue."+l}}if(i.kvlistValue!=null&&i.hasOwnProperty("kvlistValue")){if(u.value===1)return"value: multiple values";u.value=1;{var l=_.opentelemetry.proto.common.v1.KeyValueList.verify(i.kvlistValue);if(l)return"kvlistValue."+l}}if(i.bytesValue!=null&&i.hasOwnProperty("bytesValue")){if(u.value===1)return"value: multiple values";if(u.value=1,!(i.bytesValue&&typeof i.bytesValue.length=="number"||m.isString(i.bytesValue)))return"bytesValue: buffer expected"}return null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.common.v1.AnyValue)return i;var u=new _.opentelemetry.proto.common.v1.AnyValue;if(i.stringValue!=null&&(u.stringValue=String(i.stringValue)),i.boolValue!=null&&(u.boolValue=!!i.boolValue),i.intValue!=null&&(m.Long?(u.intValue=m.Long.fromValue(i.intValue)).unsigned=!1:typeof i.intValue=="string"?u.intValue=parseInt(i.intValue,10):typeof i.intValue=="number"?u.intValue=i.intValue:typeof i.intValue=="object"&&(u.intValue=new m.LongBits(i.intValue.low>>>0,i.intValue.high>>>0).toNumber())),i.doubleValue!=null&&(u.doubleValue=Number(i.doubleValue)),i.arrayValue!=null){if(typeof i.arrayValue!="object")throw TypeError(".opentelemetry.proto.common.v1.AnyValue.arrayValue: object expected");u.arrayValue=_.opentelemetry.proto.common.v1.ArrayValue.fromObject(i.arrayValue)}if(i.kvlistValue!=null){if(typeof i.kvlistValue!="object")throw TypeError(".opentelemetry.proto.common.v1.AnyValue.kvlistValue: object expected");u.kvlistValue=_.opentelemetry.proto.common.v1.KeyValueList.fromObject(i.kvlistValue)}return i.bytesValue!=null&&(typeof i.bytesValue=="string"?m.base64.decode(i.bytesValue,u.bytesValue=m.newBuffer(m.base64.length(i.bytesValue)),0):i.bytesValue.length>=0&&(u.bytesValue=i.bytesValue)),u},s.toObject=function(i,u){u||(u={});var l={};return i.stringValue!=null&&i.hasOwnProperty("stringValue")&&(l.stringValue=i.stringValue,u.oneofs&&(l.value="stringValue")),i.boolValue!=null&&i.hasOwnProperty("boolValue")&&(l.boolValue=i.boolValue,u.oneofs&&(l.value="boolValue")),i.intValue!=null&&i.hasOwnProperty("intValue")&&(typeof i.intValue=="number"?l.intValue=u.longs===String?String(i.intValue):i.intValue:l.intValue=u.longs===String?m.Long.prototype.toString.call(i.intValue):u.longs===Number?new m.LongBits(i.intValue.low>>>0,i.intValue.high>>>0).toNumber():i.intValue,u.oneofs&&(l.value="intValue")),i.doubleValue!=null&&i.hasOwnProperty("doubleValue")&&(l.doubleValue=u.json&&!isFinite(i.doubleValue)?String(i.doubleValue):i.doubleValue,u.oneofs&&(l.value="doubleValue")),i.arrayValue!=null&&i.hasOwnProperty("arrayValue")&&(l.arrayValue=_.opentelemetry.proto.common.v1.ArrayValue.toObject(i.arrayValue,u),u.oneofs&&(l.value="arrayValue")),i.kvlistValue!=null&&i.hasOwnProperty("kvlistValue")&&(l.kvlistValue=_.opentelemetry.proto.common.v1.KeyValueList.toObject(i.kvlistValue,u),u.oneofs&&(l.value="kvlistValue")),i.bytesValue!=null&&i.hasOwnProperty("bytesValue")&&(l.bytesValue=u.bytes===String?m.base64.encode(i.bytesValue,0,i.bytesValue.length):u.bytes===Array?Array.prototype.slice.call(i.bytesValue):i.bytesValue,u.oneofs&&(l.value="bytesValue")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.common.v1.AnyValue"},s})(),n.ArrayValue=(function(){function s(a){if(this.values=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.values=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.values!=null&&o.values.length)for(var u=0;u<o.values.length;++u)_.opentelemetry.proto.common.v1.AnyValue.encode(o.values[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.common.v1.ArrayValue;o.pos<u;){var c=o.uint32();c>>>3===1?(l.values&&l.values.length||(l.values=[]),l.values.push(_.opentelemetry.proto.common.v1.AnyValue.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.values!=null&&o.hasOwnProperty("values")){if(!Array.isArray(o.values))return"values: array expected";for(var i=0;i<o.values.length;++i){var u=_.opentelemetry.proto.common.v1.AnyValue.verify(o.values[i]);if(u)return"values."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.common.v1.ArrayValue)return o;var i=new _.opentelemetry.proto.common.v1.ArrayValue;if(o.values){if(!Array.isArray(o.values))throw TypeError(".opentelemetry.proto.common.v1.ArrayValue.values: array expected");i.values=[];for(var u=0;u<o.values.length;++u){if(typeof o.values[u]!="object")throw TypeError(".opentelemetry.proto.common.v1.ArrayValue.values: object expected");i.values[u]=_.opentelemetry.proto.common.v1.AnyValue.fromObject(o.values[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.values=[]),o.values&&o.values.length){u.values=[];for(var l=0;l<o.values.length;++l)u.values[l]=_.opentelemetry.proto.common.v1.AnyValue.toObject(o.values[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.common.v1.ArrayValue"},s})(),n.KeyValueList=(function(){function s(a){if(this.values=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.values=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.values!=null&&o.values.length)for(var u=0;u<o.values.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.values[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.common.v1.KeyValueList;o.pos<u;){var c=o.uint32();c>>>3===1?(l.values&&l.values.length||(l.values=[]),l.values.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.values!=null&&o.hasOwnProperty("values")){if(!Array.isArray(o.values))return"values: array expected";for(var i=0;i<o.values.length;++i){var u=_.opentelemetry.proto.common.v1.KeyValue.verify(o.values[i]);if(u)return"values."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.common.v1.KeyValueList)return o;var i=new _.opentelemetry.proto.common.v1.KeyValueList;if(o.values){if(!Array.isArray(o.values))throw TypeError(".opentelemetry.proto.common.v1.KeyValueList.values: array expected");i.values=[];for(var u=0;u<o.values.length;++u){if(typeof o.values[u]!="object")throw TypeError(".opentelemetry.proto.common.v1.KeyValueList.values: object expected");i.values[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.values[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.values=[]),o.values&&o.values.length){u.values=[];for(var l=0;l<o.values.length;++l)u.values[l]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.values[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.common.v1.KeyValueList"},s})(),n.KeyValue=(function(){function s(a){if(a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.key=null,s.prototype.value=null,s.create=function(o){return new s(o)},s.encode=function(o,i){return i||(i=ee.create()),o.key!=null&&Object.hasOwnProperty.call(o,"key")&&i.uint32(10).string(o.key),o.value!=null&&Object.hasOwnProperty.call(o,"value")&&_.opentelemetry.proto.common.v1.AnyValue.encode(o.value,i.uint32(18).fork()).ldelim(),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.common.v1.KeyValue;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.key=o.string();break}case 2:{l.value=_.opentelemetry.proto.common.v1.AnyValue.decode(o,o.uint32());break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.key!=null&&o.hasOwnProperty("key")&&!m.isString(o.key))return"key: string expected";if(o.value!=null&&o.hasOwnProperty("value")){var i=_.opentelemetry.proto.common.v1.AnyValue.verify(o.value);if(i)return"value."+i}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.common.v1.KeyValue)return o;var i=new _.opentelemetry.proto.common.v1.KeyValue;if(o.key!=null&&(i.key=String(o.key)),o.value!=null){if(typeof o.value!="object")throw TypeError(".opentelemetry.proto.common.v1.KeyValue.value: object expected");i.value=_.opentelemetry.proto.common.v1.AnyValue.fromObject(o.value)}return i},s.toObject=function(o,i){i||(i={});var u={};return i.defaults&&(u.key="",u.value=null),o.key!=null&&o.hasOwnProperty("key")&&(u.key=o.key),o.value!=null&&o.hasOwnProperty("value")&&(u.value=_.opentelemetry.proto.common.v1.AnyValue.toObject(o.value,i)),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.common.v1.KeyValue"},s})(),n.InstrumentationScope=(function(){function s(a){if(this.attributes=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.name=null,s.prototype.version=null,s.prototype.attributes=m.emptyArray,s.prototype.droppedAttributesCount=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.name!=null&&Object.hasOwnProperty.call(o,"name")&&i.uint32(10).string(o.name),o.version!=null&&Object.hasOwnProperty.call(o,"version")&&i.uint32(18).string(o.version),o.attributes!=null&&o.attributes.length)for(var u=0;u<o.attributes.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.attributes[u],i.uint32(26).fork()).ldelim();return o.droppedAttributesCount!=null&&Object.hasOwnProperty.call(o,"droppedAttributesCount")&&i.uint32(32).uint32(o.droppedAttributesCount),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.common.v1.InstrumentationScope;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.name=o.string();break}case 2:{l.version=o.string();break}case 3:{l.attributes&&l.attributes.length||(l.attributes=[]),l.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()));break}case 4:{l.droppedAttributesCount=o.uint32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.name!=null&&o.hasOwnProperty("name")&&!m.isString(o.name))return"name: string expected";if(o.version!=null&&o.hasOwnProperty("version")&&!m.isString(o.version))return"version: string expected";if(o.attributes!=null&&o.hasOwnProperty("attributes")){if(!Array.isArray(o.attributes))return"attributes: array expected";for(var i=0;i<o.attributes.length;++i){var u=_.opentelemetry.proto.common.v1.KeyValue.verify(o.attributes[i]);if(u)return"attributes."+u}}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(o.droppedAttributesCount)?"droppedAttributesCount: integer expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.common.v1.InstrumentationScope)return o;var i=new _.opentelemetry.proto.common.v1.InstrumentationScope;if(o.name!=null&&(i.name=String(o.name)),o.version!=null&&(i.version=String(o.version)),o.attributes){if(!Array.isArray(o.attributes))throw TypeError(".opentelemetry.proto.common.v1.InstrumentationScope.attributes: array expected");i.attributes=[];for(var u=0;u<o.attributes.length;++u){if(typeof o.attributes[u]!="object")throw TypeError(".opentelemetry.proto.common.v1.InstrumentationScope.attributes: object expected");i.attributes[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.attributes[u])}}return o.droppedAttributesCount!=null&&(i.droppedAttributesCount=o.droppedAttributesCount>>>0),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.attributes=[]),i.defaults&&(u.name="",u.version="",u.droppedAttributesCount=0),o.name!=null&&o.hasOwnProperty("name")&&(u.name=o.name),o.version!=null&&o.hasOwnProperty("version")&&(u.version=o.version),o.attributes&&o.attributes.length){u.attributes=[];for(var l=0;l<o.attributes.length;++l)u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.attributes[l],i)}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&(u.droppedAttributesCount=o.droppedAttributesCount),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.common.v1.InstrumentationScope"},s})(),n})(),r})(),e.resource=(function(){var r={};return r.v1=(function(){var n={};return n.Resource=(function(){function s(a){if(this.attributes=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.attributes=m.emptyArray,s.prototype.droppedAttributesCount=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.attributes!=null&&o.attributes.length)for(var u=0;u<o.attributes.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.attributes[u],i.uint32(10).fork()).ldelim();return o.droppedAttributesCount!=null&&Object.hasOwnProperty.call(o,"droppedAttributesCount")&&i.uint32(16).uint32(o.droppedAttributesCount),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.resource.v1.Resource;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.attributes&&l.attributes.length||(l.attributes=[]),l.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()));break}case 2:{l.droppedAttributesCount=o.uint32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.attributes!=null&&o.hasOwnProperty("attributes")){if(!Array.isArray(o.attributes))return"attributes: array expected";for(var i=0;i<o.attributes.length;++i){var u=_.opentelemetry.proto.common.v1.KeyValue.verify(o.attributes[i]);if(u)return"attributes."+u}}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(o.droppedAttributesCount)?"droppedAttributesCount: integer expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.resource.v1.Resource)return o;var i=new _.opentelemetry.proto.resource.v1.Resource;if(o.attributes){if(!Array.isArray(o.attributes))throw TypeError(".opentelemetry.proto.resource.v1.Resource.attributes: array expected");i.attributes=[];for(var u=0;u<o.attributes.length;++u){if(typeof o.attributes[u]!="object")throw TypeError(".opentelemetry.proto.resource.v1.Resource.attributes: object expected");i.attributes[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.attributes[u])}}return o.droppedAttributesCount!=null&&(i.droppedAttributesCount=o.droppedAttributesCount>>>0),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.attributes=[]),i.defaults&&(u.droppedAttributesCount=0),o.attributes&&o.attributes.length){u.attributes=[];for(var l=0;l<o.attributes.length;++l)u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.attributes[l],i)}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&(u.droppedAttributesCount=o.droppedAttributesCount),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.resource.v1.Resource"},s})(),n})(),r})(),e.trace=(function(){var r={};return r.v1=(function(){var n={};return n.TracesData=(function(){function s(a){if(this.resourceSpans=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resourceSpans=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resourceSpans!=null&&o.resourceSpans.length)for(var u=0;u<o.resourceSpans.length;++u)_.opentelemetry.proto.trace.v1.ResourceSpans.encode(o.resourceSpans[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.trace.v1.TracesData;o.pos<u;){var c=o.uint32();c>>>3===1?(l.resourceSpans&&l.resourceSpans.length||(l.resourceSpans=[]),l.resourceSpans.push(_.opentelemetry.proto.trace.v1.ResourceSpans.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resourceSpans!=null&&o.hasOwnProperty("resourceSpans")){if(!Array.isArray(o.resourceSpans))return"resourceSpans: array expected";for(var i=0;i<o.resourceSpans.length;++i){var u=_.opentelemetry.proto.trace.v1.ResourceSpans.verify(o.resourceSpans[i]);if(u)return"resourceSpans."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.trace.v1.TracesData)return o;var i=new _.opentelemetry.proto.trace.v1.TracesData;if(o.resourceSpans){if(!Array.isArray(o.resourceSpans))throw TypeError(".opentelemetry.proto.trace.v1.TracesData.resourceSpans: array expected");i.resourceSpans=[];for(var u=0;u<o.resourceSpans.length;++u){if(typeof o.resourceSpans[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.TracesData.resourceSpans: object expected");i.resourceSpans[u]=_.opentelemetry.proto.trace.v1.ResourceSpans.fromObject(o.resourceSpans[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.resourceSpans=[]),o.resourceSpans&&o.resourceSpans.length){u.resourceSpans=[];for(var l=0;l<o.resourceSpans.length;++l)u.resourceSpans[l]=_.opentelemetry.proto.trace.v1.ResourceSpans.toObject(o.resourceSpans[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.trace.v1.TracesData"},s})(),n.ResourceSpans=(function(){function s(a){if(this.scopeSpans=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resource=null,s.prototype.scopeSpans=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resource!=null&&Object.hasOwnProperty.call(o,"resource")&&_.opentelemetry.proto.resource.v1.Resource.encode(o.resource,i.uint32(10).fork()).ldelim(),o.scopeSpans!=null&&o.scopeSpans.length)for(var u=0;u<o.scopeSpans.length;++u)_.opentelemetry.proto.trace.v1.ScopeSpans.encode(o.scopeSpans[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.trace.v1.ResourceSpans;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.resource=_.opentelemetry.proto.resource.v1.Resource.decode(o,o.uint32());break}case 2:{l.scopeSpans&&l.scopeSpans.length||(l.scopeSpans=[]),l.scopeSpans.push(_.opentelemetry.proto.trace.v1.ScopeSpans.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resource!=null&&o.hasOwnProperty("resource")){var i=_.opentelemetry.proto.resource.v1.Resource.verify(o.resource);if(i)return"resource."+i}if(o.scopeSpans!=null&&o.hasOwnProperty("scopeSpans")){if(!Array.isArray(o.scopeSpans))return"scopeSpans: array expected";for(var u=0;u<o.scopeSpans.length;++u){var i=_.opentelemetry.proto.trace.v1.ScopeSpans.verify(o.scopeSpans[u]);if(i)return"scopeSpans."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.trace.v1.ResourceSpans)return o;var i=new _.opentelemetry.proto.trace.v1.ResourceSpans;if(o.resource!=null){if(typeof o.resource!="object")throw TypeError(".opentelemetry.proto.trace.v1.ResourceSpans.resource: object expected");i.resource=_.opentelemetry.proto.resource.v1.Resource.fromObject(o.resource)}if(o.scopeSpans){if(!Array.isArray(o.scopeSpans))throw TypeError(".opentelemetry.proto.trace.v1.ResourceSpans.scopeSpans: array expected");i.scopeSpans=[];for(var u=0;u<o.scopeSpans.length;++u){if(typeof o.scopeSpans[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.ResourceSpans.scopeSpans: object expected");i.scopeSpans[u]=_.opentelemetry.proto.trace.v1.ScopeSpans.fromObject(o.scopeSpans[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.scopeSpans=[]),i.defaults&&(u.resource=null,u.schemaUrl=""),o.resource!=null&&o.hasOwnProperty("resource")&&(u.resource=_.opentelemetry.proto.resource.v1.Resource.toObject(o.resource,i)),o.scopeSpans&&o.scopeSpans.length){u.scopeSpans=[];for(var l=0;l<o.scopeSpans.length;++l)u.scopeSpans[l]=_.opentelemetry.proto.trace.v1.ScopeSpans.toObject(o.scopeSpans[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.trace.v1.ResourceSpans"},s})(),n.ScopeSpans=(function(){function s(a){if(this.spans=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.scope=null,s.prototype.spans=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.scope!=null&&Object.hasOwnProperty.call(o,"scope")&&_.opentelemetry.proto.common.v1.InstrumentationScope.encode(o.scope,i.uint32(10).fork()).ldelim(),o.spans!=null&&o.spans.length)for(var u=0;u<o.spans.length;++u)_.opentelemetry.proto.trace.v1.Span.encode(o.spans[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.trace.v1.ScopeSpans;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.decode(o,o.uint32());break}case 2:{l.spans&&l.spans.length||(l.spans=[]),l.spans.push(_.opentelemetry.proto.trace.v1.Span.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.scope!=null&&o.hasOwnProperty("scope")){var i=_.opentelemetry.proto.common.v1.InstrumentationScope.verify(o.scope);if(i)return"scope."+i}if(o.spans!=null&&o.hasOwnProperty("spans")){if(!Array.isArray(o.spans))return"spans: array expected";for(var u=0;u<o.spans.length;++u){var i=_.opentelemetry.proto.trace.v1.Span.verify(o.spans[u]);if(i)return"spans."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.trace.v1.ScopeSpans)return o;var i=new _.opentelemetry.proto.trace.v1.ScopeSpans;if(o.scope!=null){if(typeof o.scope!="object")throw TypeError(".opentelemetry.proto.trace.v1.ScopeSpans.scope: object expected");i.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.fromObject(o.scope)}if(o.spans){if(!Array.isArray(o.spans))throw TypeError(".opentelemetry.proto.trace.v1.ScopeSpans.spans: array expected");i.spans=[];for(var u=0;u<o.spans.length;++u){if(typeof o.spans[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.ScopeSpans.spans: object expected");i.spans[u]=_.opentelemetry.proto.trace.v1.Span.fromObject(o.spans[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.spans=[]),i.defaults&&(u.scope=null,u.schemaUrl=""),o.scope!=null&&o.hasOwnProperty("scope")&&(u.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.toObject(o.scope,i)),o.spans&&o.spans.length){u.spans=[];for(var l=0;l<o.spans.length;++l)u.spans[l]=_.opentelemetry.proto.trace.v1.Span.toObject(o.spans[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.trace.v1.ScopeSpans"},s})(),n.Span=(function(){function s(a){if(this.attributes=[],this.events=[],this.links=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.traceId=null,s.prototype.spanId=null,s.prototype.traceState=null,s.prototype.parentSpanId=null,s.prototype.name=null,s.prototype.kind=null,s.prototype.startTimeUnixNano=null,s.prototype.endTimeUnixNano=null,s.prototype.attributes=m.emptyArray,s.prototype.droppedAttributesCount=null,s.prototype.events=m.emptyArray,s.prototype.droppedEventsCount=null,s.prototype.links=m.emptyArray,s.prototype.droppedLinksCount=null,s.prototype.status=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.traceId!=null&&Object.hasOwnProperty.call(o,"traceId")&&i.uint32(10).bytes(o.traceId),o.spanId!=null&&Object.hasOwnProperty.call(o,"spanId")&&i.uint32(18).bytes(o.spanId),o.traceState!=null&&Object.hasOwnProperty.call(o,"traceState")&&i.uint32(26).string(o.traceState),o.parentSpanId!=null&&Object.hasOwnProperty.call(o,"parentSpanId")&&i.uint32(34).bytes(o.parentSpanId),o.name!=null&&Object.hasOwnProperty.call(o,"name")&&i.uint32(42).string(o.name),o.kind!=null&&Object.hasOwnProperty.call(o,"kind")&&i.uint32(48).int32(o.kind),o.startTimeUnixNano!=null&&Object.hasOwnProperty.call(o,"startTimeUnixNano")&&i.uint32(57).fixed64(o.startTimeUnixNano),o.endTimeUnixNano!=null&&Object.hasOwnProperty.call(o,"endTimeUnixNano")&&i.uint32(65).fixed64(o.endTimeUnixNano),o.attributes!=null&&o.attributes.length)for(var u=0;u<o.attributes.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.attributes[u],i.uint32(74).fork()).ldelim();if(o.droppedAttributesCount!=null&&Object.hasOwnProperty.call(o,"droppedAttributesCount")&&i.uint32(80).uint32(o.droppedAttributesCount),o.events!=null&&o.events.length)for(var u=0;u<o.events.length;++u)_.opentelemetry.proto.trace.v1.Span.Event.encode(o.events[u],i.uint32(90).fork()).ldelim();if(o.droppedEventsCount!=null&&Object.hasOwnProperty.call(o,"droppedEventsCount")&&i.uint32(96).uint32(o.droppedEventsCount),o.links!=null&&o.links.length)for(var u=0;u<o.links.length;++u)_.opentelemetry.proto.trace.v1.Span.Link.encode(o.links[u],i.uint32(106).fork()).ldelim();return o.droppedLinksCount!=null&&Object.hasOwnProperty.call(o,"droppedLinksCount")&&i.uint32(112).uint32(o.droppedLinksCount),o.status!=null&&Object.hasOwnProperty.call(o,"status")&&_.opentelemetry.proto.trace.v1.Status.encode(o.status,i.uint32(122).fork()).ldelim(),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.trace.v1.Span;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.traceId=o.bytes();break}case 2:{l.spanId=o.bytes();break}case 3:{l.traceState=o.string();break}case 4:{l.parentSpanId=o.bytes();break}case 5:{l.name=o.string();break}case 6:{l.kind=o.int32();break}case 7:{l.startTimeUnixNano=o.fixed64();break}case 8:{l.endTimeUnixNano=o.fixed64();break}case 9:{l.attributes&&l.attributes.length||(l.attributes=[]),l.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()));break}case 10:{l.droppedAttributesCount=o.uint32();break}case 11:{l.events&&l.events.length||(l.events=[]),l.events.push(_.opentelemetry.proto.trace.v1.Span.Event.decode(o,o.uint32()));break}case 12:{l.droppedEventsCount=o.uint32();break}case 13:{l.links&&l.links.length||(l.links=[]),l.links.push(_.opentelemetry.proto.trace.v1.Span.Link.decode(o,o.uint32()));break}case 14:{l.droppedLinksCount=o.uint32();break}case 15:{l.status=_.opentelemetry.proto.trace.v1.Status.decode(o,o.uint32());break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.traceId!=null&&o.hasOwnProperty("traceId")&&!(o.traceId&&typeof o.traceId.length=="number"||m.isString(o.traceId)))return"traceId: buffer expected";if(o.spanId!=null&&o.hasOwnProperty("spanId")&&!(o.spanId&&typeof o.spanId.length=="number"||m.isString(o.spanId)))return"spanId: buffer expected";if(o.traceState!=null&&o.hasOwnProperty("traceState")&&!m.isString(o.traceState))return"traceState: string expected";if(o.parentSpanId!=null&&o.hasOwnProperty("parentSpanId")&&!(o.parentSpanId&&typeof o.parentSpanId.length=="number"||m.isString(o.parentSpanId)))return"parentSpanId: buffer expected";if(o.name!=null&&o.hasOwnProperty("name")&&!m.isString(o.name))return"name: string expected";if(o.kind!=null&&o.hasOwnProperty("kind"))switch(o.kind){default:return"kind: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:break}if(o.startTimeUnixNano!=null&&o.hasOwnProperty("startTimeUnixNano")&&!m.isInteger(o.startTimeUnixNano)&&!(o.startTimeUnixNano&&m.isInteger(o.startTimeUnixNano.low)&&m.isInteger(o.startTimeUnixNano.high)))return"startTimeUnixNano: integer|Long expected";if(o.endTimeUnixNano!=null&&o.hasOwnProperty("endTimeUnixNano")&&!m.isInteger(o.endTimeUnixNano)&&!(o.endTimeUnixNano&&m.isInteger(o.endTimeUnixNano.low)&&m.isInteger(o.endTimeUnixNano.high)))return"endTimeUnixNano: integer|Long expected";if(o.attributes!=null&&o.hasOwnProperty("attributes")){if(!Array.isArray(o.attributes))return"attributes: array expected";for(var i=0;i<o.attributes.length;++i){var u=_.opentelemetry.proto.common.v1.KeyValue.verify(o.attributes[i]);if(u)return"attributes."+u}}if(o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(o.droppedAttributesCount))return"droppedAttributesCount: integer expected";if(o.events!=null&&o.hasOwnProperty("events")){if(!Array.isArray(o.events))return"events: array expected";for(var i=0;i<o.events.length;++i){var u=_.opentelemetry.proto.trace.v1.Span.Event.verify(o.events[i]);if(u)return"events."+u}}if(o.droppedEventsCount!=null&&o.hasOwnProperty("droppedEventsCount")&&!m.isInteger(o.droppedEventsCount))return"droppedEventsCount: integer expected";if(o.links!=null&&o.hasOwnProperty("links")){if(!Array.isArray(o.links))return"links: array expected";for(var i=0;i<o.links.length;++i){var u=_.opentelemetry.proto.trace.v1.Span.Link.verify(o.links[i]);if(u)return"links."+u}}if(o.droppedLinksCount!=null&&o.hasOwnProperty("droppedLinksCount")&&!m.isInteger(o.droppedLinksCount))return"droppedLinksCount: integer expected";if(o.status!=null&&o.hasOwnProperty("status")){var u=_.opentelemetry.proto.trace.v1.Status.verify(o.status);if(u)return"status."+u}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.trace.v1.Span)return o;var i=new _.opentelemetry.proto.trace.v1.Span;switch(o.traceId!=null&&(typeof o.traceId=="string"?m.base64.decode(o.traceId,i.traceId=m.newBuffer(m.base64.length(o.traceId)),0):o.traceId.length>=0&&(i.traceId=o.traceId)),o.spanId!=null&&(typeof o.spanId=="string"?m.base64.decode(o.spanId,i.spanId=m.newBuffer(m.base64.length(o.spanId)),0):o.spanId.length>=0&&(i.spanId=o.spanId)),o.traceState!=null&&(i.traceState=String(o.traceState)),o.parentSpanId!=null&&(typeof o.parentSpanId=="string"?m.base64.decode(o.parentSpanId,i.parentSpanId=m.newBuffer(m.base64.length(o.parentSpanId)),0):o.parentSpanId.length>=0&&(i.parentSpanId=o.parentSpanId)),o.name!=null&&(i.name=String(o.name)),o.kind){default:if(typeof o.kind=="number"){i.kind=o.kind;break}break;case"SPAN_KIND_UNSPECIFIED":case 0:i.kind=0;break;case"SPAN_KIND_INTERNAL":case 1:i.kind=1;break;case"SPAN_KIND_SERVER":case 2:i.kind=2;break;case"SPAN_KIND_CLIENT":case 3:i.kind=3;break;case"SPAN_KIND_PRODUCER":case 4:i.kind=4;break;case"SPAN_KIND_CONSUMER":case 5:i.kind=5;break}if(o.startTimeUnixNano!=null&&(m.Long?(i.startTimeUnixNano=m.Long.fromValue(o.startTimeUnixNano)).unsigned=!1:typeof o.startTimeUnixNano=="string"?i.startTimeUnixNano=parseInt(o.startTimeUnixNano,10):typeof o.startTimeUnixNano=="number"?i.startTimeUnixNano=o.startTimeUnixNano:typeof o.startTimeUnixNano=="object"&&(i.startTimeUnixNano=new m.LongBits(o.startTimeUnixNano.low>>>0,o.startTimeUnixNano.high>>>0).toNumber())),o.endTimeUnixNano!=null&&(m.Long?(i.endTimeUnixNano=m.Long.fromValue(o.endTimeUnixNano)).unsigned=!1:typeof o.endTimeUnixNano=="string"?i.endTimeUnixNano=parseInt(o.endTimeUnixNano,10):typeof o.endTimeUnixNano=="number"?i.endTimeUnixNano=o.endTimeUnixNano:typeof o.endTimeUnixNano=="object"&&(i.endTimeUnixNano=new m.LongBits(o.endTimeUnixNano.low>>>0,o.endTimeUnixNano.high>>>0).toNumber())),o.attributes){if(!Array.isArray(o.attributes))throw TypeError(".opentelemetry.proto.trace.v1.Span.attributes: array expected");i.attributes=[];for(var u=0;u<o.attributes.length;++u){if(typeof o.attributes[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.attributes: object expected");i.attributes[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.attributes[u])}}if(o.droppedAttributesCount!=null&&(i.droppedAttributesCount=o.droppedAttributesCount>>>0),o.events){if(!Array.isArray(o.events))throw TypeError(".opentelemetry.proto.trace.v1.Span.events: array expected");i.events=[];for(var u=0;u<o.events.length;++u){if(typeof o.events[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.events: object expected");i.events[u]=_.opentelemetry.proto.trace.v1.Span.Event.fromObject(o.events[u])}}if(o.droppedEventsCount!=null&&(i.droppedEventsCount=o.droppedEventsCount>>>0),o.links){if(!Array.isArray(o.links))throw TypeError(".opentelemetry.proto.trace.v1.Span.links: array expected");i.links=[];for(var u=0;u<o.links.length;++u){if(typeof o.links[u]!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.links: object expected");i.links[u]=_.opentelemetry.proto.trace.v1.Span.Link.fromObject(o.links[u])}}if(o.droppedLinksCount!=null&&(i.droppedLinksCount=o.droppedLinksCount>>>0),o.status!=null){if(typeof o.status!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.status: object expected");i.status=_.opentelemetry.proto.trace.v1.Status.fromObject(o.status)}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.attributes=[],u.events=[],u.links=[]),i.defaults){if(i.bytes===String?u.traceId="":(u.traceId=[],i.bytes!==Array&&(u.traceId=m.newBuffer(u.traceId))),i.bytes===String?u.spanId="":(u.spanId=[],i.bytes!==Array&&(u.spanId=m.newBuffer(u.spanId))),u.traceState="",i.bytes===String?u.parentSpanId="":(u.parentSpanId=[],i.bytes!==Array&&(u.parentSpanId=m.newBuffer(u.parentSpanId))),u.name="",u.kind=i.enums===String?"SPAN_KIND_UNSPECIFIED":0,m.Long){var l=new m.Long(0,0,!1);u.startTimeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.startTimeUnixNano=i.longs===String?"0":0;if(m.Long){var l=new m.Long(0,0,!1);u.endTimeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.endTimeUnixNano=i.longs===String?"0":0;u.droppedAttributesCount=0,u.droppedEventsCount=0,u.droppedLinksCount=0,u.status=null}if(o.traceId!=null&&o.hasOwnProperty("traceId")&&(u.traceId=i.bytes===String?m.base64.encode(o.traceId,0,o.traceId.length):i.bytes===Array?Array.prototype.slice.call(o.traceId):o.traceId),o.spanId!=null&&o.hasOwnProperty("spanId")&&(u.spanId=i.bytes===String?m.base64.encode(o.spanId,0,o.spanId.length):i.bytes===Array?Array.prototype.slice.call(o.spanId):o.spanId),o.traceState!=null&&o.hasOwnProperty("traceState")&&(u.traceState=o.traceState),o.parentSpanId!=null&&o.hasOwnProperty("parentSpanId")&&(u.parentSpanId=i.bytes===String?m.base64.encode(o.parentSpanId,0,o.parentSpanId.length):i.bytes===Array?Array.prototype.slice.call(o.parentSpanId):o.parentSpanId),o.name!=null&&o.hasOwnProperty("name")&&(u.name=o.name),o.kind!=null&&o.hasOwnProperty("kind")&&(u.kind=i.enums===String?_.opentelemetry.proto.trace.v1.Span.SpanKind[o.kind]===void 0?o.kind:_.opentelemetry.proto.trace.v1.Span.SpanKind[o.kind]:o.kind),o.startTimeUnixNano!=null&&o.hasOwnProperty("startTimeUnixNano")&&(typeof o.startTimeUnixNano=="number"?u.startTimeUnixNano=i.longs===String?String(o.startTimeUnixNano):o.startTimeUnixNano:u.startTimeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.startTimeUnixNano):i.longs===Number?new m.LongBits(o.startTimeUnixNano.low>>>0,o.startTimeUnixNano.high>>>0).toNumber():o.startTimeUnixNano),o.endTimeUnixNano!=null&&o.hasOwnProperty("endTimeUnixNano")&&(typeof o.endTimeUnixNano=="number"?u.endTimeUnixNano=i.longs===String?String(o.endTimeUnixNano):o.endTimeUnixNano:u.endTimeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.endTimeUnixNano):i.longs===Number?new m.LongBits(o.endTimeUnixNano.low>>>0,o.endTimeUnixNano.high>>>0).toNumber():o.endTimeUnixNano),o.attributes&&o.attributes.length){u.attributes=[];for(var c=0;c<o.attributes.length;++c)u.attributes[c]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.attributes[c],i)}if(o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&(u.droppedAttributesCount=o.droppedAttributesCount),o.events&&o.events.length){u.events=[];for(var c=0;c<o.events.length;++c)u.events[c]=_.opentelemetry.proto.trace.v1.Span.Event.toObject(o.events[c],i)}if(o.droppedEventsCount!=null&&o.hasOwnProperty("droppedEventsCount")&&(u.droppedEventsCount=o.droppedEventsCount),o.links&&o.links.length){u.links=[];for(var c=0;c<o.links.length;++c)u.links[c]=_.opentelemetry.proto.trace.v1.Span.Link.toObject(o.links[c],i)}return o.droppedLinksCount!=null&&o.hasOwnProperty("droppedLinksCount")&&(u.droppedLinksCount=o.droppedLinksCount),o.status!=null&&o.hasOwnProperty("status")&&(u.status=_.opentelemetry.proto.trace.v1.Status.toObject(o.status,i)),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.trace.v1.Span"},s.SpanKind=(function(){var a={},o=Object.create(a);return o[a[0]="SPAN_KIND_UNSPECIFIED"]=0,o[a[1]="SPAN_KIND_INTERNAL"]=1,o[a[2]="SPAN_KIND_SERVER"]=2,o[a[3]="SPAN_KIND_CLIENT"]=3,o[a[4]="SPAN_KIND_PRODUCER"]=4,o[a[5]="SPAN_KIND_CONSUMER"]=5,o})(),s.Event=(function(){function a(o){if(this.attributes=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.timeUnixNano=null,a.prototype.name=null,a.prototype.attributes=m.emptyArray,a.prototype.droppedAttributesCount=null,a.create=function(i){return new a(i)},a.encode=function(i,u){if(u||(u=ee.create()),i.timeUnixNano!=null&&Object.hasOwnProperty.call(i,"timeUnixNano")&&u.uint32(9).fixed64(i.timeUnixNano),i.name!=null&&Object.hasOwnProperty.call(i,"name")&&u.uint32(18).string(i.name),i.attributes!=null&&i.attributes.length)for(var l=0;l<i.attributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.attributes[l],u.uint32(26).fork()).ldelim();return i.droppedAttributesCount!=null&&Object.hasOwnProperty.call(i,"droppedAttributesCount")&&u.uint32(32).uint32(i.droppedAttributesCount),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.trace.v1.Span.Event;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.timeUnixNano=i.fixed64();break}case 2:{c.name=i.string();break}case 3:{c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 4:{c.droppedAttributesCount=i.uint32();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&!m.isInteger(i.timeUnixNano)&&!(i.timeUnixNano&&m.isInteger(i.timeUnixNano.low)&&m.isInteger(i.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(i.name!=null&&i.hasOwnProperty("name")&&!m.isString(i.name))return"name: string expected";if(i.attributes!=null&&i.hasOwnProperty("attributes")){if(!Array.isArray(i.attributes))return"attributes: array expected";for(var u=0;u<i.attributes.length;++u){var l=_.opentelemetry.proto.common.v1.KeyValue.verify(i.attributes[u]);if(l)return"attributes."+l}}return i.droppedAttributesCount!=null&&i.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(i.droppedAttributesCount)?"droppedAttributesCount: integer expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.trace.v1.Span.Event)return i;var u=new _.opentelemetry.proto.trace.v1.Span.Event;if(i.timeUnixNano!=null&&(m.Long?(u.timeUnixNano=m.Long.fromValue(i.timeUnixNano)).unsigned=!1:typeof i.timeUnixNano=="string"?u.timeUnixNano=parseInt(i.timeUnixNano,10):typeof i.timeUnixNano=="number"?u.timeUnixNano=i.timeUnixNano:typeof i.timeUnixNano=="object"&&(u.timeUnixNano=new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber())),i.name!=null&&(u.name=String(i.name)),i.attributes){if(!Array.isArray(i.attributes))throw TypeError(".opentelemetry.proto.trace.v1.Span.Event.attributes: array expected");u.attributes=[];for(var l=0;l<i.attributes.length;++l){if(typeof i.attributes[l]!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.Event.attributes: object expected");u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.attributes[l])}}return i.droppedAttributesCount!=null&&(u.droppedAttributesCount=i.droppedAttributesCount>>>0),u},a.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.attributes=[]),u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.timeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.timeUnixNano=u.longs===String?"0":0;l.name="",l.droppedAttributesCount=0}if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&(typeof i.timeUnixNano=="number"?l.timeUnixNano=u.longs===String?String(i.timeUnixNano):i.timeUnixNano:l.timeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.timeUnixNano):u.longs===Number?new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber():i.timeUnixNano),i.name!=null&&i.hasOwnProperty("name")&&(l.name=i.name),i.attributes&&i.attributes.length){l.attributes=[];for(var f=0;f<i.attributes.length;++f)l.attributes[f]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.attributes[f],u)}return i.droppedAttributesCount!=null&&i.hasOwnProperty("droppedAttributesCount")&&(l.droppedAttributesCount=i.droppedAttributesCount),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.trace.v1.Span.Event"},a})(),s.Link=(function(){function a(o){if(this.attributes=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.traceId=null,a.prototype.spanId=null,a.prototype.traceState=null,a.prototype.attributes=m.emptyArray,a.prototype.droppedAttributesCount=null,a.create=function(i){return new a(i)},a.encode=function(i,u){if(u||(u=ee.create()),i.traceId!=null&&Object.hasOwnProperty.call(i,"traceId")&&u.uint32(10).bytes(i.traceId),i.spanId!=null&&Object.hasOwnProperty.call(i,"spanId")&&u.uint32(18).bytes(i.spanId),i.traceState!=null&&Object.hasOwnProperty.call(i,"traceState")&&u.uint32(26).string(i.traceState),i.attributes!=null&&i.attributes.length)for(var l=0;l<i.attributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.attributes[l],u.uint32(34).fork()).ldelim();return i.droppedAttributesCount!=null&&Object.hasOwnProperty.call(i,"droppedAttributesCount")&&u.uint32(40).uint32(i.droppedAttributesCount),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.trace.v1.Span.Link;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.traceId=i.bytes();break}case 2:{c.spanId=i.bytes();break}case 3:{c.traceState=i.string();break}case 4:{c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 5:{c.droppedAttributesCount=i.uint32();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.traceId!=null&&i.hasOwnProperty("traceId")&&!(i.traceId&&typeof i.traceId.length=="number"||m.isString(i.traceId)))return"traceId: buffer expected";if(i.spanId!=null&&i.hasOwnProperty("spanId")&&!(i.spanId&&typeof i.spanId.length=="number"||m.isString(i.spanId)))return"spanId: buffer expected";if(i.traceState!=null&&i.hasOwnProperty("traceState")&&!m.isString(i.traceState))return"traceState: string expected";if(i.attributes!=null&&i.hasOwnProperty("attributes")){if(!Array.isArray(i.attributes))return"attributes: array expected";for(var u=0;u<i.attributes.length;++u){var l=_.opentelemetry.proto.common.v1.KeyValue.verify(i.attributes[u]);if(l)return"attributes."+l}}return i.droppedAttributesCount!=null&&i.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(i.droppedAttributesCount)?"droppedAttributesCount: integer expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.trace.v1.Span.Link)return i;var u=new _.opentelemetry.proto.trace.v1.Span.Link;if(i.traceId!=null&&(typeof i.traceId=="string"?m.base64.decode(i.traceId,u.traceId=m.newBuffer(m.base64.length(i.traceId)),0):i.traceId.length>=0&&(u.traceId=i.traceId)),i.spanId!=null&&(typeof i.spanId=="string"?m.base64.decode(i.spanId,u.spanId=m.newBuffer(m.base64.length(i.spanId)),0):i.spanId.length>=0&&(u.spanId=i.spanId)),i.traceState!=null&&(u.traceState=String(i.traceState)),i.attributes){if(!Array.isArray(i.attributes))throw TypeError(".opentelemetry.proto.trace.v1.Span.Link.attributes: array expected");u.attributes=[];for(var l=0;l<i.attributes.length;++l){if(typeof i.attributes[l]!="object")throw TypeError(".opentelemetry.proto.trace.v1.Span.Link.attributes: object expected");u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.attributes[l])}}return i.droppedAttributesCount!=null&&(u.droppedAttributesCount=i.droppedAttributesCount>>>0),u},a.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.attributes=[]),u.defaults&&(u.bytes===String?l.traceId="":(l.traceId=[],u.bytes!==Array&&(l.traceId=m.newBuffer(l.traceId))),u.bytes===String?l.spanId="":(l.spanId=[],u.bytes!==Array&&(l.spanId=m.newBuffer(l.spanId))),l.traceState="",l.droppedAttributesCount=0),i.traceId!=null&&i.hasOwnProperty("traceId")&&(l.traceId=u.bytes===String?m.base64.encode(i.traceId,0,i.traceId.length):u.bytes===Array?Array.prototype.slice.call(i.traceId):i.traceId),i.spanId!=null&&i.hasOwnProperty("spanId")&&(l.spanId=u.bytes===String?m.base64.encode(i.spanId,0,i.spanId.length):u.bytes===Array?Array.prototype.slice.call(i.spanId):i.spanId),i.traceState!=null&&i.hasOwnProperty("traceState")&&(l.traceState=i.traceState),i.attributes&&i.attributes.length){l.attributes=[];for(var c=0;c<i.attributes.length;++c)l.attributes[c]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.attributes[c],u)}return i.droppedAttributesCount!=null&&i.hasOwnProperty("droppedAttributesCount")&&(l.droppedAttributesCount=i.droppedAttributesCount),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.trace.v1.Span.Link"},a})(),s})(),n.Status=(function(){function s(a){if(a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.message=null,s.prototype.code=null,s.create=function(o){return new s(o)},s.encode=function(o,i){return i||(i=ee.create()),o.message!=null&&Object.hasOwnProperty.call(o,"message")&&i.uint32(18).string(o.message),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&i.uint32(24).int32(o.code),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.trace.v1.Status;o.pos<u;){var c=o.uint32();switch(c>>>3){case 2:{l.message=o.string();break}case 3:{l.code=o.int32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.message!=null&&o.hasOwnProperty("message")&&!m.isString(o.message))return"message: string expected";if(o.code!=null&&o.hasOwnProperty("code"))switch(o.code){default:return"code: enum value expected";case 0:case 1:case 2:break}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.trace.v1.Status)return o;var i=new _.opentelemetry.proto.trace.v1.Status;switch(o.message!=null&&(i.message=String(o.message)),o.code){default:if(typeof o.code=="number"){i.code=o.code;break}break;case"STATUS_CODE_UNSET":case 0:i.code=0;break;case"STATUS_CODE_OK":case 1:i.code=1;break;case"STATUS_CODE_ERROR":case 2:i.code=2;break}return i},s.toObject=function(o,i){i||(i={});var u={};return i.defaults&&(u.message="",u.code=i.enums===String?"STATUS_CODE_UNSET":0),o.message!=null&&o.hasOwnProperty("message")&&(u.message=o.message),o.code!=null&&o.hasOwnProperty("code")&&(u.code=i.enums===String?_.opentelemetry.proto.trace.v1.Status.StatusCode[o.code]===void 0?o.code:_.opentelemetry.proto.trace.v1.Status.StatusCode[o.code]:o.code),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.trace.v1.Status"},s.StatusCode=(function(){var a={},o=Object.create(a);return o[a[0]="STATUS_CODE_UNSET"]=0,o[a[1]="STATUS_CODE_OK"]=1,o[a[2]="STATUS_CODE_ERROR"]=2,o})(),s})(),n})(),r})(),e.collector=(function(){var r={};return r.trace=(function(){var n={};return n.v1=(function(){var s={};return s.TraceService=(function(){function a(o,i,u){W.rpc.Service.call(this,o,i,u)}return(a.prototype=Object.create(W.rpc.Service.prototype)).constructor=a,a.create=function(i,u,l){return new this(i,u,l)},Object.defineProperty(a.prototype.export=function o(i,u){return this.rpcCall(o,_.opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest,_.opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse,i,u)},"name",{value:"Export"}),a})(),s.ExportTraceServiceRequest=(function(){function a(o){if(this.resourceSpans=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.resourceSpans=m.emptyArray,a.create=function(i){return new a(i)},a.encode=function(i,u){if(u||(u=ee.create()),i.resourceSpans!=null&&i.resourceSpans.length)for(var l=0;l<i.resourceSpans.length;++l)_.opentelemetry.proto.trace.v1.ResourceSpans.encode(i.resourceSpans[l],u.uint32(10).fork()).ldelim();return u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest;i.pos<l;){var f=i.uint32();f>>>3===1?(c.resourceSpans&&c.resourceSpans.length||(c.resourceSpans=[]),c.resourceSpans.push(_.opentelemetry.proto.trace.v1.ResourceSpans.decode(i,i.uint32()))):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.resourceSpans!=null&&i.hasOwnProperty("resourceSpans")){if(!Array.isArray(i.resourceSpans))return"resourceSpans: array expected";for(var u=0;u<i.resourceSpans.length;++u){var l=_.opentelemetry.proto.trace.v1.ResourceSpans.verify(i.resourceSpans[u]);if(l)return"resourceSpans."+l}}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest)return i;var u=new _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest;if(i.resourceSpans){if(!Array.isArray(i.resourceSpans))throw TypeError(".opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest.resourceSpans: array expected");u.resourceSpans=[];for(var l=0;l<i.resourceSpans.length;++l){if(typeof i.resourceSpans[l]!="object")throw TypeError(".opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest.resourceSpans: object expected");u.resourceSpans[l]=_.opentelemetry.proto.trace.v1.ResourceSpans.fromObject(i.resourceSpans[l])}}return u},a.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.resourceSpans=[]),i.resourceSpans&&i.resourceSpans.length){l.resourceSpans=[];for(var c=0;c<i.resourceSpans.length;++c)l.resourceSpans[c]=_.opentelemetry.proto.trace.v1.ResourceSpans.toObject(i.resourceSpans[c],u)}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest"},a})(),s.ExportTraceServiceResponse=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.partialSuccess=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.partialSuccess!=null&&Object.hasOwnProperty.call(i,"partialSuccess")&&_.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess.encode(i.partialSuccess,u.uint32(10).fork()).ldelim(),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse;i.pos<l;){var f=i.uint32();f>>>3===1?c.partialSuccess=_.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess.decode(i,i.uint32()):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")){var u=_.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess.verify(i.partialSuccess);if(u)return"partialSuccess."+u}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse)return i;var u=new _.opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse;if(i.partialSuccess!=null){if(typeof i.partialSuccess!="object")throw TypeError(".opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse.partialSuccess: object expected");u.partialSuccess=_.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess.fromObject(i.partialSuccess)}return u},a.toObject=function(i,u){u||(u={});var l={};return u.defaults&&(l.partialSuccess=null),i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")&&(l.partialSuccess=_.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess.toObject(i.partialSuccess,u)),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.trace.v1.ExportTraceServiceResponse"},a})(),s.ExportTracePartialSuccess=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.rejectedSpans=null,a.prototype.errorMessage=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.rejectedSpans!=null&&Object.hasOwnProperty.call(i,"rejectedSpans")&&u.uint32(8).int64(i.rejectedSpans),i.errorMessage!=null&&Object.hasOwnProperty.call(i,"errorMessage")&&u.uint32(18).string(i.errorMessage),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.rejectedSpans=i.int64();break}case 2:{c.errorMessage=i.string();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){return typeof i!="object"||i===null?"object expected":i.rejectedSpans!=null&&i.hasOwnProperty("rejectedSpans")&&!m.isInteger(i.rejectedSpans)&&!(i.rejectedSpans&&m.isInteger(i.rejectedSpans.low)&&m.isInteger(i.rejectedSpans.high))?"rejectedSpans: integer|Long expected":i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&!m.isString(i.errorMessage)?"errorMessage: string expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess)return i;var u=new _.opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess;return i.rejectedSpans!=null&&(m.Long?(u.rejectedSpans=m.Long.fromValue(i.rejectedSpans)).unsigned=!1:typeof i.rejectedSpans=="string"?u.rejectedSpans=parseInt(i.rejectedSpans,10):typeof i.rejectedSpans=="number"?u.rejectedSpans=i.rejectedSpans:typeof i.rejectedSpans=="object"&&(u.rejectedSpans=new m.LongBits(i.rejectedSpans.low>>>0,i.rejectedSpans.high>>>0).toNumber())),i.errorMessage!=null&&(u.errorMessage=String(i.errorMessage)),u},a.toObject=function(i,u){u||(u={});var l={};if(u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.rejectedSpans=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.rejectedSpans=u.longs===String?"0":0;l.errorMessage=""}return i.rejectedSpans!=null&&i.hasOwnProperty("rejectedSpans")&&(typeof i.rejectedSpans=="number"?l.rejectedSpans=u.longs===String?String(i.rejectedSpans):i.rejectedSpans:l.rejectedSpans=u.longs===String?m.Long.prototype.toString.call(i.rejectedSpans):u.longs===Number?new m.LongBits(i.rejectedSpans.low>>>0,i.rejectedSpans.high>>>0).toNumber():i.rejectedSpans),i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&(l.errorMessage=i.errorMessage),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.trace.v1.ExportTracePartialSuccess"},a})(),s})(),n})(),r.metrics=(function(){var n={};return n.v1=(function(){var s={};return s.MetricsService=(function(){function a(o,i,u){W.rpc.Service.call(this,o,i,u)}return(a.prototype=Object.create(W.rpc.Service.prototype)).constructor=a,a.create=function(i,u,l){return new this(i,u,l)},Object.defineProperty(a.prototype.export=function o(i,u){return this.rpcCall(o,_.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest,_.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse,i,u)},"name",{value:"Export"}),a})(),s.ExportMetricsServiceRequest=(function(){function a(o){if(this.resourceMetrics=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.resourceMetrics=m.emptyArray,a.create=function(i){return new a(i)},a.encode=function(i,u){if(u||(u=ee.create()),i.resourceMetrics!=null&&i.resourceMetrics.length)for(var l=0;l<i.resourceMetrics.length;++l)_.opentelemetry.proto.metrics.v1.ResourceMetrics.encode(i.resourceMetrics[l],u.uint32(10).fork()).ldelim();return u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest;i.pos<l;){var f=i.uint32();f>>>3===1?(c.resourceMetrics&&c.resourceMetrics.length||(c.resourceMetrics=[]),c.resourceMetrics.push(_.opentelemetry.proto.metrics.v1.ResourceMetrics.decode(i,i.uint32()))):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.resourceMetrics!=null&&i.hasOwnProperty("resourceMetrics")){if(!Array.isArray(i.resourceMetrics))return"resourceMetrics: array expected";for(var u=0;u<i.resourceMetrics.length;++u){var l=_.opentelemetry.proto.metrics.v1.ResourceMetrics.verify(i.resourceMetrics[u]);if(l)return"resourceMetrics."+l}}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest)return i;var u=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest;if(i.resourceMetrics){if(!Array.isArray(i.resourceMetrics))throw TypeError(".opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest.resourceMetrics: array expected");u.resourceMetrics=[];for(var l=0;l<i.resourceMetrics.length;++l){if(typeof i.resourceMetrics[l]!="object")throw TypeError(".opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest.resourceMetrics: object expected");u.resourceMetrics[l]=_.opentelemetry.proto.metrics.v1.ResourceMetrics.fromObject(i.resourceMetrics[l])}}return u},a.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.resourceMetrics=[]),i.resourceMetrics&&i.resourceMetrics.length){l.resourceMetrics=[];for(var c=0;c<i.resourceMetrics.length;++c)l.resourceMetrics[c]=_.opentelemetry.proto.metrics.v1.ResourceMetrics.toObject(i.resourceMetrics[c],u)}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest"},a})(),s.ExportMetricsServiceResponse=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.partialSuccess=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.partialSuccess!=null&&Object.hasOwnProperty.call(i,"partialSuccess")&&_.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess.encode(i.partialSuccess,u.uint32(10).fork()).ldelim(),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse;i.pos<l;){var f=i.uint32();f>>>3===1?c.partialSuccess=_.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess.decode(i,i.uint32()):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")){var u=_.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess.verify(i.partialSuccess);if(u)return"partialSuccess."+u}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse)return i;var u=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse;if(i.partialSuccess!=null){if(typeof i.partialSuccess!="object")throw TypeError(".opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse.partialSuccess: object expected");u.partialSuccess=_.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess.fromObject(i.partialSuccess)}return u},a.toObject=function(i,u){u||(u={});var l={};return u.defaults&&(l.partialSuccess=null),i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")&&(l.partialSuccess=_.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess.toObject(i.partialSuccess,u)),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceResponse"},a})(),s.ExportMetricsPartialSuccess=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.rejectedDataPoints=null,a.prototype.errorMessage=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.rejectedDataPoints!=null&&Object.hasOwnProperty.call(i,"rejectedDataPoints")&&u.uint32(8).int64(i.rejectedDataPoints),i.errorMessage!=null&&Object.hasOwnProperty.call(i,"errorMessage")&&u.uint32(18).string(i.errorMessage),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.rejectedDataPoints=i.int64();break}case 2:{c.errorMessage=i.string();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){return typeof i!="object"||i===null?"object expected":i.rejectedDataPoints!=null&&i.hasOwnProperty("rejectedDataPoints")&&!m.isInteger(i.rejectedDataPoints)&&!(i.rejectedDataPoints&&m.isInteger(i.rejectedDataPoints.low)&&m.isInteger(i.rejectedDataPoints.high))?"rejectedDataPoints: integer|Long expected":i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&!m.isString(i.errorMessage)?"errorMessage: string expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess)return i;var u=new _.opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess;return i.rejectedDataPoints!=null&&(m.Long?(u.rejectedDataPoints=m.Long.fromValue(i.rejectedDataPoints)).unsigned=!1:typeof i.rejectedDataPoints=="string"?u.rejectedDataPoints=parseInt(i.rejectedDataPoints,10):typeof i.rejectedDataPoints=="number"?u.rejectedDataPoints=i.rejectedDataPoints:typeof i.rejectedDataPoints=="object"&&(u.rejectedDataPoints=new m.LongBits(i.rejectedDataPoints.low>>>0,i.rejectedDataPoints.high>>>0).toNumber())),i.errorMessage!=null&&(u.errorMessage=String(i.errorMessage)),u},a.toObject=function(i,u){u||(u={});var l={};if(u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.rejectedDataPoints=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.rejectedDataPoints=u.longs===String?"0":0;l.errorMessage=""}return i.rejectedDataPoints!=null&&i.hasOwnProperty("rejectedDataPoints")&&(typeof i.rejectedDataPoints=="number"?l.rejectedDataPoints=u.longs===String?String(i.rejectedDataPoints):i.rejectedDataPoints:l.rejectedDataPoints=u.longs===String?m.Long.prototype.toString.call(i.rejectedDataPoints):u.longs===Number?new m.LongBits(i.rejectedDataPoints.low>>>0,i.rejectedDataPoints.high>>>0).toNumber():i.rejectedDataPoints),i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&(l.errorMessage=i.errorMessage),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.metrics.v1.ExportMetricsPartialSuccess"},a})(),s})(),n})(),r.logs=(function(){var n={};return n.v1=(function(){var s={};return s.LogsService=(function(){function a(o,i,u){W.rpc.Service.call(this,o,i,u)}return(a.prototype=Object.create(W.rpc.Service.prototype)).constructor=a,a.create=function(i,u,l){return new this(i,u,l)},Object.defineProperty(a.prototype.export=function o(i,u){return this.rpcCall(o,_.opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest,_.opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse,i,u)},"name",{value:"Export"}),a})(),s.ExportLogsServiceRequest=(function(){function a(o){if(this.resourceLogs=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.resourceLogs=m.emptyArray,a.create=function(i){return new a(i)},a.encode=function(i,u){if(u||(u=ee.create()),i.resourceLogs!=null&&i.resourceLogs.length)for(var l=0;l<i.resourceLogs.length;++l)_.opentelemetry.proto.logs.v1.ResourceLogs.encode(i.resourceLogs[l],u.uint32(10).fork()).ldelim();return u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest;i.pos<l;){var f=i.uint32();f>>>3===1?(c.resourceLogs&&c.resourceLogs.length||(c.resourceLogs=[]),c.resourceLogs.push(_.opentelemetry.proto.logs.v1.ResourceLogs.decode(i,i.uint32()))):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.resourceLogs!=null&&i.hasOwnProperty("resourceLogs")){if(!Array.isArray(i.resourceLogs))return"resourceLogs: array expected";for(var u=0;u<i.resourceLogs.length;++u){var l=_.opentelemetry.proto.logs.v1.ResourceLogs.verify(i.resourceLogs[u]);if(l)return"resourceLogs."+l}}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest)return i;var u=new _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest;if(i.resourceLogs){if(!Array.isArray(i.resourceLogs))throw TypeError(".opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest.resourceLogs: array expected");u.resourceLogs=[];for(var l=0;l<i.resourceLogs.length;++l){if(typeof i.resourceLogs[l]!="object")throw TypeError(".opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest.resourceLogs: object expected");u.resourceLogs[l]=_.opentelemetry.proto.logs.v1.ResourceLogs.fromObject(i.resourceLogs[l])}}return u},a.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.resourceLogs=[]),i.resourceLogs&&i.resourceLogs.length){l.resourceLogs=[];for(var c=0;c<i.resourceLogs.length;++c)l.resourceLogs[c]=_.opentelemetry.proto.logs.v1.ResourceLogs.toObject(i.resourceLogs[c],u)}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest"},a})(),s.ExportLogsServiceResponse=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.partialSuccess=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.partialSuccess!=null&&Object.hasOwnProperty.call(i,"partialSuccess")&&_.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess.encode(i.partialSuccess,u.uint32(10).fork()).ldelim(),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse;i.pos<l;){var f=i.uint32();f>>>3===1?c.partialSuccess=_.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess.decode(i,i.uint32()):i.skipType(f&7)}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){if(typeof i!="object"||i===null)return"object expected";if(i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")){var u=_.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess.verify(i.partialSuccess);if(u)return"partialSuccess."+u}return null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse)return i;var u=new _.opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse;if(i.partialSuccess!=null){if(typeof i.partialSuccess!="object")throw TypeError(".opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse.partialSuccess: object expected");u.partialSuccess=_.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess.fromObject(i.partialSuccess)}return u},a.toObject=function(i,u){u||(u={});var l={};return u.defaults&&(l.partialSuccess=null),i.partialSuccess!=null&&i.hasOwnProperty("partialSuccess")&&(l.partialSuccess=_.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess.toObject(i.partialSuccess,u)),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.logs.v1.ExportLogsServiceResponse"},a})(),s.ExportLogsPartialSuccess=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.rejectedLogRecords=null,a.prototype.errorMessage=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.rejectedLogRecords!=null&&Object.hasOwnProperty.call(i,"rejectedLogRecords")&&u.uint32(8).int64(i.rejectedLogRecords),i.errorMessage!=null&&Object.hasOwnProperty.call(i,"errorMessage")&&u.uint32(18).string(i.errorMessage),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.rejectedLogRecords=i.int64();break}case 2:{c.errorMessage=i.string();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){return typeof i!="object"||i===null?"object expected":i.rejectedLogRecords!=null&&i.hasOwnProperty("rejectedLogRecords")&&!m.isInteger(i.rejectedLogRecords)&&!(i.rejectedLogRecords&&m.isInteger(i.rejectedLogRecords.low)&&m.isInteger(i.rejectedLogRecords.high))?"rejectedLogRecords: integer|Long expected":i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&!m.isString(i.errorMessage)?"errorMessage: string expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess)return i;var u=new _.opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess;return i.rejectedLogRecords!=null&&(m.Long?(u.rejectedLogRecords=m.Long.fromValue(i.rejectedLogRecords)).unsigned=!1:typeof i.rejectedLogRecords=="string"?u.rejectedLogRecords=parseInt(i.rejectedLogRecords,10):typeof i.rejectedLogRecords=="number"?u.rejectedLogRecords=i.rejectedLogRecords:typeof i.rejectedLogRecords=="object"&&(u.rejectedLogRecords=new m.LongBits(i.rejectedLogRecords.low>>>0,i.rejectedLogRecords.high>>>0).toNumber())),i.errorMessage!=null&&(u.errorMessage=String(i.errorMessage)),u},a.toObject=function(i,u){u||(u={});var l={};if(u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.rejectedLogRecords=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.rejectedLogRecords=u.longs===String?"0":0;l.errorMessage=""}return i.rejectedLogRecords!=null&&i.hasOwnProperty("rejectedLogRecords")&&(typeof i.rejectedLogRecords=="number"?l.rejectedLogRecords=u.longs===String?String(i.rejectedLogRecords):i.rejectedLogRecords:l.rejectedLogRecords=u.longs===String?m.Long.prototype.toString.call(i.rejectedLogRecords):u.longs===Number?new m.LongBits(i.rejectedLogRecords.low>>>0,i.rejectedLogRecords.high>>>0).toNumber():i.rejectedLogRecords),i.errorMessage!=null&&i.hasOwnProperty("errorMessage")&&(l.errorMessage=i.errorMessage),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.collector.logs.v1.ExportLogsPartialSuccess"},a})(),s})(),n})(),r})(),e.metrics=(function(){var r={};return r.v1=(function(){var n={};return n.MetricsData=(function(){function s(a){if(this.resourceMetrics=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resourceMetrics=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resourceMetrics!=null&&o.resourceMetrics.length)for(var u=0;u<o.resourceMetrics.length;++u)_.opentelemetry.proto.metrics.v1.ResourceMetrics.encode(o.resourceMetrics[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.MetricsData;o.pos<u;){var c=o.uint32();c>>>3===1?(l.resourceMetrics&&l.resourceMetrics.length||(l.resourceMetrics=[]),l.resourceMetrics.push(_.opentelemetry.proto.metrics.v1.ResourceMetrics.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resourceMetrics!=null&&o.hasOwnProperty("resourceMetrics")){if(!Array.isArray(o.resourceMetrics))return"resourceMetrics: array expected";for(var i=0;i<o.resourceMetrics.length;++i){var u=_.opentelemetry.proto.metrics.v1.ResourceMetrics.verify(o.resourceMetrics[i]);if(u)return"resourceMetrics."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.MetricsData)return o;var i=new _.opentelemetry.proto.metrics.v1.MetricsData;if(o.resourceMetrics){if(!Array.isArray(o.resourceMetrics))throw TypeError(".opentelemetry.proto.metrics.v1.MetricsData.resourceMetrics: array expected");i.resourceMetrics=[];for(var u=0;u<o.resourceMetrics.length;++u){if(typeof o.resourceMetrics[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.MetricsData.resourceMetrics: object expected");i.resourceMetrics[u]=_.opentelemetry.proto.metrics.v1.ResourceMetrics.fromObject(o.resourceMetrics[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.resourceMetrics=[]),o.resourceMetrics&&o.resourceMetrics.length){u.resourceMetrics=[];for(var l=0;l<o.resourceMetrics.length;++l)u.resourceMetrics[l]=_.opentelemetry.proto.metrics.v1.ResourceMetrics.toObject(o.resourceMetrics[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.MetricsData"},s})(),n.ResourceMetrics=(function(){function s(a){if(this.scopeMetrics=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resource=null,s.prototype.scopeMetrics=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resource!=null&&Object.hasOwnProperty.call(o,"resource")&&_.opentelemetry.proto.resource.v1.Resource.encode(o.resource,i.uint32(10).fork()).ldelim(),o.scopeMetrics!=null&&o.scopeMetrics.length)for(var u=0;u<o.scopeMetrics.length;++u)_.opentelemetry.proto.metrics.v1.ScopeMetrics.encode(o.scopeMetrics[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.ResourceMetrics;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.resource=_.opentelemetry.proto.resource.v1.Resource.decode(o,o.uint32());break}case 2:{l.scopeMetrics&&l.scopeMetrics.length||(l.scopeMetrics=[]),l.scopeMetrics.push(_.opentelemetry.proto.metrics.v1.ScopeMetrics.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resource!=null&&o.hasOwnProperty("resource")){var i=_.opentelemetry.proto.resource.v1.Resource.verify(o.resource);if(i)return"resource."+i}if(o.scopeMetrics!=null&&o.hasOwnProperty("scopeMetrics")){if(!Array.isArray(o.scopeMetrics))return"scopeMetrics: array expected";for(var u=0;u<o.scopeMetrics.length;++u){var i=_.opentelemetry.proto.metrics.v1.ScopeMetrics.verify(o.scopeMetrics[u]);if(i)return"scopeMetrics."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.ResourceMetrics)return o;var i=new _.opentelemetry.proto.metrics.v1.ResourceMetrics;if(o.resource!=null){if(typeof o.resource!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ResourceMetrics.resource: object expected");i.resource=_.opentelemetry.proto.resource.v1.Resource.fromObject(o.resource)}if(o.scopeMetrics){if(!Array.isArray(o.scopeMetrics))throw TypeError(".opentelemetry.proto.metrics.v1.ResourceMetrics.scopeMetrics: array expected");i.scopeMetrics=[];for(var u=0;u<o.scopeMetrics.length;++u){if(typeof o.scopeMetrics[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ResourceMetrics.scopeMetrics: object expected");i.scopeMetrics[u]=_.opentelemetry.proto.metrics.v1.ScopeMetrics.fromObject(o.scopeMetrics[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.scopeMetrics=[]),i.defaults&&(u.resource=null,u.schemaUrl=""),o.resource!=null&&o.hasOwnProperty("resource")&&(u.resource=_.opentelemetry.proto.resource.v1.Resource.toObject(o.resource,i)),o.scopeMetrics&&o.scopeMetrics.length){u.scopeMetrics=[];for(var l=0;l<o.scopeMetrics.length;++l)u.scopeMetrics[l]=_.opentelemetry.proto.metrics.v1.ScopeMetrics.toObject(o.scopeMetrics[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.ResourceMetrics"},s})(),n.ScopeMetrics=(function(){function s(a){if(this.metrics=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.scope=null,s.prototype.metrics=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.scope!=null&&Object.hasOwnProperty.call(o,"scope")&&_.opentelemetry.proto.common.v1.InstrumentationScope.encode(o.scope,i.uint32(10).fork()).ldelim(),o.metrics!=null&&o.metrics.length)for(var u=0;u<o.metrics.length;++u)_.opentelemetry.proto.metrics.v1.Metric.encode(o.metrics[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.ScopeMetrics;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.decode(o,o.uint32());break}case 2:{l.metrics&&l.metrics.length||(l.metrics=[]),l.metrics.push(_.opentelemetry.proto.metrics.v1.Metric.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.scope!=null&&o.hasOwnProperty("scope")){var i=_.opentelemetry.proto.common.v1.InstrumentationScope.verify(o.scope);if(i)return"scope."+i}if(o.metrics!=null&&o.hasOwnProperty("metrics")){if(!Array.isArray(o.metrics))return"metrics: array expected";for(var u=0;u<o.metrics.length;++u){var i=_.opentelemetry.proto.metrics.v1.Metric.verify(o.metrics[u]);if(i)return"metrics."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.ScopeMetrics)return o;var i=new _.opentelemetry.proto.metrics.v1.ScopeMetrics;if(o.scope!=null){if(typeof o.scope!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ScopeMetrics.scope: object expected");i.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.fromObject(o.scope)}if(o.metrics){if(!Array.isArray(o.metrics))throw TypeError(".opentelemetry.proto.metrics.v1.ScopeMetrics.metrics: array expected");i.metrics=[];for(var u=0;u<o.metrics.length;++u){if(typeof o.metrics[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ScopeMetrics.metrics: object expected");i.metrics[u]=_.opentelemetry.proto.metrics.v1.Metric.fromObject(o.metrics[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.metrics=[]),i.defaults&&(u.scope=null,u.schemaUrl=""),o.scope!=null&&o.hasOwnProperty("scope")&&(u.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.toObject(o.scope,i)),o.metrics&&o.metrics.length){u.metrics=[];for(var l=0;l<o.metrics.length;++l)u.metrics[l]=_.opentelemetry.proto.metrics.v1.Metric.toObject(o.metrics[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.ScopeMetrics"},s})(),n.Metric=(function(){function s(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.name=null,s.prototype.description=null,s.prototype.unit=null,s.prototype.gauge=null,s.prototype.sum=null,s.prototype.histogram=null,s.prototype.exponentialHistogram=null,s.prototype.summary=null;var a;return Object.defineProperty(s.prototype,"data",{get:m.oneOfGetter(a=["gauge","sum","histogram","exponentialHistogram","summary"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){return u||(u=ee.create()),i.name!=null&&Object.hasOwnProperty.call(i,"name")&&u.uint32(10).string(i.name),i.description!=null&&Object.hasOwnProperty.call(i,"description")&&u.uint32(18).string(i.description),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&u.uint32(26).string(i.unit),i.gauge!=null&&Object.hasOwnProperty.call(i,"gauge")&&_.opentelemetry.proto.metrics.v1.Gauge.encode(i.gauge,u.uint32(42).fork()).ldelim(),i.sum!=null&&Object.hasOwnProperty.call(i,"sum")&&_.opentelemetry.proto.metrics.v1.Sum.encode(i.sum,u.uint32(58).fork()).ldelim(),i.histogram!=null&&Object.hasOwnProperty.call(i,"histogram")&&_.opentelemetry.proto.metrics.v1.Histogram.encode(i.histogram,u.uint32(74).fork()).ldelim(),i.exponentialHistogram!=null&&Object.hasOwnProperty.call(i,"exponentialHistogram")&&_.opentelemetry.proto.metrics.v1.ExponentialHistogram.encode(i.exponentialHistogram,u.uint32(82).fork()).ldelim(),i.summary!=null&&Object.hasOwnProperty.call(i,"summary")&&_.opentelemetry.proto.metrics.v1.Summary.encode(i.summary,u.uint32(90).fork()).ldelim(),u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.Metric;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.name=i.string();break}case 2:{c.description=i.string();break}case 3:{c.unit=i.string();break}case 5:{c.gauge=_.opentelemetry.proto.metrics.v1.Gauge.decode(i,i.uint32());break}case 7:{c.sum=_.opentelemetry.proto.metrics.v1.Sum.decode(i,i.uint32());break}case 9:{c.histogram=_.opentelemetry.proto.metrics.v1.Histogram.decode(i,i.uint32());break}case 10:{c.exponentialHistogram=_.opentelemetry.proto.metrics.v1.ExponentialHistogram.decode(i,i.uint32());break}case 11:{c.summary=_.opentelemetry.proto.metrics.v1.Summary.decode(i,i.uint32());break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.name!=null&&i.hasOwnProperty("name")&&!m.isString(i.name))return"name: string expected";if(i.description!=null&&i.hasOwnProperty("description")&&!m.isString(i.description))return"description: string expected";if(i.unit!=null&&i.hasOwnProperty("unit")&&!m.isString(i.unit))return"unit: string expected";if(i.gauge!=null&&i.hasOwnProperty("gauge")){u.data=1;{var l=_.opentelemetry.proto.metrics.v1.Gauge.verify(i.gauge);if(l)return"gauge."+l}}if(i.sum!=null&&i.hasOwnProperty("sum")){if(u.data===1)return"data: multiple values";u.data=1;{var l=_.opentelemetry.proto.metrics.v1.Sum.verify(i.sum);if(l)return"sum."+l}}if(i.histogram!=null&&i.hasOwnProperty("histogram")){if(u.data===1)return"data: multiple values";u.data=1;{var l=_.opentelemetry.proto.metrics.v1.Histogram.verify(i.histogram);if(l)return"histogram."+l}}if(i.exponentialHistogram!=null&&i.hasOwnProperty("exponentialHistogram")){if(u.data===1)return"data: multiple values";u.data=1;{var l=_.opentelemetry.proto.metrics.v1.ExponentialHistogram.verify(i.exponentialHistogram);if(l)return"exponentialHistogram."+l}}if(i.summary!=null&&i.hasOwnProperty("summary")){if(u.data===1)return"data: multiple values";u.data=1;{var l=_.opentelemetry.proto.metrics.v1.Summary.verify(i.summary);if(l)return"summary."+l}}return null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.Metric)return i;var u=new _.opentelemetry.proto.metrics.v1.Metric;if(i.name!=null&&(u.name=String(i.name)),i.description!=null&&(u.description=String(i.description)),i.unit!=null&&(u.unit=String(i.unit)),i.gauge!=null){if(typeof i.gauge!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Metric.gauge: object expected");u.gauge=_.opentelemetry.proto.metrics.v1.Gauge.fromObject(i.gauge)}if(i.sum!=null){if(typeof i.sum!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Metric.sum: object expected");u.sum=_.opentelemetry.proto.metrics.v1.Sum.fromObject(i.sum)}if(i.histogram!=null){if(typeof i.histogram!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Metric.histogram: object expected");u.histogram=_.opentelemetry.proto.metrics.v1.Histogram.fromObject(i.histogram)}if(i.exponentialHistogram!=null){if(typeof i.exponentialHistogram!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Metric.exponentialHistogram: object expected");u.exponentialHistogram=_.opentelemetry.proto.metrics.v1.ExponentialHistogram.fromObject(i.exponentialHistogram)}if(i.summary!=null){if(typeof i.summary!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Metric.summary: object expected");u.summary=_.opentelemetry.proto.metrics.v1.Summary.fromObject(i.summary)}return u},s.toObject=function(i,u){u||(u={});var l={};return u.defaults&&(l.name="",l.description="",l.unit=""),i.name!=null&&i.hasOwnProperty("name")&&(l.name=i.name),i.description!=null&&i.hasOwnProperty("description")&&(l.description=i.description),i.unit!=null&&i.hasOwnProperty("unit")&&(l.unit=i.unit),i.gauge!=null&&i.hasOwnProperty("gauge")&&(l.gauge=_.opentelemetry.proto.metrics.v1.Gauge.toObject(i.gauge,u),u.oneofs&&(l.data="gauge")),i.sum!=null&&i.hasOwnProperty("sum")&&(l.sum=_.opentelemetry.proto.metrics.v1.Sum.toObject(i.sum,u),u.oneofs&&(l.data="sum")),i.histogram!=null&&i.hasOwnProperty("histogram")&&(l.histogram=_.opentelemetry.proto.metrics.v1.Histogram.toObject(i.histogram,u),u.oneofs&&(l.data="histogram")),i.exponentialHistogram!=null&&i.hasOwnProperty("exponentialHistogram")&&(l.exponentialHistogram=_.opentelemetry.proto.metrics.v1.ExponentialHistogram.toObject(i.exponentialHistogram,u),u.oneofs&&(l.data="exponentialHistogram")),i.summary!=null&&i.hasOwnProperty("summary")&&(l.summary=_.opentelemetry.proto.metrics.v1.Summary.toObject(i.summary,u),u.oneofs&&(l.data="summary")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.Metric"},s})(),n.Gauge=(function(){function s(a){if(this.dataPoints=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.dataPoints=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.dataPoints!=null&&o.dataPoints.length)for(var u=0;u<o.dataPoints.length;++u)_.opentelemetry.proto.metrics.v1.NumberDataPoint.encode(o.dataPoints[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.Gauge;o.pos<u;){var c=o.uint32();c>>>3===1?(l.dataPoints&&l.dataPoints.length||(l.dataPoints=[]),l.dataPoints.push(_.opentelemetry.proto.metrics.v1.NumberDataPoint.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.dataPoints!=null&&o.hasOwnProperty("dataPoints")){if(!Array.isArray(o.dataPoints))return"dataPoints: array expected";for(var i=0;i<o.dataPoints.length;++i){var u=_.opentelemetry.proto.metrics.v1.NumberDataPoint.verify(o.dataPoints[i]);if(u)return"dataPoints."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.Gauge)return o;var i=new _.opentelemetry.proto.metrics.v1.Gauge;if(o.dataPoints){if(!Array.isArray(o.dataPoints))throw TypeError(".opentelemetry.proto.metrics.v1.Gauge.dataPoints: array expected");i.dataPoints=[];for(var u=0;u<o.dataPoints.length;++u){if(typeof o.dataPoints[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Gauge.dataPoints: object expected");i.dataPoints[u]=_.opentelemetry.proto.metrics.v1.NumberDataPoint.fromObject(o.dataPoints[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.dataPoints=[]),o.dataPoints&&o.dataPoints.length){u.dataPoints=[];for(var l=0;l<o.dataPoints.length;++l)u.dataPoints[l]=_.opentelemetry.proto.metrics.v1.NumberDataPoint.toObject(o.dataPoints[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.Gauge"},s})(),n.Sum=(function(){function s(a){if(this.dataPoints=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.dataPoints=m.emptyArray,s.prototype.aggregationTemporality=null,s.prototype.isMonotonic=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.dataPoints!=null&&o.dataPoints.length)for(var u=0;u<o.dataPoints.length;++u)_.opentelemetry.proto.metrics.v1.NumberDataPoint.encode(o.dataPoints[u],i.uint32(10).fork()).ldelim();return o.aggregationTemporality!=null&&Object.hasOwnProperty.call(o,"aggregationTemporality")&&i.uint32(16).int32(o.aggregationTemporality),o.isMonotonic!=null&&Object.hasOwnProperty.call(o,"isMonotonic")&&i.uint32(24).bool(o.isMonotonic),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.Sum;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.dataPoints&&l.dataPoints.length||(l.dataPoints=[]),l.dataPoints.push(_.opentelemetry.proto.metrics.v1.NumberDataPoint.decode(o,o.uint32()));break}case 2:{l.aggregationTemporality=o.int32();break}case 3:{l.isMonotonic=o.bool();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.dataPoints!=null&&o.hasOwnProperty("dataPoints")){if(!Array.isArray(o.dataPoints))return"dataPoints: array expected";for(var i=0;i<o.dataPoints.length;++i){var u=_.opentelemetry.proto.metrics.v1.NumberDataPoint.verify(o.dataPoints[i]);if(u)return"dataPoints."+u}}if(o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality"))switch(o.aggregationTemporality){default:return"aggregationTemporality: enum value expected";case 0:case 1:case 2:break}return o.isMonotonic!=null&&o.hasOwnProperty("isMonotonic")&&typeof o.isMonotonic!="boolean"?"isMonotonic: boolean expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.Sum)return o;var i=new _.opentelemetry.proto.metrics.v1.Sum;if(o.dataPoints){if(!Array.isArray(o.dataPoints))throw TypeError(".opentelemetry.proto.metrics.v1.Sum.dataPoints: array expected");i.dataPoints=[];for(var u=0;u<o.dataPoints.length;++u){if(typeof o.dataPoints[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Sum.dataPoints: object expected");i.dataPoints[u]=_.opentelemetry.proto.metrics.v1.NumberDataPoint.fromObject(o.dataPoints[u])}}switch(o.aggregationTemporality){default:if(typeof o.aggregationTemporality=="number"){i.aggregationTemporality=o.aggregationTemporality;break}break;case"AGGREGATION_TEMPORALITY_UNSPECIFIED":case 0:i.aggregationTemporality=0;break;case"AGGREGATION_TEMPORALITY_DELTA":case 1:i.aggregationTemporality=1;break;case"AGGREGATION_TEMPORALITY_CUMULATIVE":case 2:i.aggregationTemporality=2;break}return o.isMonotonic!=null&&(i.isMonotonic=!!o.isMonotonic),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.dataPoints=[]),i.defaults&&(u.aggregationTemporality=i.enums===String?"AGGREGATION_TEMPORALITY_UNSPECIFIED":0,u.isMonotonic=!1),o.dataPoints&&o.dataPoints.length){u.dataPoints=[];for(var l=0;l<o.dataPoints.length;++l)u.dataPoints[l]=_.opentelemetry.proto.metrics.v1.NumberDataPoint.toObject(o.dataPoints[l],i)}return o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality")&&(u.aggregationTemporality=i.enums===String?_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]===void 0?o.aggregationTemporality:_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]:o.aggregationTemporality),o.isMonotonic!=null&&o.hasOwnProperty("isMonotonic")&&(u.isMonotonic=o.isMonotonic),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.Sum"},s})(),n.Histogram=(function(){function s(a){if(this.dataPoints=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.dataPoints=m.emptyArray,s.prototype.aggregationTemporality=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.dataPoints!=null&&o.dataPoints.length)for(var u=0;u<o.dataPoints.length;++u)_.opentelemetry.proto.metrics.v1.HistogramDataPoint.encode(o.dataPoints[u],i.uint32(10).fork()).ldelim();return o.aggregationTemporality!=null&&Object.hasOwnProperty.call(o,"aggregationTemporality")&&i.uint32(16).int32(o.aggregationTemporality),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.Histogram;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.dataPoints&&l.dataPoints.length||(l.dataPoints=[]),l.dataPoints.push(_.opentelemetry.proto.metrics.v1.HistogramDataPoint.decode(o,o.uint32()));break}case 2:{l.aggregationTemporality=o.int32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.dataPoints!=null&&o.hasOwnProperty("dataPoints")){if(!Array.isArray(o.dataPoints))return"dataPoints: array expected";for(var i=0;i<o.dataPoints.length;++i){var u=_.opentelemetry.proto.metrics.v1.HistogramDataPoint.verify(o.dataPoints[i]);if(u)return"dataPoints."+u}}if(o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality"))switch(o.aggregationTemporality){default:return"aggregationTemporality: enum value expected";case 0:case 1:case 2:break}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.Histogram)return o;var i=new _.opentelemetry.proto.metrics.v1.Histogram;if(o.dataPoints){if(!Array.isArray(o.dataPoints))throw TypeError(".opentelemetry.proto.metrics.v1.Histogram.dataPoints: array expected");i.dataPoints=[];for(var u=0;u<o.dataPoints.length;++u){if(typeof o.dataPoints[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Histogram.dataPoints: object expected");i.dataPoints[u]=_.opentelemetry.proto.metrics.v1.HistogramDataPoint.fromObject(o.dataPoints[u])}}switch(o.aggregationTemporality){default:if(typeof o.aggregationTemporality=="number"){i.aggregationTemporality=o.aggregationTemporality;break}break;case"AGGREGATION_TEMPORALITY_UNSPECIFIED":case 0:i.aggregationTemporality=0;break;case"AGGREGATION_TEMPORALITY_DELTA":case 1:i.aggregationTemporality=1;break;case"AGGREGATION_TEMPORALITY_CUMULATIVE":case 2:i.aggregationTemporality=2;break}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.dataPoints=[]),i.defaults&&(u.aggregationTemporality=i.enums===String?"AGGREGATION_TEMPORALITY_UNSPECIFIED":0),o.dataPoints&&o.dataPoints.length){u.dataPoints=[];for(var l=0;l<o.dataPoints.length;++l)u.dataPoints[l]=_.opentelemetry.proto.metrics.v1.HistogramDataPoint.toObject(o.dataPoints[l],i)}return o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality")&&(u.aggregationTemporality=i.enums===String?_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]===void 0?o.aggregationTemporality:_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]:o.aggregationTemporality),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.Histogram"},s})(),n.ExponentialHistogram=(function(){function s(a){if(this.dataPoints=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.dataPoints=m.emptyArray,s.prototype.aggregationTemporality=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.dataPoints!=null&&o.dataPoints.length)for(var u=0;u<o.dataPoints.length;++u)_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.encode(o.dataPoints[u],i.uint32(10).fork()).ldelim();return o.aggregationTemporality!=null&&Object.hasOwnProperty.call(o,"aggregationTemporality")&&i.uint32(16).int32(o.aggregationTemporality),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.ExponentialHistogram;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.dataPoints&&l.dataPoints.length||(l.dataPoints=[]),l.dataPoints.push(_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.decode(o,o.uint32()));break}case 2:{l.aggregationTemporality=o.int32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.dataPoints!=null&&o.hasOwnProperty("dataPoints")){if(!Array.isArray(o.dataPoints))return"dataPoints: array expected";for(var i=0;i<o.dataPoints.length;++i){var u=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.verify(o.dataPoints[i]);if(u)return"dataPoints."+u}}if(o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality"))switch(o.aggregationTemporality){default:return"aggregationTemporality: enum value expected";case 0:case 1:case 2:break}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.ExponentialHistogram)return o;var i=new _.opentelemetry.proto.metrics.v1.ExponentialHistogram;if(o.dataPoints){if(!Array.isArray(o.dataPoints))throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogram.dataPoints: array expected");i.dataPoints=[];for(var u=0;u<o.dataPoints.length;++u){if(typeof o.dataPoints[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogram.dataPoints: object expected");i.dataPoints[u]=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.fromObject(o.dataPoints[u])}}switch(o.aggregationTemporality){default:if(typeof o.aggregationTemporality=="number"){i.aggregationTemporality=o.aggregationTemporality;break}break;case"AGGREGATION_TEMPORALITY_UNSPECIFIED":case 0:i.aggregationTemporality=0;break;case"AGGREGATION_TEMPORALITY_DELTA":case 1:i.aggregationTemporality=1;break;case"AGGREGATION_TEMPORALITY_CUMULATIVE":case 2:i.aggregationTemporality=2;break}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.dataPoints=[]),i.defaults&&(u.aggregationTemporality=i.enums===String?"AGGREGATION_TEMPORALITY_UNSPECIFIED":0),o.dataPoints&&o.dataPoints.length){u.dataPoints=[];for(var l=0;l<o.dataPoints.length;++l)u.dataPoints[l]=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.toObject(o.dataPoints[l],i)}return o.aggregationTemporality!=null&&o.hasOwnProperty("aggregationTemporality")&&(u.aggregationTemporality=i.enums===String?_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]===void 0?o.aggregationTemporality:_.opentelemetry.proto.metrics.v1.AggregationTemporality[o.aggregationTemporality]:o.aggregationTemporality),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.ExponentialHistogram"},s})(),n.Summary=(function(){function s(a){if(this.dataPoints=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.dataPoints=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.dataPoints!=null&&o.dataPoints.length)for(var u=0;u<o.dataPoints.length;++u)_.opentelemetry.proto.metrics.v1.SummaryDataPoint.encode(o.dataPoints[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.Summary;o.pos<u;){var c=o.uint32();c>>>3===1?(l.dataPoints&&l.dataPoints.length||(l.dataPoints=[]),l.dataPoints.push(_.opentelemetry.proto.metrics.v1.SummaryDataPoint.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.dataPoints!=null&&o.hasOwnProperty("dataPoints")){if(!Array.isArray(o.dataPoints))return"dataPoints: array expected";for(var i=0;i<o.dataPoints.length;++i){var u=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.verify(o.dataPoints[i]);if(u)return"dataPoints."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.Summary)return o;var i=new _.opentelemetry.proto.metrics.v1.Summary;if(o.dataPoints){if(!Array.isArray(o.dataPoints))throw TypeError(".opentelemetry.proto.metrics.v1.Summary.dataPoints: array expected");i.dataPoints=[];for(var u=0;u<o.dataPoints.length;++u){if(typeof o.dataPoints[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Summary.dataPoints: object expected");i.dataPoints[u]=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.fromObject(o.dataPoints[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.dataPoints=[]),o.dataPoints&&o.dataPoints.length){u.dataPoints=[];for(var l=0;l<o.dataPoints.length;++l)u.dataPoints[l]=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.toObject(o.dataPoints[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.Summary"},s})(),n.AggregationTemporality=(function(){var s={},a=Object.create(s);return a[s[0]="AGGREGATION_TEMPORALITY_UNSPECIFIED"]=0,a[s[1]="AGGREGATION_TEMPORALITY_DELTA"]=1,a[s[2]="AGGREGATION_TEMPORALITY_CUMULATIVE"]=2,a})(),n.DataPointFlags=(function(){var s={},a=Object.create(s);return a[s[0]="DATA_POINT_FLAGS_DO_NOT_USE"]=0,a[s[1]="DATA_POINT_FLAGS_NO_RECORDED_VALUE_MASK"]=1,a})(),n.NumberDataPoint=(function(){function s(o){if(this.attributes=[],this.exemplars=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.attributes=m.emptyArray,s.prototype.startTimeUnixNano=null,s.prototype.timeUnixNano=null,s.prototype.asDouble=null,s.prototype.asInt=null,s.prototype.exemplars=m.emptyArray,s.prototype.flags=null;var a;return Object.defineProperty(s.prototype,"value",{get:m.oneOfGetter(a=["asDouble","asInt"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){if(u||(u=ee.create()),i.startTimeUnixNano!=null&&Object.hasOwnProperty.call(i,"startTimeUnixNano")&&u.uint32(17).fixed64(i.startTimeUnixNano),i.timeUnixNano!=null&&Object.hasOwnProperty.call(i,"timeUnixNano")&&u.uint32(25).fixed64(i.timeUnixNano),i.asDouble!=null&&Object.hasOwnProperty.call(i,"asDouble")&&u.uint32(33).double(i.asDouble),i.exemplars!=null&&i.exemplars.length)for(var l=0;l<i.exemplars.length;++l)_.opentelemetry.proto.metrics.v1.Exemplar.encode(i.exemplars[l],u.uint32(42).fork()).ldelim();if(i.asInt!=null&&Object.hasOwnProperty.call(i,"asInt")&&u.uint32(49).sfixed64(i.asInt),i.attributes!=null&&i.attributes.length)for(var l=0;l<i.attributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.attributes[l],u.uint32(58).fork()).ldelim();return i.flags!=null&&Object.hasOwnProperty.call(i,"flags")&&u.uint32(64).uint32(i.flags),u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.NumberDataPoint;i.pos<l;){var f=i.uint32();switch(f>>>3){case 7:{c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 2:{c.startTimeUnixNano=i.fixed64();break}case 3:{c.timeUnixNano=i.fixed64();break}case 4:{c.asDouble=i.double();break}case 6:{c.asInt=i.sfixed64();break}case 5:{c.exemplars&&c.exemplars.length||(c.exemplars=[]),c.exemplars.push(_.opentelemetry.proto.metrics.v1.Exemplar.decode(i,i.uint32()));break}case 8:{c.flags=i.uint32();break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.attributes!=null&&i.hasOwnProperty("attributes")){if(!Array.isArray(i.attributes))return"attributes: array expected";for(var l=0;l<i.attributes.length;++l){var c=_.opentelemetry.proto.common.v1.KeyValue.verify(i.attributes[l]);if(c)return"attributes."+c}}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&!m.isInteger(i.startTimeUnixNano)&&!(i.startTimeUnixNano&&m.isInteger(i.startTimeUnixNano.low)&&m.isInteger(i.startTimeUnixNano.high)))return"startTimeUnixNano: integer|Long expected";if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&!m.isInteger(i.timeUnixNano)&&!(i.timeUnixNano&&m.isInteger(i.timeUnixNano.low)&&m.isInteger(i.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(i.asDouble!=null&&i.hasOwnProperty("asDouble")&&(u.value=1,typeof i.asDouble!="number"))return"asDouble: number expected";if(i.asInt!=null&&i.hasOwnProperty("asInt")){if(u.value===1)return"value: multiple values";if(u.value=1,!m.isInteger(i.asInt)&&!(i.asInt&&m.isInteger(i.asInt.low)&&m.isInteger(i.asInt.high)))return"asInt: integer|Long expected"}if(i.exemplars!=null&&i.hasOwnProperty("exemplars")){if(!Array.isArray(i.exemplars))return"exemplars: array expected";for(var l=0;l<i.exemplars.length;++l){var c=_.opentelemetry.proto.metrics.v1.Exemplar.verify(i.exemplars[l]);if(c)return"exemplars."+c}}return i.flags!=null&&i.hasOwnProperty("flags")&&!m.isInteger(i.flags)?"flags: integer expected":null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.NumberDataPoint)return i;var u=new _.opentelemetry.proto.metrics.v1.NumberDataPoint;if(i.attributes){if(!Array.isArray(i.attributes))throw TypeError(".opentelemetry.proto.metrics.v1.NumberDataPoint.attributes: array expected");u.attributes=[];for(var l=0;l<i.attributes.length;++l){if(typeof i.attributes[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.NumberDataPoint.attributes: object expected");u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.attributes[l])}}if(i.startTimeUnixNano!=null&&(m.Long?(u.startTimeUnixNano=m.Long.fromValue(i.startTimeUnixNano)).unsigned=!1:typeof i.startTimeUnixNano=="string"?u.startTimeUnixNano=parseInt(i.startTimeUnixNano,10):typeof i.startTimeUnixNano=="number"?u.startTimeUnixNano=i.startTimeUnixNano:typeof i.startTimeUnixNano=="object"&&(u.startTimeUnixNano=new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber())),i.timeUnixNano!=null&&(m.Long?(u.timeUnixNano=m.Long.fromValue(i.timeUnixNano)).unsigned=!1:typeof i.timeUnixNano=="string"?u.timeUnixNano=parseInt(i.timeUnixNano,10):typeof i.timeUnixNano=="number"?u.timeUnixNano=i.timeUnixNano:typeof i.timeUnixNano=="object"&&(u.timeUnixNano=new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber())),i.asDouble!=null&&(u.asDouble=Number(i.asDouble)),i.asInt!=null&&(m.Long?(u.asInt=m.Long.fromValue(i.asInt)).unsigned=!1:typeof i.asInt=="string"?u.asInt=parseInt(i.asInt,10):typeof i.asInt=="number"?u.asInt=i.asInt:typeof i.asInt=="object"&&(u.asInt=new m.LongBits(i.asInt.low>>>0,i.asInt.high>>>0).toNumber())),i.exemplars){if(!Array.isArray(i.exemplars))throw TypeError(".opentelemetry.proto.metrics.v1.NumberDataPoint.exemplars: array expected");u.exemplars=[];for(var l=0;l<i.exemplars.length;++l){if(typeof i.exemplars[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.NumberDataPoint.exemplars: object expected");u.exemplars[l]=_.opentelemetry.proto.metrics.v1.Exemplar.fromObject(i.exemplars[l])}}return i.flags!=null&&(u.flags=i.flags>>>0),u},s.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.exemplars=[],l.attributes=[]),u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.startTimeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.startTimeUnixNano=u.longs===String?"0":0;if(m.Long){var c=new m.Long(0,0,!1);l.timeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.timeUnixNano=u.longs===String?"0":0;l.flags=0}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&(typeof i.startTimeUnixNano=="number"?l.startTimeUnixNano=u.longs===String?String(i.startTimeUnixNano):i.startTimeUnixNano:l.startTimeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.startTimeUnixNano):u.longs===Number?new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber():i.startTimeUnixNano),i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&(typeof i.timeUnixNano=="number"?l.timeUnixNano=u.longs===String?String(i.timeUnixNano):i.timeUnixNano:l.timeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.timeUnixNano):u.longs===Number?new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber():i.timeUnixNano),i.asDouble!=null&&i.hasOwnProperty("asDouble")&&(l.asDouble=u.json&&!isFinite(i.asDouble)?String(i.asDouble):i.asDouble,u.oneofs&&(l.value="asDouble")),i.exemplars&&i.exemplars.length){l.exemplars=[];for(var f=0;f<i.exemplars.length;++f)l.exemplars[f]=_.opentelemetry.proto.metrics.v1.Exemplar.toObject(i.exemplars[f],u)}if(i.asInt!=null&&i.hasOwnProperty("asInt")&&(typeof i.asInt=="number"?l.asInt=u.longs===String?String(i.asInt):i.asInt:l.asInt=u.longs===String?m.Long.prototype.toString.call(i.asInt):u.longs===Number?new m.LongBits(i.asInt.low>>>0,i.asInt.high>>>0).toNumber():i.asInt,u.oneofs&&(l.value="asInt")),i.attributes&&i.attributes.length){l.attributes=[];for(var f=0;f<i.attributes.length;++f)l.attributes[f]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.attributes[f],u)}return i.flags!=null&&i.hasOwnProperty("flags")&&(l.flags=i.flags),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.NumberDataPoint"},s})(),n.HistogramDataPoint=(function(){function s(o){if(this.attributes=[],this.bucketCounts=[],this.explicitBounds=[],this.exemplars=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.attributes=m.emptyArray,s.prototype.startTimeUnixNano=null,s.prototype.timeUnixNano=null,s.prototype.count=null,s.prototype.sum=null,s.prototype.bucketCounts=m.emptyArray,s.prototype.explicitBounds=m.emptyArray,s.prototype.exemplars=m.emptyArray,s.prototype.flags=null,s.prototype.min=null,s.prototype.max=null;var a;return Object.defineProperty(s.prototype,"_sum",{get:m.oneOfGetter(a=["sum"]),set:m.oneOfSetter(a)}),Object.defineProperty(s.prototype,"_min",{get:m.oneOfGetter(a=["min"]),set:m.oneOfSetter(a)}),Object.defineProperty(s.prototype,"_max",{get:m.oneOfGetter(a=["max"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){if(u||(u=ee.create()),i.startTimeUnixNano!=null&&Object.hasOwnProperty.call(i,"startTimeUnixNano")&&u.uint32(17).fixed64(i.startTimeUnixNano),i.timeUnixNano!=null&&Object.hasOwnProperty.call(i,"timeUnixNano")&&u.uint32(25).fixed64(i.timeUnixNano),i.count!=null&&Object.hasOwnProperty.call(i,"count")&&u.uint32(33).fixed64(i.count),i.sum!=null&&Object.hasOwnProperty.call(i,"sum")&&u.uint32(41).double(i.sum),i.bucketCounts!=null&&i.bucketCounts.length){u.uint32(50).fork();for(var l=0;l<i.bucketCounts.length;++l)u.fixed64(i.bucketCounts[l]);u.ldelim()}if(i.explicitBounds!=null&&i.explicitBounds.length){u.uint32(58).fork();for(var l=0;l<i.explicitBounds.length;++l)u.double(i.explicitBounds[l]);u.ldelim()}if(i.exemplars!=null&&i.exemplars.length)for(var l=0;l<i.exemplars.length;++l)_.opentelemetry.proto.metrics.v1.Exemplar.encode(i.exemplars[l],u.uint32(66).fork()).ldelim();if(i.attributes!=null&&i.attributes.length)for(var l=0;l<i.attributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.attributes[l],u.uint32(74).fork()).ldelim();return i.flags!=null&&Object.hasOwnProperty.call(i,"flags")&&u.uint32(80).uint32(i.flags),i.min!=null&&Object.hasOwnProperty.call(i,"min")&&u.uint32(89).double(i.min),i.max!=null&&Object.hasOwnProperty.call(i,"max")&&u.uint32(97).double(i.max),u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.HistogramDataPoint;i.pos<l;){var f=i.uint32();switch(f>>>3){case 9:{c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 2:{c.startTimeUnixNano=i.fixed64();break}case 3:{c.timeUnixNano=i.fixed64();break}case 4:{c.count=i.fixed64();break}case 5:{c.sum=i.double();break}case 6:{if(c.bucketCounts&&c.bucketCounts.length||(c.bucketCounts=[]),(f&7)===2)for(var h=i.uint32()+i.pos;i.pos<h;)c.bucketCounts.push(i.fixed64());else c.bucketCounts.push(i.fixed64());break}case 7:{if(c.explicitBounds&&c.explicitBounds.length||(c.explicitBounds=[]),(f&7)===2)for(var h=i.uint32()+i.pos;i.pos<h;)c.explicitBounds.push(i.double());else c.explicitBounds.push(i.double());break}case 8:{c.exemplars&&c.exemplars.length||(c.exemplars=[]),c.exemplars.push(_.opentelemetry.proto.metrics.v1.Exemplar.decode(i,i.uint32()));break}case 10:{c.flags=i.uint32();break}case 11:{c.min=i.double();break}case 12:{c.max=i.double();break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.attributes!=null&&i.hasOwnProperty("attributes")){if(!Array.isArray(i.attributes))return"attributes: array expected";for(var l=0;l<i.attributes.length;++l){var c=_.opentelemetry.proto.common.v1.KeyValue.verify(i.attributes[l]);if(c)return"attributes."+c}}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&!m.isInteger(i.startTimeUnixNano)&&!(i.startTimeUnixNano&&m.isInteger(i.startTimeUnixNano.low)&&m.isInteger(i.startTimeUnixNano.high)))return"startTimeUnixNano: integer|Long expected";if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&!m.isInteger(i.timeUnixNano)&&!(i.timeUnixNano&&m.isInteger(i.timeUnixNano.low)&&m.isInteger(i.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(i.count!=null&&i.hasOwnProperty("count")&&!m.isInteger(i.count)&&!(i.count&&m.isInteger(i.count.low)&&m.isInteger(i.count.high)))return"count: integer|Long expected";if(i.sum!=null&&i.hasOwnProperty("sum")&&(u._sum=1,typeof i.sum!="number"))return"sum: number expected";if(i.bucketCounts!=null&&i.hasOwnProperty("bucketCounts")){if(!Array.isArray(i.bucketCounts))return"bucketCounts: array expected";for(var l=0;l<i.bucketCounts.length;++l)if(!m.isInteger(i.bucketCounts[l])&&!(i.bucketCounts[l]&&m.isInteger(i.bucketCounts[l].low)&&m.isInteger(i.bucketCounts[l].high)))return"bucketCounts: integer|Long[] expected"}if(i.explicitBounds!=null&&i.hasOwnProperty("explicitBounds")){if(!Array.isArray(i.explicitBounds))return"explicitBounds: array expected";for(var l=0;l<i.explicitBounds.length;++l)if(typeof i.explicitBounds[l]!="number")return"explicitBounds: number[] expected"}if(i.exemplars!=null&&i.hasOwnProperty("exemplars")){if(!Array.isArray(i.exemplars))return"exemplars: array expected";for(var l=0;l<i.exemplars.length;++l){var c=_.opentelemetry.proto.metrics.v1.Exemplar.verify(i.exemplars[l]);if(c)return"exemplars."+c}}return i.flags!=null&&i.hasOwnProperty("flags")&&!m.isInteger(i.flags)?"flags: integer expected":i.min!=null&&i.hasOwnProperty("min")&&(u._min=1,typeof i.min!="number")?"min: number expected":i.max!=null&&i.hasOwnProperty("max")&&(u._max=1,typeof i.max!="number")?"max: number expected":null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.HistogramDataPoint)return i;var u=new _.opentelemetry.proto.metrics.v1.HistogramDataPoint;if(i.attributes){if(!Array.isArray(i.attributes))throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.attributes: array expected");u.attributes=[];for(var l=0;l<i.attributes.length;++l){if(typeof i.attributes[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.attributes: object expected");u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.attributes[l])}}if(i.startTimeUnixNano!=null&&(m.Long?(u.startTimeUnixNano=m.Long.fromValue(i.startTimeUnixNano)).unsigned=!1:typeof i.startTimeUnixNano=="string"?u.startTimeUnixNano=parseInt(i.startTimeUnixNano,10):typeof i.startTimeUnixNano=="number"?u.startTimeUnixNano=i.startTimeUnixNano:typeof i.startTimeUnixNano=="object"&&(u.startTimeUnixNano=new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber())),i.timeUnixNano!=null&&(m.Long?(u.timeUnixNano=m.Long.fromValue(i.timeUnixNano)).unsigned=!1:typeof i.timeUnixNano=="string"?u.timeUnixNano=parseInt(i.timeUnixNano,10):typeof i.timeUnixNano=="number"?u.timeUnixNano=i.timeUnixNano:typeof i.timeUnixNano=="object"&&(u.timeUnixNano=new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber())),i.count!=null&&(m.Long?(u.count=m.Long.fromValue(i.count)).unsigned=!1:typeof i.count=="string"?u.count=parseInt(i.count,10):typeof i.count=="number"?u.count=i.count:typeof i.count=="object"&&(u.count=new m.LongBits(i.count.low>>>0,i.count.high>>>0).toNumber())),i.sum!=null&&(u.sum=Number(i.sum)),i.bucketCounts){if(!Array.isArray(i.bucketCounts))throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.bucketCounts: array expected");u.bucketCounts=[];for(var l=0;l<i.bucketCounts.length;++l)m.Long?(u.bucketCounts[l]=m.Long.fromValue(i.bucketCounts[l])).unsigned=!1:typeof i.bucketCounts[l]=="string"?u.bucketCounts[l]=parseInt(i.bucketCounts[l],10):typeof i.bucketCounts[l]=="number"?u.bucketCounts[l]=i.bucketCounts[l]:typeof i.bucketCounts[l]=="object"&&(u.bucketCounts[l]=new m.LongBits(i.bucketCounts[l].low>>>0,i.bucketCounts[l].high>>>0).toNumber())}if(i.explicitBounds){if(!Array.isArray(i.explicitBounds))throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.explicitBounds: array expected");u.explicitBounds=[];for(var l=0;l<i.explicitBounds.length;++l)u.explicitBounds[l]=Number(i.explicitBounds[l])}if(i.exemplars){if(!Array.isArray(i.exemplars))throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.exemplars: array expected");u.exemplars=[];for(var l=0;l<i.exemplars.length;++l){if(typeof i.exemplars[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.HistogramDataPoint.exemplars: object expected");u.exemplars[l]=_.opentelemetry.proto.metrics.v1.Exemplar.fromObject(i.exemplars[l])}}return i.flags!=null&&(u.flags=i.flags>>>0),i.min!=null&&(u.min=Number(i.min)),i.max!=null&&(u.max=Number(i.max)),u},s.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.bucketCounts=[],l.explicitBounds=[],l.exemplars=[],l.attributes=[]),u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.startTimeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.startTimeUnixNano=u.longs===String?"0":0;if(m.Long){var c=new m.Long(0,0,!1);l.timeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.timeUnixNano=u.longs===String?"0":0;if(m.Long){var c=new m.Long(0,0,!1);l.count=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.count=u.longs===String?"0":0;l.flags=0}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&(typeof i.startTimeUnixNano=="number"?l.startTimeUnixNano=u.longs===String?String(i.startTimeUnixNano):i.startTimeUnixNano:l.startTimeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.startTimeUnixNano):u.longs===Number?new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber():i.startTimeUnixNano),i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&(typeof i.timeUnixNano=="number"?l.timeUnixNano=u.longs===String?String(i.timeUnixNano):i.timeUnixNano:l.timeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.timeUnixNano):u.longs===Number?new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber():i.timeUnixNano),i.count!=null&&i.hasOwnProperty("count")&&(typeof i.count=="number"?l.count=u.longs===String?String(i.count):i.count:l.count=u.longs===String?m.Long.prototype.toString.call(i.count):u.longs===Number?new m.LongBits(i.count.low>>>0,i.count.high>>>0).toNumber():i.count),i.sum!=null&&i.hasOwnProperty("sum")&&(l.sum=u.json&&!isFinite(i.sum)?String(i.sum):i.sum,u.oneofs&&(l._sum="sum")),i.bucketCounts&&i.bucketCounts.length){l.bucketCounts=[];for(var f=0;f<i.bucketCounts.length;++f)typeof i.bucketCounts[f]=="number"?l.bucketCounts[f]=u.longs===String?String(i.bucketCounts[f]):i.bucketCounts[f]:l.bucketCounts[f]=u.longs===String?m.Long.prototype.toString.call(i.bucketCounts[f]):u.longs===Number?new m.LongBits(i.bucketCounts[f].low>>>0,i.bucketCounts[f].high>>>0).toNumber():i.bucketCounts[f]}if(i.explicitBounds&&i.explicitBounds.length){l.explicitBounds=[];for(var f=0;f<i.explicitBounds.length;++f)l.explicitBounds[f]=u.json&&!isFinite(i.explicitBounds[f])?String(i.explicitBounds[f]):i.explicitBounds[f]}if(i.exemplars&&i.exemplars.length){l.exemplars=[];for(var f=0;f<i.exemplars.length;++f)l.exemplars[f]=_.opentelemetry.proto.metrics.v1.Exemplar.toObject(i.exemplars[f],u)}if(i.attributes&&i.attributes.length){l.attributes=[];for(var f=0;f<i.attributes.length;++f)l.attributes[f]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.attributes[f],u)}return i.flags!=null&&i.hasOwnProperty("flags")&&(l.flags=i.flags),i.min!=null&&i.hasOwnProperty("min")&&(l.min=u.json&&!isFinite(i.min)?String(i.min):i.min,u.oneofs&&(l._min="min")),i.max!=null&&i.hasOwnProperty("max")&&(l.max=u.json&&!isFinite(i.max)?String(i.max):i.max,u.oneofs&&(l._max="max")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.HistogramDataPoint"},s})(),n.ExponentialHistogramDataPoint=(function(){function s(o){if(this.attributes=[],this.exemplars=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.attributes=m.emptyArray,s.prototype.startTimeUnixNano=null,s.prototype.timeUnixNano=null,s.prototype.count=null,s.prototype.sum=null,s.prototype.scale=null,s.prototype.zeroCount=null,s.prototype.positive=null,s.prototype.negative=null,s.prototype.flags=null,s.prototype.exemplars=m.emptyArray,s.prototype.min=null,s.prototype.max=null,s.prototype.zeroThreshold=null;var a;return Object.defineProperty(s.prototype,"_sum",{get:m.oneOfGetter(a=["sum"]),set:m.oneOfSetter(a)}),Object.defineProperty(s.prototype,"_min",{get:m.oneOfGetter(a=["min"]),set:m.oneOfSetter(a)}),Object.defineProperty(s.prototype,"_max",{get:m.oneOfGetter(a=["max"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){if(u||(u=ee.create()),i.attributes!=null&&i.attributes.length)for(var l=0;l<i.attributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.attributes[l],u.uint32(10).fork()).ldelim();if(i.startTimeUnixNano!=null&&Object.hasOwnProperty.call(i,"startTimeUnixNano")&&u.uint32(17).fixed64(i.startTimeUnixNano),i.timeUnixNano!=null&&Object.hasOwnProperty.call(i,"timeUnixNano")&&u.uint32(25).fixed64(i.timeUnixNano),i.count!=null&&Object.hasOwnProperty.call(i,"count")&&u.uint32(33).fixed64(i.count),i.sum!=null&&Object.hasOwnProperty.call(i,"sum")&&u.uint32(41).double(i.sum),i.scale!=null&&Object.hasOwnProperty.call(i,"scale")&&u.uint32(48).sint32(i.scale),i.zeroCount!=null&&Object.hasOwnProperty.call(i,"zeroCount")&&u.uint32(57).fixed64(i.zeroCount),i.positive!=null&&Object.hasOwnProperty.call(i,"positive")&&_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.encode(i.positive,u.uint32(66).fork()).ldelim(),i.negative!=null&&Object.hasOwnProperty.call(i,"negative")&&_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.encode(i.negative,u.uint32(74).fork()).ldelim(),i.flags!=null&&Object.hasOwnProperty.call(i,"flags")&&u.uint32(80).uint32(i.flags),i.exemplars!=null&&i.exemplars.length)for(var l=0;l<i.exemplars.length;++l)_.opentelemetry.proto.metrics.v1.Exemplar.encode(i.exemplars[l],u.uint32(90).fork()).ldelim();return i.min!=null&&Object.hasOwnProperty.call(i,"min")&&u.uint32(97).double(i.min),i.max!=null&&Object.hasOwnProperty.call(i,"max")&&u.uint32(105).double(i.max),i.zeroThreshold!=null&&Object.hasOwnProperty.call(i,"zeroThreshold")&&u.uint32(113).double(i.zeroThreshold),u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.attributes&&c.attributes.length||(c.attributes=[]),c.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 2:{c.startTimeUnixNano=i.fixed64();break}case 3:{c.timeUnixNano=i.fixed64();break}case 4:{c.count=i.fixed64();break}case 5:{c.sum=i.double();break}case 6:{c.scale=i.sint32();break}case 7:{c.zeroCount=i.fixed64();break}case 8:{c.positive=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.decode(i,i.uint32());break}case 9:{c.negative=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.decode(i,i.uint32());break}case 10:{c.flags=i.uint32();break}case 11:{c.exemplars&&c.exemplars.length||(c.exemplars=[]),c.exemplars.push(_.opentelemetry.proto.metrics.v1.Exemplar.decode(i,i.uint32()));break}case 12:{c.min=i.double();break}case 13:{c.max=i.double();break}case 14:{c.zeroThreshold=i.double();break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.attributes!=null&&i.hasOwnProperty("attributes")){if(!Array.isArray(i.attributes))return"attributes: array expected";for(var l=0;l<i.attributes.length;++l){var c=_.opentelemetry.proto.common.v1.KeyValue.verify(i.attributes[l]);if(c)return"attributes."+c}}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&!m.isInteger(i.startTimeUnixNano)&&!(i.startTimeUnixNano&&m.isInteger(i.startTimeUnixNano.low)&&m.isInteger(i.startTimeUnixNano.high)))return"startTimeUnixNano: integer|Long expected";if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&!m.isInteger(i.timeUnixNano)&&!(i.timeUnixNano&&m.isInteger(i.timeUnixNano.low)&&m.isInteger(i.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(i.count!=null&&i.hasOwnProperty("count")&&!m.isInteger(i.count)&&!(i.count&&m.isInteger(i.count.low)&&m.isInteger(i.count.high)))return"count: integer|Long expected";if(i.sum!=null&&i.hasOwnProperty("sum")&&(u._sum=1,typeof i.sum!="number"))return"sum: number expected";if(i.scale!=null&&i.hasOwnProperty("scale")&&!m.isInteger(i.scale))return"scale: integer expected";if(i.zeroCount!=null&&i.hasOwnProperty("zeroCount")&&!m.isInteger(i.zeroCount)&&!(i.zeroCount&&m.isInteger(i.zeroCount.low)&&m.isInteger(i.zeroCount.high)))return"zeroCount: integer|Long expected";if(i.positive!=null&&i.hasOwnProperty("positive")){var c=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.verify(i.positive);if(c)return"positive."+c}if(i.negative!=null&&i.hasOwnProperty("negative")){var c=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.verify(i.negative);if(c)return"negative."+c}if(i.flags!=null&&i.hasOwnProperty("flags")&&!m.isInteger(i.flags))return"flags: integer expected";if(i.exemplars!=null&&i.hasOwnProperty("exemplars")){if(!Array.isArray(i.exemplars))return"exemplars: array expected";for(var l=0;l<i.exemplars.length;++l){var c=_.opentelemetry.proto.metrics.v1.Exemplar.verify(i.exemplars[l]);if(c)return"exemplars."+c}}return i.min!=null&&i.hasOwnProperty("min")&&(u._min=1,typeof i.min!="number")?"min: number expected":i.max!=null&&i.hasOwnProperty("max")&&(u._max=1,typeof i.max!="number")?"max: number expected":i.zeroThreshold!=null&&i.hasOwnProperty("zeroThreshold")&&typeof i.zeroThreshold!="number"?"zeroThreshold: number expected":null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint)return i;var u=new _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint;if(i.attributes){if(!Array.isArray(i.attributes))throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.attributes: array expected");u.attributes=[];for(var l=0;l<i.attributes.length;++l){if(typeof i.attributes[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.attributes: object expected");u.attributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.attributes[l])}}if(i.startTimeUnixNano!=null&&(m.Long?(u.startTimeUnixNano=m.Long.fromValue(i.startTimeUnixNano)).unsigned=!1:typeof i.startTimeUnixNano=="string"?u.startTimeUnixNano=parseInt(i.startTimeUnixNano,10):typeof i.startTimeUnixNano=="number"?u.startTimeUnixNano=i.startTimeUnixNano:typeof i.startTimeUnixNano=="object"&&(u.startTimeUnixNano=new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber())),i.timeUnixNano!=null&&(m.Long?(u.timeUnixNano=m.Long.fromValue(i.timeUnixNano)).unsigned=!1:typeof i.timeUnixNano=="string"?u.timeUnixNano=parseInt(i.timeUnixNano,10):typeof i.timeUnixNano=="number"?u.timeUnixNano=i.timeUnixNano:typeof i.timeUnixNano=="object"&&(u.timeUnixNano=new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber())),i.count!=null&&(m.Long?(u.count=m.Long.fromValue(i.count)).unsigned=!1:typeof i.count=="string"?u.count=parseInt(i.count,10):typeof i.count=="number"?u.count=i.count:typeof i.count=="object"&&(u.count=new m.LongBits(i.count.low>>>0,i.count.high>>>0).toNumber())),i.sum!=null&&(u.sum=Number(i.sum)),i.scale!=null&&(u.scale=i.scale|0),i.zeroCount!=null&&(m.Long?(u.zeroCount=m.Long.fromValue(i.zeroCount)).unsigned=!1:typeof i.zeroCount=="string"?u.zeroCount=parseInt(i.zeroCount,10):typeof i.zeroCount=="number"?u.zeroCount=i.zeroCount:typeof i.zeroCount=="object"&&(u.zeroCount=new m.LongBits(i.zeroCount.low>>>0,i.zeroCount.high>>>0).toNumber())),i.positive!=null){if(typeof i.positive!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.positive: object expected");u.positive=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.fromObject(i.positive)}if(i.negative!=null){if(typeof i.negative!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.negative: object expected");u.negative=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.fromObject(i.negative)}if(i.flags!=null&&(u.flags=i.flags>>>0),i.exemplars){if(!Array.isArray(i.exemplars))throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.exemplars: array expected");u.exemplars=[];for(var l=0;l<i.exemplars.length;++l){if(typeof i.exemplars[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.exemplars: object expected");u.exemplars[l]=_.opentelemetry.proto.metrics.v1.Exemplar.fromObject(i.exemplars[l])}}return i.min!=null&&(u.min=Number(i.min)),i.max!=null&&(u.max=Number(i.max)),i.zeroThreshold!=null&&(u.zeroThreshold=Number(i.zeroThreshold)),u},s.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.attributes=[],l.exemplars=[]),u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.startTimeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.startTimeUnixNano=u.longs===String?"0":0;if(m.Long){var c=new m.Long(0,0,!1);l.timeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.timeUnixNano=u.longs===String?"0":0;if(m.Long){var c=new m.Long(0,0,!1);l.count=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.count=u.longs===String?"0":0;if(l.scale=0,m.Long){var c=new m.Long(0,0,!1);l.zeroCount=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.zeroCount=u.longs===String?"0":0;l.positive=null,l.negative=null,l.flags=0,l.zeroThreshold=0}if(i.attributes&&i.attributes.length){l.attributes=[];for(var f=0;f<i.attributes.length;++f)l.attributes[f]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.attributes[f],u)}if(i.startTimeUnixNano!=null&&i.hasOwnProperty("startTimeUnixNano")&&(typeof i.startTimeUnixNano=="number"?l.startTimeUnixNano=u.longs===String?String(i.startTimeUnixNano):i.startTimeUnixNano:l.startTimeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.startTimeUnixNano):u.longs===Number?new m.LongBits(i.startTimeUnixNano.low>>>0,i.startTimeUnixNano.high>>>0).toNumber():i.startTimeUnixNano),i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&(typeof i.timeUnixNano=="number"?l.timeUnixNano=u.longs===String?String(i.timeUnixNano):i.timeUnixNano:l.timeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.timeUnixNano):u.longs===Number?new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber():i.timeUnixNano),i.count!=null&&i.hasOwnProperty("count")&&(typeof i.count=="number"?l.count=u.longs===String?String(i.count):i.count:l.count=u.longs===String?m.Long.prototype.toString.call(i.count):u.longs===Number?new m.LongBits(i.count.low>>>0,i.count.high>>>0).toNumber():i.count),i.sum!=null&&i.hasOwnProperty("sum")&&(l.sum=u.json&&!isFinite(i.sum)?String(i.sum):i.sum,u.oneofs&&(l._sum="sum")),i.scale!=null&&i.hasOwnProperty("scale")&&(l.scale=i.scale),i.zeroCount!=null&&i.hasOwnProperty("zeroCount")&&(typeof i.zeroCount=="number"?l.zeroCount=u.longs===String?String(i.zeroCount):i.zeroCount:l.zeroCount=u.longs===String?m.Long.prototype.toString.call(i.zeroCount):u.longs===Number?new m.LongBits(i.zeroCount.low>>>0,i.zeroCount.high>>>0).toNumber():i.zeroCount),i.positive!=null&&i.hasOwnProperty("positive")&&(l.positive=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.toObject(i.positive,u)),i.negative!=null&&i.hasOwnProperty("negative")&&(l.negative=_.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.toObject(i.negative,u)),i.flags!=null&&i.hasOwnProperty("flags")&&(l.flags=i.flags),i.exemplars&&i.exemplars.length){l.exemplars=[];for(var f=0;f<i.exemplars.length;++f)l.exemplars[f]=_.opentelemetry.proto.metrics.v1.Exemplar.toObject(i.exemplars[f],u)}return i.min!=null&&i.hasOwnProperty("min")&&(l.min=u.json&&!isFinite(i.min)?String(i.min):i.min,u.oneofs&&(l._min="min")),i.max!=null&&i.hasOwnProperty("max")&&(l.max=u.json&&!isFinite(i.max)?String(i.max):i.max,u.oneofs&&(l._max="max")),i.zeroThreshold!=null&&i.hasOwnProperty("zeroThreshold")&&(l.zeroThreshold=u.json&&!isFinite(i.zeroThreshold)?String(i.zeroThreshold):i.zeroThreshold),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint"},s.Buckets=(function(){function o(i){if(this.bucketCounts=[],i)for(var u=Object.keys(i),l=0;l<u.length;++l)i[u[l]]!=null&&(this[u[l]]=i[u[l]])}return o.prototype.offset=null,o.prototype.bucketCounts=m.emptyArray,o.create=function(u){return new o(u)},o.encode=function(u,l){if(l||(l=ee.create()),u.offset!=null&&Object.hasOwnProperty.call(u,"offset")&&l.uint32(8).sint32(u.offset),u.bucketCounts!=null&&u.bucketCounts.length){l.uint32(18).fork();for(var c=0;c<u.bucketCounts.length;++c)l.uint64(u.bucketCounts[c]);l.ldelim()}return l},o.encodeDelimited=function(u,l){return this.encode(u,l).ldelim()},o.decode=function(u,l){u instanceof w||(u=w.create(u));for(var c=l===void 0?u.len:u.pos+l,f=new _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets;u.pos<c;){var h=u.uint32();switch(h>>>3){case 1:{f.offset=u.sint32();break}case 2:{if(f.bucketCounts&&f.bucketCounts.length||(f.bucketCounts=[]),(h&7)===2)for(var S=u.uint32()+u.pos;u.pos<S;)f.bucketCounts.push(u.uint64());else f.bucketCounts.push(u.uint64());break}default:u.skipType(h&7);break}}return f},o.decodeDelimited=function(u){return u instanceof w||(u=new w(u)),this.decode(u,u.uint32())},o.verify=function(u){if(typeof u!="object"||u===null)return"object expected";if(u.offset!=null&&u.hasOwnProperty("offset")&&!m.isInteger(u.offset))return"offset: integer expected";if(u.bucketCounts!=null&&u.hasOwnProperty("bucketCounts")){if(!Array.isArray(u.bucketCounts))return"bucketCounts: array expected";for(var l=0;l<u.bucketCounts.length;++l)if(!m.isInteger(u.bucketCounts[l])&&!(u.bucketCounts[l]&&m.isInteger(u.bucketCounts[l].low)&&m.isInteger(u.bucketCounts[l].high)))return"bucketCounts: integer|Long[] expected"}return null},o.fromObject=function(u){if(u instanceof _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets)return u;var l=new _.opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets;if(u.offset!=null&&(l.offset=u.offset|0),u.bucketCounts){if(!Array.isArray(u.bucketCounts))throw TypeError(".opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets.bucketCounts: array expected");l.bucketCounts=[];for(var c=0;c<u.bucketCounts.length;++c)m.Long?(l.bucketCounts[c]=m.Long.fromValue(u.bucketCounts[c])).unsigned=!0:typeof u.bucketCounts[c]=="string"?l.bucketCounts[c]=parseInt(u.bucketCounts[c],10):typeof u.bucketCounts[c]=="number"?l.bucketCounts[c]=u.bucketCounts[c]:typeof u.bucketCounts[c]=="object"&&(l.bucketCounts[c]=new m.LongBits(u.bucketCounts[c].low>>>0,u.bucketCounts[c].high>>>0).toNumber(!0))}return l},o.toObject=function(u,l){l||(l={});var c={};if((l.arrays||l.defaults)&&(c.bucketCounts=[]),l.defaults&&(c.offset=0),u.offset!=null&&u.hasOwnProperty("offset")&&(c.offset=u.offset),u.bucketCounts&&u.bucketCounts.length){c.bucketCounts=[];for(var f=0;f<u.bucketCounts.length;++f)typeof u.bucketCounts[f]=="number"?c.bucketCounts[f]=l.longs===String?String(u.bucketCounts[f]):u.bucketCounts[f]:c.bucketCounts[f]=l.longs===String?m.Long.prototype.toString.call(u.bucketCounts[f]):l.longs===Number?new m.LongBits(u.bucketCounts[f].low>>>0,u.bucketCounts[f].high>>>0).toNumber(!0):u.bucketCounts[f]}return c},o.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},o.getTypeUrl=function(u){return u===void 0&&(u="type.googleapis.com"),u+"/opentelemetry.proto.metrics.v1.ExponentialHistogramDataPoint.Buckets"},o})(),s})(),n.SummaryDataPoint=(function(){function s(a){if(this.attributes=[],this.quantileValues=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.attributes=m.emptyArray,s.prototype.startTimeUnixNano=null,s.prototype.timeUnixNano=null,s.prototype.count=null,s.prototype.sum=null,s.prototype.quantileValues=m.emptyArray,s.prototype.flags=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.startTimeUnixNano!=null&&Object.hasOwnProperty.call(o,"startTimeUnixNano")&&i.uint32(17).fixed64(o.startTimeUnixNano),o.timeUnixNano!=null&&Object.hasOwnProperty.call(o,"timeUnixNano")&&i.uint32(25).fixed64(o.timeUnixNano),o.count!=null&&Object.hasOwnProperty.call(o,"count")&&i.uint32(33).fixed64(o.count),o.sum!=null&&Object.hasOwnProperty.call(o,"sum")&&i.uint32(41).double(o.sum),o.quantileValues!=null&&o.quantileValues.length)for(var u=0;u<o.quantileValues.length;++u)_.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile.encode(o.quantileValues[u],i.uint32(50).fork()).ldelim();if(o.attributes!=null&&o.attributes.length)for(var u=0;u<o.attributes.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.attributes[u],i.uint32(58).fork()).ldelim();return o.flags!=null&&Object.hasOwnProperty.call(o,"flags")&&i.uint32(64).uint32(o.flags),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.metrics.v1.SummaryDataPoint;o.pos<u;){var c=o.uint32();switch(c>>>3){case 7:{l.attributes&&l.attributes.length||(l.attributes=[]),l.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()));break}case 2:{l.startTimeUnixNano=o.fixed64();break}case 3:{l.timeUnixNano=o.fixed64();break}case 4:{l.count=o.fixed64();break}case 5:{l.sum=o.double();break}case 6:{l.quantileValues&&l.quantileValues.length||(l.quantileValues=[]),l.quantileValues.push(_.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile.decode(o,o.uint32()));break}case 8:{l.flags=o.uint32();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.attributes!=null&&o.hasOwnProperty("attributes")){if(!Array.isArray(o.attributes))return"attributes: array expected";for(var i=0;i<o.attributes.length;++i){var u=_.opentelemetry.proto.common.v1.KeyValue.verify(o.attributes[i]);if(u)return"attributes."+u}}if(o.startTimeUnixNano!=null&&o.hasOwnProperty("startTimeUnixNano")&&!m.isInteger(o.startTimeUnixNano)&&!(o.startTimeUnixNano&&m.isInteger(o.startTimeUnixNano.low)&&m.isInteger(o.startTimeUnixNano.high)))return"startTimeUnixNano: integer|Long expected";if(o.timeUnixNano!=null&&o.hasOwnProperty("timeUnixNano")&&!m.isInteger(o.timeUnixNano)&&!(o.timeUnixNano&&m.isInteger(o.timeUnixNano.low)&&m.isInteger(o.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(o.count!=null&&o.hasOwnProperty("count")&&!m.isInteger(o.count)&&!(o.count&&m.isInteger(o.count.low)&&m.isInteger(o.count.high)))return"count: integer|Long expected";if(o.sum!=null&&o.hasOwnProperty("sum")&&typeof o.sum!="number")return"sum: number expected";if(o.quantileValues!=null&&o.hasOwnProperty("quantileValues")){if(!Array.isArray(o.quantileValues))return"quantileValues: array expected";for(var i=0;i<o.quantileValues.length;++i){var u=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile.verify(o.quantileValues[i]);if(u)return"quantileValues."+u}}return o.flags!=null&&o.hasOwnProperty("flags")&&!m.isInteger(o.flags)?"flags: integer expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.metrics.v1.SummaryDataPoint)return o;var i=new _.opentelemetry.proto.metrics.v1.SummaryDataPoint;if(o.attributes){if(!Array.isArray(o.attributes))throw TypeError(".opentelemetry.proto.metrics.v1.SummaryDataPoint.attributes: array expected");i.attributes=[];for(var u=0;u<o.attributes.length;++u){if(typeof o.attributes[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.SummaryDataPoint.attributes: object expected");i.attributes[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.attributes[u])}}if(o.startTimeUnixNano!=null&&(m.Long?(i.startTimeUnixNano=m.Long.fromValue(o.startTimeUnixNano)).unsigned=!1:typeof o.startTimeUnixNano=="string"?i.startTimeUnixNano=parseInt(o.startTimeUnixNano,10):typeof o.startTimeUnixNano=="number"?i.startTimeUnixNano=o.startTimeUnixNano:typeof o.startTimeUnixNano=="object"&&(i.startTimeUnixNano=new m.LongBits(o.startTimeUnixNano.low>>>0,o.startTimeUnixNano.high>>>0).toNumber())),o.timeUnixNano!=null&&(m.Long?(i.timeUnixNano=m.Long.fromValue(o.timeUnixNano)).unsigned=!1:typeof o.timeUnixNano=="string"?i.timeUnixNano=parseInt(o.timeUnixNano,10):typeof o.timeUnixNano=="number"?i.timeUnixNano=o.timeUnixNano:typeof o.timeUnixNano=="object"&&(i.timeUnixNano=new m.LongBits(o.timeUnixNano.low>>>0,o.timeUnixNano.high>>>0).toNumber())),o.count!=null&&(m.Long?(i.count=m.Long.fromValue(o.count)).unsigned=!1:typeof o.count=="string"?i.count=parseInt(o.count,10):typeof o.count=="number"?i.count=o.count:typeof o.count=="object"&&(i.count=new m.LongBits(o.count.low>>>0,o.count.high>>>0).toNumber())),o.sum!=null&&(i.sum=Number(o.sum)),o.quantileValues){if(!Array.isArray(o.quantileValues))throw TypeError(".opentelemetry.proto.metrics.v1.SummaryDataPoint.quantileValues: array expected");i.quantileValues=[];for(var u=0;u<o.quantileValues.length;++u){if(typeof o.quantileValues[u]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.SummaryDataPoint.quantileValues: object expected");i.quantileValues[u]=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile.fromObject(o.quantileValues[u])}}return o.flags!=null&&(i.flags=o.flags>>>0),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.quantileValues=[],u.attributes=[]),i.defaults){if(m.Long){var l=new m.Long(0,0,!1);u.startTimeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.startTimeUnixNano=i.longs===String?"0":0;if(m.Long){var l=new m.Long(0,0,!1);u.timeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.timeUnixNano=i.longs===String?"0":0;if(m.Long){var l=new m.Long(0,0,!1);u.count=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.count=i.longs===String?"0":0;u.sum=0,u.flags=0}if(o.startTimeUnixNano!=null&&o.hasOwnProperty("startTimeUnixNano")&&(typeof o.startTimeUnixNano=="number"?u.startTimeUnixNano=i.longs===String?String(o.startTimeUnixNano):o.startTimeUnixNano:u.startTimeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.startTimeUnixNano):i.longs===Number?new m.LongBits(o.startTimeUnixNano.low>>>0,o.startTimeUnixNano.high>>>0).toNumber():o.startTimeUnixNano),o.timeUnixNano!=null&&o.hasOwnProperty("timeUnixNano")&&(typeof o.timeUnixNano=="number"?u.timeUnixNano=i.longs===String?String(o.timeUnixNano):o.timeUnixNano:u.timeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.timeUnixNano):i.longs===Number?new m.LongBits(o.timeUnixNano.low>>>0,o.timeUnixNano.high>>>0).toNumber():o.timeUnixNano),o.count!=null&&o.hasOwnProperty("count")&&(typeof o.count=="number"?u.count=i.longs===String?String(o.count):o.count:u.count=i.longs===String?m.Long.prototype.toString.call(o.count):i.longs===Number?new m.LongBits(o.count.low>>>0,o.count.high>>>0).toNumber():o.count),o.sum!=null&&o.hasOwnProperty("sum")&&(u.sum=i.json&&!isFinite(o.sum)?String(o.sum):o.sum),o.quantileValues&&o.quantileValues.length){u.quantileValues=[];for(var c=0;c<o.quantileValues.length;++c)u.quantileValues[c]=_.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile.toObject(o.quantileValues[c],i)}if(o.attributes&&o.attributes.length){u.attributes=[];for(var c=0;c<o.attributes.length;++c)u.attributes[c]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.attributes[c],i)}return o.flags!=null&&o.hasOwnProperty("flags")&&(u.flags=o.flags),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.metrics.v1.SummaryDataPoint"},s.ValueAtQuantile=(function(){function a(o){if(o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}return a.prototype.quantile=null,a.prototype.value=null,a.create=function(i){return new a(i)},a.encode=function(i,u){return u||(u=ee.create()),i.quantile!=null&&Object.hasOwnProperty.call(i,"quantile")&&u.uint32(9).double(i.quantile),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&u.uint32(17).double(i.value),u},a.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},a.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile;i.pos<l;){var f=i.uint32();switch(f>>>3){case 1:{c.quantile=i.double();break}case 2:{c.value=i.double();break}default:i.skipType(f&7);break}}return c},a.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},a.verify=function(i){return typeof i!="object"||i===null?"object expected":i.quantile!=null&&i.hasOwnProperty("quantile")&&typeof i.quantile!="number"?"quantile: number expected":i.value!=null&&i.hasOwnProperty("value")&&typeof i.value!="number"?"value: number expected":null},a.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile)return i;var u=new _.opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile;return i.quantile!=null&&(u.quantile=Number(i.quantile)),i.value!=null&&(u.value=Number(i.value)),u},a.toObject=function(i,u){u||(u={});var l={};return u.defaults&&(l.quantile=0,l.value=0),i.quantile!=null&&i.hasOwnProperty("quantile")&&(l.quantile=u.json&&!isFinite(i.quantile)?String(i.quantile):i.quantile),i.value!=null&&i.hasOwnProperty("value")&&(l.value=u.json&&!isFinite(i.value)?String(i.value):i.value),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},a.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.SummaryDataPoint.ValueAtQuantile"},a})(),s})(),n.Exemplar=(function(){function s(o){if(this.filteredAttributes=[],o)for(var i=Object.keys(o),u=0;u<i.length;++u)o[i[u]]!=null&&(this[i[u]]=o[i[u]])}s.prototype.filteredAttributes=m.emptyArray,s.prototype.timeUnixNano=null,s.prototype.asDouble=null,s.prototype.asInt=null,s.prototype.spanId=null,s.prototype.traceId=null;var a;return Object.defineProperty(s.prototype,"value",{get:m.oneOfGetter(a=["asDouble","asInt"]),set:m.oneOfSetter(a)}),s.create=function(i){return new s(i)},s.encode=function(i,u){if(u||(u=ee.create()),i.timeUnixNano!=null&&Object.hasOwnProperty.call(i,"timeUnixNano")&&u.uint32(17).fixed64(i.timeUnixNano),i.asDouble!=null&&Object.hasOwnProperty.call(i,"asDouble")&&u.uint32(25).double(i.asDouble),i.spanId!=null&&Object.hasOwnProperty.call(i,"spanId")&&u.uint32(34).bytes(i.spanId),i.traceId!=null&&Object.hasOwnProperty.call(i,"traceId")&&u.uint32(42).bytes(i.traceId),i.asInt!=null&&Object.hasOwnProperty.call(i,"asInt")&&u.uint32(49).sfixed64(i.asInt),i.filteredAttributes!=null&&i.filteredAttributes.length)for(var l=0;l<i.filteredAttributes.length;++l)_.opentelemetry.proto.common.v1.KeyValue.encode(i.filteredAttributes[l],u.uint32(58).fork()).ldelim();return u},s.encodeDelimited=function(i,u){return this.encode(i,u).ldelim()},s.decode=function(i,u){i instanceof w||(i=w.create(i));for(var l=u===void 0?i.len:i.pos+u,c=new _.opentelemetry.proto.metrics.v1.Exemplar;i.pos<l;){var f=i.uint32();switch(f>>>3){case 7:{c.filteredAttributes&&c.filteredAttributes.length||(c.filteredAttributes=[]),c.filteredAttributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(i,i.uint32()));break}case 2:{c.timeUnixNano=i.fixed64();break}case 3:{c.asDouble=i.double();break}case 6:{c.asInt=i.sfixed64();break}case 4:{c.spanId=i.bytes();break}case 5:{c.traceId=i.bytes();break}default:i.skipType(f&7);break}}return c},s.decodeDelimited=function(i){return i instanceof w||(i=new w(i)),this.decode(i,i.uint32())},s.verify=function(i){if(typeof i!="object"||i===null)return"object expected";var u={};if(i.filteredAttributes!=null&&i.hasOwnProperty("filteredAttributes")){if(!Array.isArray(i.filteredAttributes))return"filteredAttributes: array expected";for(var l=0;l<i.filteredAttributes.length;++l){var c=_.opentelemetry.proto.common.v1.KeyValue.verify(i.filteredAttributes[l]);if(c)return"filteredAttributes."+c}}if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&!m.isInteger(i.timeUnixNano)&&!(i.timeUnixNano&&m.isInteger(i.timeUnixNano.low)&&m.isInteger(i.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(i.asDouble!=null&&i.hasOwnProperty("asDouble")&&(u.value=1,typeof i.asDouble!="number"))return"asDouble: number expected";if(i.asInt!=null&&i.hasOwnProperty("asInt")){if(u.value===1)return"value: multiple values";if(u.value=1,!m.isInteger(i.asInt)&&!(i.asInt&&m.isInteger(i.asInt.low)&&m.isInteger(i.asInt.high)))return"asInt: integer|Long expected"}return i.spanId!=null&&i.hasOwnProperty("spanId")&&!(i.spanId&&typeof i.spanId.length=="number"||m.isString(i.spanId))?"spanId: buffer expected":i.traceId!=null&&i.hasOwnProperty("traceId")&&!(i.traceId&&typeof i.traceId.length=="number"||m.isString(i.traceId))?"traceId: buffer expected":null},s.fromObject=function(i){if(i instanceof _.opentelemetry.proto.metrics.v1.Exemplar)return i;var u=new _.opentelemetry.proto.metrics.v1.Exemplar;if(i.filteredAttributes){if(!Array.isArray(i.filteredAttributes))throw TypeError(".opentelemetry.proto.metrics.v1.Exemplar.filteredAttributes: array expected");u.filteredAttributes=[];for(var l=0;l<i.filteredAttributes.length;++l){if(typeof i.filteredAttributes[l]!="object")throw TypeError(".opentelemetry.proto.metrics.v1.Exemplar.filteredAttributes: object expected");u.filteredAttributes[l]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(i.filteredAttributes[l])}}return i.timeUnixNano!=null&&(m.Long?(u.timeUnixNano=m.Long.fromValue(i.timeUnixNano)).unsigned=!1:typeof i.timeUnixNano=="string"?u.timeUnixNano=parseInt(i.timeUnixNano,10):typeof i.timeUnixNano=="number"?u.timeUnixNano=i.timeUnixNano:typeof i.timeUnixNano=="object"&&(u.timeUnixNano=new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber())),i.asDouble!=null&&(u.asDouble=Number(i.asDouble)),i.asInt!=null&&(m.Long?(u.asInt=m.Long.fromValue(i.asInt)).unsigned=!1:typeof i.asInt=="string"?u.asInt=parseInt(i.asInt,10):typeof i.asInt=="number"?u.asInt=i.asInt:typeof i.asInt=="object"&&(u.asInt=new m.LongBits(i.asInt.low>>>0,i.asInt.high>>>0).toNumber())),i.spanId!=null&&(typeof i.spanId=="string"?m.base64.decode(i.spanId,u.spanId=m.newBuffer(m.base64.length(i.spanId)),0):i.spanId.length>=0&&(u.spanId=i.spanId)),i.traceId!=null&&(typeof i.traceId=="string"?m.base64.decode(i.traceId,u.traceId=m.newBuffer(m.base64.length(i.traceId)),0):i.traceId.length>=0&&(u.traceId=i.traceId)),u},s.toObject=function(i,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.filteredAttributes=[]),u.defaults){if(m.Long){var c=new m.Long(0,0,!1);l.timeUnixNano=u.longs===String?c.toString():u.longs===Number?c.toNumber():c}else l.timeUnixNano=u.longs===String?"0":0;u.bytes===String?l.spanId="":(l.spanId=[],u.bytes!==Array&&(l.spanId=m.newBuffer(l.spanId))),u.bytes===String?l.traceId="":(l.traceId=[],u.bytes!==Array&&(l.traceId=m.newBuffer(l.traceId)))}if(i.timeUnixNano!=null&&i.hasOwnProperty("timeUnixNano")&&(typeof i.timeUnixNano=="number"?l.timeUnixNano=u.longs===String?String(i.timeUnixNano):i.timeUnixNano:l.timeUnixNano=u.longs===String?m.Long.prototype.toString.call(i.timeUnixNano):u.longs===Number?new m.LongBits(i.timeUnixNano.low>>>0,i.timeUnixNano.high>>>0).toNumber():i.timeUnixNano),i.asDouble!=null&&i.hasOwnProperty("asDouble")&&(l.asDouble=u.json&&!isFinite(i.asDouble)?String(i.asDouble):i.asDouble,u.oneofs&&(l.value="asDouble")),i.spanId!=null&&i.hasOwnProperty("spanId")&&(l.spanId=u.bytes===String?m.base64.encode(i.spanId,0,i.spanId.length):u.bytes===Array?Array.prototype.slice.call(i.spanId):i.spanId),i.traceId!=null&&i.hasOwnProperty("traceId")&&(l.traceId=u.bytes===String?m.base64.encode(i.traceId,0,i.traceId.length):u.bytes===Array?Array.prototype.slice.call(i.traceId):i.traceId),i.asInt!=null&&i.hasOwnProperty("asInt")&&(typeof i.asInt=="number"?l.asInt=u.longs===String?String(i.asInt):i.asInt:l.asInt=u.longs===String?m.Long.prototype.toString.call(i.asInt):u.longs===Number?new m.LongBits(i.asInt.low>>>0,i.asInt.high>>>0).toNumber():i.asInt,u.oneofs&&(l.value="asInt")),i.filteredAttributes&&i.filteredAttributes.length){l.filteredAttributes=[];for(var f=0;f<i.filteredAttributes.length;++f)l.filteredAttributes[f]=_.opentelemetry.proto.common.v1.KeyValue.toObject(i.filteredAttributes[f],u)}return l},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(i){return i===void 0&&(i="type.googleapis.com"),i+"/opentelemetry.proto.metrics.v1.Exemplar"},s})(),n})(),r})(),e.logs=(function(){var r={};return r.v1=(function(){var n={};return n.LogsData=(function(){function s(a){if(this.resourceLogs=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resourceLogs=m.emptyArray,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resourceLogs!=null&&o.resourceLogs.length)for(var u=0;u<o.resourceLogs.length;++u)_.opentelemetry.proto.logs.v1.ResourceLogs.encode(o.resourceLogs[u],i.uint32(10).fork()).ldelim();return i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.logs.v1.LogsData;o.pos<u;){var c=o.uint32();c>>>3===1?(l.resourceLogs&&l.resourceLogs.length||(l.resourceLogs=[]),l.resourceLogs.push(_.opentelemetry.proto.logs.v1.ResourceLogs.decode(o,o.uint32()))):o.skipType(c&7)}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resourceLogs!=null&&o.hasOwnProperty("resourceLogs")){if(!Array.isArray(o.resourceLogs))return"resourceLogs: array expected";for(var i=0;i<o.resourceLogs.length;++i){var u=_.opentelemetry.proto.logs.v1.ResourceLogs.verify(o.resourceLogs[i]);if(u)return"resourceLogs."+u}}return null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.logs.v1.LogsData)return o;var i=new _.opentelemetry.proto.logs.v1.LogsData;if(o.resourceLogs){if(!Array.isArray(o.resourceLogs))throw TypeError(".opentelemetry.proto.logs.v1.LogsData.resourceLogs: array expected");i.resourceLogs=[];for(var u=0;u<o.resourceLogs.length;++u){if(typeof o.resourceLogs[u]!="object")throw TypeError(".opentelemetry.proto.logs.v1.LogsData.resourceLogs: object expected");i.resourceLogs[u]=_.opentelemetry.proto.logs.v1.ResourceLogs.fromObject(o.resourceLogs[u])}}return i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.resourceLogs=[]),o.resourceLogs&&o.resourceLogs.length){u.resourceLogs=[];for(var l=0;l<o.resourceLogs.length;++l)u.resourceLogs[l]=_.opentelemetry.proto.logs.v1.ResourceLogs.toObject(o.resourceLogs[l],i)}return u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.logs.v1.LogsData"},s})(),n.ResourceLogs=(function(){function s(a){if(this.scopeLogs=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.resource=null,s.prototype.scopeLogs=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.resource!=null&&Object.hasOwnProperty.call(o,"resource")&&_.opentelemetry.proto.resource.v1.Resource.encode(o.resource,i.uint32(10).fork()).ldelim(),o.scopeLogs!=null&&o.scopeLogs.length)for(var u=0;u<o.scopeLogs.length;++u)_.opentelemetry.proto.logs.v1.ScopeLogs.encode(o.scopeLogs[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.logs.v1.ResourceLogs;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.resource=_.opentelemetry.proto.resource.v1.Resource.decode(o,o.uint32());break}case 2:{l.scopeLogs&&l.scopeLogs.length||(l.scopeLogs=[]),l.scopeLogs.push(_.opentelemetry.proto.logs.v1.ScopeLogs.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.resource!=null&&o.hasOwnProperty("resource")){var i=_.opentelemetry.proto.resource.v1.Resource.verify(o.resource);if(i)return"resource."+i}if(o.scopeLogs!=null&&o.hasOwnProperty("scopeLogs")){if(!Array.isArray(o.scopeLogs))return"scopeLogs: array expected";for(var u=0;u<o.scopeLogs.length;++u){var i=_.opentelemetry.proto.logs.v1.ScopeLogs.verify(o.scopeLogs[u]);if(i)return"scopeLogs."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.logs.v1.ResourceLogs)return o;var i=new _.opentelemetry.proto.logs.v1.ResourceLogs;if(o.resource!=null){if(typeof o.resource!="object")throw TypeError(".opentelemetry.proto.logs.v1.ResourceLogs.resource: object expected");i.resource=_.opentelemetry.proto.resource.v1.Resource.fromObject(o.resource)}if(o.scopeLogs){if(!Array.isArray(o.scopeLogs))throw TypeError(".opentelemetry.proto.logs.v1.ResourceLogs.scopeLogs: array expected");i.scopeLogs=[];for(var u=0;u<o.scopeLogs.length;++u){if(typeof o.scopeLogs[u]!="object")throw TypeError(".opentelemetry.proto.logs.v1.ResourceLogs.scopeLogs: object expected");i.scopeLogs[u]=_.opentelemetry.proto.logs.v1.ScopeLogs.fromObject(o.scopeLogs[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.scopeLogs=[]),i.defaults&&(u.resource=null,u.schemaUrl=""),o.resource!=null&&o.hasOwnProperty("resource")&&(u.resource=_.opentelemetry.proto.resource.v1.Resource.toObject(o.resource,i)),o.scopeLogs&&o.scopeLogs.length){u.scopeLogs=[];for(var l=0;l<o.scopeLogs.length;++l)u.scopeLogs[l]=_.opentelemetry.proto.logs.v1.ScopeLogs.toObject(o.scopeLogs[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.logs.v1.ResourceLogs"},s})(),n.ScopeLogs=(function(){function s(a){if(this.logRecords=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.scope=null,s.prototype.logRecords=m.emptyArray,s.prototype.schemaUrl=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.scope!=null&&Object.hasOwnProperty.call(o,"scope")&&_.opentelemetry.proto.common.v1.InstrumentationScope.encode(o.scope,i.uint32(10).fork()).ldelim(),o.logRecords!=null&&o.logRecords.length)for(var u=0;u<o.logRecords.length;++u)_.opentelemetry.proto.logs.v1.LogRecord.encode(o.logRecords[u],i.uint32(18).fork()).ldelim();return o.schemaUrl!=null&&Object.hasOwnProperty.call(o,"schemaUrl")&&i.uint32(26).string(o.schemaUrl),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.logs.v1.ScopeLogs;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.decode(o,o.uint32());break}case 2:{l.logRecords&&l.logRecords.length||(l.logRecords=[]),l.logRecords.push(_.opentelemetry.proto.logs.v1.LogRecord.decode(o,o.uint32()));break}case 3:{l.schemaUrl=o.string();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.scope!=null&&o.hasOwnProperty("scope")){var i=_.opentelemetry.proto.common.v1.InstrumentationScope.verify(o.scope);if(i)return"scope."+i}if(o.logRecords!=null&&o.hasOwnProperty("logRecords")){if(!Array.isArray(o.logRecords))return"logRecords: array expected";for(var u=0;u<o.logRecords.length;++u){var i=_.opentelemetry.proto.logs.v1.LogRecord.verify(o.logRecords[u]);if(i)return"logRecords."+i}}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&!m.isString(o.schemaUrl)?"schemaUrl: string expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.logs.v1.ScopeLogs)return o;var i=new _.opentelemetry.proto.logs.v1.ScopeLogs;if(o.scope!=null){if(typeof o.scope!="object")throw TypeError(".opentelemetry.proto.logs.v1.ScopeLogs.scope: object expected");i.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.fromObject(o.scope)}if(o.logRecords){if(!Array.isArray(o.logRecords))throw TypeError(".opentelemetry.proto.logs.v1.ScopeLogs.logRecords: array expected");i.logRecords=[];for(var u=0;u<o.logRecords.length;++u){if(typeof o.logRecords[u]!="object")throw TypeError(".opentelemetry.proto.logs.v1.ScopeLogs.logRecords: object expected");i.logRecords[u]=_.opentelemetry.proto.logs.v1.LogRecord.fromObject(o.logRecords[u])}}return o.schemaUrl!=null&&(i.schemaUrl=String(o.schemaUrl)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.logRecords=[]),i.defaults&&(u.scope=null,u.schemaUrl=""),o.scope!=null&&o.hasOwnProperty("scope")&&(u.scope=_.opentelemetry.proto.common.v1.InstrumentationScope.toObject(o.scope,i)),o.logRecords&&o.logRecords.length){u.logRecords=[];for(var l=0;l<o.logRecords.length;++l)u.logRecords[l]=_.opentelemetry.proto.logs.v1.LogRecord.toObject(o.logRecords[l],i)}return o.schemaUrl!=null&&o.hasOwnProperty("schemaUrl")&&(u.schemaUrl=o.schemaUrl),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.logs.v1.ScopeLogs"},s})(),n.SeverityNumber=(function(){var s={},a=Object.create(s);return a[s[0]="SEVERITY_NUMBER_UNSPECIFIED"]=0,a[s[1]="SEVERITY_NUMBER_TRACE"]=1,a[s[2]="SEVERITY_NUMBER_TRACE2"]=2,a[s[3]="SEVERITY_NUMBER_TRACE3"]=3,a[s[4]="SEVERITY_NUMBER_TRACE4"]=4,a[s[5]="SEVERITY_NUMBER_DEBUG"]=5,a[s[6]="SEVERITY_NUMBER_DEBUG2"]=6,a[s[7]="SEVERITY_NUMBER_DEBUG3"]=7,a[s[8]="SEVERITY_NUMBER_DEBUG4"]=8,a[s[9]="SEVERITY_NUMBER_INFO"]=9,a[s[10]="SEVERITY_NUMBER_INFO2"]=10,a[s[11]="SEVERITY_NUMBER_INFO3"]=11,a[s[12]="SEVERITY_NUMBER_INFO4"]=12,a[s[13]="SEVERITY_NUMBER_WARN"]=13,a[s[14]="SEVERITY_NUMBER_WARN2"]=14,a[s[15]="SEVERITY_NUMBER_WARN3"]=15,a[s[16]="SEVERITY_NUMBER_WARN4"]=16,a[s[17]="SEVERITY_NUMBER_ERROR"]=17,a[s[18]="SEVERITY_NUMBER_ERROR2"]=18,a[s[19]="SEVERITY_NUMBER_ERROR3"]=19,a[s[20]="SEVERITY_NUMBER_ERROR4"]=20,a[s[21]="SEVERITY_NUMBER_FATAL"]=21,a[s[22]="SEVERITY_NUMBER_FATAL2"]=22,a[s[23]="SEVERITY_NUMBER_FATAL3"]=23,a[s[24]="SEVERITY_NUMBER_FATAL4"]=24,a})(),n.LogRecordFlags=(function(){var s={},a=Object.create(s);return a[s[0]="LOG_RECORD_FLAGS_DO_NOT_USE"]=0,a[s[255]="LOG_RECORD_FLAGS_TRACE_FLAGS_MASK"]=255,a})(),n.LogRecord=(function(){function s(a){if(this.attributes=[],a)for(var o=Object.keys(a),i=0;i<o.length;++i)a[o[i]]!=null&&(this[o[i]]=a[o[i]])}return s.prototype.timeUnixNano=null,s.prototype.observedTimeUnixNano=null,s.prototype.severityNumber=null,s.prototype.severityText=null,s.prototype.body=null,s.prototype.attributes=m.emptyArray,s.prototype.droppedAttributesCount=null,s.prototype.flags=null,s.prototype.traceId=null,s.prototype.spanId=null,s.create=function(o){return new s(o)},s.encode=function(o,i){if(i||(i=ee.create()),o.timeUnixNano!=null&&Object.hasOwnProperty.call(o,"timeUnixNano")&&i.uint32(9).fixed64(o.timeUnixNano),o.severityNumber!=null&&Object.hasOwnProperty.call(o,"severityNumber")&&i.uint32(16).int32(o.severityNumber),o.severityText!=null&&Object.hasOwnProperty.call(o,"severityText")&&i.uint32(26).string(o.severityText),o.body!=null&&Object.hasOwnProperty.call(o,"body")&&_.opentelemetry.proto.common.v1.AnyValue.encode(o.body,i.uint32(42).fork()).ldelim(),o.attributes!=null&&o.attributes.length)for(var u=0;u<o.attributes.length;++u)_.opentelemetry.proto.common.v1.KeyValue.encode(o.attributes[u],i.uint32(50).fork()).ldelim();return o.droppedAttributesCount!=null&&Object.hasOwnProperty.call(o,"droppedAttributesCount")&&i.uint32(56).uint32(o.droppedAttributesCount),o.flags!=null&&Object.hasOwnProperty.call(o,"flags")&&i.uint32(69).fixed32(o.flags),o.traceId!=null&&Object.hasOwnProperty.call(o,"traceId")&&i.uint32(74).bytes(o.traceId),o.spanId!=null&&Object.hasOwnProperty.call(o,"spanId")&&i.uint32(82).bytes(o.spanId),o.observedTimeUnixNano!=null&&Object.hasOwnProperty.call(o,"observedTimeUnixNano")&&i.uint32(89).fixed64(o.observedTimeUnixNano),i},s.encodeDelimited=function(o,i){return this.encode(o,i).ldelim()},s.decode=function(o,i){o instanceof w||(o=w.create(o));for(var u=i===void 0?o.len:o.pos+i,l=new _.opentelemetry.proto.logs.v1.LogRecord;o.pos<u;){var c=o.uint32();switch(c>>>3){case 1:{l.timeUnixNano=o.fixed64();break}case 11:{l.observedTimeUnixNano=o.fixed64();break}case 2:{l.severityNumber=o.int32();break}case 3:{l.severityText=o.string();break}case 5:{l.body=_.opentelemetry.proto.common.v1.AnyValue.decode(o,o.uint32());break}case 6:{l.attributes&&l.attributes.length||(l.attributes=[]),l.attributes.push(_.opentelemetry.proto.common.v1.KeyValue.decode(o,o.uint32()));break}case 7:{l.droppedAttributesCount=o.uint32();break}case 8:{l.flags=o.fixed32();break}case 9:{l.traceId=o.bytes();break}case 10:{l.spanId=o.bytes();break}default:o.skipType(c&7);break}}return l},s.decodeDelimited=function(o){return o instanceof w||(o=new w(o)),this.decode(o,o.uint32())},s.verify=function(o){if(typeof o!="object"||o===null)return"object expected";if(o.timeUnixNano!=null&&o.hasOwnProperty("timeUnixNano")&&!m.isInteger(o.timeUnixNano)&&!(o.timeUnixNano&&m.isInteger(o.timeUnixNano.low)&&m.isInteger(o.timeUnixNano.high)))return"timeUnixNano: integer|Long expected";if(o.observedTimeUnixNano!=null&&o.hasOwnProperty("observedTimeUnixNano")&&!m.isInteger(o.observedTimeUnixNano)&&!(o.observedTimeUnixNano&&m.isInteger(o.observedTimeUnixNano.low)&&m.isInteger(o.observedTimeUnixNano.high)))return"observedTimeUnixNano: integer|Long expected";if(o.severityNumber!=null&&o.hasOwnProperty("severityNumber"))switch(o.severityNumber){default:return"severityNumber: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:break}if(o.severityText!=null&&o.hasOwnProperty("severityText")&&!m.isString(o.severityText))return"severityText: string expected";if(o.body!=null&&o.hasOwnProperty("body")){var i=_.opentelemetry.proto.common.v1.AnyValue.verify(o.body);if(i)return"body."+i}if(o.attributes!=null&&o.hasOwnProperty("attributes")){if(!Array.isArray(o.attributes))return"attributes: array expected";for(var u=0;u<o.attributes.length;++u){var i=_.opentelemetry.proto.common.v1.KeyValue.verify(o.attributes[u]);if(i)return"attributes."+i}}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&!m.isInteger(o.droppedAttributesCount)?"droppedAttributesCount: integer expected":o.flags!=null&&o.hasOwnProperty("flags")&&!m.isInteger(o.flags)?"flags: integer expected":o.traceId!=null&&o.hasOwnProperty("traceId")&&!(o.traceId&&typeof o.traceId.length=="number"||m.isString(o.traceId))?"traceId: buffer expected":o.spanId!=null&&o.hasOwnProperty("spanId")&&!(o.spanId&&typeof o.spanId.length=="number"||m.isString(o.spanId))?"spanId: buffer expected":null},s.fromObject=function(o){if(o instanceof _.opentelemetry.proto.logs.v1.LogRecord)return o;var i=new _.opentelemetry.proto.logs.v1.LogRecord;switch(o.timeUnixNano!=null&&(m.Long?(i.timeUnixNano=m.Long.fromValue(o.timeUnixNano)).unsigned=!1:typeof o.timeUnixNano=="string"?i.timeUnixNano=parseInt(o.timeUnixNano,10):typeof o.timeUnixNano=="number"?i.timeUnixNano=o.timeUnixNano:typeof o.timeUnixNano=="object"&&(i.timeUnixNano=new m.LongBits(o.timeUnixNano.low>>>0,o.timeUnixNano.high>>>0).toNumber())),o.observedTimeUnixNano!=null&&(m.Long?(i.observedTimeUnixNano=m.Long.fromValue(o.observedTimeUnixNano)).unsigned=!1:typeof o.observedTimeUnixNano=="string"?i.observedTimeUnixNano=parseInt(o.observedTimeUnixNano,10):typeof o.observedTimeUnixNano=="number"?i.observedTimeUnixNano=o.observedTimeUnixNano:typeof o.observedTimeUnixNano=="object"&&(i.observedTimeUnixNano=new m.LongBits(o.observedTimeUnixNano.low>>>0,o.observedTimeUnixNano.high>>>0).toNumber())),o.severityNumber){default:if(typeof o.severityNumber=="number"){i.severityNumber=o.severityNumber;break}break;case"SEVERITY_NUMBER_UNSPECIFIED":case 0:i.severityNumber=0;break;case"SEVERITY_NUMBER_TRACE":case 1:i.severityNumber=1;break;case"SEVERITY_NUMBER_TRACE2":case 2:i.severityNumber=2;break;case"SEVERITY_NUMBER_TRACE3":case 3:i.severityNumber=3;break;case"SEVERITY_NUMBER_TRACE4":case 4:i.severityNumber=4;break;case"SEVERITY_NUMBER_DEBUG":case 5:i.severityNumber=5;break;case"SEVERITY_NUMBER_DEBUG2":case 6:i.severityNumber=6;break;case"SEVERITY_NUMBER_DEBUG3":case 7:i.severityNumber=7;break;case"SEVERITY_NUMBER_DEBUG4":case 8:i.severityNumber=8;break;case"SEVERITY_NUMBER_INFO":case 9:i.severityNumber=9;break;case"SEVERITY_NUMBER_INFO2":case 10:i.severityNumber=10;break;case"SEVERITY_NUMBER_INFO3":case 11:i.severityNumber=11;break;case"SEVERITY_NUMBER_INFO4":case 12:i.severityNumber=12;break;case"SEVERITY_NUMBER_WARN":case 13:i.severityNumber=13;break;case"SEVERITY_NUMBER_WARN2":case 14:i.severityNumber=14;break;case"SEVERITY_NUMBER_WARN3":case 15:i.severityNumber=15;break;case"SEVERITY_NUMBER_WARN4":case 16:i.severityNumber=16;break;case"SEVERITY_NUMBER_ERROR":case 17:i.severityNumber=17;break;case"SEVERITY_NUMBER_ERROR2":case 18:i.severityNumber=18;break;case"SEVERITY_NUMBER_ERROR3":case 19:i.severityNumber=19;break;case"SEVERITY_NUMBER_ERROR4":case 20:i.severityNumber=20;break;case"SEVERITY_NUMBER_FATAL":case 21:i.severityNumber=21;break;case"SEVERITY_NUMBER_FATAL2":case 22:i.severityNumber=22;break;case"SEVERITY_NUMBER_FATAL3":case 23:i.severityNumber=23;break;case"SEVERITY_NUMBER_FATAL4":case 24:i.severityNumber=24;break}if(o.severityText!=null&&(i.severityText=String(o.severityText)),o.body!=null){if(typeof o.body!="object")throw TypeError(".opentelemetry.proto.logs.v1.LogRecord.body: object expected");i.body=_.opentelemetry.proto.common.v1.AnyValue.fromObject(o.body)}if(o.attributes){if(!Array.isArray(o.attributes))throw TypeError(".opentelemetry.proto.logs.v1.LogRecord.attributes: array expected");i.attributes=[];for(var u=0;u<o.attributes.length;++u){if(typeof o.attributes[u]!="object")throw TypeError(".opentelemetry.proto.logs.v1.LogRecord.attributes: object expected");i.attributes[u]=_.opentelemetry.proto.common.v1.KeyValue.fromObject(o.attributes[u])}}return o.droppedAttributesCount!=null&&(i.droppedAttributesCount=o.droppedAttributesCount>>>0),o.flags!=null&&(i.flags=o.flags>>>0),o.traceId!=null&&(typeof o.traceId=="string"?m.base64.decode(o.traceId,i.traceId=m.newBuffer(m.base64.length(o.traceId)),0):o.traceId.length>=0&&(i.traceId=o.traceId)),o.spanId!=null&&(typeof o.spanId=="string"?m.base64.decode(o.spanId,i.spanId=m.newBuffer(m.base64.length(o.spanId)),0):o.spanId.length>=0&&(i.spanId=o.spanId)),i},s.toObject=function(o,i){i||(i={});var u={};if((i.arrays||i.defaults)&&(u.attributes=[]),i.defaults){if(m.Long){var l=new m.Long(0,0,!1);u.timeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.timeUnixNano=i.longs===String?"0":0;if(u.severityNumber=i.enums===String?"SEVERITY_NUMBER_UNSPECIFIED":0,u.severityText="",u.body=null,u.droppedAttributesCount=0,u.flags=0,i.bytes===String?u.traceId="":(u.traceId=[],i.bytes!==Array&&(u.traceId=m.newBuffer(u.traceId))),i.bytes===String?u.spanId="":(u.spanId=[],i.bytes!==Array&&(u.spanId=m.newBuffer(u.spanId))),m.Long){var l=new m.Long(0,0,!1);u.observedTimeUnixNano=i.longs===String?l.toString():i.longs===Number?l.toNumber():l}else u.observedTimeUnixNano=i.longs===String?"0":0}if(o.timeUnixNano!=null&&o.hasOwnProperty("timeUnixNano")&&(typeof o.timeUnixNano=="number"?u.timeUnixNano=i.longs===String?String(o.timeUnixNano):o.timeUnixNano:u.timeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.timeUnixNano):i.longs===Number?new m.LongBits(o.timeUnixNano.low>>>0,o.timeUnixNano.high>>>0).toNumber():o.timeUnixNano),o.severityNumber!=null&&o.hasOwnProperty("severityNumber")&&(u.severityNumber=i.enums===String?_.opentelemetry.proto.logs.v1.SeverityNumber[o.severityNumber]===void 0?o.severityNumber:_.opentelemetry.proto.logs.v1.SeverityNumber[o.severityNumber]:o.severityNumber),o.severityText!=null&&o.hasOwnProperty("severityText")&&(u.severityText=o.severityText),o.body!=null&&o.hasOwnProperty("body")&&(u.body=_.opentelemetry.proto.common.v1.AnyValue.toObject(o.body,i)),o.attributes&&o.attributes.length){u.attributes=[];for(var c=0;c<o.attributes.length;++c)u.attributes[c]=_.opentelemetry.proto.common.v1.KeyValue.toObject(o.attributes[c],i)}return o.droppedAttributesCount!=null&&o.hasOwnProperty("droppedAttributesCount")&&(u.droppedAttributesCount=o.droppedAttributesCount),o.flags!=null&&o.hasOwnProperty("flags")&&(u.flags=o.flags),o.traceId!=null&&o.hasOwnProperty("traceId")&&(u.traceId=i.bytes===String?m.base64.encode(o.traceId,0,o.traceId.length):i.bytes===Array?Array.prototype.slice.call(o.traceId):o.traceId),o.spanId!=null&&o.hasOwnProperty("spanId")&&(u.spanId=i.bytes===String?m.base64.encode(o.spanId,0,o.spanId.length):i.bytes===Array?Array.prototype.slice.call(o.spanId):o.spanId),o.observedTimeUnixNano!=null&&o.hasOwnProperty("observedTimeUnixNano")&&(typeof o.observedTimeUnixNano=="number"?u.observedTimeUnixNano=i.longs===String?String(o.observedTimeUnixNano):o.observedTimeUnixNano:u.observedTimeUnixNano=i.longs===String?m.Long.prototype.toString.call(o.observedTimeUnixNano):i.longs===Number?new m.LongBits(o.observedTimeUnixNano.low>>>0,o.observedTimeUnixNano.high>>>0).toNumber():o.observedTimeUnixNano),u},s.prototype.toJSON=function(){return this.constructor.toObject(this,W.util.toJSONOptions)},s.getTypeUrl=function(o){return o===void 0&&(o="type.googleapis.com"),o+"/opentelemetry.proto.logs.v1.LogRecord"},s})(),n})(),r})(),e})(),t})();QW.exports=_});var zh=p(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});bl.ServiceClientType=void 0;var Uae;(function(t){t[t.SPANS=0]="SPANS",t[t.METRICS=1]="METRICS",t[t.LOGS=2]="LOGS"})(Uae=bl.ServiceClientType||(bl.ServiceClientType={}))});var Qh=p(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});Kh.getExportRequestProto=void 0;var wO=JW(),XW=zh();function kae(t){return t===XW.ServiceClientType.SPANS?wO.opentelemetry.proto.collector.trace.v1.ExportTraceServiceRequest:t===XW.ServiceClientType.LOGS?wO.opentelemetry.proto.collector.logs.v1.ExportLogsServiceRequest:wO.opentelemetry.proto.collector.metrics.v1.ExportMetricsServiceRequest}Kh.getExportRequestProto=kae});var OO=p(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.send=void 0;var ZW=Ys(),Bae=Qh();function qae(t,e,r,n,s){let a=t.convert(e),o=(0,Bae.getExportRequestProto)(t.getServiceClientType()),i=o.create(a);if(i){let u=o.encode(i).finish();u&&(0,ZW.sendWithHttp)(t,Buffer.from(u),"application/x-protobuf",n,s)}else s(new ZW.OTLPExporterError("No proto"))}Jh.send=qae});var e3=p(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.OTLPProtoExporterNodeBase=void 0;var Vae=(k(),B(U)),Fae=Ys(),vO=class extends Fae.OTLPExporterNodeBase{constructor(e={}){super(e)}_sendPromise(e,r,n){let s=new Promise((o,i)=>{this._send(this,e,this.compression,o,i)}).then(r,n);this._sendingPromises.push(s);let a=()=>{let o=this._sendingPromises.indexOf(s);this._sendingPromises.splice(o,1)};s.then(a,a)}send(e,r,n){if(this._shutdownOnce.isCalled){Vae.diag.debug("Shutdown already started. Cannot send objects");return}this._send?this._sendPromise(e,r,n):setImmediate(()=>{let{send:s}=OO();this._send=s,this._sendPromise(e,r,n)})}};Xh.OTLPProtoExporterNodeBase=vO});var t3=p(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.send=Ks.OTLPProtoExporterNodeBase=void 0;var $ae=e3();Object.defineProperty(Ks,"OTLPProtoExporterNodeBase",{enumerable:!0,get:function(){return $ae.OTLPProtoExporterNodeBase}});var Gae=OO();Object.defineProperty(Ks,"send",{enumerable:!0,get:function(){return Gae.send}})});var r3=p(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.OTLPProtoExporterBrowserBase=void 0;var Wae=(k(),B(U)),bO=Ys(),jae=Qh(),AO=class extends bO.OTLPExporterBrowserBase{constructor(e={}){super(e)}send(e,r,n){if(this._shutdownOnce.isCalled){Wae.diag.debug("Shutdown already started. Cannot send objects");return}let s=this.convert(e),a=(0,jae.getExportRequestProto)(this.getServiceClientType()),o=a.create(s);if(o){let i=a.encode(o).finish();i&&(0,bO.sendWithXhr)(new Blob([i],{type:"application/x-protobuf"}),this.url,Object.assign(Object.assign({},this._headers),{"Content-Type":"application/x-protobuf",Accept:"application/x-protobuf"}),this.timeoutMillis,r,n)}else n(new bO.OTLPExporterError("No proto"))}};Zh.OTLPProtoExporterBrowserBase=AO});var n3=p(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.ServiceClientType=Qs.OTLPProtoExporterBrowserBase=void 0;var Hae=r3();Object.defineProperty(Qs,"OTLPProtoExporterBrowserBase",{enumerable:!0,get:function(){return Hae.OTLPProtoExporterBrowserBase}});var Yae=zh();Object.defineProperty(Qs,"ServiceClientType",{enumerable:!0,get:function(){return Yae.ServiceClientType}})});var o3=p(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.getExportRequestProto=yr.ServiceClientType=yr.OTLPProtoExporterBrowserBase=yr.send=yr.OTLPProtoExporterNodeBase=void 0;var i3=t3();Object.defineProperty(yr,"OTLPProtoExporterNodeBase",{enumerable:!0,get:function(){return i3.OTLPProtoExporterNodeBase}});Object.defineProperty(yr,"send",{enumerable:!0,get:function(){return i3.send}});var zae=n3();Object.defineProperty(yr,"OTLPProtoExporterBrowserBase",{enumerable:!0,get:function(){return zae.OTLPProtoExporterBrowserBase}});var Kae=zh();Object.defineProperty(yr,"ServiceClientType",{enumerable:!0,get:function(){return Kae.ServiceClientType}});var Qae=Qh();Object.defineProperty(yr,"getExportRequestProto",{enumerable:!0,get:function(){return Qae.getExportRequestProto}})});var RO=p(Po=>{"use strict";var Jae=Po&&Po.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Xae=Po&&Po.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Jae(e,t,r)};Object.defineProperty(Po,"__esModule",{value:!0});Xae(o3(),Po)});var a3=p(s3=>{"use strict";Object.defineProperty(s3,"__esModule",{value:!0})});var Al=p(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.getOtlpEncoder=Tr.encodeAsString=Tr.encodeAsLongBits=Tr.toLongBits=Tr.hrTimeToNanos=void 0;var e_=te();function NO(t){let e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}Tr.hrTimeToNanos=NO;function l3(t){let e=Number(BigInt.asUintN(32,t)),r=Number(BigInt.asUintN(32,t>>BigInt(32)));return{low:e,high:r}}Tr.toLongBits=l3;function PO(t){let e=NO(t);return l3(e)}Tr.encodeAsLongBits=PO;function c3(t){return NO(t).toString()}Tr.encodeAsString=c3;var Zae=typeof BigInt<"u"?c3:e_.hrTimeToNanoseconds;function u3(t){return t}function f3(t){if(t!==void 0)return(0,e_.hexToBinary)(t)}var eue={encodeHrTime:PO,encodeSpanContext:e_.hexToBinary,encodeOptionalSpanContext:f3};function tue(t){var e,r;if(t===void 0)return eue;let n=(e=t.useLongBits)!==null&&e!==void 0?e:!0,s=(r=t.useHex)!==null&&r!==void 0?r:!1;return{encodeHrTime:n?PO:Zae,encodeSpanContext:s?u3:e_.hexToBinary,encodeOptionalSpanContext:s?u3:f3}}Tr.getOtlpEncoder=tue});var p3=p(d3=>{"use strict";Object.defineProperty(d3,"__esModule",{value:!0})});var _3=p(h3=>{"use strict";Object.defineProperty(h3,"__esModule",{value:!0})});var m3=p(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.ESpanKind=void 0;var rue;(function(t){t[t.SPAN_KIND_UNSPECIFIED=0]="SPAN_KIND_UNSPECIFIED",t[t.SPAN_KIND_INTERNAL=1]="SPAN_KIND_INTERNAL",t[t.SPAN_KIND_SERVER=2]="SPAN_KIND_SERVER",t[t.SPAN_KIND_CLIENT=3]="SPAN_KIND_CLIENT",t[t.SPAN_KIND_PRODUCER=4]="SPAN_KIND_PRODUCER",t[t.SPAN_KIND_CONSUMER=5]="SPAN_KIND_CONSUMER"})(rue=Rl.ESpanKind||(Rl.ESpanKind={}))});var E3=p(S3=>{"use strict";Object.defineProperty(S3,"__esModule",{value:!0})});var Nl=p(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.toAnyValue=hi.toKeyValue=hi.toAttributes=void 0;function nue(t){return Object.keys(t).map(e=>IO(e,t[e]))}hi.toAttributes=nue;function IO(t,e){return{key:t,value:MO(e)}}hi.toKeyValue=IO;function MO(t){let e=typeof t;return e==="string"?{stringValue:t}:e==="number"?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:e==="boolean"?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(MO)}}:e==="object"&&t!=null?{kvlistValue:{values:Object.entries(t).map(([r,n])=>IO(r,n))}}:{}}hi.toAnyValue=MO});var T3=p(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.toOtlpSpanEvent=_i.toOtlpLink=_i.sdkSpanToOtlpSpan=void 0;var LO=Nl();function iue(t,e){var r;let n=t.spanContext(),s=t.status;return{traceId:e.encodeSpanContext(n.traceId),spanId:e.encodeSpanContext(n.spanId),parentSpanId:e.encodeOptionalSpanContext(t.parentSpanId),traceState:(r=n.traceState)===null||r===void 0?void 0:r.serialize(),name:t.name,kind:t.kind==null?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:(0,LO.toAttributes)(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(a=>y3(a,e)),droppedEventsCount:t.droppedEventsCount,status:{code:s.code,message:s.message},links:t.links.map(a=>g3(a,e)),droppedLinksCount:t.droppedLinksCount}}_i.sdkSpanToOtlpSpan=iue;function g3(t,e){var r;return{attributes:t.attributes?(0,LO.toAttributes)(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:(r=t.context.traceState)===null||r===void 0?void 0:r.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}_i.toOtlpLink=g3;function y3(t,e){return{attributes:t.attributes?(0,LO.toAttributes)(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}_i.toOtlpSpanEvent=y3});var w3=p(t_=>{"use strict";Object.defineProperty(t_,"__esModule",{value:!0});t_.createExportTraceServiceRequest=void 0;var oue=Nl(),sue=T3(),aue=Al();function uue(t,e){let r=(0,aue.getOtlpEncoder)(e);return{resourceSpans:cue(t,r)}}t_.createExportTraceServiceRequest=uue;function lue(t){let e=new Map;for(let r of t){let n=e.get(r.resource);n||(n=new Map,e.set(r.resource,n));let s=`${r.instrumentationLibrary.name}@${r.instrumentationLibrary.version||""}:${r.instrumentationLibrary.schemaUrl||""}`,a=n.get(s);a||(a=[],n.set(s,a)),a.push(r)}return e}function cue(t,e){let r=lue(t),n=[],s=r.entries(),a=s.next();for(;!a.done;){let[o,i]=a.value,u=[],l=i.values(),c=l.next();for(;!c.done;){let h=c.value;if(h.length>0){let{name:S,version:g,schemaUrl:E}=h[0].instrumentationLibrary,T=h.map(O=>(0,sue.sdkSpanToOtlpSpan)(O,e));u.push({scope:{name:S,version:g},spans:T,schemaUrl:E})}c=l.next()}let f={resource:{attributes:(0,oue.toAttributes)(o.attributes),droppedAttributesCount:0},scopeSpans:u,schemaUrl:void 0};n.push(f),a=s.next()}return n}});var r_=p(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.AggregationTemporality=void 0;var fue;(function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"})(fue=Pl.AggregationTemporality||(Pl.AggregationTemporality={}))});var Js=p(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.DataPointType=void 0;var due;(function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"})(due=Il.DataPointType||(Il.DataPointType={}))});var cn=p(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.equalsCaseInsensitive=De.binarySearchLB=De.setEquals=De.FlatMap=De.isPromiseAllSettledRejectionResult=De.PromiseAllSettled=De.callWithTimeout=De.TimeoutError=De.instrumentationScopeId=De.hashAttributes=De.isNotNullish=void 0;function pue(t){return t!=null}De.isNotNullish=pue;function hue(t){let e=Object.keys(t);return e.length===0?"":(e=e.sort(),JSON.stringify(e.map(r=>[r,t[r]])))}De.hashAttributes=hue;function _ue(t){var e,r;return`${t.name}:${(e=t.version)!==null&&e!==void 0?e:""}:${(r=t.schemaUrl)!==null&&r!==void 0?r:""}`}De.instrumentationScopeId=_ue;var n_=class t extends Error{constructor(e){super(e),Object.setPrototypeOf(this,t.prototype)}};De.TimeoutError=n_;function mue(t,e){let r,n=new Promise(function(a,o){r=setTimeout(function(){o(new n_("Operation timed out."))},e)});return Promise.race([t,n]).then(s=>(clearTimeout(r),s),s=>{throw clearTimeout(r),s})}De.callWithTimeout=mue;async function Sue(t){return Promise.all(t.map(async e=>{try{return{status:"fulfilled",value:await e}}catch(r){return{status:"rejected",reason:r}}}))}De.PromiseAllSettled=Sue;function Eue(t){return t.status==="rejected"}De.isPromiseAllSettledRejectionResult=Eue;function gue(t,e){let r=[];return t.forEach(n=>{r.push(...e(n))}),r}De.FlatMap=gue;function yue(t,e){if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}De.setEquals=yue;function Tue(t,e){let r=0,n=t.length-1;for(;n-r>1;){let s=Math.trunc((n+r)/2);t[s]<=e?r=s:n=s-1}return t[n]<=e?n:t[r]<=e?r:-1}De.binarySearchLB=Tue;function wue(t,e){return t.toLowerCase()===e.toLowerCase()}De.equalsCaseInsensitive=wue});var Xs=p(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.AggregatorKind=void 0;var Oue;(function(t){t[t.DROP=0]="DROP",t[t.SUM=1]="SUM",t[t.LAST_VALUE=2]="LAST_VALUE",t[t.HISTOGRAM=3]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"})(Oue=Ml.AggregatorKind||(Ml.AggregatorKind={}))});var O3=p(i_=>{"use strict";Object.defineProperty(i_,"__esModule",{value:!0});i_.DropAggregator=void 0;var vue=Xs(),CO=class{constructor(){this.kind=vue.AggregatorKind.DROP}createAccumulation(){}merge(e,r){}diff(e,r){}toMetricData(e,r,n,s){}};i_.DropAggregator=CO});var Pn=p(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.isValidName=ur.isDescriptorCompatibleWith=ur.createInstrumentDescriptorWithView=ur.createInstrumentDescriptor=ur.InstrumentType=void 0;var v3=(k(),B(U)),bue=cn(),Aue;(function(t){t.COUNTER="COUNTER",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(Aue=ur.InstrumentType||(ur.InstrumentType={}));function Rue(t,e,r){var n,s,a,o;return b3(t)||v3.diag.warn(`Invalid metric name: "${t}". The metric name should be a ASCII string with a length no greater than 255 characters.`),{name:t,type:e,description:(n=r?.description)!==null&&n!==void 0?n:"",unit:(s=r?.unit)!==null&&s!==void 0?s:"",valueType:(a=r?.valueType)!==null&&a!==void 0?a:v3.ValueType.DOUBLE,advice:(o=r?.advice)!==null&&o!==void 0?o:{}}}ur.createInstrumentDescriptor=Rue;function Nue(t,e){var r,n;return{name:(r=t.name)!==null&&r!==void 0?r:e.name,description:(n=t.description)!==null&&n!==void 0?n:e.description,type:e.type,unit:e.unit,valueType:e.valueType,advice:e.advice}}ur.createInstrumentDescriptorWithView=Nue;function Pue(t,e){return(0,bue.equalsCaseInsensitive)(t.name,e.name)&&t.unit===e.unit&&t.type===e.type&&t.valueType===e.valueType}ur.isDescriptorCompatibleWith=Pue;var Iue=/^[a-z][a-z0-9_.\-/]{0,254}$/i;function b3(t){return t.match(Iue)!=null}ur.isValidName=b3});var A3=p(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.HistogramAggregator=ea.HistogramAccumulation=void 0;var Mue=Xs(),Lue=Js(),DO=Pn(),Cue=cn();function Due(t){let e=t.map(()=>0);return e.push(0),{buckets:{boundaries:t,counts:e},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}var Zs=class{constructor(e,r,n=!0,s=Due(r)){this.startTime=e,this._boundaries=r,this._recordMinMax=n,this._current=s}record(e){if(Number.isNaN(e))return;this._current.count+=1,this._current.sum+=e,this._recordMinMax&&(this._current.min=Math.min(e,this._current.min),this._current.max=Math.max(e,this._current.max),this._current.hasMinMax=!0);let r=(0,Cue.binarySearchLB)(this._boundaries,e);this._current.buckets.counts[r+1]+=1}setStartTime(e){this.startTime=e}toPointValue(){return this._current}};ea.HistogramAccumulation=Zs;var xO=class{constructor(e,r){this._boundaries=e,this._recordMinMax=r,this.kind=Mue.AggregatorKind.HISTOGRAM}createAccumulation(e){return new Zs(e,this._boundaries,this._recordMinMax)}merge(e,r){let n=e.toPointValue(),s=r.toPointValue(),a=n.buckets.counts,o=s.buckets.counts,i=new Array(a.length);for(let c=0;c<a.length;c++)i[c]=a[c]+o[c];let u=1/0,l=-1/0;return this._recordMinMax&&(n.hasMinMax&&s.hasMinMax?(u=Math.min(n.min,s.min),l=Math.max(n.max,s.max)):n.hasMinMax?(u=n.min,l=n.max):s.hasMinMax&&(u=s.min,l=s.max)),new Zs(e.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:i},count:n.count+s.count,sum:n.sum+s.sum,hasMinMax:this._recordMinMax&&(n.hasMinMax||s.hasMinMax),min:u,max:l})}diff(e,r){let n=e.toPointValue(),s=r.toPointValue(),a=n.buckets.counts,o=s.buckets.counts,i=new Array(a.length);for(let u=0;u<a.length;u++)i[u]=o[u]-a[u];return new Zs(r.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:i},count:s.count-n.count,sum:s.sum-n.sum,hasMinMax:!1,min:1/0,max:-1/0})}toMetricData(e,r,n,s){return{descriptor:e,aggregationTemporality:r,dataPointType:Lue.DataPointType.HISTOGRAM,dataPoints:n.map(([a,o])=>{let i=o.toPointValue(),u=e.type===DO.InstrumentType.UP_DOWN_COUNTER||e.type===DO.InstrumentType.OBSERVABLE_GAUGE||e.type===DO.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:a,startTime:o.startTime,endTime:s,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:u?void 0:i.sum,buckets:i.buckets,count:i.count}}})}}};ea.HistogramAggregator=xO});var R3=p(o_=>{"use strict";Object.defineProperty(o_,"__esModule",{value:!0});o_.Buckets=void 0;var UO=class t{constructor(e=new kO,r=0,n=0,s=0){this.backing=e,this.indexBase=r,this.indexStart=n,this.indexEnd=s}get offset(){return this.indexStart}get length(){return this.backing.length===0||this.indexEnd===this.indexStart&&this.at(0)===0?0:this.indexEnd-this.indexStart+1}counts(){return Array.from({length:this.length},(e,r)=>this.at(r))}at(e){let r=this.indexBase-this.indexStart;return e<r&&(e+=this.backing.length),e-=r,this.backing.countAt(e)}incrementBucket(e,r){this.backing.increment(e,r)}decrementBucket(e,r){this.backing.decrement(e,r)}trim(){for(let e=0;e<this.length;e++)if(this.at(e)!==0){this.indexStart+=e;break}else if(e===this.length-1){this.indexStart=this.indexEnd=this.indexBase=0;return}for(let e=this.length-1;e>=0;e--)if(this.at(e)!==0){this.indexEnd-=this.length-e-1;break}this._rotate()}downscale(e){this._rotate();let r=1+this.indexEnd-this.indexStart,n=1<<e,s=0,a=0;for(let o=this.indexStart;o<=this.indexEnd;){let i=o%n;i<0&&(i+=n);for(let u=i;u<n&&s<r;u++)this._relocateBucket(a,s),s++,o++;a++}this.indexStart>>=e,this.indexEnd>>=e,this.indexBase=this.indexStart}clone(){return new t(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)}_rotate(){let e=this.indexBase-this.indexStart;e!==0&&(e>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,e),this.backing.reverse(e,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+e)),this.indexBase=this.indexStart)}_relocateBucket(e,r){e!==r&&this.incrementBucket(e,this.backing.emptyBucket(r))}};o_.Buckets=UO;var kO=class t{constructor(e=[0]){this._counts=e}get length(){return this._counts.length}countAt(e){return this._counts[e]}growTo(e,r,n){let s=new Array(e).fill(0);s.splice(n,this._counts.length-r,...this._counts.slice(r)),s.splice(0,r,...this._counts.slice(0,r)),this._counts=s}reverse(e,r){let n=Math.floor((e+r)/2)-e;for(let s=0;s<n;s++){let a=this._counts[e+s];this._counts[e+s]=this._counts[r-s-1],this._counts[r-s-1]=a}}emptyBucket(e){let r=this._counts[e];return this._counts[e]=0,r}increment(e,r){this._counts[e]+=r}decrement(e,r){this._counts[e]>=r?this._counts[e]-=r:this._counts[e]=0}clone(){return new t([...this._counts])}}});var qO=p(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.getSignificand=Wt.getNormalBase2=Wt.MIN_VALUE=Wt.MAX_NORMAL_EXPONENT=Wt.MIN_NORMAL_EXPONENT=Wt.SIGNIFICAND_WIDTH=void 0;Wt.SIGNIFICAND_WIDTH=52;var xue=2146435072,Uue=1048575,BO=1023;Wt.MIN_NORMAL_EXPONENT=-BO+1;Wt.MAX_NORMAL_EXPONENT=BO;Wt.MIN_VALUE=Math.pow(2,-1022);function kue(t){let e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t),((e.getUint32(0)&xue)>>20)-BO}Wt.getNormalBase2=kue;function Bue(t){let e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t);let r=e.getUint32(0),n=e.getUint32(4);return(r&Uue)*Math.pow(2,32)+n}Wt.getSignificand=Bue});var s_=p(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.nextGreaterSquare=ta.ldexp=void 0;function que(t,e){return t===0||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||Number.isNaN(t)?t:t*Math.pow(2,e)}ta.ldexp=que;function Vue(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}ta.nextGreaterSquare=Vue});var u_=p(a_=>{"use strict";Object.defineProperty(a_,"__esModule",{value:!0});a_.MappingError=void 0;var VO=class extends Error{};a_.MappingError=VO});var P3=p(l_=>{"use strict";Object.defineProperty(l_,"__esModule",{value:!0});l_.ExponentMapping=void 0;var ra=qO(),Fue=s_(),N3=u_(),FO=class{constructor(e){this._shift=-e}mapToIndex(e){if(e<ra.MIN_VALUE)return this._minNormalLowerBoundaryIndex();let r=ra.getNormalBase2(e),n=this._rightShift(ra.getSignificand(e)-1,ra.SIGNIFICAND_WIDTH);return r+n>>this._shift}lowerBoundary(e){let r=this._minNormalLowerBoundaryIndex();if(e<r)throw new N3.MappingError(`underflow: ${e} is < minimum lower boundary: ${r}`);let n=this._maxNormalLowerBoundaryIndex();if(e>n)throw new N3.MappingError(`overflow: ${e} is > maximum lower boundary: ${n}`);return Fue.ldexp(1,e<<this._shift)}get scale(){return this._shift===0?0:-this._shift}_minNormalLowerBoundaryIndex(){let e=ra.MIN_NORMAL_EXPONENT>>this._shift;return this._shift<2&&e--,e}_maxNormalLowerBoundaryIndex(){return ra.MAX_NORMAL_EXPONENT>>this._shift}_rightShift(e,r){return Math.floor(e*Math.pow(2,-r))}};l_.ExponentMapping=FO});var L3=p(c_=>{"use strict";Object.defineProperty(c_,"__esModule",{value:!0});c_.LogarithmMapping=void 0;var na=qO(),I3=s_(),M3=u_(),$O=class{constructor(e){this._scale=e,this._scaleFactor=I3.ldexp(Math.LOG2E,e),this._inverseFactor=I3.ldexp(Math.LN2,-e)}mapToIndex(e){if(e<=na.MIN_VALUE)return this._minNormalLowerBoundaryIndex()-1;if(na.getSignificand(e)===0)return(na.getNormalBase2(e)<<this._scale)-1;let r=Math.floor(Math.log(e)*this._scaleFactor),n=this._maxNormalLowerBoundaryIndex();return r>=n?n:r}lowerBoundary(e){let r=this._maxNormalLowerBoundaryIndex();if(e>=r){if(e===r)return 2*Math.exp((e-(1<<this._scale))/this._scaleFactor);throw new M3.MappingError(`overflow: ${e} is > maximum lower boundary: ${r}`)}let n=this._minNormalLowerBoundaryIndex();if(e<=n){if(e===n)return na.MIN_VALUE;if(e===n-1)return Math.exp((e+(1<<this._scale))/this._scaleFactor)/2;throw new M3.MappingError(`overflow: ${e} is < minimum lower boundary: ${n}`)}return Math.exp(e*this._inverseFactor)}get scale(){return this._scale}_minNormalLowerBoundaryIndex(){return na.MIN_NORMAL_EXPONENT<<this._scale}_maxNormalLowerBoundaryIndex(){return(na.MAX_NORMAL_EXPONENT+1<<this._scale)-1}};c_.LogarithmMapping=$O});var x3=p(f_=>{"use strict";Object.defineProperty(f_,"__esModule",{value:!0});f_.getMapping=void 0;var $ue=P3(),Gue=L3(),Wue=u_(),C3=-10,D3=20,jue=Array.from({length:31},(t,e)=>e>10?new Gue.LogarithmMapping(e-10):new $ue.ExponentMapping(e-10));function Hue(t){if(t>D3||t<C3)throw new Wue.MappingError(`expected scale >= ${C3} && <= ${D3}, got: ${t}`);return jue[t+10]}f_.getMapping=Hue});var B3=p(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.ExponentialHistogramAggregator=oa.ExponentialHistogramAccumulation=void 0;var Yue=Xs(),zue=Js(),Kue=(k(),B(U)),GO=Pn(),U3=R3(),k3=x3(),Que=s_(),ia=class t{constructor(e,r){this.low=e,this.high=r}static combine(e,r){return new t(Math.min(e.low,r.low),Math.max(e.high,r.high))}},Jue=20,Xue=160,WO=2,d_=class t{constructor(e=e,r=Xue,n=!0,s=0,a=0,o=0,i=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,l=new U3.Buckets,c=new U3.Buckets,f=(0,k3.getMapping)(Jue)){this.startTime=e,this._maxSize=r,this._recordMinMax=n,this._sum=s,this._count=a,this._zeroCount=o,this._min=i,this._max=u,this._positive=l,this._negative=c,this._mapping=f,this._maxSize<WO&&(Kue.diag.warn(`Exponential Histogram Max Size set to ${this._maxSize},                 changing to the minimum size of: ${WO}`),this._maxSize=WO)}record(e){this.updateByIncrement(e,1)}setStartTime(e){this.startTime=e}toPointValue(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}}get sum(){return this._sum}get min(){return this._min}get max(){return this._max}get count(){return this._count}get zeroCount(){return this._zeroCount}get scale(){return this._count===this._zeroCount?0:this._mapping.scale}get positive(){return this._positive}get negative(){return this._negative}updateByIncrement(e,r){if(!Number.isNaN(e)){if(e>this._max&&(this._max=e),e<this._min&&(this._min=e),this._count+=r,e===0){this._zeroCount+=r;return}this._sum+=e*r,e>0?this._updateBuckets(this._positive,e,r):this._updateBuckets(this._negative,-e,r)}}merge(e){this._count===0?(this._min=e.min,this._max=e.max):e.count!==0&&(e.min<this.min&&(this._min=e.min),e.max>this.max&&(this._max=e.max)),this.startTime=e.startTime,this._sum+=e.sum,this._count+=e.count,this._zeroCount+=e.zeroCount;let r=this._minScale(e);this._downscale(this.scale-r),this._mergeBuckets(this.positive,e,e.positive,r),this._mergeBuckets(this.negative,e,e.negative,r)}diff(e){this._min=1/0,this._max=-1/0,this._sum-=e.sum,this._count-=e.count,this._zeroCount-=e.zeroCount;let r=this._minScale(e);this._downscale(this.scale-r),this._diffBuckets(this.positive,e,e.positive,r),this._diffBuckets(this.negative,e,e.negative,r)}clone(){return new t(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)}_updateBuckets(e,r,n){let s=this._mapping.mapToIndex(r),a=!1,o=0,i=0;if(e.length===0?(e.indexStart=s,e.indexEnd=e.indexStart,e.indexBase=e.indexStart):s<e.indexStart&&e.indexEnd-s>=this._maxSize?(a=!0,i=s,o=e.indexEnd):s>e.indexEnd&&s-e.indexStart>=this._maxSize&&(a=!0,i=e.indexStart,o=s),a){let u=this._changeScale(o,i);this._downscale(u),s=this._mapping.mapToIndex(r)}this._incrementIndexBy(e,s,n)}_incrementIndexBy(e,r,n){if(n===0)return;if(e.length===0&&(e.indexStart=e.indexEnd=e.indexBase=r),r<e.indexStart){let a=e.indexEnd-r;a>=e.backing.length&&this._grow(e,a+1),e.indexStart=r}else if(r>e.indexEnd){let a=r-e.indexStart;a>=e.backing.length&&this._grow(e,a+1),e.indexEnd=r}let s=r-e.indexBase;s<0&&(s+=e.backing.length),e.incrementBucket(s,n)}_grow(e,r){let n=e.backing.length,s=e.indexBase-e.indexStart,a=n-s,o=(0,Que.nextGreaterSquare)(r);o>this._maxSize&&(o=this._maxSize);let i=o-s;e.backing.growTo(o,a,i)}_changeScale(e,r){let n=0;for(;e-r>=this._maxSize;)e>>=1,r>>=1,n++;return n}_downscale(e){if(e===0)return;if(e<0)throw new Error(`impossible change of scale: ${this.scale}`);let r=this._mapping.scale-e;this._positive.downscale(e),this._negative.downscale(e),this._mapping=(0,k3.getMapping)(r)}_minScale(e){let r=Math.min(this.scale,e.scale),n=ia.combine(this._highLowAtScale(this.positive,this.scale,r),this._highLowAtScale(e.positive,e.scale,r)),s=ia.combine(this._highLowAtScale(this.negative,this.scale,r),this._highLowAtScale(e.negative,e.scale,r));return Math.min(r-this._changeScale(n.high,n.low),r-this._changeScale(s.high,s.low))}_highLowAtScale(e,r,n){if(e.length===0)return new ia(0,-1);let s=r-n;return new ia(e.indexStart>>s,e.indexEnd>>s)}_mergeBuckets(e,r,n,s){let a=n.offset,o=r.scale-s;for(let i=0;i<n.length;i++)this._incrementIndexBy(e,a+i>>o,n.at(i))}_diffBuckets(e,r,n,s){let a=n.offset,o=r.scale-s;for(let i=0;i<n.length;i++){let l=(a+i>>o)-e.indexBase;l<0&&(l+=e.backing.length),e.decrementBucket(l,n.at(i))}e.trim()}};oa.ExponentialHistogramAccumulation=d_;var jO=class{constructor(e,r){this._maxSize=e,this._recordMinMax=r,this.kind=Yue.AggregatorKind.EXPONENTIAL_HISTOGRAM}createAccumulation(e){return new d_(e,this._maxSize,this._recordMinMax)}merge(e,r){let n=r.clone();return n.merge(e),n}diff(e,r){let n=r.clone();return n.diff(e),n}toMetricData(e,r,n,s){return{descriptor:e,aggregationTemporality:r,dataPointType:zue.DataPointType.EXPONENTIAL_HISTOGRAM,dataPoints:n.map(([a,o])=>{let i=o.toPointValue(),u=e.type===GO.InstrumentType.UP_DOWN_COUNTER||e.type===GO.InstrumentType.OBSERVABLE_GAUGE||e.type===GO.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:a,startTime:o.startTime,endTime:s,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:u?void 0:i.sum,positive:{offset:i.positive.offset,bucketCounts:i.positive.bucketCounts},negative:{offset:i.negative.offset,bucketCounts:i.negative.bucketCounts},count:i.count,scale:i.scale,zeroCount:i.zeroCount}}})}}};oa.ExponentialHistogramAggregator=jO});var q3=p(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.LastValueAggregator=aa.LastValueAccumulation=void 0;var Zue=Xs(),Ll=te(),ele=Js(),sa=class{constructor(e,r=0,n=[0,0]){this.startTime=e,this._current=r,this.sampleTime=n}record(e){this._current=e,this.sampleTime=(0,Ll.millisToHrTime)(Date.now())}setStartTime(e){this.startTime=e}toPointValue(){return this._current}};aa.LastValueAccumulation=sa;var HO=class{constructor(){this.kind=Zue.AggregatorKind.LAST_VALUE}createAccumulation(e){return new sa(e)}merge(e,r){let n=(0,Ll.hrTimeToMicroseconds)(r.sampleTime)>=(0,Ll.hrTimeToMicroseconds)(e.sampleTime)?r:e;return new sa(e.startTime,n.toPointValue(),n.sampleTime)}diff(e,r){let n=(0,Ll.hrTimeToMicroseconds)(r.sampleTime)>=(0,Ll.hrTimeToMicroseconds)(e.sampleTime)?r:e;return new sa(r.startTime,n.toPointValue(),n.sampleTime)}toMetricData(e,r,n,s){return{descriptor:e,aggregationTemporality:r,dataPointType:ele.DataPointType.GAUGE,dataPoints:n.map(([a,o])=>({attributes:a,startTime:o.startTime,endTime:s,value:o.toPointValue()}))}}};aa.LastValueAggregator=HO});var V3=p(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.SumAggregator=ua.SumAccumulation=void 0;var tle=Xs(),rle=Js(),mi=class{constructor(e,r,n=0,s=!1){this.startTime=e,this.monotonic=r,this._current=n,this.reset=s}record(e){this.monotonic&&e<0||(this._current+=e)}setStartTime(e){this.startTime=e}toPointValue(){return this._current}};ua.SumAccumulation=mi;var YO=class{constructor(e){this.monotonic=e,this.kind=tle.AggregatorKind.SUM}createAccumulation(e){return new mi(e,this.monotonic)}merge(e,r){let n=e.toPointValue(),s=r.toPointValue();return r.reset?new mi(r.startTime,this.monotonic,s,r.reset):new mi(e.startTime,this.monotonic,n+s)}diff(e,r){let n=e.toPointValue(),s=r.toPointValue();return this.monotonic&&n>s?new mi(r.startTime,this.monotonic,s,!0):new mi(r.startTime,this.monotonic,s-n)}toMetricData(e,r,n,s){return{descriptor:e,aggregationTemporality:r,dataPointType:rle.DataPointType.SUM,dataPoints:n.map(([a,o])=>({attributes:a,startTime:o.startTime,endTime:s,value:o.toPointValue()})),isMonotonic:this.monotonic}}};ua.SumAggregator=YO});var F3=p(Fr=>{"use strict";var nle=Fr&&Fr.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Cl=Fr&&Fr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&nle(e,t,r)};Object.defineProperty(Fr,"__esModule",{value:!0});Cl(O3(),Fr);Cl(A3(),Fr);Cl(B3(),Fr);Cl(q3(),Fr);Cl(V3(),Fr)});var m_=p(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.DefaultAggregation=lt.ExponentialHistogramAggregation=lt.ExplicitBucketHistogramAggregation=lt.HistogramAggregation=lt.LastValueAggregation=lt.SumAggregation=lt.DropAggregation=lt.Aggregation=void 0;var ile=(k(),B(U)),Io=F3(),In=Pn(),fn=class{static Drop(){return $3}static Sum(){return G3}static LastValue(){return W3}static Histogram(){return j3}static ExponentialHistogram(){return ole}static Default(){return sle}};lt.Aggregation=fn;var Dl=class t extends fn{createAggregator(e){return t.DEFAULT_INSTANCE}};lt.DropAggregation=Dl;Dl.DEFAULT_INSTANCE=new Io.DropAggregator;var la=class t extends fn{createAggregator(e){switch(e.type){case In.InstrumentType.COUNTER:case In.InstrumentType.OBSERVABLE_COUNTER:case In.InstrumentType.HISTOGRAM:return t.MONOTONIC_INSTANCE;default:return t.NON_MONOTONIC_INSTANCE}}};lt.SumAggregation=la;la.MONOTONIC_INSTANCE=new Io.SumAggregator(!0);la.NON_MONOTONIC_INSTANCE=new Io.SumAggregator(!1);var xl=class t extends fn{createAggregator(e){return t.DEFAULT_INSTANCE}};lt.LastValueAggregation=xl;xl.DEFAULT_INSTANCE=new Io.LastValueAggregator;var Ul=class t extends fn{createAggregator(e){return t.DEFAULT_INSTANCE}};lt.HistogramAggregation=Ul;Ul.DEFAULT_INSTANCE=new Io.HistogramAggregator([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0);var p_=class extends fn{constructor(e,r=!0){if(super(),this._recordMinMax=r,e==null)throw new Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");e=e.concat(),e=e.sort((a,o)=>a-o);let n=e.lastIndexOf(-1/0),s=e.indexOf(1/0);s===-1&&(s=void 0),this._boundaries=e.slice(n+1,s)}createAggregator(e){return new Io.HistogramAggregator(this._boundaries,this._recordMinMax)}};lt.ExplicitBucketHistogramAggregation=p_;var h_=class extends fn{constructor(e=160,r=!0){super(),this._maxSize=e,this._recordMinMax=r}createAggregator(e){return new Io.ExponentialHistogramAggregator(this._maxSize,this._recordMinMax)}};lt.ExponentialHistogramAggregation=h_;var __=class extends fn{_resolve(e){switch(e.type){case In.InstrumentType.COUNTER:case In.InstrumentType.UP_DOWN_COUNTER:case In.InstrumentType.OBSERVABLE_COUNTER:case In.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER:return G3;case In.InstrumentType.OBSERVABLE_GAUGE:return W3;case In.InstrumentType.HISTOGRAM:return e.advice.explicitBucketBoundaries?new p_(e.advice.explicitBucketBoundaries):j3}return ile.diag.warn(`Unable to recognize instrument type: ${e.type}`),$3}createAggregator(e){return this._resolve(e).createAggregator(e)}};lt.DefaultAggregation=__;var $3=new Dl,G3=new la,W3=new xl,j3=new Ul,ole=new h_,sle=new __});var zO=p(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR=ca.DEFAULT_AGGREGATION_SELECTOR=void 0;var ale=m_(),ule=r_(),lle=t=>ale.Aggregation.Default();ca.DEFAULT_AGGREGATION_SELECTOR=lle;var cle=t=>ule.AggregationTemporality.CUMULATIVE;ca.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR=cle});var QO=p(E_=>{"use strict";Object.defineProperty(E_,"__esModule",{value:!0});E_.MetricReader=void 0;var H3=(k(),B(U)),S_=cn(),Y3=zO(),KO=class{constructor(e){var r,n,s;this._shutdown=!1,this._aggregationSelector=(r=e?.aggregationSelector)!==null&&r!==void 0?r:Y3.DEFAULT_AGGREGATION_SELECTOR,this._aggregationTemporalitySelector=(n=e?.aggregationTemporalitySelector)!==null&&n!==void 0?n:Y3.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR,this._metricProducers=(s=e?.metricProducers)!==null&&s!==void 0?s:[]}setMetricProducer(e){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=e,this.onInitialized()}selectAggregation(e){return this._aggregationSelector(e)}selectAggregationTemporality(e){return this._aggregationTemporalitySelector(e)}onInitialized(){}async collect(e){if(this._sdkMetricProducer===void 0)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");let[r,...n]=await Promise.all([this._sdkMetricProducer.collect({timeoutMillis:e?.timeoutMillis}),...this._metricProducers.map(i=>i.collect({timeoutMillis:e?.timeoutMillis}))]),s=r.errors.concat((0,S_.FlatMap)(n,i=>i.errors)),a=r.resourceMetrics.resource,o=r.resourceMetrics.scopeMetrics.concat((0,S_.FlatMap)(n,i=>i.resourceMetrics.scopeMetrics));return{resourceMetrics:{resource:a,scopeMetrics:o},errors:s}}async shutdown(e){if(this._shutdown){H3.diag.error("Cannot call shutdown twice.");return}e?.timeoutMillis==null?await this.onShutdown():await(0,S_.callWithTimeout)(this.onShutdown(),e.timeoutMillis),this._shutdown=!0}async forceFlush(e){if(this._shutdown){H3.diag.warn("Cannot forceFlush on already shutdown MetricReader.");return}if(e?.timeoutMillis==null){await this.onForceFlush();return}await(0,S_.callWithTimeout)(this.onForceFlush(),e.timeoutMillis)}};E_.MetricReader=KO});var Q3=p(y_=>{"use strict";Object.defineProperty(y_,"__esModule",{value:!0});y_.PeriodicExportingMetricReader=void 0;var z3=(k(),B(U)),g_=te(),fle=QO(),K3=cn(),dle=(k(),B(U)),JO=class extends fle.MetricReader{constructor(e){var r,n,s,a;if(super({aggregationSelector:(r=e.exporter.selectAggregation)===null||r===void 0?void 0:r.bind(e.exporter),aggregationTemporalitySelector:(n=e.exporter.selectAggregationTemporality)===null||n===void 0?void 0:n.bind(e.exporter),metricProducers:e.metricProducers}),e.exportIntervalMillis!==void 0&&e.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(e.exportTimeoutMillis!==void 0&&e.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(e.exportTimeoutMillis!==void 0&&e.exportIntervalMillis!==void 0&&e.exportIntervalMillis<e.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");this._exportInterval=(s=e.exportIntervalMillis)!==null&&s!==void 0?s:6e4,this._exportTimeout=(a=e.exportTimeoutMillis)!==null&&a!==void 0?a:3e4,this._exporter=e.exporter}async _runOnce(){try{await(0,K3.callWithTimeout)(this._doRun(),this._exportTimeout)}catch(e){if(e instanceof K3.TimeoutError){z3.diag.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout);return}(0,g_.globalErrorHandler)(e)}}async _doRun(){var e,r;let{resourceMetrics:n,errors:s}=await this.collect({timeoutMillis:this._exportTimeout});s.length>0&&z3.diag.error("PeriodicExportingMetricReader: metrics collection errors",...s);let a=async()=>{let o=await g_.internal._export(this._exporter,n);if(o.code!==g_.ExportResultCode.SUCCESS)throw new Error(`PeriodicExportingMetricReader: metrics export failed (error ${o.error})`)};n.resource.asyncAttributesPending?(r=(e=n.resource).waitForAsyncAttributes)===null||r===void 0||r.call(e).then(a,o=>dle.diag.debug("Error while resolving async portion of resource: ",o)):await a()}onInitialized(){this._interval=setInterval(()=>{this._runOnce()},this._exportInterval),(0,g_.unrefTimer)(this._interval)}async onForceFlush(){await this._runOnce(),await this._exporter.forceFlush()}async onShutdown(){this._interval&&clearInterval(this._interval),await this._exporter.shutdown()}};y_.PeriodicExportingMetricReader=JO});var X3=p(T_=>{"use strict";Object.defineProperty(T_,"__esModule",{value:!0});T_.InMemoryMetricExporter=void 0;var J3=te(),XO=class{constructor(e){this._shutdown=!1,this._metrics=[],this._aggregationTemporality=e}export(e,r){if(this._shutdown){setTimeout(()=>r({code:J3.ExportResultCode.FAILED}),0);return}this._metrics.push(e),setTimeout(()=>r({code:J3.ExportResultCode.SUCCESS}),0)}getMetrics(){return this._metrics}forceFlush(){return Promise.resolve()}reset(){this._metrics=[]}selectAggregationTemporality(e){return this._aggregationTemporality}shutdown(){return this._shutdown=!0,Promise.resolve()}};T_.InMemoryMetricExporter=XO});var ej=p(w_=>{"use strict";Object.defineProperty(w_,"__esModule",{value:!0});w_.ConsoleMetricExporter=void 0;var Z3=te(),ple=zO(),ZO=class t{constructor(e){var r;this._shutdown=!1,this._temporalitySelector=(r=e?.temporalitySelector)!==null&&r!==void 0?r:ple.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR}export(e,r){if(this._shutdown){setImmediate(r,{code:Z3.ExportResultCode.FAILED});return}return t._sendMetrics(e,r)}forceFlush(){return Promise.resolve()}selectAggregationTemporality(e){return this._temporalitySelector(e)}shutdown(){return this._shutdown=!0,Promise.resolve()}static _sendMetrics(e,r){for(let n of e.scopeMetrics)for(let s of n.metrics)console.dir({descriptor:s.descriptor,dataPointType:s.dataPointType,dataPoints:s.dataPoints});r({code:Z3.ExportResultCode.SUCCESS})}};w_.ConsoleMetricExporter=ZO});var tj=p(O_=>{"use strict";Object.defineProperty(O_,"__esModule",{value:!0});O_.ViewRegistry=void 0;var ev=class{constructor(){this._registeredViews=[]}addView(e){this._registeredViews.push(e)}findViews(e,r){return this._registeredViews.filter(s=>this._matchInstrument(s.instrumentSelector,e)&&this._matchMeter(s.meterSelector,r))}_matchInstrument(e,r){return(e.getType()===void 0||r.type===e.getType())&&e.getNameFilter().match(r.name)&&e.getUnitFilter().match(r.unit)}_matchMeter(e,r){return e.getNameFilter().match(r.name)&&(r.version===void 0||e.getVersionFilter().match(r.version))&&(r.schemaUrl===void 0||e.getSchemaUrlFilter().match(r.schemaUrl))}};O_.ViewRegistry=ev});var v_=p(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.isObservableInstrument=Je.ObservableUpDownCounterInstrument=Je.ObservableGaugeInstrument=Je.ObservableCounterInstrument=Je.ObservableInstrument=Je.HistogramInstrument=Je.CounterInstrument=Je.UpDownCounterInstrument=Je.SyncInstrument=void 0;var fa=(k(),B(U)),hle=te(),da=class{constructor(e,r){this._writableMetricStorage=e,this._descriptor=r}_record(e,r={},n=fa.context.active()){if(typeof e!="number"){fa.diag.warn(`non-number value provided to metric ${this._descriptor.name}: ${e}`);return}this._descriptor.valueType===fa.ValueType.INT&&!Number.isInteger(e)&&(fa.diag.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`),e=Math.trunc(e),!Number.isInteger(e))||this._writableMetricStorage.record(e,r,n,(0,hle.millisToHrTime)(Date.now()))}};Je.SyncInstrument=da;var tv=class extends da{add(e,r,n){this._record(e,r,n)}};Je.UpDownCounterInstrument=tv;var rv=class extends da{add(e,r,n){if(e<0){fa.diag.warn(`negative value provided to counter ${this._descriptor.name}: ${e}`);return}this._record(e,r,n)}};Je.CounterInstrument=rv;var nv=class extends da{record(e,r,n){if(e<0){fa.diag.warn(`negative value provided to histogram ${this._descriptor.name}: ${e}`);return}this._record(e,r,n)}};Je.HistogramInstrument=nv;var Mo=class{constructor(e,r,n){this._observableRegistry=n,this._descriptor=e,this._metricStorages=r}addCallback(e){this._observableRegistry.addCallback(e,this)}removeCallback(e){this._observableRegistry.removeCallback(e,this)}};Je.ObservableInstrument=Mo;var iv=class extends Mo{};Je.ObservableCounterInstrument=iv;var ov=class extends Mo{};Je.ObservableGaugeInstrument=ov;var sv=class extends Mo{};Je.ObservableUpDownCounterInstrument=sv;function _le(t){return t instanceof Mo}Je.isObservableInstrument=_le});var rj=p(b_=>{"use strict";Object.defineProperty(b_,"__esModule",{value:!0});b_.Meter=void 0;var wr=Pn(),pa=v_(),av=class{constructor(e){this._meterSharedState=e}createHistogram(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.HISTOGRAM,r),s=this._meterSharedState.registerMetricStorage(n);return new pa.HistogramInstrument(s,n)}createCounter(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.COUNTER,r),s=this._meterSharedState.registerMetricStorage(n);return new pa.CounterInstrument(s,n)}createUpDownCounter(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.UP_DOWN_COUNTER,r),s=this._meterSharedState.registerMetricStorage(n);return new pa.UpDownCounterInstrument(s,n)}createObservableGauge(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.OBSERVABLE_GAUGE,r),s=this._meterSharedState.registerAsyncMetricStorage(n);return new pa.ObservableGaugeInstrument(n,s,this._meterSharedState.observableRegistry)}createObservableCounter(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.OBSERVABLE_COUNTER,r),s=this._meterSharedState.registerAsyncMetricStorage(n);return new pa.ObservableCounterInstrument(n,s,this._meterSharedState.observableRegistry)}createObservableUpDownCounter(e,r){let n=(0,wr.createInstrumentDescriptor)(e,wr.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER,r),s=this._meterSharedState.registerAsyncMetricStorage(n);return new pa.ObservableUpDownCounterInstrument(n,s,this._meterSharedState.observableRegistry)}addBatchObservableCallback(e,r){this._meterSharedState.observableRegistry.addBatchCallback(e,r)}removeBatchObservableCallback(e,r){this._meterSharedState.observableRegistry.removeBatchCallback(e,r)}};b_.Meter=av});var lv=p(A_=>{"use strict";Object.defineProperty(A_,"__esModule",{value:!0});A_.MetricStorage=void 0;var mle=Pn(),uv=class{constructor(e){this._instrumentDescriptor=e}getInstrumentDescriptor(){return this._instrumentDescriptor}updateDescription(e){this._instrumentDescriptor=(0,mle.createInstrumentDescriptor)(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:e,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})}};A_.MetricStorage=uv});var kl=p(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.AttributeHashMap=ha.HashMap=void 0;var Sle=cn(),R_=class{constructor(e){this._hash=e,this._valueMap=new Map,this._keyMap=new Map}get(e,r){return r??(r=this._hash(e)),this._valueMap.get(r)}getOrDefault(e,r){let n=this._hash(e);if(this._valueMap.has(n))return this._valueMap.get(n);let s=r();return this._keyMap.has(n)||this._keyMap.set(n,e),this._valueMap.set(n,s),s}set(e,r,n){n??(n=this._hash(e)),this._keyMap.has(n)||this._keyMap.set(n,e),this._valueMap.set(n,r)}has(e,r){return r??(r=this._hash(e)),this._valueMap.has(r)}*keys(){let e=this._keyMap.entries(),r=e.next();for(;r.done!==!0;)yield[r.value[1],r.value[0]],r=e.next()}*entries(){let e=this._valueMap.entries(),r=e.next();for(;r.done!==!0;)yield[this._keyMap.get(r.value[0]),r.value[1],r.value[0]],r=e.next()}get size(){return this._valueMap.size}};ha.HashMap=R_;var cv=class extends R_{constructor(){super(Sle.hashAttributes)}};ha.AttributeHashMap=cv});var pv=p(N_=>{"use strict";Object.defineProperty(N_,"__esModule",{value:!0});N_.DeltaMetricProcessor=void 0;var fv=kl(),dv=class{constructor(e){this._aggregator=e,this._activeCollectionStorage=new fv.AttributeHashMap,this._cumulativeMemoStorage=new fv.AttributeHashMap}record(e,r,n,s){let a=this._activeCollectionStorage.getOrDefault(r,()=>this._aggregator.createAccumulation(s));a?.record(e)}batchCumulate(e,r){Array.from(e.entries()).forEach(([n,s,a])=>{let o=this._aggregator.createAccumulation(r);o?.record(s);let i=o;if(this._cumulativeMemoStorage.has(n,a)){let u=this._cumulativeMemoStorage.get(n,a);i=this._aggregator.diff(u,o)}if(this._activeCollectionStorage.has(n,a)){let u=this._activeCollectionStorage.get(n,a);i=this._aggregator.merge(u,i)}this._cumulativeMemoStorage.set(n,o,a),this._activeCollectionStorage.set(n,i,a)})}collect(){let e=this._activeCollectionStorage;return this._activeCollectionStorage=new fv.AttributeHashMap,e}};N_.DeltaMetricProcessor=dv});var _v=p(P_=>{"use strict";Object.defineProperty(P_,"__esModule",{value:!0});P_.TemporalMetricProcessor=void 0;var Ele=r_(),gle=kl(),hv=class t{constructor(e,r){this._aggregator=e,this._unreportedAccumulations=new Map,this._reportHistory=new Map,r.forEach(n=>{this._unreportedAccumulations.set(n,[])})}buildMetrics(e,r,n,s){this._stashAccumulations(n);let a=this._getMergedUnreportedAccumulations(e),o=a,i;if(this._reportHistory.has(e)){let l=this._reportHistory.get(e),c=l.collectionTime;i=l.aggregationTemporality,i===Ele.AggregationTemporality.CUMULATIVE?o=t.merge(l.accumulations,a,this._aggregator):o=t.calibrateStartTime(l.accumulations,a,c)}else i=e.selectAggregationTemporality(r.type);this._reportHistory.set(e,{accumulations:o,collectionTime:s,aggregationTemporality:i});let u=yle(o);if(u.length!==0)return this._aggregator.toMetricData(r,i,u,s)}_stashAccumulations(e){let r=this._unreportedAccumulations.keys();for(let n of r){let s=this._unreportedAccumulations.get(n);s===void 0&&(s=[],this._unreportedAccumulations.set(n,s)),s.push(e)}}_getMergedUnreportedAccumulations(e){let r=new gle.AttributeHashMap,n=this._unreportedAccumulations.get(e);if(this._unreportedAccumulations.set(e,[]),n===void 0)return r;for(let s of n)r=t.merge(r,s,this._aggregator);return r}static merge(e,r,n){let s=e,a=r.entries(),o=a.next();for(;o.done!==!0;){let[i,u,l]=o.value;if(e.has(i,l)){let c=e.get(i,l),f=n.merge(c,u);s.set(i,f,l)}else s.set(i,u,l);o=a.next()}return s}static calibrateStartTime(e,r,n){for(let[s,a]of e.keys()){let o=r.get(s,a);o?.setStartTime(n)}return r}};P_.TemporalMetricProcessor=hv;function yle(t){return Array.from(t.entries())}});var nj=p(I_=>{"use strict";Object.defineProperty(I_,"__esModule",{value:!0});I_.AsyncMetricStorage=void 0;var Tle=lv(),wle=pv(),Ole=_v(),vle=kl(),mv=class extends Tle.MetricStorage{constructor(e,r,n,s){super(e),this._attributesProcessor=n,this._deltaMetricStorage=new wle.DeltaMetricProcessor(r),this._temporalMetricStorage=new Ole.TemporalMetricProcessor(r,s)}record(e,r){let n=new vle.AttributeHashMap;Array.from(e.entries()).forEach(([s,a])=>{n.set(this._attributesProcessor.process(s),a)}),this._deltaMetricStorage.batchCumulate(n,r)}collect(e,r){let n=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,this._instrumentDescriptor,n,r)}};I_.AsyncMetricStorage=mv});var uj=p(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.getConflictResolutionRecipe=jt.getDescriptionResolutionRecipe=jt.getTypeConflictResolutionRecipe=jt.getUnitConflictResolutionRecipe=jt.getValueTypeConflictResolutionRecipe=jt.getIncompatibilityDetails=void 0;function ble(t,e){let r="";return t.unit!==e.unit&&(r+=`	- Unit '${t.unit}' does not match '${e.unit}'
`),t.type!==e.type&&(r+=`	- Type '${t.type}' does not match '${e.type}'
`),t.valueType!==e.valueType&&(r+=`	- Value Type '${t.valueType}' does not match '${e.valueType}'
`),t.description!==e.description&&(r+=`	- Description '${t.description}' does not match '${e.description}'
`),r}jt.getIncompatibilityDetails=ble;function ij(t,e){return`	- use valueType '${t.valueType}' on instrument creation or use an instrument name other than '${e.name}'`}jt.getValueTypeConflictResolutionRecipe=ij;function oj(t,e){return`	- use unit '${t.unit}' on instrument creation or use an instrument name other than '${e.name}'`}jt.getUnitConflictResolutionRecipe=oj;function sj(t,e){let r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`	- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'`}jt.getTypeConflictResolutionRecipe=sj;function aj(t,e){let r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`	- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'
    	- OR - create a new view with the name ${t.name} and description '${t.description}' and InstrumentSelector ${n}
    	- OR - create a new view with the name ${e.name} and description '${t.description}' and InstrumentSelector ${n}`}jt.getDescriptionResolutionRecipe=aj;function Ale(t,e){return t.valueType!==e.valueType?ij(t,e):t.unit!==e.unit?oj(t,e):t.type!==e.type?sj(t,e):t.description!==e.description?aj(t,e):""}jt.getConflictResolutionRecipe=Ale});var cj=p(L_=>{"use strict";Object.defineProperty(L_,"__esModule",{value:!0});L_.MetricStorageRegistry=void 0;var Rle=Pn(),lj=(k(),B(U)),M_=uj(),Sv=class t{constructor(){this._sharedRegistry=new Map,this._perCollectorRegistry=new Map}static create(){return new t}getStorages(e){let r=[];for(let s of this._sharedRegistry.values())r=r.concat(s);let n=this._perCollectorRegistry.get(e);if(n!=null)for(let s of n.values())r=r.concat(s);return r}register(e){this._registerStorage(e,this._sharedRegistry)}registerForCollector(e,r){let n=this._perCollectorRegistry.get(e);n==null&&(n=new Map,this._perCollectorRegistry.set(e,n)),this._registerStorage(r,n)}findOrUpdateCompatibleStorage(e){let r=this._sharedRegistry.get(e.name);return r===void 0?null:this._findOrUpdateCompatibleStorage(e,r)}findOrUpdateCompatibleCollectorStorage(e,r){let n=this._perCollectorRegistry.get(e);if(n===void 0)return null;let s=n.get(r.name);return s===void 0?null:this._findOrUpdateCompatibleStorage(r,s)}_registerStorage(e,r){let n=e.getInstrumentDescriptor(),s=r.get(n.name);if(s===void 0){r.set(n.name,[e]);return}s.push(e)}_findOrUpdateCompatibleStorage(e,r){let n=null;for(let s of r){let a=s.getInstrumentDescriptor();(0,Rle.isDescriptorCompatibleWith)(a,e)?(a.description!==e.description&&(e.description.length>a.description.length&&s.updateDescription(e.description),lj.diag.warn("A view or instrument with the name ",e.name,` has already been registered, but has a different description and is incompatible with another registered view.
`,`Details:
`,(0,M_.getIncompatibilityDetails)(a,e),`The longer description will be used.
To resolve the conflict:`,(0,M_.getConflictResolutionRecipe)(a,e))),n=s):lj.diag.warn("A view or instrument with the name ",e.name,` has already been registered and is incompatible with another registered view.
`,`Details:
`,(0,M_.getIncompatibilityDetails)(a,e),`To resolve the conflict:
`,(0,M_.getConflictResolutionRecipe)(a,e))}return n}};L_.MetricStorageRegistry=Sv});var fj=p(C_=>{"use strict";Object.defineProperty(C_,"__esModule",{value:!0});C_.MultiMetricStorage=void 0;var Ev=class{constructor(e){this._backingStorages=e}record(e,r,n,s){this._backingStorages.forEach(a=>{a.record(e,r,n,s)})}};C_.MultiMetricStorage=Ev});var pj=p(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.BatchObservableResultImpl=ma.ObservableResultImpl=void 0;var _a=(k(),B(U)),dj=kl(),Nle=v_(),gv=class{constructor(e,r){this._instrumentName=e,this._valueType=r,this._buffer=new dj.AttributeHashMap}observe(e,r={}){if(typeof e!="number"){_a.diag.warn(`non-number value provided to metric ${this._instrumentName}: ${e}`);return}this._valueType===_a.ValueType.INT&&!Number.isInteger(e)&&(_a.diag.warn(`INT value type cannot accept a floating-point value for ${this._instrumentName}, ignoring the fractional digits.`),e=Math.trunc(e),!Number.isInteger(e))||this._buffer.set(r,e)}};ma.ObservableResultImpl=gv;var yv=class{constructor(){this._buffer=new Map}observe(e,r,n={}){if(!(0,Nle.isObservableInstrument)(e))return;let s=this._buffer.get(e);if(s==null&&(s=new dj.AttributeHashMap,this._buffer.set(e,s)),typeof r!="number"){_a.diag.warn(`non-number value provided to metric ${e._descriptor.name}: ${r}`);return}e._descriptor.valueType===_a.ValueType.INT&&!Number.isInteger(r)&&(_a.diag.warn(`INT value type cannot accept a floating-point value for ${e._descriptor.name}, ignoring the fractional digits.`),r=Math.trunc(r),!Number.isInteger(r))||s.set(n,r)}};ma.BatchObservableResultImpl=yv});var mj=p(D_=>{"use strict";Object.defineProperty(D_,"__esModule",{value:!0});D_.ObservableRegistry=void 0;var Ple=(k(),B(U)),hj=v_(),_j=pj(),Bl=cn(),Tv=class{constructor(){this._callbacks=[],this._batchCallbacks=[]}addCallback(e,r){this._findCallback(e,r)>=0||this._callbacks.push({callback:e,instrument:r})}removeCallback(e,r){let n=this._findCallback(e,r);n<0||this._callbacks.splice(n,1)}addBatchCallback(e,r){let n=new Set(r.filter(hj.isObservableInstrument));if(n.size===0){Ple.diag.error("BatchObservableCallback is not associated with valid instruments",r);return}this._findBatchCallback(e,n)>=0||this._batchCallbacks.push({callback:e,instruments:n})}removeBatchCallback(e,r){let n=new Set(r.filter(hj.isObservableInstrument)),s=this._findBatchCallback(e,n);s<0||this._batchCallbacks.splice(s,1)}async observe(e,r){let n=this._observeCallbacks(e,r),s=this._observeBatchCallbacks(e,r);return(await(0,Bl.PromiseAllSettled)([...n,...s])).filter(Bl.isPromiseAllSettledRejectionResult).map(i=>i.reason)}_observeCallbacks(e,r){return this._callbacks.map(async({callback:n,instrument:s})=>{let a=new _j.ObservableResultImpl(s._descriptor.name,s._descriptor.valueType),o=Promise.resolve(n(a));r!=null&&(o=(0,Bl.callWithTimeout)(o,r)),await o,s._metricStorages.forEach(i=>{i.record(a._buffer,e)})})}_observeBatchCallbacks(e,r){return this._batchCallbacks.map(async({callback:n,instruments:s})=>{let a=new _j.BatchObservableResultImpl,o=Promise.resolve(n(a));r!=null&&(o=(0,Bl.callWithTimeout)(o,r)),await o,s.forEach(i=>{let u=a._buffer.get(i);u!=null&&i._metricStorages.forEach(l=>{l.record(u,e)})})})}_findCallback(e,r){return this._callbacks.findIndex(n=>n.callback===e&&n.instrument===r)}_findBatchCallback(e,r){return this._batchCallbacks.findIndex(n=>n.callback===e&&(0,Bl.setEquals)(n.instruments,r))}};D_.ObservableRegistry=Tv});var Sj=p(x_=>{"use strict";Object.defineProperty(x_,"__esModule",{value:!0});x_.SyncMetricStorage=void 0;var Ile=lv(),Mle=pv(),Lle=_v(),wv=class extends Ile.MetricStorage{constructor(e,r,n,s){super(e),this._attributesProcessor=n,this._deltaMetricStorage=new Mle.DeltaMetricProcessor(r),this._temporalMetricStorage=new Lle.TemporalMetricProcessor(r,s)}record(e,r,n,s){r=this._attributesProcessor.process(r,n),this._deltaMetricStorage.record(e,r,n,s)}collect(e,r){let n=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,this._instrumentDescriptor,n,r)}};x_.SyncMetricStorage=wv});var vv=p(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.FilteringAttributesProcessor=Si.NoopAttributesProcessor=Si.AttributesProcessor=void 0;var ql=class{static Noop(){return Cle}};Si.AttributesProcessor=ql;var U_=class extends ql{process(e,r){return e}};Si.NoopAttributesProcessor=U_;var Ov=class extends ql{constructor(e){super(),this._allowedAttributeNames=e}process(e,r){let n={};return Object.keys(e).filter(s=>this._allowedAttributeNames.includes(s)).forEach(s=>n[s]=e[s]),n}};Si.FilteringAttributesProcessor=Ov;var Cle=new U_});var Ej=p(k_=>{"use strict";Object.defineProperty(k_,"__esModule",{value:!0});k_.MeterSharedState=void 0;var Dle=Pn(),xle=rj(),Ule=cn(),kle=nj(),Ble=cj(),qle=fj(),Vle=mj(),Fle=Sj(),$le=vv(),bv=class{constructor(e,r){this._meterProviderSharedState=e,this._instrumentationScope=r,this.metricStorageRegistry=new Ble.MetricStorageRegistry,this.observableRegistry=new Vle.ObservableRegistry,this.meter=new xle.Meter(this)}registerMetricStorage(e){let r=this._registerMetricStorage(e,Fle.SyncMetricStorage);return r.length===1?r[0]:new qle.MultiMetricStorage(r)}registerAsyncMetricStorage(e){return this._registerMetricStorage(e,kle.AsyncMetricStorage)}async collect(e,r,n){let s=await this.observableRegistry.observe(r,n?.timeoutMillis),a=this.metricStorageRegistry.getStorages(e);if(a.length===0)return null;let o=a.map(i=>i.collect(e,r)).filter(Ule.isNotNullish);return o.length===0?{errors:s}:{scopeMetrics:{scope:this._instrumentationScope,metrics:o},errors:s}}_registerMetricStorage(e,r){let s=this._meterProviderSharedState.viewRegistry.findViews(e,this._instrumentationScope).map(a=>{let o=(0,Dle.createInstrumentDescriptorWithView)(a,e),i=this.metricStorageRegistry.findOrUpdateCompatibleStorage(o);if(i!=null)return i;let u=a.aggregation.createAggregator(o),l=new r(o,u,a.attributesProcessor,this._meterProviderSharedState.metricCollectors);return this.metricStorageRegistry.register(l),l});if(s.length===0){let o=this._meterProviderSharedState.selectAggregations(e.type).map(([i,u])=>{let l=this.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(i,e);if(l!=null)return l;let c=u.createAggregator(e),f=new r(e,c,$le.AttributesProcessor.Noop(),[i]);return this.metricStorageRegistry.registerForCollector(i,f),f});s=s.concat(o)}return s}};k_.MeterSharedState=bv});var gj=p(B_=>{"use strict";Object.defineProperty(B_,"__esModule",{value:!0});B_.MeterProviderSharedState=void 0;var Gle=cn(),Wle=tj(),jle=Ej(),Av=class{constructor(e){this.resource=e,this.viewRegistry=new Wle.ViewRegistry,this.metricCollectors=[],this.meterSharedStates=new Map}getMeterSharedState(e){let r=(0,Gle.instrumentationScopeId)(e),n=this.meterSharedStates.get(r);return n==null&&(n=new jle.MeterSharedState(this,e),this.meterSharedStates.set(r,n)),n}selectAggregations(e){let r=[];for(let n of this.metricCollectors)r.push([n,n.selectAggregation(e)]);return r}};B_.MeterProviderSharedState=Av});var yj=p(q_=>{"use strict";Object.defineProperty(q_,"__esModule",{value:!0});q_.MetricCollector=void 0;var Hle=te(),Rv=class{constructor(e,r){this._sharedState=e,this._metricReader=r}async collect(e){let r=(0,Hle.millisToHrTime)(Date.now()),n=[],s=[],a=Array.from(this._sharedState.meterSharedStates.values()).map(async o=>{let i=await o.collect(this,r,e);i?.scopeMetrics!=null&&n.push(i.scopeMetrics),i?.errors!=null&&s.push(...i.errors)});return await Promise.all(a),{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:n},errors:s}}async forceFlush(e){await this._metricReader.forceFlush(e)}async shutdown(e){await this._metricReader.shutdown(e)}selectAggregationTemporality(e){return this._metricReader.selectAggregationTemporality(e)}selectAggregation(e){return this._metricReader.selectAggregation(e)}};q_.MetricCollector=Rv});var wj=p(F_=>{"use strict";Object.defineProperty(F_,"__esModule",{value:!0});F_.MeterProvider=void 0;var V_=(k(),B(U)),Tj=_s(),Yle=gj(),zle=yj(),Nv=class{constructor(e){var r;this._shutdown=!1;let n=Tj.Resource.default().merge((r=e?.resource)!==null&&r!==void 0?r:Tj.Resource.empty());if(this._sharedState=new Yle.MeterProviderSharedState(n),e?.views!=null&&e.views.length>0)for(let s of e.views)this._sharedState.viewRegistry.addView(s);if(e?.readers!=null&&e.readers.length>0)for(let s of e.readers)this.addMetricReader(s)}getMeter(e,r="",n={}){return this._shutdown?(V_.diag.warn("A shutdown MeterProvider cannot provide a Meter"),(0,V_.createNoopMeter)()):this._sharedState.getMeterSharedState({name:e,version:r,schemaUrl:n.schemaUrl}).meter}addMetricReader(e){let r=new zle.MetricCollector(this._sharedState,e);e.setMetricProducer(r),this._sharedState.metricCollectors.push(r)}async shutdown(e){if(this._shutdown){V_.diag.warn("shutdown may only be called once per MeterProvider");return}this._shutdown=!0,await Promise.all(this._sharedState.metricCollectors.map(r=>r.shutdown(e)))}async forceFlush(e){if(this._shutdown){V_.diag.warn("invalid attempt to force flush after MeterProvider shutdown");return}await Promise.all(this._sharedState.metricCollectors.map(r=>r.forceFlush(e)))}};F_.MeterProvider=Nv});var $_=p(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.ExactPredicate=Sa.PatternPredicate=void 0;var Kle=/[\^$\\.+?()[\]{}|]/g,Pv=class t{constructor(e){e==="*"?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(t.escapePattern(e)))}match(e){return this._matchAll?!0:this._regexp.test(e)}static escapePattern(e){return`^${e.replace(Kle,"\\$&").replace("*",".*")}$`}static hasWildcard(e){return e.includes("*")}};Sa.PatternPredicate=Pv;var Iv=class{constructor(e){this._matchAll=e===void 0,this._pattern=e}match(e){return!!(this._matchAll||e===this._pattern)}};Sa.ExactPredicate=Iv});var vj=p(G_=>{"use strict";Object.defineProperty(G_,"__esModule",{value:!0});G_.InstrumentSelector=void 0;var Oj=$_(),Mv=class{constructor(e){var r;this._nameFilter=new Oj.PatternPredicate((r=e?.name)!==null&&r!==void 0?r:"*"),this._type=e?.type,this._unitFilter=new Oj.ExactPredicate(e?.unit)}getType(){return this._type}getNameFilter(){return this._nameFilter}getUnitFilter(){return this._unitFilter}};G_.InstrumentSelector=Mv});var bj=p(W_=>{"use strict";Object.defineProperty(W_,"__esModule",{value:!0});W_.MeterSelector=void 0;var Lv=$_(),Cv=class{constructor(e){this._nameFilter=new Lv.ExactPredicate(e?.name),this._versionFilter=new Lv.ExactPredicate(e?.version),this._schemaUrlFilter=new Lv.ExactPredicate(e?.schemaUrl)}getNameFilter(){return this._nameFilter}getVersionFilter(){return this._versionFilter}getSchemaUrlFilter(){return this._schemaUrlFilter}};W_.MeterSelector=Cv});var Rj=p(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0});j_.View=void 0;var Qle=$_(),Aj=vv(),Jle=vj(),Xle=bj(),Zle=m_();function ece(t){return t.instrumentName==null&&t.instrumentType==null&&t.instrumentUnit==null&&t.meterName==null&&t.meterVersion==null&&t.meterSchemaUrl==null}var Dv=class{constructor(e){var r;if(ece(e))throw new Error("Cannot create view with no selector arguments supplied");if(e.name!=null&&(e?.instrumentName==null||Qle.PatternPredicate.hasWildcard(e.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.");e.attributeKeys!=null?this.attributesProcessor=new Aj.FilteringAttributesProcessor(e.attributeKeys):this.attributesProcessor=Aj.AttributesProcessor.Noop(),this.name=e.name,this.description=e.description,this.aggregation=(r=e.aggregation)!==null&&r!==void 0?r:Zle.Aggregation.Default(),this.instrumentSelector=new Jle.InstrumentSelector({name:e.instrumentName,type:e.instrumentType,unit:e.instrumentUnit}),this.meterSelector=new Xle.MeterSelector({name:e.meterName,version:e.meterVersion,schemaUrl:e.meterSchemaUrl})}};j_.View=Dv});var Nj=p(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.TimeoutError=ae.View=ae.Aggregation=ae.SumAggregation=ae.LastValueAggregation=ae.HistogramAggregation=ae.DropAggregation=ae.ExponentialHistogramAggregation=ae.ExplicitBucketHistogramAggregation=ae.DefaultAggregation=ae.MeterProvider=ae.InstrumentType=ae.ConsoleMetricExporter=ae.InMemoryMetricExporter=ae.PeriodicExportingMetricReader=ae.MetricReader=ae.DataPointType=ae.AggregationTemporality=void 0;var tce=r_();Object.defineProperty(ae,"AggregationTemporality",{enumerable:!0,get:function(){return tce.AggregationTemporality}});var rce=Js();Object.defineProperty(ae,"DataPointType",{enumerable:!0,get:function(){return rce.DataPointType}});var nce=QO();Object.defineProperty(ae,"MetricReader",{enumerable:!0,get:function(){return nce.MetricReader}});var ice=Q3();Object.defineProperty(ae,"PeriodicExportingMetricReader",{enumerable:!0,get:function(){return ice.PeriodicExportingMetricReader}});var oce=X3();Object.defineProperty(ae,"InMemoryMetricExporter",{enumerable:!0,get:function(){return oce.InMemoryMetricExporter}});var sce=ej();Object.defineProperty(ae,"ConsoleMetricExporter",{enumerable:!0,get:function(){return sce.ConsoleMetricExporter}});var ace=Pn();Object.defineProperty(ae,"InstrumentType",{enumerable:!0,get:function(){return ace.InstrumentType}});var uce=wj();Object.defineProperty(ae,"MeterProvider",{enumerable:!0,get:function(){return uce.MeterProvider}});var Ei=m_();Object.defineProperty(ae,"DefaultAggregation",{enumerable:!0,get:function(){return Ei.DefaultAggregation}});Object.defineProperty(ae,"ExplicitBucketHistogramAggregation",{enumerable:!0,get:function(){return Ei.ExplicitBucketHistogramAggregation}});Object.defineProperty(ae,"ExponentialHistogramAggregation",{enumerable:!0,get:function(){return Ei.ExponentialHistogramAggregation}});Object.defineProperty(ae,"DropAggregation",{enumerable:!0,get:function(){return Ei.DropAggregation}});Object.defineProperty(ae,"HistogramAggregation",{enumerable:!0,get:function(){return Ei.HistogramAggregation}});Object.defineProperty(ae,"LastValueAggregation",{enumerable:!0,get:function(){return Ei.LastValueAggregation}});Object.defineProperty(ae,"SumAggregation",{enumerable:!0,get:function(){return Ei.SumAggregation}});Object.defineProperty(ae,"Aggregation",{enumerable:!0,get:function(){return Ei.Aggregation}});var lce=Rj();Object.defineProperty(ae,"View",{enumerable:!0,get:function(){return lce.View}});var cce=cn();Object.defineProperty(ae,"TimeoutError",{enumerable:!0,get:function(){return cce.TimeoutError}})});var Cj=p(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.toMetric=gi.toScopeMetrics=gi.toResourceMetrics=void 0;var Pj=(k(),B(U)),Ea=Nj(),H_=Nl(),fce=Al();function dce(t,e){let r=(0,fce.getOtlpEncoder)(e);return{resource:{attributes:(0,H_.toAttributes)(t.resource.attributes),droppedAttributesCount:0},schemaUrl:void 0,scopeMetrics:Mj(t.scopeMetrics,r)}}gi.toResourceMetrics=dce;function Mj(t,e){return Array.from(t.map(r=>({scope:{name:r.scope.name,version:r.scope.version},metrics:r.metrics.map(n=>Lj(n,e)),schemaUrl:r.scope.schemaUrl})))}gi.toScopeMetrics=Mj;function Lj(t,e){let r={name:t.descriptor.name,description:t.descriptor.description,unit:t.descriptor.unit},n=mce(t.aggregationTemporality);switch(t.dataPointType){case Ea.DataPointType.SUM:r.sum={aggregationTemporality:n,isMonotonic:t.isMonotonic,dataPoints:Ij(t,e)};break;case Ea.DataPointType.GAUGE:r.gauge={dataPoints:Ij(t,e)};break;case Ea.DataPointType.HISTOGRAM:r.histogram={aggregationTemporality:n,dataPoints:hce(t,e)};break;case Ea.DataPointType.EXPONENTIAL_HISTOGRAM:r.exponentialHistogram={aggregationTemporality:n,dataPoints:_ce(t,e)};break}return r}gi.toMetric=Lj;function pce(t,e,r){let n={attributes:(0,H_.toAttributes)(t.attributes),startTimeUnixNano:r.encodeHrTime(t.startTime),timeUnixNano:r.encodeHrTime(t.endTime)};switch(e){case Pj.ValueType.INT:n.asInt=t.value;break;case Pj.ValueType.DOUBLE:n.asDouble=t.value;break}return n}function Ij(t,e){return t.dataPoints.map(r=>pce(r,t.descriptor.valueType,e))}function hce(t,e){return t.dataPoints.map(r=>{let n=r.value;return{attributes:(0,H_.toAttributes)(r.attributes),bucketCounts:n.buckets.counts,explicitBounds:n.buckets.boundaries,count:n.count,sum:n.sum,min:n.min,max:n.max,startTimeUnixNano:e.encodeHrTime(r.startTime),timeUnixNano:e.encodeHrTime(r.endTime)}})}function _ce(t,e){return t.dataPoints.map(r=>{let n=r.value;return{attributes:(0,H_.toAttributes)(r.attributes),count:n.count,min:n.min,max:n.max,sum:n.sum,positive:{offset:n.positive.offset,bucketCounts:n.positive.bucketCounts},negative:{offset:n.negative.offset,bucketCounts:n.negative.bucketCounts},scale:n.scale,zeroCount:n.zeroCount,startTimeUnixNano:e.encodeHrTime(r.startTime),timeUnixNano:e.encodeHrTime(r.endTime)}})}function mce(t){switch(t){case Ea.AggregationTemporality.DELTA:return 1;case Ea.AggregationTemporality.CUMULATIVE:return 2}}});var Dj=p(Y_=>{"use strict";Object.defineProperty(Y_,"__esModule",{value:!0});Y_.createExportMetricsServiceRequest=void 0;var Sce=Cj();function Ece(t,e){return{resourceMetrics:t.map(r=>(0,Sce.toResourceMetrics)(r,e))}}Y_.createExportMetricsServiceRequest=Ece});var Uj=p(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.toLogAttributes=ga.createExportLogsServiceRequest=void 0;var gce=Al(),xv=Nl();function yce(t,e){let r=(0,gce.getOtlpEncoder)(e);return{resourceLogs:wce(t,r)}}ga.createExportLogsServiceRequest=yce;function Tce(t){let e=new Map;for(let r of t){let{resource:n,instrumentationScope:{name:s,version:a="",schemaUrl:o=""}}=r,i=e.get(n);i||(i=new Map,e.set(n,i));let u=`${s}@${a}:${o}`,l=i.get(u);l||(l=[],i.set(u,l)),l.push(r)}return e}function wce(t,e){let r=Tce(t);return Array.from(r,([n,s])=>({resource:{attributes:(0,xv.toAttributes)(n.attributes),droppedAttributesCount:0},scopeLogs:Array.from(s,([,a])=>{let{instrumentationScope:{name:o,version:i,schemaUrl:u}}=a[0];return{scope:{name:o,version:i},logRecords:a.map(l=>Oce(l,e)),schemaUrl:u}}),schemaUrl:void 0}))}function Oce(t,e){var r,n,s;return{timeUnixNano:e.encodeHrTime(t.hrTime),observedTimeUnixNano:e.encodeHrTime(t.hrTimeObserved),severityNumber:t.severityNumber,severityText:t.severityText,body:(0,xv.toAnyValue)(t.body),attributes:xj(t.attributes),droppedAttributesCount:t.droppedAttributesCount,flags:(r=t.spanContext)===null||r===void 0?void 0:r.traceFlags,traceId:e.encodeOptionalSpanContext((n=t.spanContext)===null||n===void 0?void 0:n.traceId),spanId:e.encodeOptionalSpanContext((s=t.spanContext)===null||s===void 0?void 0:s.spanId)}}function xj(t){return Object.keys(t).map(e=>(0,xv.toKeyValue)(e,t[e]))}ga.toLogAttributes=xj});var Uv=p(ct=>{"use strict";var vce=ct&&ct.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),ya=ct&&ct.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&vce(e,t,r)};Object.defineProperty(ct,"__esModule",{value:!0});ct.createExportLogsServiceRequest=ct.createExportMetricsServiceRequest=ct.createExportTraceServiceRequest=void 0;ya(a3(),ct);ya(Al(),ct);ya(p3(),ct);ya(_3(),ct);ya(m3(),ct);ya(E3(),ct);var bce=w3();Object.defineProperty(ct,"createExportTraceServiceRequest",{enumerable:!0,get:function(){return bce.createExportTraceServiceRequest}});var Ace=Dj();Object.defineProperty(ct,"createExportMetricsServiceRequest",{enumerable:!0,get:function(){return Ace.createExportMetricsServiceRequest}});var Rce=Uj();Object.defineProperty(ct,"createExportLogsServiceRequest",{enumerable:!0,get:function(){return Rce.createExportLogsServiceRequest}})});var kj=p(z_=>{"use strict";Object.defineProperty(z_,"__esModule",{value:!0});z_.VERSION=void 0;z_.VERSION="0.49.1"});var Fj=p(K_=>{"use strict";Object.defineProperty(K_,"__esModule",{value:!0});K_.OTLPTraceExporter=void 0;var Ta=te(),Bj=Ys(),qj=RO(),Nce=Uv(),Pce=kj(),Vj="v1/traces",Ice=`http://localhost:4318/${Vj}`,Mce={"User-Agent":`OTel-OTLP-Exporter-JavaScript/${Pce.VERSION}`},kv=class extends qj.OTLPProtoExporterNodeBase{constructor(e={}){super(e),this.headers=Object.assign(Object.assign(Object.assign(Object.assign({},this.headers),Mce),Ta.baggageUtils.parseKeyPairsIntoRecord((0,Ta.getEnv)().OTEL_EXPORTER_OTLP_TRACES_HEADERS)),e.headers)}convert(e){return(0,Nce.createExportTraceServiceRequest)(e)}getDefaultUrl(e){return typeof e.url=="string"?e.url:(0,Ta.getEnv)().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?(0,Bj.appendRootPathToUrlIfNeeded)((0,Ta.getEnv)().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT):(0,Ta.getEnv)().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?(0,Bj.appendResourcePathToUrl)((0,Ta.getEnv)().OTEL_EXPORTER_OTLP_ENDPOINT,Vj):Ice}getServiceClientType(){return qj.ServiceClientType.SPANS}};K_.OTLPTraceExporter=kv});var $j=p(Q_=>{"use strict";Object.defineProperty(Q_,"__esModule",{value:!0});Q_.OTLPTraceExporter=void 0;var Lce=Fj();Object.defineProperty(Q_,"OTLPTraceExporter",{enumerable:!0,get:function(){return Lce.OTLPTraceExporter}})});var Gj=p(J_=>{"use strict";Object.defineProperty(J_,"__esModule",{value:!0});J_.OTLPTraceExporter=void 0;var Cce=$j();Object.defineProperty(J_,"OTLPTraceExporter",{enumerable:!0,get:function(){return Cce.OTLPTraceExporter}})});var Wj=p(X_=>{"use strict";Object.defineProperty(X_,"__esModule",{value:!0});X_.OTLPTraceExporter=void 0;var Dce=Gj();Object.defineProperty(X_,"OTLPTraceExporter",{enumerable:!0,get:function(){return Dce.OTLPTraceExporter}})});var jj=p(Z_=>{"use strict";Object.defineProperty(Z_,"__esModule",{value:!0});Z_.VERSION=void 0;Z_.VERSION="0.49.1"});var Kj=p(em=>{"use strict";Object.defineProperty(em,"__esModule",{value:!0});em.OTLPLogExporter=void 0;var wa=te(),Hj=Ys(),Yj=RO(),xce=Uv(),Uce=jj(),kce={"User-Agent":`OTel-OTLP-Exporter-JavaScript/${Uce.VERSION}`},zj="v1/logs",Bce=`http://localhost:4318/${zj}`,Bv=class extends Yj.OTLPProtoExporterNodeBase{constructor(e={}){super(e),this.headers=Object.assign(Object.assign(Object.assign(Object.assign({},this.headers),kce),wa.baggageUtils.parseKeyPairsIntoRecord((0,wa.getEnv)().OTEL_EXPORTER_OTLP_LOGS_HEADERS)),e.headers)}convert(e){return(0,xce.createExportLogsServiceRequest)(e)}getDefaultUrl(e){return typeof e.url=="string"?e.url:(0,wa.getEnv)().OTEL_EXPORTER_OTLP_LOGS_ENDPOINT.length>0?(0,Hj.appendRootPathToUrlIfNeeded)((0,wa.getEnv)().OTEL_EXPORTER_OTLP_LOGS_ENDPOINT):(0,wa.getEnv)().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?(0,Hj.appendResourcePathToUrl)((0,wa.getEnv)().OTEL_EXPORTER_OTLP_ENDPOINT,zj):Bce}getServiceClientType(){return Yj.ServiceClientType.LOGS}};em.OTLPLogExporter=Bv});var Qj=p(tm=>{"use strict";Object.defineProperty(tm,"__esModule",{value:!0});tm.OTLPLogExporter=void 0;var qce=Kj();Object.defineProperty(tm,"OTLPLogExporter",{enumerable:!0,get:function(){return qce.OTLPLogExporter}})});var Jj=p(rm=>{"use strict";Object.defineProperty(rm,"__esModule",{value:!0});rm.OTLPLogExporter=void 0;var Vce=Qj();Object.defineProperty(rm,"OTLPLogExporter",{enumerable:!0,get:function(){return Vce.OTLPLogExporter}})});var Xj=p(nm=>{"use strict";Object.defineProperty(nm,"__esModule",{value:!0});nm.OTLPLogExporter=void 0;var Fce=Jj();Object.defineProperty(nm,"OTLPLogExporter",{enumerable:!0,get:function(){return Fce.OTLPLogExporter}})});var Zj=p(im=>{"use strict";Object.defineProperty(im,"__esModule",{value:!0});im.TelemetryExporter=void 0;var qv=gt();function $ce(t){return"kind"in t}function Gce(t){return"severityText"in t&&"severityNumber"in t}var Vv=class{tracesExporters=[];logsExporters=[];constructor(e){if(!qv.globalParams.enableOTLP)return;let{OTLPTraceExporter:r}=Wj(),{OTLPLogExporter:n}=Xj(),s=new Set(e.tracesEndpoint);for(let o of s)this.tracesExporters.push(new r({url:o})),console.log(`Traces will be exported to ${o}`);let a=new Set(e.logsEndpoint);for(let o of a)this.logsExporters.push(new n({url:o})),console.log(`Logs will be exported to ${o}`)}async export(e){if(!qv.globalParams.enableOTLP)return;let{ExportResultCode:r}=te(),n=[],s=[];e.forEach(o=>{$ce(o)&&n.push(o),Gce(o)&&s.push(o)});let a=[];if(n.length>0&&this.tracesExporters.length>0){let o=new Promise(i=>{let u=l=>{l.code!==r.SUCCESS&&(console.warn(`Trace export failed: ${l.code}`),console.warn(l)),i()};for(let l of this.tracesExporters)l.export(n,u)});a.push(o)}if(s.length>0&&this.logsExporters.length>0){let o=new Promise(i=>{let u=l=>{l.code!==r.SUCCESS&&(console.warn(`Log export failed: ${l.code}`),console.warn(l)),i()};for(let l of this.logsExporters)l.export(s,u)});a.push(o)}await Promise.all(a)}async flush(){if(qv.globalParams.enableOTLP){for(let e of this.tracesExporters)await e.forceFlush();for(let e of this.logsExporters)await e.forceFlush()}}};im.TelemetryExporter=Vv});var $v=p(e5=>{"use strict";e5.parse=function(t,e){return new Fv(t,e).parse()};var Fv=class t{constructor(e,r){this.source=e,this.transform=r||Wce,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var r;(this.recorded.length>0||e)&&(r=this.recorded.join(""),r==="NULL"&&!e&&(r=null),r!==null&&(r=this.transform(r)),this.entries.push(r),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var r,n,s;for(this.consumeDimensions();!this.isEof();)if(r=this.nextCharacter(),r.value==="{"&&!s)this.dimension++,this.dimension>1&&(n=new t(this.source.substr(this.position-1),this.transform),this.entries.push(n.parse(!0)),this.position+=n.position-2);else if(r.value==="}"&&!s){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else r.value==='"'&&!r.escaped?(s&&this.newEntry(!0),s=!s):r.value===","&&!s?this.newEntry():this.record(r.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function Wce(t){return t}});var Gv=p((oMe,t5)=>{var jce=$v();t5.exports={create:function(t,e){return{parse:function(){return jce.parse(t,e)}}}}});var i5=p((sMe,n5)=>{"use strict";var Hce=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,Yce=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,zce=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,Kce=/^-?infinity$/;n5.exports=function(e){if(Kce.test(e))return Number(e.replace("i","I"));var r=Hce.exec(e);if(!r)return Qce(e)||null;var n=!!r[8],s=parseInt(r[1],10);n&&(s=r5(s));var a=parseInt(r[2],10)-1,o=r[3],i=parseInt(r[4],10),u=parseInt(r[5],10),l=parseInt(r[6],10),c=r[7];c=c?1e3*parseFloat(c):0;var f,h=Jce(e);return h!=null?(f=new Date(Date.UTC(s,a,o,i,u,l,c)),Wv(s)&&f.setUTCFullYear(s),h!==0&&f.setTime(f.getTime()-h)):(f=new Date(s,a,o,i,u,l,c),Wv(s)&&f.setFullYear(s)),f};function Qce(t){var e=Yce.exec(t);if(e){var r=parseInt(e[1],10),n=!!e[4];n&&(r=r5(r));var s=parseInt(e[2],10)-1,a=e[3],o=new Date(r,s,a);return Wv(r)&&o.setFullYear(r),o}}function Jce(t){if(t.endsWith("+00"))return 0;var e=zce.exec(t.split(" ")[1]);if(e){var r=e[1];if(r==="Z")return 0;var n=r==="-"?-1:1,s=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return s*n*1e3}}function r5(t){return-(t-1)}function Wv(t){return t>=0&&t<100}});var s5=p((aMe,o5)=>{o5.exports=Zce;var Xce=Object.prototype.hasOwnProperty;function Zce(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Xce.call(r,n)&&(t[n]=r[n])}return t}});var l5=p((uMe,u5)=>{"use strict";var efe=s5();u5.exports=Oa;function Oa(t){if(!(this instanceof Oa))return new Oa(t);efe(this,dfe(t))}var tfe=["seconds","minutes","hours","days","months","years"];Oa.prototype.toPostgres=function(){var t=tfe.filter(this.hasOwnProperty,this);return this.milliseconds&&t.indexOf("seconds")<0&&t.push("seconds"),t.length===0?"0":t.map(function(e){var r=this[e]||0;return e==="seconds"&&this.milliseconds&&(r=(r+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),r+" "+e},this).join(" ")};var rfe={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},nfe=["years","months","days"],ife=["hours","minutes","seconds"];Oa.prototype.toISOString=Oa.prototype.toISO=function(){var t=nfe.map(r,this).join(""),e=ife.map(r,this).join("");return"P"+t+"T"+e;function r(n){var s=this[n]||0;return n==="seconds"&&this.milliseconds&&(s=(s+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),s+rfe[n]}};var jv="([+-]?\\d+)",ofe=jv+"\\s+years?",sfe=jv+"\\s+mons?",afe=jv+"\\s+days?",ufe="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",lfe=new RegExp([ofe,sfe,afe,ufe].map(function(t){return"("+t+")?"}).join("\\s*")),a5={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},cfe=["hours","minutes","seconds","milliseconds"];function ffe(t){var e=t+"000000".slice(t.length);return parseInt(e,10)/1e3}function dfe(t){if(!t)return{};var e=lfe.exec(t),r=e[8]==="-";return Object.keys(a5).reduce(function(n,s){var a=a5[s],o=e[a];return!o||(o=s==="milliseconds"?ffe(o):parseInt(o,10),!o)||(r&&~cfe.indexOf(s)&&(o*=-1),n[s]=o),n},{})}});var d5=p((lMe,f5)=>{"use strict";var c5=Buffer.from||Buffer;f5.exports=function(e){if(/^\\x/.test(e))return c5(e.substr(2),"hex");for(var r="",n=0;n<e.length;)if(e[n]!=="\\")r+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))r+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var s=1;n+s<e.length&&e[n+s]==="\\";)s++;for(var a=0;a<Math.floor(s/2);++a)r+="\\";n+=Math.floor(s/2)*2}return c5(r,"binary")}});var g5=p((cMe,E5)=>{var Vl=$v(),Fl=Gv(),om=i5(),h5=l5(),_5=d5();function sm(t){return function(r){return r===null?r:t(r)}}function m5(t){return t===null?t:t==="TRUE"||t==="t"||t==="true"||t==="y"||t==="yes"||t==="on"||t==="1"}function pfe(t){return t?Vl.parse(t,m5):null}function hfe(t){return parseInt(t,10)}function Hv(t){return t?Vl.parse(t,sm(hfe)):null}function _fe(t){return t?Vl.parse(t,sm(function(e){return S5(e).trim()})):null}var mfe=function(t){if(!t)return null;var e=Fl.create(t,function(r){return r!==null&&(r=Qv(r)),r});return e.parse()},Yv=function(t){if(!t)return null;var e=Fl.create(t,function(r){return r!==null&&(r=parseFloat(r)),r});return e.parse()},Or=function(t){if(!t)return null;var e=Fl.create(t);return e.parse()},zv=function(t){if(!t)return null;var e=Fl.create(t,function(r){return r!==null&&(r=om(r)),r});return e.parse()},Sfe=function(t){if(!t)return null;var e=Fl.create(t,function(r){return r!==null&&(r=h5(r)),r});return e.parse()},Efe=function(t){return t?Vl.parse(t,sm(_5)):null},Kv=function(t){return parseInt(t,10)},S5=function(t){var e=String(t);return/^\d+$/.test(e)?e:t},p5=function(t){return t?Vl.parse(t,sm(JSON.parse)):null},Qv=function(t){return t[0]!=="("?null:(t=t.substring(1,t.length-1).split(","),{x:parseFloat(t[0]),y:parseFloat(t[1])})},gfe=function(t){if(t[0]!=="<"&&t[1]!=="(")return null;for(var e="(",r="",n=!1,s=2;s<t.length-1;s++){if(n||(e+=t[s]),t[s]===")"){n=!0;continue}else if(!n)continue;t[s]!==","&&(r+=t[s])}var a=Qv(e);return a.radius=parseFloat(r),a},yfe=function(t){t(20,S5),t(21,Kv),t(23,Kv),t(26,Kv),t(700,parseFloat),t(701,parseFloat),t(16,m5),t(1082,om),t(1114,om),t(1184,om),t(600,Qv),t(651,Or),t(718,gfe),t(1e3,pfe),t(1001,Efe),t(1005,Hv),t(1007,Hv),t(1028,Hv),t(1016,_fe),t(1017,mfe),t(1021,Yv),t(1022,Yv),t(1231,Yv),t(1014,Or),t(1015,Or),t(1008,Or),t(1009,Or),t(1040,Or),t(1041,Or),t(1115,zv),t(1182,zv),t(1185,zv),t(1186,h5),t(1187,Sfe),t(17,_5),t(114,JSON.parse.bind(JSON)),t(3802,JSON.parse.bind(JSON)),t(199,p5),t(3807,p5),t(3907,Or),t(2951,Or),t(791,Or),t(1183,Or),t(1270,Or)};E5.exports={init:yfe}});var T5=p((fMe,y5)=>{"use strict";var Ht=1e6;function Tfe(t){var e=t.readInt32BE(0),r=t.readUInt32BE(4),n="";e<0&&(e=~e+(r===0),r=~r+1>>>0,n="-");var s="",a,o,i,u,l,c;{if(a=e%Ht,e=e/Ht>>>0,o=4294967296*a+r,r=o/Ht>>>0,i=""+(o-Ht*r),r===0&&e===0)return n+i+s;for(u="",l=6-i.length,c=0;c<l;c++)u+="0";s=u+i+s}{if(a=e%Ht,e=e/Ht>>>0,o=4294967296*a+r,r=o/Ht>>>0,i=""+(o-Ht*r),r===0&&e===0)return n+i+s;for(u="",l=6-i.length,c=0;c<l;c++)u+="0";s=u+i+s}{if(a=e%Ht,e=e/Ht>>>0,o=4294967296*a+r,r=o/Ht>>>0,i=""+(o-Ht*r),r===0&&e===0)return n+i+s;for(u="",l=6-i.length,c=0;c<l;c++)u+="0";s=u+i+s}return a=e%Ht,o=4294967296*a+r,i=""+o%Ht,n+i+s}y5.exports=Tfe});var A5=p((dMe,b5)=>{var wfe=T5(),qe=function(t,e,r,n,s){r=r||0,n=n||!1,s=s||function(S,g,E){return S*Math.pow(2,E)+g};var a=r>>3,o=function(S){return n?~S&255:S},i=255,u=8-r%8;e<u&&(i=255<<8-e&255,u=e),r&&(i=i>>r%8);var l=0;r%8+e>=8&&(l=s(0,o(t[a])&i,u));for(var c=e+r>>3,f=a+1;f<c;f++)l=s(l,o(t[f]),8);var h=(e+r)%8;return h>0&&(l=s(l,o(t[c])>>8-h,h)),l},v5=function(t,e,r){var n=Math.pow(2,r-1)-1,s=qe(t,1),a=qe(t,r,1);if(a===0)return 0;var o=1,i=function(l,c,f){l===0&&(l=1);for(var h=1;h<=f;h++)o/=2,(c&1<<f-h)>0&&(l+=o);return l},u=qe(t,e,r+1,!1,i);return a==Math.pow(2,r+1)-1?u===0?s===0?1/0:-1/0:NaN:(s===0?1:-1)*Math.pow(2,a-n)*u},Ofe=function(t){return qe(t,1)==1?-1*(qe(t,15,1,!0)+1):qe(t,15,1)},w5=function(t){return qe(t,1)==1?-1*(qe(t,31,1,!0)+1):qe(t,31,1)},vfe=function(t){return v5(t,23,8)},bfe=function(t){return v5(t,52,11)},Afe=function(t){var e=qe(t,16,32);if(e==49152)return NaN;for(var r=Math.pow(1e4,qe(t,16,16)),n=0,s=[],a=qe(t,16),o=0;o<a;o++)n+=qe(t,16,64+16*o)*r,r/=1e4;var i=Math.pow(10,qe(t,16,48));return(e===0?1:-1)*Math.round(n*i)/i},O5=function(t,e){var r=qe(e,1),n=qe(e,63,1),s=new Date((r===0?1:-1)*n/1e3+9466848e5);return t||s.setTime(s.getTime()+s.getTimezoneOffset()*6e4),s.usec=n%1e3,s.getMicroSeconds=function(){return this.usec},s.setMicroSeconds=function(a){this.usec=a},s.getUTCMicroSeconds=function(){return this.usec},s},$l=function(t){for(var e=qe(t,32),r=qe(t,32,32),n=qe(t,32,64),s=96,a=[],o=0;o<e;o++)a[o]=qe(t,32,s),s+=32,s+=32;var i=function(l){var c=qe(t,32,s);if(s+=32,c==4294967295)return null;var f;if(l==23||l==20)return f=qe(t,c*8,s),s+=c*8,f;if(l==25)return f=t.toString(this.encoding,s>>3,(s+=c<<3)>>3),f;console.log("ERROR: ElementType not implemented: "+l)},u=function(l,c){var f=[],h;if(l.length>1){var S=l.shift();for(h=0;h<S;h++)f[h]=u(l,c);l.unshift(S)}else for(h=0;h<l[0];h++)f[h]=i(c);return f};return u(a,n)},Rfe=function(t){return t.toString("utf8")},Nfe=function(t){return t===null?null:qe(t,8)>0},Pfe=function(t){t(20,wfe),t(21,Ofe),t(23,w5),t(26,w5),t(1700,Afe),t(700,vfe),t(701,bfe),t(16,Nfe),t(1114,O5.bind(null,!1)),t(1184,O5.bind(null,!0)),t(1e3,$l),t(1007,$l),t(1016,$l),t(1008,$l),t(1009,$l),t(25,Rfe)};b5.exports={init:Pfe}});var N5=p((pMe,R5)=>{R5.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var jl=p(Wl=>{var Ife=g5(),Mfe=A5(),Lfe=Gv(),Cfe=N5();Wl.getTypeParser=Dfe;Wl.setTypeParser=xfe;Wl.arrayParser=Lfe;Wl.builtins=Cfe;var Gl={text:{},binary:{}};function P5(t){return String(t)}function Dfe(t,e){return e=e||"text",Gl[e]&&Gl[e][t]||P5}function xfe(t,e,r){typeof e=="function"&&(r=e,e="text"),Gl[e][t]=r}Ife.init(function(t,e){Gl.text[t]=e});Mfe.init(function(t,e){Gl.binary[t]=e})});var Hl=p((_Me,Jv)=>{"use strict";Jv.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var va=jl(),Ufe=va.getTypeParser(20,"text"),kfe=va.getTypeParser(1016,"text");Jv.exports.__defineSetter__("parseInt8",function(t){va.setTypeParser(20,"text",t?va.getTypeParser(23,"text"):Ufe),va.setTypeParser(1016,"text",t?va.getTypeParser(1007,"text"):kfe)})});var Yl=p((mMe,M5)=>{"use strict";var Bfe=Hl();function qfe(t){var e=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function I5(t){for(var e="{",r=0;r<t.length;r++)r>0&&(e=e+","),t[r]===null||typeof t[r]>"u"?e=e+"NULL":Array.isArray(t[r])?e=e+I5(t[r]):t[r]instanceof Buffer?e+="\\\\x"+t[r].toString("hex"):e+=qfe(am(t[r]));return e=e+"}",e}var am=function(t,e){if(t==null)return null;if(t instanceof Buffer)return t;if(ArrayBuffer.isView(t)){var r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return r.length===t.byteLength?r:r.slice(t.byteOffset,t.byteOffset+t.byteLength)}return t instanceof Date?Bfe.parseInputDatesAsUTC?$fe(t):Ffe(t):Array.isArray(t)?I5(t):typeof t=="object"?Vfe(t,e):t.toString()};function Vfe(t,e){if(t&&typeof t.toPostgres=="function"){if(e=e||[],e.indexOf(t)!==-1)throw new Error('circular reference detected while preparing "'+t+'" for query');return e.push(t),am(t.toPostgres(am),e)}return JSON.stringify(t)}function At(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function Ffe(t){var e=-t.getTimezoneOffset(),r=t.getFullYear(),n=r<1;n&&(r=Math.abs(r)+1);var s=At(r,4)+"-"+At(t.getMonth()+1,2)+"-"+At(t.getDate(),2)+"T"+At(t.getHours(),2)+":"+At(t.getMinutes(),2)+":"+At(t.getSeconds(),2)+"."+At(t.getMilliseconds(),3);return e<0?(s+="-",e*=-1):s+="+",s+=At(Math.floor(e/60),2)+":"+At(e%60,2),n&&(s+=" BC"),s}function $fe(t){var e=t.getUTCFullYear(),r=e<1;r&&(e=Math.abs(e)+1);var n=At(e,4)+"-"+At(t.getUTCMonth()+1,2)+"-"+At(t.getUTCDate(),2)+"T"+At(t.getUTCHours(),2)+":"+At(t.getUTCMinutes(),2)+":"+At(t.getUTCSeconds(),2)+"."+At(t.getUTCMilliseconds(),3);return n+="+00:00",r&&(n+=" BC"),n}function Gfe(t,e,r){return t=typeof t=="string"?{text:t}:t,e&&(typeof e=="function"?t.callback=e:t.values=e),r&&(t.callback=r),t}var Wfe=function(t){return'"'+t.replace(/"/g,'""')+'"'},jfe=function(t){for(var e=!1,r="'",n=0;n<t.length;n++){var s=t[n];s==="'"?r+=s+s:s==="\\"?(r+=s+s,e=!0):r+=s}return r+="'",e===!0&&(r=" E"+r),r};M5.exports={prepareValue:function(e){return am(e)},normalizeQueryConfig:Gfe,escapeIdentifier:Wfe,escapeLiteral:jfe}});var C5=p((SMe,L5)=>{"use strict";var zl=require("crypto");function Xv(t){return zl.createHash("md5").update(t,"utf-8").digest("hex")}function Hfe(t,e,r){var n=Xv(e+t),s=Xv(Buffer.concat([Buffer.from(n),r]));return"md5"+s}function Yfe(t){return zl.createHash("sha256").update(t).digest()}function zfe(t,e){return zl.createHmac("sha256",t).update(e).digest()}async function Kfe(t,e,r){return zl.pbkdf2Sync(t,e,r,32,"sha256")}L5.exports={postgresMd5PasswordHash:Hfe,randomBytes:zl.randomBytes,deriveKey:Kfe,sha256:Yfe,hmacSha256:zfe,md5:Xv}});var k5=p((EMe,U5)=>{var D5=require("crypto");U5.exports={postgresMd5PasswordHash:Jfe,randomBytes:Qfe,deriveKey:ede,sha256:Xfe,hmacSha256:Zfe,md5:Zv};var x5=D5.webcrypto||globalThis.crypto,ba=x5.subtle,eb=new TextEncoder;function Qfe(t){return x5.getRandomValues(Buffer.alloc(t))}async function Zv(t){try{return D5.createHash("md5").update(t,"utf-8").digest("hex")}catch{let r=typeof t=="string"?eb.encode(t):t,n=await ba.digest("MD5",r);return Array.from(new Uint8Array(n)).map(s=>s.toString(16).padStart(2,"0")).join("")}}async function Jfe(t,e,r){var n=await Zv(e+t),s=await Zv(Buffer.concat([Buffer.from(n),r]));return"md5"+s}async function Xfe(t){return await ba.digest("SHA-256",t)}async function Zfe(t,e){let r=await ba.importKey("raw",t,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await ba.sign("HMAC",r,eb.encode(e))}async function ede(t,e,r){let n=await ba.importKey("raw",eb.encode(t),"PBKDF2",!1,["deriveBits"]),s={name:"PBKDF2",hash:"SHA-256",salt:e,iterations:r};return await ba.deriveBits(s,n,256,["deriveBits"])}});var rb=p((gMe,tb)=>{"use strict";var tde=parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15;tde?tb.exports=C5():tb.exports=k5()});var F5=p((yMe,V5)=>{"use strict";var Lo=rb();function rde(t){if(t.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=Lo.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}async function nde(t,e,r){if(t.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof r!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=sde(r);if(n.nonce.startsWith(t.clientNonce)){if(n.nonce.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var s="n=*,r="+t.clientNonce,a="r="+n.nonce+",s="+n.salt+",i="+n.iteration,o="c=biws,r="+n.nonce,i=s+","+a+","+o,u=Buffer.from(n.salt,"base64"),l=await Lo.deriveKey(e,u,n.iteration),c=await Lo.hmacSha256(l,"Client Key"),f=await Lo.sha256(c),h=await Lo.hmacSha256(f,i),S=ude(Buffer.from(c),Buffer.from(h)).toString("base64"),g=await Lo.hmacSha256(l,"Server Key"),E=await Lo.hmacSha256(g,i);t.message="SASLResponse",t.serverSignature=Buffer.from(E).toString("base64"),t.response=o+",p="+S}function ide(t,e){if(t.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:r}=ade(e);if(r!==t.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function ode(t){if(typeof t!="string")throw new TypeError("SASL: text must be a string");return t.split("").map((e,r)=>t.charCodeAt(r)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function B5(t){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(t)}function q5(t){if(typeof t!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(t.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let r=e[0],n=e.substring(2);return[r,n]}))}function sde(t){let e=q5(t),r=e.get("r");if(r){if(!ode(r))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let n=e.get("s");if(n){if(!B5(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let s=e.get("i");if(s){if(!/^[1-9][0-9]*$/.test(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let a=parseInt(s,10);return{nonce:r,salt:n,iteration:a}}function ade(t){let r=q5(t).get("v");if(r){if(!B5(r))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:r}}function ude(t,e){if(!Buffer.isBuffer(t))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(t.length!==e.length)throw new Error("Buffer lengths must match");if(t.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(t.map((r,n)=>t[n]^e[n]))}V5.exports={startSession:rde,continueSession:nde,finalizeSession:ide}});var nb=p((TMe,$5)=>{"use strict";var lde=jl();function um(t){this._types=t||lde,this.text={},this.binary={}}um.prototype.getOverrides=function(t){switch(t){case"text":return this.text;case"binary":return this.binary;default:return{}}};um.prototype.setTypeParser=function(t,e,r){typeof e=="function"&&(r=e,e="text"),this.getOverrides(e)[t]=r};um.prototype.getTypeParser=function(t,e){return e=e||"text",this.getOverrides(e)[t]||this._types.getTypeParser(t,e)};$5.exports=um});var j5=p((wMe,W5)=>{"use strict";function Aa(t,e={}){if(t.charAt(0)==="/"){let u=t.split(" ");return{host:u[0],database:u[1]}}let r={},n,s=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(t)&&(t=encodeURI(t).replace(/%25(\d\d)/g,"%$1"));try{try{n=new URL(t,"postgres://base")}catch{n=new URL(t.replace("@/","@___DUMMY___/"),"postgres://base"),s=!0}}catch(u){throw u.input&&(u.input="*****REDACTED*****"),u}for(let u of n.searchParams.entries())r[u[0]]=u[1];if(r.user=r.user||decodeURIComponent(n.username),r.password=r.password||decodeURIComponent(n.password),n.protocol=="socket:")return r.host=decodeURI(n.pathname),r.database=n.searchParams.get("db"),r.client_encoding=n.searchParams.get("encoding"),r;let a=s?"":n.hostname;r.host?a&&/^%2f/i.test(a)&&(n.pathname=a+n.pathname):r.host=decodeURIComponent(a),r.port||(r.port=n.port);let o=n.pathname.slice(1)||null;r.database=o?decodeURI(o):null,(r.ssl==="true"||r.ssl==="1")&&(r.ssl=!0),r.ssl==="0"&&(r.ssl=!1),(r.sslcert||r.sslkey||r.sslrootcert||r.sslmode)&&(r.ssl={});let i=r.sslcert||r.sslkey||r.sslrootcert?require("fs"):null;if(r.sslcert&&(r.ssl.cert=i.readFileSync(r.sslcert).toString()),r.sslkey&&(r.ssl.key=i.readFileSync(r.sslkey).toString()),r.sslrootcert&&(r.ssl.ca=i.readFileSync(r.sslrootcert).toString()),e.useLibpqCompat&&r.uselibpqcompat)throw new Error("Both useLibpqCompat and uselibpqcompat are set. Please use only one of them.");if(r.uselibpqcompat==="true"||e.useLibpqCompat)switch(r.sslmode){case"disable":{r.ssl=!1;break}case"prefer":{r.ssl.rejectUnauthorized=!1;break}case"require":{r.sslrootcert?r.ssl.checkServerIdentity=function(){}:r.ssl.rejectUnauthorized=!1;break}case"verify-ca":{if(!r.ssl.ca)throw new Error("SECURITY WARNING: Using sslmode=verify-ca requires specifying a CA with sslrootcert. If a public CA is used, verify-ca allows connections to a server that somebody else may have registered with the CA, making you vulnerable to Man-in-the-Middle attacks. Either specify a custom CA certificate with sslrootcert parameter or use sslmode=verify-full for proper security.");r.ssl.checkServerIdentity=function(){};break}case"verify-full":break}else switch(r.sslmode){case"disable":{r.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":{r.sslmode!=="verify-full"&&ib(r.sslmode);break}case"no-verify":{r.ssl.rejectUnauthorized=!1;break}}return r}function cde(t){return Object.entries(t).reduce((r,[n,s])=>(s!=null&&(r[n]=s),r),{})}function G5(t){return Object.entries(t).reduce((r,[n,s])=>{if(n==="ssl"){let a=s;typeof a=="boolean"&&(r[n]=a),typeof a=="object"&&(r[n]=cde(a))}else if(s!=null)if(n==="port"){if(s!==""){let a=parseInt(s,10);if(isNaN(a))throw new Error(`Invalid ${n}: ${s}`);r[n]=a}}else r[n]=s;return r},{})}function fde(t){return G5(Aa(t))}function ib(t){!ib.warned&&typeof process<"u"&&process.emitWarning&&(ib.warned=!0,process.emitWarning(`SECURITY WARNING: The SSL modes 'prefer', 'require', and 'verify-ca' are treated as aliases for 'verify-full'.
In the next major version (pg-connection-string v3.0.0 and pg v9.0.0), these modes will adopt standard libpq semantics, which have weaker security guarantees.

To prepare for this change:
- If you want the current behavior, explicitly use 'sslmode=verify-full'
- If you want libpq compatibility now, use 'uselibpqcompat=true&sslmode=${t}'

See https://www.postgresql.org/docs/current/libpq-ssl.html for libpq SSL mode definitions.`))}W5.exports=Aa;Aa.parse=Aa;Aa.toClientConfig=G5;Aa.parseIntoClientConfig=fde});var sb=p((OMe,z5)=>{"use strict";var dde=require("dns"),Y5=Hl(),H5=j5().parse,Dt=function(t,e,r){return r===void 0?r=process.env["PG"+t.toUpperCase()]:r===!1||(r=process.env[r]),e[t]||r||Y5[t]},pde=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return Y5.ssl},Ra=function(t){return"'"+(""+t).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},vr=function(t,e,r){var n=e[r];n!=null&&t.push(r+"="+Ra(n))},ob=class{constructor(e){e=typeof e=="string"?H5(e):e||{},e.connectionString&&(e=Object.assign({},e,H5(e.connectionString))),this.user=Dt("user",e),this.database=Dt("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(Dt("port",e),10),this.host=Dt("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:Dt("password",e)}),this.binary=Dt("binary",e),this.options=Dt("options",e),this.ssl=typeof e.ssl>"u"?pde():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=Dt("client_encoding",e),this.replication=Dt("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=Dt("application_name",e,"PGAPPNAME"),this.fallback_application_name=Dt("fallback_application_name",e,!1),this.statement_timeout=Dt("statement_timeout",e,!1),this.lock_timeout=Dt("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=Dt("idle_in_transaction_session_timeout",e,!1),this.query_timeout=Dt("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var r=[];vr(r,this,"user"),vr(r,this,"password"),vr(r,this,"port"),vr(r,this,"application_name"),vr(r,this,"fallback_application_name"),vr(r,this,"connect_timeout"),vr(r,this,"options");var n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(vr(r,n,"sslmode"),vr(r,n,"sslca"),vr(r,n,"sslkey"),vr(r,n,"sslcert"),vr(r,n,"sslrootcert"),this.database&&r.push("dbname="+Ra(this.database)),this.replication&&r.push("replication="+Ra(this.replication)),this.host&&r.push("host="+Ra(this.host)),this.isDomainSocket)return e(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+Ra(this.client_encoding)),dde.lookup(this.host,function(s,a){return s?e(s,null):(r.push("hostaddr="+Ra(a)),e(null,r.join(" ")))})}};z5.exports=ob});var J5=p((vMe,Q5)=>{"use strict";var hde=jl(),K5=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,ab=class{constructor(e,r){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=r,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(e){var r;e.text?r=K5.exec(e.text):r=K5.exec(e.command),r&&(this.command=r[1],r[3]?(this.oid=parseInt(r[2],10),this.rowCount=parseInt(r[3],10)):r[2]&&(this.rowCount=parseInt(r[2],10)))}_parseRowAsArray(e){for(var r=new Array(e.length),n=0,s=e.length;n<s;n++){var a=e[n];a!==null?r[n]=this._parsers[n](a):r[n]=null}return r}parseRow(e){for(var r={...this._prebuiltEmptyResultObject},n=0,s=e.length;n<s;n++){var a=e[n],o=this.fields[n].name;a!==null&&(r[o]=this._parsers[n](a))}return r}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var r=0;r<e.length;r++){var n=e[r];this._types?this._parsers[r]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[r]=hde.getTypeParser(n.dataTypeID,n.format||"text")}this._createPrebuiltEmptyResultObject()}_createPrebuiltEmptyResultObject(){for(var e={},r=0;r<this.fields.length;r++)e[this.fields[r].name]=null;this._prebuiltEmptyResultObject={...e}}};Q5.exports=ab});var tH=p((bMe,eH)=>{"use strict";var{EventEmitter:_de}=require("events"),X5=J5(),Z5=Yl(),ub=class extends _de{constructor(e,r,n){super(),e=Z5.normalizeQueryConfig(e,r,n),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new X5(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new X5(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let r;if(!this._canceledDueToError){try{r=this._result.parseRow(e.fields)}catch(n){this._canceledDueToError=n;return}this.emit("row",r,this._result),this._accumulateRows&&this._result.addRow(r)}}handleCommandComplete(e,r){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&r.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,r){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(r){process.nextTick(()=>{throw r})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let r=e.parsedStatements[this.name];return this.text&&r&&this.text!==r?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,r){e.execute({portal:this.portal,rows:r}),r?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:Z5.prepareValue})}catch(r){this.handleError(r,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,r){}};eH.exports=ub});var Ob=p(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.NoticeMessage=X.DataRowMessage=X.CommandCompleteMessage=X.ReadyForQueryMessage=X.NotificationResponseMessage=X.BackendKeyDataMessage=X.AuthenticationMD5Password=X.ParameterStatusMessage=X.ParameterDescriptionMessage=X.RowDescriptionMessage=X.Field=X.CopyResponse=X.CopyDataMessage=X.DatabaseError=X.copyDone=X.emptyQuery=X.replicationStart=X.portalSuspended=X.noData=X.closeComplete=X.bindComplete=X.parseComplete=void 0;X.parseComplete={name:"parseComplete",length:5};X.bindComplete={name:"bindComplete",length:5};X.closeComplete={name:"closeComplete",length:5};X.noData={name:"noData",length:5};X.portalSuspended={name:"portalSuspended",length:5};X.replicationStart={name:"replicationStart",length:4};X.emptyQuery={name:"emptyQuery",length:4};X.copyDone={name:"copyDone",length:4};var lb=class extends Error{constructor(e,r,n){super(e),this.length=r,this.name=n}};X.DatabaseError=lb;var cb=class{constructor(e,r){this.length=e,this.chunk=r,this.name="copyData"}};X.CopyDataMessage=cb;var fb=class{constructor(e,r,n,s){this.length=e,this.name=r,this.binary=n,this.columnTypes=new Array(s)}};X.CopyResponse=fb;var db=class{constructor(e,r,n,s,a,o,i){this.name=e,this.tableID=r,this.columnID=n,this.dataTypeID=s,this.dataTypeSize=a,this.dataTypeModifier=o,this.format=i}};X.Field=db;var pb=class{constructor(e,r){this.length=e,this.fieldCount=r,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};X.RowDescriptionMessage=pb;var hb=class{constructor(e,r){this.length=e,this.parameterCount=r,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};X.ParameterDescriptionMessage=hb;var _b=class{constructor(e,r,n){this.length=e,this.parameterName=r,this.parameterValue=n,this.name="parameterStatus"}};X.ParameterStatusMessage=_b;var mb=class{constructor(e,r){this.length=e,this.salt=r,this.name="authenticationMD5Password"}};X.AuthenticationMD5Password=mb;var Sb=class{constructor(e,r,n){this.length=e,this.processID=r,this.secretKey=n,this.name="backendKeyData"}};X.BackendKeyDataMessage=Sb;var Eb=class{constructor(e,r,n,s){this.length=e,this.processId=r,this.channel=n,this.payload=s,this.name="notification"}};X.NotificationResponseMessage=Eb;var gb=class{constructor(e,r){this.length=e,this.status=r,this.name="readyForQuery"}};X.ReadyForQueryMessage=gb;var yb=class{constructor(e,r){this.length=e,this.text=r,this.name="commandComplete"}};X.CommandCompleteMessage=yb;var Tb=class{constructor(e,r){this.length=e,this.fields=r,this.name="dataRow",this.fieldCount=r.length}};X.DataRowMessage=Tb;var wb=class{constructor(e,r){this.length=e,this.message=r,this.name="notice"}};X.NoticeMessage=wb});var rH=p(lm=>{"use strict";Object.defineProperty(lm,"__esModule",{value:!0});lm.Writer=void 0;var vb=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){if(this.buffer.length-this.offset<e){let n=this.buffer,s=n.length+(n.length>>1)+e;this.buffer=Buffer.allocUnsafe(s),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{let r=Buffer.byteLength(e);this.ensure(r+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=r}return this.buffer[this.offset++]=0,this}addString(e=""){let r=Buffer.byteLength(e);return this.ensure(r),this.buffer.write(e,this.offset),this.offset+=r,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let r=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(r,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){let r=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),r}};lm.Writer=vb});var iH=p(fm=>{"use strict";Object.defineProperty(fm,"__esModule",{value:!0});fm.serialize=void 0;var bb=rH(),xe=new bb.Writer,mde=t=>{xe.addInt16(3).addInt16(0);for(let n of Object.keys(t))xe.addCString(n).addCString(t[n]);xe.addCString("client_encoding").addCString("UTF8");let e=xe.addCString("").flush(),r=e.length+4;return new bb.Writer().addInt32(r).add(e).flush()},Sde=()=>{let t=Buffer.allocUnsafe(8);return t.writeInt32BE(8,0),t.writeInt32BE(80877103,4),t},Ede=t=>xe.addCString(t).flush(112),gde=function(t,e){return xe.addCString(t).addInt32(Buffer.byteLength(e)).addString(e),xe.flush(112)},yde=function(t){return xe.addString(t).flush(112)},Tde=t=>xe.addCString(t).flush(81),nH=[],wde=t=>{let e=t.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let r=t.types||nH,n=r.length,s=xe.addCString(e).addCString(t.text).addInt16(n);for(let a=0;a<n;a++)s.addInt32(r[a]);return xe.flush(80)},Na=new bb.Writer,Ode=function(t,e){for(let r=0;r<t.length;r++){let n=e?e(t[r],r):t[r];n==null?(xe.addInt16(0),Na.addInt32(-1)):n instanceof Buffer?(xe.addInt16(1),Na.addInt32(n.length),Na.add(n)):(xe.addInt16(0),Na.addInt32(Buffer.byteLength(n)),Na.addString(n))}},vde=(t={})=>{let e=t.portal||"",r=t.statement||"",n=t.binary||!1,s=t.values||nH,a=s.length;return xe.addCString(e).addCString(r),xe.addInt16(a),Ode(s,t.valueMapper),xe.addInt16(a),xe.add(Na.flush()),xe.addInt16(1),xe.addInt16(n?1:0),xe.flush(66)},bde=Buffer.from([69,0,0,0,9,0,0,0,0,0]),Ade=t=>{if(!t||!t.portal&&!t.rows)return bde;let e=t.portal||"",r=t.rows||0,n=Buffer.byteLength(e),s=4+n+1+4,a=Buffer.allocUnsafe(1+s);return a[0]=69,a.writeInt32BE(s,1),a.write(e,5,"utf-8"),a[n+5]=0,a.writeUInt32BE(r,a.length-4),a},Rde=(t,e)=>{let r=Buffer.allocUnsafe(16);return r.writeInt32BE(16,0),r.writeInt16BE(1234,4),r.writeInt16BE(5678,6),r.writeInt32BE(t,8),r.writeInt32BE(e,12),r},Ab=(t,e)=>{let n=4+Buffer.byteLength(e)+1,s=Buffer.allocUnsafe(1+n);return s[0]=t,s.writeInt32BE(n,1),s.write(e,5,"utf-8"),s[n]=0,s},Nde=xe.addCString("P").flush(68),Pde=xe.addCString("S").flush(68),Ide=t=>t.name?Ab(68,`${t.type}${t.name||""}`):t.type==="P"?Nde:Pde,Mde=t=>{let e=`${t.type}${t.name||""}`;return Ab(67,e)},Lde=t=>xe.add(t).flush(100),Cde=t=>Ab(102,t),cm=t=>Buffer.from([t,0,0,0,4]),Dde=cm(72),xde=cm(83),Ude=cm(88),kde=cm(99),Bde={startup:mde,password:Ede,requestSsl:Sde,sendSASLInitialResponseMessage:gde,sendSCRAMClientFinalMessage:yde,query:Tde,parse:wde,bind:vde,execute:Ade,describe:Ide,close:Mde,flush:()=>Dde,sync:()=>xde,end:()=>Ude,copyData:Lde,copyDone:()=>kde,copyFail:Cde,cancel:Rde};fm.serialize=Bde});var oH=p(dm=>{"use strict";Object.defineProperty(dm,"__esModule",{value:!0});dm.BufferReader=void 0;var qde=Buffer.allocUnsafe(0),Rb=class{constructor(e=0){this.offset=e,this.buffer=qde,this.encoding="utf-8"}setBuffer(e,r){this.offset=e,this.buffer=r}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}uint32(){let e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e}string(e){let r=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,r}cstring(){let e=this.offset,r=e;for(;this.buffer[r++]!==0;);return this.offset=r,this.buffer.toString(this.encoding,e,r-1)}bytes(e){let r=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,r}};dm.BufferReader=Rb});var lH=p(pm=>{"use strict";Object.defineProperty(pm,"__esModule",{value:!0});pm.Parser=void 0;var Ve=Ob(),Vde=oH(),Pb=1,Fde=4,sH=Pb+Fde,lr=-1,Nb=Buffer.allocUnsafe(0),Ib=class{constructor(e){if(this.buffer=Nb,this.bufferLength=0,this.bufferOffset=0,this.reader=new Vde.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,r){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,s=this.bufferOffset;for(;s+sH<=n;){let a=this.buffer[s],o=this.buffer.readUInt32BE(s+Pb),i=Pb+o;if(i+s<=n){let u=this.handlePacket(s+sH,a,o,this.buffer);r(u),s+=i}else break}s===n?(this.buffer=Nb,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-s,this.bufferOffset=s)}mergeBuffer(e){if(this.bufferLength>0){let r=this.bufferLength+e.byteLength;if(r+this.bufferOffset>this.buffer.byteLength){let s;if(r<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)s=this.buffer;else{let a=this.buffer.byteLength*2;for(;r>=a;)a*=2;s=Buffer.allocUnsafe(a)}this.buffer.copy(s,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=s,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=r}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,r,n,s){let{reader:a}=this;a.setBuffer(e,s);let o;switch(r){case 50:o=Ve.bindComplete;break;case 49:o=Ve.parseComplete;break;case 51:o=Ve.closeComplete;break;case 110:o=Ve.noData;break;case 115:o=Ve.portalSuspended;break;case 99:o=Ve.copyDone;break;case 87:o=Ve.replicationStart;break;case 73:o=Ve.emptyQuery;break;case 68:o=Jde(a);break;case 67:o=Gde(a);break;case 90:o=$de(a);break;case 65:o=Yde(a);break;case 82:o=epe(a,n);break;case 83:o=Xde(a);break;case 75:o=Zde(a);break;case 69:o=aH(a,"error");break;case 78:o=aH(a,"notice");break;case 84:o=zde(a);break;case 116:o=Qde(a);break;case 71:o=jde(a);break;case 72:o=Hde(a);break;case 100:o=Wde(a,n);break;default:return new Ve.DatabaseError("received invalid response: "+r.toString(16),n,"error")}return a.setBuffer(0,Nb),o.length=n,o}};pm.Parser=Ib;var $de=t=>{let e=t.string(1);return new Ve.ReadyForQueryMessage(lr,e)},Gde=t=>{let e=t.cstring();return new Ve.CommandCompleteMessage(lr,e)},Wde=(t,e)=>{let r=t.bytes(e-4);return new Ve.CopyDataMessage(lr,r)},jde=t=>uH(t,"copyInResponse"),Hde=t=>uH(t,"copyOutResponse"),uH=(t,e)=>{let r=t.byte()!==0,n=t.int16(),s=new Ve.CopyResponse(lr,e,r,n);for(let a=0;a<n;a++)s.columnTypes[a]=t.int16();return s},Yde=t=>{let e=t.int32(),r=t.cstring(),n=t.cstring();return new Ve.NotificationResponseMessage(lr,e,r,n)},zde=t=>{let e=t.int16(),r=new Ve.RowDescriptionMessage(lr,e);for(let n=0;n<e;n++)r.fields[n]=Kde(t);return r},Kde=t=>{let e=t.cstring(),r=t.uint32(),n=t.int16(),s=t.uint32(),a=t.int16(),o=t.int32(),i=t.int16()===0?"text":"binary";return new Ve.Field(e,r,n,s,a,o,i)},Qde=t=>{let e=t.int16(),r=new Ve.ParameterDescriptionMessage(lr,e);for(let n=0;n<e;n++)r.dataTypeIDs[n]=t.int32();return r},Jde=t=>{let e=t.int16(),r=new Array(e);for(let n=0;n<e;n++){let s=t.int32();r[n]=s===-1?null:t.string(s)}return new Ve.DataRowMessage(lr,r)},Xde=t=>{let e=t.cstring(),r=t.cstring();return new Ve.ParameterStatusMessage(lr,e,r)},Zde=t=>{let e=t.int32(),r=t.int32();return new Ve.BackendKeyDataMessage(lr,e,r)},epe=(t,e)=>{let r=t.int32(),n={name:"authenticationOk",length:e};switch(r){case 0:break;case 3:n.length===8&&(n.name="authenticationCleartextPassword");break;case 5:if(n.length===12){n.name="authenticationMD5Password";let s=t.bytes(4);return new Ve.AuthenticationMD5Password(lr,s)}break;case 10:{n.name="authenticationSASL",n.mechanisms=[];let s;do s=t.cstring(),s&&n.mechanisms.push(s);while(s)}break;case 11:n.name="authenticationSASLContinue",n.data=t.string(e-8);break;case 12:n.name="authenticationSASLFinal",n.data=t.string(e-8);break;default:throw new Error("Unknown authenticationOk message type "+r)}return n},aH=(t,e)=>{let r={},n=t.string(1);for(;n!=="\0";)r[n]=t.cstring(),n=t.string(1);let s=r.M,a=e==="notice"?new Ve.NoticeMessage(lr,s):new Ve.DatabaseError(s,lr,e);return a.severity=r.S,a.code=r.C,a.detail=r.D,a.hint=r.H,a.position=r.P,a.internalPosition=r.p,a.internalQuery=r.q,a.where=r.W,a.schema=r.s,a.table=r.t,a.column=r.c,a.dataType=r.d,a.constraint=r.n,a.file=r.F,a.line=r.L,a.routine=r.R,a}});var Mb=p(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.DatabaseError=yi.serialize=yi.parse=void 0;var tpe=Ob();Object.defineProperty(yi,"DatabaseError",{enumerable:!0,get:function(){return tpe.DatabaseError}});var rpe=iH();Object.defineProperty(yi,"serialize",{enumerable:!0,get:function(){return rpe.serialize}});var npe=lH();function ipe(t,e){let r=new npe.Parser;return t.on("data",n=>r.parse(n,e)),new Promise(n=>t.on("end",()=>n()))}yi.parse=ipe});var cH=p(Lb=>{"use strict";Object.defineProperty(Lb,"__esModule",{value:!0});Lb.default={}});var fH=p((CMe,Cb)=>{Cb.exports.getStream=function(e){let r=require("net");if(typeof r.Socket=="function")return new r.Socket;{let{CloudflareSocket:n}=cH();return new n(e)}};Cb.exports.getSecureStream=function(e){var r=require("tls");return r.connect?r.connect(e):(e.socket.startTls(e),e.socket)}});var xb=p((xMe,dH)=>{"use strict";var DMe=require("net"),ope=require("events").EventEmitter,{parse:spe,serialize:ft}=Mb(),{getStream:ape,getSecureStream:upe}=fH(),lpe=ft.flush(),cpe=ft.sync(),fpe=ft.end(),Db=class extends ope{constructor(e){super(),e=e||{},this.stream=e.stream||ape(e.ssl),typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var r=this;this.on("newListener",function(n){n==="message"&&(r._emitMessage=!0)})}connect(e,r){var n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,r),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});let s=function(a){n._ending&&(a.code==="ECONNRESET"||a.code==="EPIPE")||n.emit("error",a)};if(this.stream.on("error",s),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(a){var o=a.toString("utf8");switch(o){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}let i={socket:n.stream};n.ssl!==!0&&(Object.assign(i,n.ssl),"key"in n.ssl&&(i.key=n.ssl.key));var u=require("net");u.isIP&&u.isIP(r)===0&&(i.servername=r);try{n.stream=upe(i)}catch(l){return n.emit("error",l)}n.attachListeners(n.stream),n.stream.on("error",s),n.emit("sslconnect")})}attachListeners(e){spe(e,r=>{var n=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(n,r)})}requestSsl(){this.stream.write(ft.requestSsl())}startup(e){this.stream.write(ft.startup(e))}cancel(e,r){this._send(ft.cancel(e,r))}password(e){this._send(ft.password(e))}sendSASLInitialResponseMessage(e,r){this._send(ft.sendSASLInitialResponseMessage(e,r))}sendSCRAMClientFinalMessage(e){this._send(ft.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(ft.query(e))}parse(e){this._send(ft.parse(e))}bind(e){this._send(ft.bind(e))}execute(e){this._send(ft.execute(e))}flush(){this.stream.writable&&this.stream.write(lpe)}sync(){this._ending=!0,this._send(cpe)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(fpe,()=>{this.stream.end()})}close(e){this._send(ft.close(e))}describe(e){this._send(ft.describe(e))}sendCopyFromChunk(e){this._send(ft.copyData(e))}endCopyFrom(){this._send(ft.copyDone())}sendCopyFail(e){this._send(ft.copyFail(e))}};dH.exports=Db});var mH=p((UMe,_H)=>{"use strict";var{Transform:dpe}=require("stream"),{StringDecoder:ppe}=require("string_decoder"),Ti=Symbol("last"),hm=Symbol("decoder");function hpe(t,e,r){let n;if(this.overflow){if(n=this[hm].write(t).split(this.matcher),n.length===1)return r();n.shift(),this.overflow=!1}else this[Ti]+=this[hm].write(t),n=this[Ti].split(this.matcher);this[Ti]=n.pop();for(let s=0;s<n.length;s++)try{hH(this,this.mapper(n[s]))}catch(a){return r(a)}if(this.overflow=this[Ti].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function _pe(t){if(this[Ti]+=this[hm].end(),this[Ti])try{hH(this,this.mapper(this[Ti]))}catch(e){return t(e)}t()}function hH(t,e){e!==void 0&&t.push(e)}function pH(t){return t}function mpe(t,e,r){switch(t=t||/\r?\n/,e=e||pH,r=r||{},arguments.length){case 1:typeof t=="function"?(e=t,t=/\r?\n/):typeof t=="object"&&!(t instanceof RegExp)&&!t[Symbol.split]&&(r=t,t=/\r?\n/);break;case 2:typeof t=="function"?(r=e,e=t,t=/\r?\n/):typeof e=="object"&&(r=e,e=pH)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=hpe,r.flush=_pe,r.readableObjectMode=!0;let n=new dpe(r);return n[Ti]="",n[hm]=new ppe("utf8"),n.matcher=t,n.mapper=e,n.maxLength=r.maxLength,n.skipOverflow=r.skipOverflow||!1,n.overflow=!1,n._destroy=function(s,a){this._writableState.errorEmitted=!1,a(s)},n}_H.exports=mpe});var gH=p((kMe,Mn)=>{"use strict";var SH=require("path"),Spe=require("stream").Stream,Epe=mH(),EH=require("util"),gpe=5432,_m=process.platform==="win32",Kl=process.stderr,ype=56,Tpe=7,wpe=61440,Ope=32768;function vpe(t){return(t&wpe)==Ope}var Pa=["host","port","database","user","password"],Ub=Pa.length,bpe=Pa[Ub-1];function kb(){var t=Kl instanceof Spe&&Kl.writable===!0;if(t){var e=Array.prototype.slice.call(arguments).concat(`
`);Kl.write(EH.format.apply(EH,e))}}Object.defineProperty(Mn.exports,"isWin",{get:function(){return _m},set:function(t){_m=t}});Mn.exports.warnTo=function(t){var e=Kl;return Kl=t,e};Mn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(_m?SH.join(e.APPDATA||"./","postgresql","pgpass.conf"):SH.join(e.HOME||"./",".pgpass"));return r};Mn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:_m?!0:(e=e||"<unkn>",vpe(t.mode)?t.mode&(ype|Tpe)?(kb('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(kb('WARNING: password file "%s" is not a plain file',e),!1))};var Ape=Mn.exports.match=function(t,e){return Pa.slice(0,-1).reduce(function(r,n,s){return s==1&&Number(t[n]||gpe)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};Mn.exports.getPassword=function(t,e,r){var n,s=e.pipe(Epe());function a(u){var l=Rpe(u);l&&Npe(l)&&Ape(t,l)&&(n=l[bpe],s.end())}var o=function(){e.destroy(),r(n)},i=function(u){e.destroy(),kb("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",i),s.on("data",a).on("end",o).on("error",i)};var Rpe=Mn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,s=0,a=0,o={},i=!1,u=function(c,f,h){var S=t.substring(f,h);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(S=S.replace(/\\([:\\])/g,"$1")),o[Pa[c]]=S},l=0;l<t.length-1;l+=1){if(e=t.charAt(l+1),r=t.charAt(l),i=n==Ub-1,i){u(n,s);break}l>=0&&e==":"&&r!=="\\"&&(u(n,s,l+1),s=l+2,n+=1)}return o=Object.keys(o).length===Ub?o:null,o},Npe=Mn.exports.isValidEntry=function(t){for(var e={0:function(o){return o.length>0},1:function(o){return o==="*"?!0:(o=Number(o),isFinite(o)&&o>0&&o<9007199254740992&&Math.floor(o)===o)},2:function(o){return o.length>0},3:function(o){return o.length>0},4:function(o){return o.length>0}},r=0;r<Pa.length;r+=1){var n=e[r],s=t[Pa[r]]||"",a=n(s);if(!a)return!1}return!0}});var TH=p((qMe,Bb)=>{"use strict";var BMe=require("path"),yH=require("fs"),mm=gH();Bb.exports=function(t,e){var r=mm.getFileName();yH.stat(r,function(n,s){if(n||!mm.usePgPass(s,r))return e(void 0);var a=yH.createReadStream(r);mm.getPassword(t,a,e)})};Bb.exports.warnTo=mm.warnTo});var bH=p((VMe,vH)=>{"use strict";var Ppe=require("events").EventEmitter,wH=Yl(),qb=F5(),Ipe=nb(),Mpe=sb(),OH=tH(),Lpe=Hl(),Cpe=xb(),Dpe=rb(),Sm=class extends Ppe{constructor(e){super(),this.connectionParameters=new Mpe(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var r=e||{};this._Promise=r.Promise||global.Promise,this._types=new Ipe(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=r.connection||new Cpe({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||Lpe.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){var r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let s=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(s)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let s=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(s),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(s):this._handleErrorEvent(s):this._connectionError||this._handleErrorEvent(s)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(s=>{s?n(s):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{TH()(this.connectionParameters,s=>{s!==void 0&&(this.connectionParameters.password=this.password=s),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await Dpe.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=qb.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await qb.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{qb.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){var n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return wH.escapeIdentifier(e)}escapeLiteral(e){return wH.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){var s,a,o,i,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(o=e.query_timeout||this.connectionParameters.query_timeout,a=s=e,typeof r=="function"&&(s.callback=s.callback||r)):(o=this.connectionParameters.query_timeout,s=new OH(e,r,n),s.callback||(a=new this._Promise((l,c)=>{s.callback=(f,h)=>f?c(f):l(h)}).catch(l=>{throw Error.captureStackTrace(l),l}))),o&&(u=s.callback,i=setTimeout(()=>{var l=new Error("Query read timeout");process.nextTick(()=>{s.handleError(l,this.connection)}),u(l),s.callback=()=>{};var c=this.queryQueue.indexOf(s);c>-1&&this.queryQueue.splice(c,1),this._pulseQueryQueue()},o),s.callback=(l,c)=>{clearTimeout(i),u(l,c)}),this.binary&&!s.binary&&(s.binary=!0),s._result&&!s._result._types&&(s._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{s.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(s),this._pulseQueryQueue(),a):(process.nextTick(()=>{s.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};Sm.Query=OH;vH.exports=Sm});var PH=p((FMe,NH)=>{"use strict";var xpe=require("events").EventEmitter,AH=function(){},RH=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},Vb=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},Ia=class{constructor(e){this.callback=e}};function Upe(){throw new Error("Release called on client which has already been released to the pool.")}function Em(t,e){if(e)return{callback:e,result:void 0};let r,n,s=function(o,i){o?r(o):n(i)},a=new t(function(o,i){n=o,r=i}).catch(o=>{throw Error.captureStackTrace(o),o});return{callback:s,result:a}}function kpe(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var Fb=class extends xpe{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||gm().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let s=r.idleListener;return this._acquireClient(n,e,s,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=RH(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let s=this;e.end(()=>{s.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let s=new Error("Cannot use a pool after calling end on the pool");return e?e(s):this.Promise.reject(s)}let r=Em(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new Ia(r.callback)),n;let s=(i,u,l)=>{clearTimeout(o),r.callback(i,u,l)},a=new Ia(s),o=setTimeout(()=>{RH(this._pendingQueue,i=>i.callback===s),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return o.unref&&o.unref(),this._pendingQueue.push(a),n}return this.newClient(new Ia(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=kpe(this,r);this.log("checking client timeout");let s,a=!1;this.options.connectionTimeoutMillis&&(s=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(o=>{if(s&&clearTimeout(s),r.on("error",n),o)this.log("client failed to connect",o),this._clients=this._clients.filter(i=>i!==r),a&&(o=new Error("Connection terminated due to connection timeout",{cause:o})),this._pulseQueue(),e.timedOut||e.callback(o,void 0,AH);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let i=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(l=>l.client===r)!==-1&&this._acquireClient(r,new Ia((l,c,f)=>f()),n,!1)},this.options.maxLifetimeSeconds*1e3);i.unref(),r.once("end",()=>clearTimeout(i))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,s){s&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?s&&this.options.verify?this.options.verify(e,e.release):e.release():s&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,AH);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return s=>{n&&Upe(),n=!0,this._release(e,r,s)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this._isAboveMin()&&(this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this)))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new Vb(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=Em(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let s=Em(this.Promise,n);return n=s.callback,this.connect((a,o)=>{if(a)return n(a);let i=!1,u=l=>{i||(i=!0,o.release(l),n(l))};o.once("error",u),this.log("dispatching query");try{o.query(e,r,(l,c)=>{if(this.log("query dispatched"),o.removeListener("error",u),!i)return i=!0,o.release(l),l?n(l):n(void 0,c)})}catch(l){return o.release(l),n(l)}}),s.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=Em(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};NH.exports=Fb});var LH=p(($Me,MH)=>{"use strict";var IH=require("events").EventEmitter,Bpe=require("util"),$b=Yl(),Ma=MH.exports=function(t,e,r){IH.call(this),t=$b.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};Bpe.inherits(Ma,IH);var qpe={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};Ma.prototype.handleError=function(t){var e=this.native.pq.resultErrorFields();if(e)for(var r in e){var n=qpe[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};Ma.prototype.then=function(t,e){return this._getPromise().then(t,e)};Ma.prototype.catch=function(t){return this._getPromise().catch(t)};Ma.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};Ma.prototype.submit=function(t){this.state="running";var e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;var r=function(a,o,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),a)return e.handleError(a);e._emitRowEvents&&(i.length>1?o.forEach((u,l)=>{u.forEach(c=>{e.emit("row",c,i[l])})}):o.forEach(function(u){e.emit("row",u,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var n=(this.values||[]).map($b.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let a=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(a)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(a){return a?r(a):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let a=new Error("Query values must be an array");return r(a)}var s=this.values.map($b.prepareValue);t.native.query(this.text,s,r)}else t.native.query(this.text,r)}});var kH=p((GMe,UH)=>{"use strict";var CH;try{CH=require("pg-native")}catch(t){throw t}var Vpe=nb(),DH=require("events").EventEmitter,Fpe=require("util"),$pe=sb(),xH=LH(),Yt=UH.exports=function(t){DH.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new Vpe(t.types),this.native=new CH({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new $pe(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Yt.Query=xH;Fpe.inherits(Yt,DH);Yt.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Yt.prototype._connect=function(t){var e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(s){if(s)return e.native.end(),t(s);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Yt.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};Yt.prototype.query=function(t,e,r){var n,s,a,o,i;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,s=n=t,typeof e=="function"&&(t.callback=e);else if(a=this.connectionParameters.query_timeout,n=new xH(t,e,r),!n.callback){let u,l;s=new this._Promise((c,f)=>{u=c,l=f}).catch(c=>{throw Error.captureStackTrace(c),c}),n.callback=(c,f)=>c?l(c):u(f)}return a&&(i=n.callback,o=setTimeout(()=>{var u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),i(u),n.callback=()=>{};var l=this._queryQueue.indexOf(n);l>-1&&this._queryQueue.splice(l,1),this._pulseQueryQueue()},a),n.callback=(u,l)=>{clearTimeout(o),i(u,l)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),s):(this._queryQueue.push(n),this._pulseQueryQueue(),s):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),s)};Yt.prototype.end=function(t){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));var r;return t||(r=new this._Promise(function(n,s){t=a=>a?s(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};Yt.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Yt.prototype._pulseQueryQueue=function(t){if(this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);var r=this;e.once("_done",function(){r._pulseQueryQueue()})}};Yt.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Yt.prototype.ref=function(){};Yt.prototype.unref=function(){};Yt.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};Yt.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var Gb=p((WMe,BH)=>{"use strict";BH.exports=kH()});var gm=p((HMe,Ql)=>{"use strict";var Gpe=bH(),Wpe=Hl(),jpe=xb(),Hpe=PH(),{DatabaseError:Ype}=Mb(),{escapeIdentifier:zpe,escapeLiteral:Kpe}=Yl(),Qpe=t=>class extends Hpe{constructor(r){super(r,t)}},Wb=function(t){this.defaults=Wpe,this.Client=t,this.Query=this.Client.Query,this.Pool=Qpe(this.Client),this._pools=[],this.Connection=jpe,this.types=jl(),this.DatabaseError=Ype,this.escapeIdentifier=zpe,this.escapeLiteral=Kpe};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Ql.exports=new Wb(Gb()):(Ql.exports=new Wb(Gpe),Object.defineProperty(Ql.exports,"native",{configurable:!0,enumerable:!1,get(){var t=null;try{t=new Wb(Gb())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Ql.exports,"native",{value:t}),t}}))});var Tm=p(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.getPGDatabaseOwner=je.currentDBUserIdentity=je.connectToPGAndReportOutcome=je.connectToPGDatabase=je.maskDatabaseUrl=je.getDatabaseNameFromUrl=je.getPGClientConfig=je.deriveDatabaseUrl=je.ensurePGDatabase=je.dropPGDatabase=void 0;var qH=gm();async function Jpe(t={}){if(!t.urlToDrop&&!t.dbToDrop)throw new TypeError("dropPGDatabase requires a target database name or URL to DROP");let e=[],r=c=>{e.push(c),(t.logger??console.log)(c)};function n(c,f){return r(`FAIL: ${c}${f?` | HINT: ${f}`:""}`),{message:c,status:"failed",notes:e,hint:f}}let s=t.adminUrl??(t.urlToDrop?Co(t.urlToDrop,"postgres"):void 0);if(!s)throw new TypeError("dropPostgresDatabase requires a connection string to a database with permission to perform the DROP");let a=Co(t.urlToDrop??s,"template1"),o=t.tryTemplate1Fallback??!0,i=t.dbToDrop??Yb(t.urlToDrop);if(!i)return n("Target URL has no database name in the path (e.g., /mydb).","Fix the target URL and retry.");r(`Target DB to drop: ${i}`),r(`Admin URL (planned): ${ec(s)}`);let u=await Xl(s,r);!u&&o&&(r("Admin connect failed. Trying template1 as a fallback..."),u=await Xl(a,r));let l=async()=>{if(!u)return"unknown";let{rows:c}=await u.query("SELECT EXISTS (SELECT 1 FROM pg_database WHERE datname = $1) AS exists",[i]);return c[0]?.exists??!1};try{let c="unknown";if(u&&(c=await l(),c===!1))return r(`DB "${i}" does not exist (confirmed via catalog).`),{status:"did_not_exist",notes:e,message:"Success (already dropped)"};if(!u){let g=await ym(t.urlToDrop??Co(s,i),r,"probe target (existence test)");return g.result==="ok"?(await g.client.end().catch(()=>{}),n(`Database "${i}" exists, but we could not establish an admin connection to drop it.`,"Provide an admin/alternate DB URL (same server) with privileges to DROP DATABASE")):g.code==="3D000"?(r(`DB "${i}" does not exist (error 3D000 while connecting). Database already does not exist.`),{status:"did_not_exist",notes:e,message:"Success (already dropped)"}):n(`Could not establish any admin connection, and target connect failed with ${g.code??g.result}.`,$H(g.code))}let f=await VH(u),h=await FH(u,i);!f.isSuperuser&&h&&h!==f.user&&(r(`Ownership check: DB owned by "${h}", current_user is "${f.user}" (superuser=${f.isSuperuser}).`),r("Warning: You might lack privileges to DROP this database unless you are the owner or superuser."));try{r("Attempting DROP ... WITH (FORCE)."),await Zpe(u,i)}catch(g){let E=g;if(the(E)){r("WITH (FORCE) not supported by server (syntax error). Falling back to terminate-and-drop.");try{await rhe(u,i,3e3,r)}catch(T){let O=T;return await u.end().catch(()=>{}),n(`Drop failed even after fallback: ${Zl(O)}`,jb(O?.code))}}else return await u.end().catch(()=>{}),n(`Drop failed: ${Zl(E)}`,jb(E?.code))}let S=await l();return S===!1?(r(`Verified: database "${i}" is gone.`),{status:"dropped",notes:e,message:"Success (dropped)"}):S===!0?n(`After drop attempt, database "${i}" still exists.`,"Terminate all sessions and retry."):(r("Could not verify drop due to unexpected state."),{status:"dropped",notes:e,message:"Success (dropped)"})}finally{await u?.end().catch(()=>{})}}je.dropPGDatabase=Jpe;async function Xpe(t){if(!t.urlToEnsure&&!t.dbToEnsure)throw new TypeError("ensurePGDatabase requires a target database name or URL to check");let e=[],r=c=>{e.push(c),(t.logger??console.log)(c)};function n(c,f){return r(`FAIL: ${c}${f?` | HINT: ${f}`:""}`),{status:"failed",notes:e,hint:f,message:c}}let s=t.dbToEnsure??Yb(t.urlToEnsure);if(!s)return n("Target URL has no database name in the path (e.g., /mydb).","Fix the target URL and retry.");if(t.urlToEnsure)try{let c=await ym(t.urlToEnsure,r,"probe target (existence test)");if(c.result==="ok")return await c.client.end().catch(()=>{}),{status:"already_exists",notes:e,message:"Success (already existed)"}}catch{r("Caught error probing database: (e as Error).message; attempting create.")}let a=t.adminUrl??(t.urlToEnsure?Co(t.urlToEnsure,"postgres"):void 0);if(!a)throw new TypeError("dropPostgresDatabase requires a connection string to a database with permission to perform the DROP");let o=Co(t.urlToEnsure??a,"template1"),i=t.tryTemplate1Fallback??!0,u=await Xl(a,r);!u&&i&&(r("Admin connect failed. Trying template1 as a fallback..."),u=await Xl(o,r));let l=async()=>{if(!u)return"unknown";let{rows:c}=await u.query("SELECT EXISTS (SELECT 1 FROM pg_database WHERE datname = $1) AS exists",[s]);return c[0]?.exists??!1};try{let c="unknown";if(u&&(c=await l(),c===!0))return r(`DB "${s}" exists (confirmed via catalog).`),{status:"already_exists",notes:e,message:"Success (already existed)"};if(!u){let h=t.urlToEnsure??Co(a,s),S=await ym(h,r,"probe target (existence test)");return S.result==="ok"?(await S.client.end().catch(()=>{}),r(`Probe of database ${s} via ${ec(h)} succeeds.`),{status:"already_exists",notes:e,message:"Success (already existed)"}):n(`Could not establish any admin connection, and target connect failed with ${S.code??S.result}.`,$H(S.code))}try{r("Attempting CREATE."),await ehe(u,s)}catch(h){let S=h;return await u.end().catch(()=>{}),n(`Create failed: ${Zl(S)}`,jb(S?.code))}let f=await l();return f===!0?(r(`Verified: database "${s}" exists.`),{status:"created",notes:e,message:"Success (created)"}):f===!1?n(`After create attempt, database "${s}" does not exist still.`):(r("Could not verify creation due to unexpected state."),{status:"created",notes:e,message:"Success (unverified)"})}finally{await u?.end().catch(()=>{})}}je.ensurePGDatabase=Xpe;function Co(t,e){try{let r=new URL(t);return r.pathname=`/${e}`,r.toString()}catch{return t}}je.deriveDatabaseUrl=Co;function Hb(t){let e=typeof t=="string"?t:t.toString(),r=n(typeof t=="string"?new URL(t):t);return{connectionString:e,connectionTimeoutMillis:r?r*1e3:1e4};function n(s){try{let a=s.searchParams.get("connect_timeout");return a?parseInt(a,10):void 0}catch{return}}}je.getPGClientConfig=Hb;function Yb(t){return new URL(t).pathname?.replace(/^\//,"")||""}je.getDatabaseNameFromUrl=Yb;function ec(t){try{let e=new URL(t);if(e.password){let r=decodeURIComponent(e.password),n=r.length<=2?r:`${r[0]}${"*".repeat(r.length-2)}${r[r.length-1]}`;e.password=encodeURIComponent(n)}return e.toString()}catch{return t}}je.maskDatabaseUrl=ec;async function Xl(t,e){e(`Connecting: ${ec(t)}`);let r=new qH.Client(Hb(t));r.on("error",n=>{e(`Unexpected error in startup client: ${n}`)});try{return await r.connect(),r}catch(n){let s=n;e(`Connect failed: ${Zl(s)}${s?.code?` (code ${s.code})`:""}`);try{await r.end()}catch{}return null}}je.connectToPGDatabase=Xl;async function ym(t,e,r){e(`Connecting to ${r}: ${ec(t)}`);let n=new qH.Client(Hb(t));n.on("error",s=>{e(`Unexpected error in startup client: ${s}`)});try{return await n.connect(),{result:"ok",client:n}}catch(s){let a=s;try{await n.end()}catch{}return{result:"error",code:a?.code,message:a?.message??String(a)}}}je.connectToPGAndReportOutcome=ym;function Zl(t){let e=t?.message??String(t);return e.length>500?`${e.slice(0,500)}\u2026`:e}async function VH(t){let{rows:e}=await t.query("SELECT current_user AS user"),r=e[0]?.user??"",{rows:n}=await t.query("SELECT rolsuper FROM pg_roles WHERE rolname = current_user");return{user:r,isSuperuser:!!n[0]?.rolsuper}}je.currentDBUserIdentity=VH;async function FH(t,e){let{rows:r}=await t.query(`SELECT r.rolname AS owner
     FROM pg_database d JOIN pg_roles r ON r.oid = d.datdba
     WHERE d.datname = $1`,[e]);return r[0]?.owner??null}je.getPGDatabaseOwner=FH;function Jl(t){return`"${t.replace(/"/g,'""')}"`}async function Zpe(t,e){await t.query(`DROP DATABASE IF EXISTS ${Jl(e)} WITH (FORCE)`)}async function ehe(t,e){await t.query(`CREATE DATABASE ${Jl(e)}`)}function the(t){return t?.code==="42601"||/WITH\s*\(\s*FORCE\s*\)/i.test(t?.message??"")}async function rhe(t,e,r,n){try{await t.query(`ALTER DATABASE ${Jl(e)} WITH ALLOW_CONNECTIONS = false`)}catch(s){n(`ALTER DATABASE ... ALLOW_CONNECTIONS=false failed (continuing): ${Zl(s)}`)}await t.query("SELECT pg_terminate_backend(pid) FROM pg_stat_activity WHERE datname = $1 AND pid <> pg_backend_pid()",[e]),r>0&&(n(`Waiting ${r}ms for backends to terminate...`),await new Promise(s=>setTimeout(s,r)));try{await t.query(`DROP DATABASE IF EXISTS ${Jl(e)}`)}catch(s){let a=s;if(a?.code==="55006")n('DB still "being accessed by other users"; retrying after extra wait...'),await new Promise(o=>setTimeout(o,Math.max(1e3,r))),await t.query("SELECT pg_terminate_backend(pid) FROM pg_stat_activity WHERE datname = $1 AND pid <> pg_backend_pid()",[e]),await t.query(`DROP DATABASE IF EXISTS ${Jl(e)}`);else throw a}}function $H(t){if(t)switch(t){case"ECONNREFUSED":return"Server not reachable. Check host/port or firewall.";case"ENOTFOUND":return"Hostname not resolvable. Check DNS/host.";case"ETIMEDOUT":return"Connection timed out. Check network/firewall.";case"28P01":return"Invalid password.";case"28000":return"Authentication rejected (pg_hba.conf or method).";default:return t.substring(0,2)==="28"?"Other connection security error":void 0}}function jb(t){switch(t?.substring(0,5)){case"42501":return"Insufficient privilege. You must be the owner or a superuser.";case"53300":return"Too many connections to server; free some slots.";default:break}switch(t?.substring(0,2)){case"42":return"Syntax error or access rule violation.";case"3D":return"Target database does not exist (already gone).";case"55":return"Database is in use. Terminate sessions or use PG13+ WITH (FORCE).";case"53":return"Insufficient resources.";default:return}}});var WH=p(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.runSysMigrationsPg=La.getCurrentSysDBVersion=void 0;async function GH(t,e="dbos"){if(!(await t.query("SELECT table_name FROM information_schema.tables WHERE table_schema = $1 AND table_name = 'dbos_migrations'",[e])).rows[0]?.table_name)return 0;let n=await t.query(`select version from "${e}"."dbos_migrations" order by version desc limit 1`);if(n.rowCount===0)return 0;let s=n.rows[0].version,a=Number(s);return Number.isFinite(a)?a:0}La.getCurrentSysDBVersion=GH;var nhe=new Set(["42P07","42710","42701","42P06","23505"]);function ihe(t){return typeof t=="object"&&t!==null&&("code"in t||"message"in t)}function ohe(t,e){if(!ihe(t))return!1;if(t.code&&e.has(t.code))return!0;let r=t.message??"";return/already exists/i.test(r)||/duplicate/i.test(r)||/multiple.*?not allowed/i.test(r)}async function she(t,e,r,n){for(let s of e)try{await t.query(s,[])}catch(a){if(ohe(a,r)){n(`Ignoring migration error; migration was likely already applied.  Occurred while executing: ${s}`,a);continue}throw a}}async function ahe(t,e,r="dbos",n={}){let{ignoreErrorCodes:s=nhe,onWarn:a=S=>console.info(S)}=n,o=await GH(t,r),i=e.length;if(o>i)return{fromVersion:o,toVersion:o,appliedCount:0,skippedCount:e.length,notice:`Database version (${o}) is ahead of this build's max (${i}). A newer software version may be running concurrently.`};let u=0,l=0,c=o,f=!1;for(let S=0;S<e.length;S++){let g=e[S],E=S+1;if(E<=o){l++;continue}f||(a("Running DBOS system database migrations..."),f=!0);let T=g.pg??[];if(T.length===0){a(`Migration "${g.name}" has no Postgres statements; skipping.`),l++;continue}await she(t,T,s,(O,v)=>a(`${O}${v?`
  \u2192 ${String(v.message??"")}`:""}`)),u++,c=E}return(await t.query(`UPDATE "${r}"."dbos_migrations" SET "version" = $1`,[c])).rowCount===0&&await t.query(`INSERT into "${r}"."dbos_migrations" ("version") values ($1)`,[c]),{fromVersion:o,toVersion:c,appliedCount:u,skippedCount:l,notice:o<i&&u===0&&l>0?"Nothing to apply; DB is already up-to-date relative to known migrations.":void 0}}La.runSysMigrationsPg=ahe});var jH=p(wm=>{"use strict";Object.defineProperty(wm,"__esModule",{value:!0});wm.allMigrations=void 0;function uhe(t="dbos"){return[{name:"20240123182943_schema",pg:[`CREATE SCHEMA IF NOT EXISTS "${t}"`]},{name:"20240123182944_dbos_migrations",pg:[`create table "${t}"."dbos_migrations" ("version" bigint not null, constraint "dbos_migrations_pkey" primary key ("version"))`]},{name:"20240123183021_tables",pg:[`create table "${t}"."operation_outputs" ("workflow_uuid" text not null, "function_id" integer not null, "output" text, "error" text, constraint "operation_outputs_pkey" primary key ("workflow_uuid", "function_id"))`,`create table "${t}"."workflow_inputs" ("workflow_uuid" text not null, "inputs" text not null, constraint "workflow_inputs_pkey" primary key ("workflow_uuid"))`,`create table "${t}"."workflow_status" ("workflow_uuid" text, "status" text, "name" text, "authenticated_user" text, "assumed_role" text, "authenticated_roles" text, "request" text, "output" text, "error" text, "executor_id" text, constraint "workflow_status_pkey" primary key ("workflow_uuid"))`,`create table "${t}"."notifications" ("destination_uuid" text not null, "topic" text, "message" text not null, "created_at_epoch_ms" bigint not null default (EXTRACT(EPOCH FROM now())*1000)::bigint)`,`create table "${t}"."workflow_events" ("workflow_uuid" text not null, "key" text not null, "value" text not null, constraint "workflow_events_pkey" primary key ("workflow_uuid", "key"))`]},{name:"20240123183025_indexes",pg:[`create index "idx_workflow_topic" on "${t}"."notifications" ("destination_uuid", "topic")`]},{name:"20240123183030_triggers",pg:[`
    CREATE OR REPLACE FUNCTION "${t}".notifications_function() RETURNS TRIGGER AS $$
    DECLARE
        payload text := NEW.destination_uuid || '::' || NEW.topic;
    BEGIN
        PERFORM pg_notify('dbos_notifications_channel', payload);
        RETURN NEW;
    END;
    $$ LANGUAGE plpgsql;

    CREATE TRIGGER dbos_notifications_trigger
    AFTER INSERT ON "${t}".notifications
    FOR EACH ROW EXECUTE FUNCTION "${t}".notifications_function();

    CREATE OR REPLACE FUNCTION "${t}".workflow_events_function() RETURNS TRIGGER AS $$
    DECLARE
        payload text := NEW.workflow_uuid || '::' || NEW.key;
    BEGIN
        PERFORM pg_notify('dbos_workflow_events_channel', payload);
        RETURN NEW;
    END;
    $$ LANGUAGE plpgsql;

    CREATE TRIGGER dbos_workflow_events_trigger
    AFTER INSERT ON "${t}".workflow_events
    FOR EACH ROW EXECUTE FUNCTION "${t}".workflow_events_function();
  `]},{name:"20240124015239_status_timestamp",pg:[`alter table "${t}"."workflow_status" add column "created_at" bigint not null default (EXTRACT(EPOCH FROM now())*1000)::bigint, add column "updated_at" bigint not null default (EXTRACT(EPOCH FROM now())*1000)::bigint`]},{name:"20240201213211_replica_identity",pg:['create extension if not exists "uuid-ossp"',`alter table "${t}"."notifications" add column "message_uuid" text default uuid_generate_v4()`,`alter table "${t}"."notifications" add constraint "notifications_pkey" primary key ("message_uuid")`]},{name:"20240205223925_foreign_keys",pg:[`create index "workflow_status_created_at_index" on "${t}"."workflow_status" ("created_at")`,`alter table "${t}"."operation_outputs" add constraint "operation_outputs_workflow_uuid_foreign" foreign key ("workflow_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`,`alter table "${t}"."workflow_inputs" add constraint "workflow_inputs_workflow_uuid_foreign" foreign key ("workflow_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`,`alter table "${t}"."notifications" add constraint "notifications_destination_uuid_foreign" foreign key ("destination_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`,`alter table "${t}"."workflow_events" add constraint "workflow_events_workflow_uuid_foreign" foreign key ("workflow_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`]},{name:"20240207192338_executor_id_index",pg:[`create index "workflow_status_executor_id_index" on "${t}"."workflow_status" ("executor_id")`]},{name:"20240430090000_tables",pg:[`create table "${t}"."scheduler_state" ("workflow_fn_name" text not null, "last_run_time" bigint not null, constraint "scheduler_state_pkey" primary key ("workflow_fn_name"))`]},{name:"20240516004341_application_version",pg:[`alter table "${t}"."workflow_status" add column "application_version" text, add column "application_id" text`]},{name:"20240517000000_status_class_config",pg:[`alter table "${t}"."workflow_status" add column "class_name" varchar(255) default null, add column "config_name" varchar(255) default null`]},{name:"20240621000000_workflow_tries",pg:[`alter table "${t}"."workflow_status" add column "recovery_attempts" bigint default '0'`]},{name:"20240924000000_workflowqueue",pg:[`alter table "${t}"."workflow_status" add column "queue_name" text default null`,`create table "${t}"."workflow_queue" ("queue_name" text not null, "workflow_uuid" text not null, "created_at_epoch_ms" bigint not null default (EXTRACT(EPOCH FROM now())*1000)::bigint, "started_at_epoch_ms" bigint, "completed_at_epoch_ms" bigint, constraint "workflow_queue_pkey" primary key ("workflow_uuid"))`,`alter table "${t}"."workflow_queue" add constraint "workflow_queue_workflow_uuid_foreign" foreign key ("workflow_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`]},{name:"20241009150000_event_dispatch_kv",pg:[`create table "${t}"."event_dispatch_kv" ("service_name" text not null, "workflow_fn_name" text not null, "key" text not null, "value" text, "update_seq" decimal(38, 0), "update_time" decimal(38, 15), constraint "event_dispatch_kv_pkey" primary key ("service_name", "workflow_fn_name", "key"))`]},{name:"20250312171547_function_name_op_outputs",pg:[`alter table "${t}"."operation_outputs" add column "function_name" text not null default ''`]},{name:"20250319190617_add_childid_opoutputs",pg:[`alter table "${t}"."operation_outputs" add column "child_workflow_id" text`]},{name:"20252101000000_workflow_queues_executor_id",pg:[`alter table "${t}"."workflow_queue" add column "executor_id" text`]},{name:"20252501190959_queue_dedup_id",pg:[`alter table "${t}"."workflow_queue" add column "deduplication_id" text`,`alter table "${t}"."workflow_queue" add constraint "workflow_queue_queue_name_deduplication_id_unique" unique ("queue_name", "deduplication_id")`]},{name:"20252505000000_workflow_timeout",pg:[`alter table "${t}"."workflow_status" add column "workflow_timeout_ms" bigint, add column "workflow_deadline_epoch_ms" bigint`]},{name:"20252512000000_queue_priority",pg:[`alter table "${t}"."workflow_queue" add column "priority" integer not null default '0'`]},{name:"20252523000000_consolidate_inputs",pg:[`alter table "${t}"."workflow_status" add column "inputs" text null`]},{name:"20252528000000_consolidate_queues",pg:[`alter table "${t}"."workflow_status" add column "started_at_epoch_ms" bigint null, add column "deduplication_id" text null, add column "priority" integer not null default '0'`,`alter table "${t}"."workflow_status" add constraint "uq_workflow_status_queue_name_dedup_id" unique ("queue_name", "deduplication_id")`,`create index "workflow_status_status_index" on "${t}"."workflow_status" ("status")`]},{name:"20252806000000_streaming",pg:[`create table "${t}"."streams" ("workflow_uuid" text not null, "key" text not null, "value" text not null, "offset" integer not null, constraint "streams_pkey" primary key ("workflow_uuid", "key", "offset"))`,`alter table "${t}"."streams" add constraint "streams_workflow_uuid_foreign" foreign key ("workflow_uuid") references "${t}"."workflow_status" ("workflow_uuid") on update CASCADE on delete CASCADE`]},{name:"20252810000000_partitioned_queues",pg:[`alter table "${t}"."workflow_status" add column "queue_partition_key" text`]},{name:"20252950000000_workflow_status_queue_status_started_index",pg:[`create index "idx_workflow_status_queue_status_started" on "${t}"."workflow_status" ("queue_name", "status", "started_at_epoch_ms")`]},{pg:[`ALTER TABLE "${t}".workflow_status ADD COLUMN forked_from TEXT;`,`create index "idx_workflow_status_forked_from" on "${t}"."workflow_status" ("forked_from")`]},{pg:[`ALTER TABLE "${t}".operation_outputs ADD COLUMN started_at_epoch_ms BIGINT, ADD COLUMN completed_at_epoch_ms BIGINT;`]},{pg:[`ALTER TABLE "${t}"."workflow_status" ADD COLUMN "owner_xid" VARCHAR(40) DEFAULT NULL`]},{pg:[`
        CREATE TABLE "${t}".workflow_events_history (
            workflow_uuid TEXT NOT NULL,
            function_id INTEGER NOT NULL,
            key TEXT NOT NULL,
            value TEXT NOT NULL,
            PRIMARY KEY (workflow_uuid, function_id, key),
            FOREIGN KEY (workflow_uuid) REFERENCES "${t}".workflow_status(workflow_uuid)
                ON UPDATE CASCADE ON DELETE CASCADE
        );
        `,`ALTER TABLE "${t}".streams ADD COLUMN function_id INTEGER NOT NULL DEFAULT 0;`]},{pg:[`ALTER TABLE "${t}"."workflow_status" ADD COLUMN "parent_workflow_id" TEXT DEFAULT NULL;`,`CREATE INDEX "idx_workflow_status_parent_workflow_id" ON "${t}"."workflow_status" ("parent_workflow_id");`]},{pg:[`ALTER TABLE "${t}"."workflow_status" ADD COLUMN "serialization" TEXT DEFAULT NULL`,`ALTER TABLE "${t}"."notifications" ADD COLUMN "serialization" TEXT DEFAULT NULL`,`ALTER TABLE "${t}"."workflow_events" ADD COLUMN "serialization" TEXT DEFAULT NULL`,`ALTER TABLE "${t}"."workflow_events_history" ADD COLUMN "serialization" TEXT DEFAULT NULL`,`ALTER TABLE "${t}"."operation_outputs" ADD COLUMN "serialization" TEXT DEFAULT NULL`,`ALTER TABLE "${t}"."streams" ADD COLUMN "serialization" TEXT DEFAULT NULL`]}]}wm.allMigrations=uhe});var Om=p(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.DEBUG_TRIGGER_INITWF_COMMIT=Te.DEBUG_TRIGGER_STEP_COMMIT=Te.DEBUG_TRIGGER_WORKFLOW_ENQUEUE=Te.DEBUG_TRIGGER_WORKFLOW_QUEUE_START=Te.clearDebugTriggers=Te.setDebugTrigger=Te.debugTriggerPoint=Te.pointLocations=Te.pointTriggers=Te.DebugAction=Te.getCallSiteInfo=void 0;var lhe=gt();function HH(){let e=new Error().stack?.split(`
`);if(e&&e.length>2){let r=e[2].match(/at\s+(.*):(\d+):(\d+)/);if(r){let n=r[1],s=parseInt(r[2],10);return{fileName:n,lineNumber:s}}}return{fileName:"unknown",lineNumber:-1}}Te.getCallSiteInfo=HH;var zb=class{sleepms;awaitEvent;callback;asyncCallback};Te.DebugAction=zb;Te.pointTriggers=new Map;Te.pointLocations=new Map;async function che(t){let e=HH();if(Te.pointLocations.has(t)||Te.pointLocations.set(t,{name:t,...e,hitCount:0}),Te.pointTriggers.has(t)){let r=Te.pointTriggers.get(t);r.sleepms&&await(0,lhe.sleepms)(r.sleepms),r.asyncCallback&&await r.asyncCallback(),r.callback&&r.callback(),r.awaitEvent&&await r.awaitEvent}}Te.debugTriggerPoint=che;function fhe(t,e){Te.pointTriggers.set(t,e)}Te.setDebugTrigger=fhe;function dhe(){Te.pointTriggers.clear()}Te.clearDebugTriggers=dhe;Te.DEBUG_TRIGGER_WORKFLOW_QUEUE_START="DEBUG_TRIGGER_WORKFLOW_QUEUE_START";Te.DEBUG_TRIGGER_WORKFLOW_ENQUEUE="DEBUG_TRIGGER_WORKFLOW_ENQUEUE";Te.DEBUG_TRIGGER_STEP_COMMIT="DEBUG_TRIGGER_STEP_COMMIT";Te.DEBUG_TRIGGER_INITWF_COMMIT="DEBUG_TRIGGER_INITWF_COMMIT"});var Am=p(J=>{"use strict";var Ye=J&&J.__decorate||function(t,e,r,n){var s=arguments.length,a=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(a=(s<3?o(a):s>3?o(e,r,a):o(e,r))||a);return s>3&&a&&Object.defineProperty(e,r,a),a},q=J&&J.__metadata||function(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)};Object.defineProperty(J,"__esModule",{value:!0});J.PostgresSystemDatabase=J.ensureSystemDatabase=J.grantDbosSchemaPermissions=J.DBOS_STREAM_CLOSED_SENTINEL=J.DEFAULT_POOL_SIZE=J.DBOS_FUNCNAME_CLOSESTREAM=J.DBOS_FUNCNAME_WRITESTREAM=J.DBOS_FUNCNAME_GETSTATUS=J.DBOS_FUNCNAME_SLEEP=J.DBOS_FUNCNAME_GETEVENT=J.DBOS_FUNCNAME_SETEVENT=J.DBOS_FUNCNAME_RECV=J.DBOS_FUNCNAME_SEND=void 0;var Jb=Gi(),KH=gm(),He=dr(),Se=Xo(),dn=gt(),phe=require("crypto"),QH=gt(),tc=Tm(),hhe=WH(),_he=jH(),vm=Om(),YH=wn();J.DBOS_FUNCNAME_SEND="DBOS.send";J.DBOS_FUNCNAME_RECV="DBOS.recv";J.DBOS_FUNCNAME_SETEVENT="DBOS.setEvent";J.DBOS_FUNCNAME_GETEVENT="DBOS.getEvent";J.DBOS_FUNCNAME_SLEEP="DBOS.sleep";J.DBOS_FUNCNAME_GETSTATUS="getStatus";J.DBOS_FUNCNAME_WRITESTREAM="DBOS.writeStream";J.DBOS_FUNCNAME_CLOSESTREAM="DBOS.closeStream";J.DEFAULT_POOL_SIZE=10;J.DBOS_STREAM_CLOSED_SENTINEL="__DBOS_STREAM_CLOSED__";async function mhe(t,e,r,n="dbos"){r.info(`Granting permissions for ${n} schema to ${e}`);let s=new KH.Client((0,QH.getClientConfig)(t));await s.connect();try{let a=`GRANT USAGE ON SCHEMA "${n}" TO "${e}"`;r.info(a),await s.query(a);let o=`GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA "${n}" TO "${e}"`;r.info(o),await s.query(o);let i=`GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA "${n}" TO "${e}"`;r.info(i),await s.query(i);let u=`GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA "${n}" TO "${e}"`;r.info(u),await s.query(u);let l=`ALTER DEFAULT PRIVILEGES IN SCHEMA "${n}" GRANT ALL ON TABLES TO "${e}"`;r.info(l),await s.query(l);let c=`ALTER DEFAULT PRIVILEGES IN SCHEMA "${n}" GRANT ALL ON SEQUENCES TO "${e}"`;r.info(c),await s.query(c);let f=`ALTER DEFAULT PRIVILEGES IN SCHEMA "${n}" GRANT EXECUTE ON FUNCTIONS TO "${e}"`;r.info(f),await s.query(f)}catch(a){throw r.error(`Failed to grant permissions to role ${e}: ${a.message}`),a}finally{await s.end()}}J.grantDbosSchemaPermissions=mhe;async function JH(t,e,r,n="dbos"){let s=null;if(r)s=await r.connect();else{let a=await(0,tc.ensurePGDatabase)({urlToEnsure:t,logger:i=>e.debug(i)});a.status==="failed"&&e.warn(`Database could not be verified / created: ${(0,tc.maskDatabaseUrl)(t)}: ${a.message} ${a.hint??""}
  ${a.notes.join(`
`)}`);let o=await(0,tc.connectToPGAndReportOutcome)(t,()=>{},"System Database");if(o.result!=="ok")throw e.warn(`Unable to connect to system database at ${(0,tc.maskDatabaseUrl)(t)}
        ${o.message}: (${o.code?o.code:"connectivity problem"})`),new He.DBOSInitializationError(`Unable to connect to system database at ${(0,tc.maskDatabaseUrl)(t)}`);s=o.client}try{await(0,hhe.runSysMigrationsPg)(s,(0,_he.allMigrations)(n),n,{onWarn:a=>e.info(a)})}finally{try{r?s.release():await s.end()}catch{}}}J.ensureSystemDatabase=JH;var rc=class{map=new Map;curCK=0;registerCallback(e,r){this.map.has(e)||this.map.set(e,new Map);let n=this.curCK++;return this.map.get(e).set(n,r),{key:e,ck:n}}deregisterCallback(e){if(!this.map.has(e.key))return;let r=this.map.get(e.key);r.has(e.ck)&&(r.delete(e.ck),r.size===0&&this.map.delete(e.key))}callCallbacks(e,r){if(!this.map.has(e))return;let n=this.map.get(e);for(let s of n.values())s(r)}};async function zH(t,e,r,n,s=!1){try{let{rows:a}=await t.query(`INSERT INTO "${r}".workflow_status (
        workflow_uuid,
        status,
        name,
        class_name,
        config_name,
        queue_name,
        authenticated_user,
        assumed_role,
        authenticated_roles,
        request,
        executor_id,
        application_version,
        application_id,
        created_at,
        recovery_attempts,
        updated_at,
        workflow_timeout_ms,
        workflow_deadline_epoch_ms,
        inputs,
        deduplication_id,
        priority,
        queue_partition_key,
        forked_from,
        parent_workflow_id,
        serialization,
        owner_xid
      ) VALUES($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $26, $27)
      ON CONFLICT (workflow_uuid)
        DO UPDATE SET
          recovery_attempts = CASE
            WHEN workflow_status.status != '${Se.StatusString.ENQUEUED}'
            THEN workflow_status.recovery_attempts + $25
            ELSE workflow_status.recovery_attempts
          END,
          updated_at = EXCLUDED.updated_at,
          executor_id = CASE
            WHEN EXCLUDED.status != '${Se.StatusString.ENQUEUED}'
            THEN EXCLUDED.executor_id
            ELSE workflow_status.executor_id
          END
        RETURNING recovery_attempts, status, name, class_name, config_name, queue_name, workflow_deadline_epoch_ms, executor_id, owner_xid, serialization`,[e.workflowUUID,e.status,e.workflowName,e.workflowClassName===""?null:e.workflowClassName,e.workflowConfigName===""?null:e.workflowConfigName,e.queueName??null,e.authenticatedUser,e.assumedRole,JSON.stringify(e.authenticatedRoles),JSON.stringify(e.request),e.executorId,e.applicationVersion??null,e.applicationID,e.createdAt,e.status===Se.StatusString.ENQUEUED?0:1,e.updatedAt??Date.now(),e.timeoutMS??null,e.deadlineEpochMS??null,e.input??null,e.deduplicationID??null,e.priority,e.queuePartitionKey??null,e.forkedFrom??null,e.parentWorkflowID??null,s??!1?1:0,e.serialization,n]);if(a.length===0)throw new Error(`Attempt to insert workflow ${e.workflowUUID} failed`);let o=a[0];return o.class_name=o.class_name??"",o.config_name=o.config_name??"",o}catch(a){throw a.code==="23505"?new He.DBOSQueueDuplicatedError(e.workflowUUID,e.queueName??"",e.deduplicationID??""):a}}async function Kb(t,e,r){let{rows:n}=await t.query(`SELECT status FROM "${r}".workflow_status WHERE workflow_uuid=$1`,[e]);return n.length===0?void 0:n[0].status}async function Ca(t,e,r,n,s={}){let a="SET status=$2, updated_at=$3",o="WHERE workflow_uuid=$1",i=[e,r,Date.now()],u=s.update??{};if(u.output){let h=i.push(u.output);a+=`, output=$${h}`}if(u.error){let h=i.push(u.error);a+=`, error=$${h}`}if(u.resetRecoveryAttempts&&(a+=", recovery_attempts = 0"),u.resetDeadline&&(a+=", workflow_deadline_epoch_ms = NULL"),u.queueName!==void 0){let h=i.push(u.queueName??void 0);a+=`, queue_name=$${h}`}if(u.resetDeduplicationID&&(a+=", deduplication_id = NULL"),u.resetStartedAtEpochMs&&(a+=", started_at_epoch_ms = NULL"),u.executorId!==void 0){let h=i.push(u.executorId??void 0);a+=`, executor_id=$${h}`}if(u.resetNameTo!==void 0){let h=i.push(u.resetNameTo??void 0);a+=`, name=$${h}`}let l=s.where??{};if(l.status){let h=i.push(l.status);o+=` AND status=$${h}`}let c=await t.query(`UPDATE "${n}".workflow_status ${a} ${o}`,i);if((s.throwOnFailure??!0)&&c.rowCount!==1)throw new He.DBOSWorkflowConflictError(`Attempt to record transition of nonexistent workflow ${e}`)}async function bm(t,e,r,n,s,a,o,i,u={}){try{let l=await t.query(`INSERT INTO ${a}.operation_outputs
       (workflow_uuid, function_id, output, error, function_name, child_workflow_id, started_at_epoch_ms, completed_at_epoch_ms, serialization)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
       ON CONFLICT DO NOTHING RETURNING completed_at_epoch_ms;`,[e,r,u.output??null,u.error??null,n,u.childWorkflowID??null,o,i,u.serialization??null]);if(s&&(l?.rowCount??0)>0&&Number(l?.rows?.[0]?.completed_at_epoch_ms)!==i)throw Jb.DBOSExecutor.globalInstance?.logger.warn(`Step output for ${e}(${r}):${n} already recorded`),new He.DBOSWorkflowConflictError(e)}catch(l){let c=l;throw c.code==="40001"||c.code==="23505"?new He.DBOSWorkflowConflictError(e):c}}function She(t){return{workflowUUID:t.workflow_uuid,status:t.status,workflowName:t.name,output:t.output?t.output:null,error:t.error?t.error:null,workflowClassName:t.class_name??"",workflowConfigName:t.config_name??"",queueName:t.queue_name??void 0,authenticatedUser:t.authenticated_user,assumedRole:t.assumed_role,authenticatedRoles:JSON.parse(t.authenticated_roles),request:t.request?JSON.parse(t.request):{},executorId:t.executor_id,createdAt:Number(t.created_at),updatedAt:Number(t.updated_at),applicationVersion:t.application_version,applicationID:t.application_id,recoveryAttempts:Number(t.recovery_attempts),input:t.inputs?t.inputs:null,timeoutMS:t.workflow_timeout_ms?Number(t.workflow_timeout_ms):void 0,deadlineEpochMS:t.workflow_deadline_epoch_ms?Number(t.workflow_deadline_epoch_ms):void 0,deduplicationID:t.deduplication_id??void 0,priority:t.priority??0,queuePartitionKey:t.queue_partition_key??void 0,startedAtEpochMs:t.started_at_epoch_ms?Number(t.started_at_epoch_ms):void 0,forkedFrom:t.forked_from??void 0,parentWorkflowID:t.parent_workflow_id??void 0,serialization:t.serialization}}var Ehe=new Set(["08","53","57"]),ghe=new Set(["40003"]),yhe=new Set(["ECONNRESET","ECONNREFUSED","EHOSTUNREACH","ENETUNREACH","ETIMEDOUT","ECONNABORTED"]);function The(t){return!!t&&typeof t=="object"&&typeof t.code=="string"&&t.code.length===5}function whe(t){if(!t)return!1;if(ghe.has(t))return!0;let e=t.toString().slice(0,2);return Ehe.has(e)}function Ohe(t){let e=t.code;return!!e&&yhe.has(e)}function Qb(t){let e=t.toLowerCase();return t.includes("ECONNREFUSED")||t.includes("ECONNRESET")||e.includes("connection timeout")||e.includes("server closed the connection")||e.includes("connection terminated unexpectedly")||e.includes("client has encountered a connection error")||e.includes("timeout exceeded when trying to connect")||e.includes("could not connect to server")}function*vhe(t){let e=[t],r=new Set;for(;e.length;){let n=e.shift();if(n&&typeof n=="object"){if(r.has(n))continue;r.add(n);let s=n;Array.isArray(s.errors)&&e.push(...s.errors);let a=n;a.cause&&e.push(a.cause);let o=n;o.error&&e.push(o.error)}yield n}}function bhe(t){for(let e of vhe(t)){let r=e;if(The(r)&&whe(r.code)||Ohe(r))return!0;if(e instanceof Error){if(e.stack&&Qb(e.stack)||e.message&&Qb(e.message))return!0}else if(Qb(String(e)))return!0}return!1}function ze(t={}){let{initialBackoff:e=1,maxBackoff:r=60}=t;return function(n,s,a){let o=a.value;return a.value=async function(...i){let u=0,l=e;for(;;)try{return await o.apply(this,i)}catch(c){if(bhe(c)){u++;let f=l*(.5+Math.random());Jb.DBOSExecutor.globalInstance?.logger.warn(`Database connection failed: ${c instanceof Error?c.message:String(c)}. Retrying in ${f.toFixed(2)}s (attempt ${u})`),await(0,dn.sleepms)(f*1e3),l=Math.min(l*2,r)}else throw c}},a}}var Me=class{systemDatabaseUrl;logger;serializer;pool;schemaName;notificationsClient=null;dbPollingIntervalResultMs=1e3;dbPollingIntervalEventMs=1e4;shouldUseDBNotifications=!0;notificationsMap=new rc;workflowEventsMap=new rc;cancelWakeupMap=new rc;customPool=!1;runningWorkflowMap=new Map;workflowCancellationMap=new Map;constructor(e,r,n,s=J.DEFAULT_POOL_SIZE,a,o="dbos"){if(this.systemDatabaseUrl=e,this.logger=r,this.serializer=n,this.schemaName=o,a)this.pool=a,this.customPool=!0;else{let i={...(0,QH.getClientConfig)(e),application_name:`dbos_transact_${dn.globalParams.executorID}_${dn.globalParams.appVersion}`,max:s};this.pool=new KH.Pool(i)}this.pool.on("error",i=>{this.logger.warn(`Unexpected error in pool: ${i}`)}),this.pool.on("connect",i=>{i.on("error",u=>{this.logger.warn(`Unexpected error in idle client: ${u}`)})})}getSerializer(){return this.serializer}async init(){await JH(this.systemDatabaseUrl,this.logger,this.customPool?this.pool:void 0,this.schemaName),this.shouldUseDBNotifications&&await this.#s()}async destroy(){if(this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.notificationsClient)try{this.notificationsClient.release(!0)}catch(e){this.logger.warn(`Error ending notifications client: ${String(e)}`)}await this.pool.end()}async initWorkflowStatus(e,r,n){let s=await this.pool.connect(),a=!1;try{await s.query("BEGIN ISOLATION LEVEL READ COMMITTED");let o=await zH(s,e,this.schemaName,r,!!n?.isRecoveryRequest||!!n?.isDequeuedRequest);if(o.name!==e.workflowName){let c=`Workflow already exists with a different function name: ${o.name}, but the provided function name is: ${e.workflowName}`;throw new He.DBOSConflictingWorkflowError(e.workflowUUID,c)}else if(o.class_name!==e.workflowClassName){let c=`Workflow already exists with a different class name: ${o.class_name}, but the provided class name is: ${e.workflowClassName}`;throw new He.DBOSConflictingWorkflowError(e.workflowUUID,c)}else if((o.config_name||"")!==(e.workflowConfigName||"")){let c=`Workflow already exists with a different class configuration: ${o.config_name}, but the provided class configuration is: ${e.workflowConfigName}`;throw new He.DBOSConflictingWorkflowError(e.workflowUUID,c)}else(o.queue_name??void 0)!==(e.queueName??void 0)&&this.logger.warn(`Workflow (${e.workflowUUID}) already exists in queue: ${o.queue_name}, but the provided queue name is: ${e.queueName}. The queue is not updated. ${new Error().stack}`);let i=o.status,u=o.workflow_deadline_epoch_ms??void 0;if(r!==o.owner_xid&&!n?.isRecoveryRequest&&!n?.isDequeuedRequest){if(i===Se.StatusString.MAX_RECOVERY_ATTEMPTS_EXCEEDED)throw new He.DBOSMaxRecoveryAttemptsExceededError(e.workflowUUID,n?.maxRetries??-1);return{status:i,deadlineEpochMS:u,shouldExecuteOnThisExecutor:!1,serialization:o.serialization}}a=!0;let l=o.recovery_attempts;if(n?.maxRetries&&l>n?.maxRetries+1)throw await Ca(s,e.workflowUUID,Se.StatusString.MAX_RECOVERY_ATTEMPTS_EXCEEDED,this.schemaName,{where:{status:Se.StatusString.PENDING},throwOnFailure:!1}),new He.DBOSMaxRecoveryAttemptsExceededError(e.workflowUUID,n.maxRetries);return this.logger.debug(`Workflow ${e.workflowUUID} attempt number: ${l}.`),{status:i,deadlineEpochMS:u,shouldExecuteOnThisExecutor:!0,serialization:o.serialization}}finally{try{a?(await s.query("COMMIT"),await(0,vm.debugTriggerPoint)(vm.DEBUG_TRIGGER_INITWF_COMMIT)):await s.query("ROLLBACK")}finally{s.release()}}}async recordWorkflowOutput(e,r){let n=await this.pool.connect();try{await Ca(n,e,Se.StatusString.SUCCESS,this.schemaName,{update:{output:r.output,resetDeduplicationID:!0}})}finally{n.release()}}async recordWorkflowError(e,r){let n=await this.pool.connect();try{await Ca(n,e,Se.StatusString.ERROR,this.schemaName,{update:{error:r.error,resetDeduplicationID:!0}})}finally{n.release()}}async getPendingWorkflows(e,r){return(await this.pool.query(`SELECT workflow_uuid, queue_name 
       FROM "${this.schemaName}".workflow_status 
       WHERE status=$1 AND executor_id=$2 AND application_version=$3`,[Se.StatusString.PENDING,e,r])).rows.map(s=>({workflowUUID:s.workflow_uuid,queueName:s.queue_name}))}async#e(e,r,n){await this.#o(e,r);let{rows:s}=await e.query(`SELECT output, error, child_workflow_id, function_name
       FROM "${this.schemaName}".operation_outputs
      WHERE workflow_uuid=$1 AND function_id=$2`,[r,n]);if(s.length!==0)return{output:s[0].output,error:s[0].error,childWorkflowID:s[0].child_workflow_id,functionName:s[0].function_name}}async getOperationResultAndThrowIfCancelled(e,r){let n=await this.pool.connect();try{return await this.#e(n,e,r)}finally{n.release()}}async getAllOperationResults(e){let{rows:r}=await this.pool.query(`SELECT * FROM "${this.schemaName}".operation_outputs WHERE workflow_uuid=$1`,[e]);return r}async recordOperationResult(e,r,n,s,a,o={}){let i=await this.pool.connect(),u=Date.now();try{await bm(i,e,r,n,s,this.schemaName,a,u,o)}finally{i.release(),await(0,vm.debugTriggerPoint)(vm.DEBUG_TRIGGER_STEP_COMMIT)}}async forkWorkflow(e,r,n={}){let s=n.newWorkflowID??(0,phe.randomUUID)(),a=await this.getWorkflowStatus(e);if(a===null)throw new He.DBOSNonExistentWorkflowError(`Workflow ${e} does not exist`);if(!a.input)throw new He.DBOSNonExistentWorkflowError(`Workflow ${e} has no input`);let o=await this.pool.connect();try{await o.query("BEGIN ISOLATION LEVEL READ COMMITTED");let i=Date.now();if(await zH(o,{workflowUUID:s,status:Se.StatusString.ENQUEUED,workflowName:a.workflowName,workflowClassName:a.workflowClassName,workflowConfigName:a.workflowConfigName,queueName:dn.INTERNAL_QUEUE_NAME,authenticatedUser:a.authenticatedUser,assumedRole:a.assumedRole,authenticatedRoles:a.authenticatedRoles,output:null,error:null,request:a.request,executorId:dn.globalParams.executorID,applicationVersion:n.applicationVersion??a.applicationVersion,applicationID:a.applicationID,createdAt:i,recoveryAttempts:0,updatedAt:i,timeoutMS:n.timeoutMS??a.timeoutMS,input:a.input,deduplicationID:void 0,priority:0,queuePartitionKey:void 0,forkedFrom:e,serialization:a.serialization},this.schemaName,null),r>0){let u=`INSERT INTO "${this.schemaName}".operation_outputs
          (workflow_uuid, function_id, output, error, function_name, child_workflow_id)
          SELECT $1 AS workflow_uuid, function_id, output, error, function_name, child_workflow_id
          FROM "${this.schemaName}".operation_outputs
          WHERE workflow_uuid = $2 AND function_id < $3`;await o.query(u,[s,e,r]);let l=`INSERT INTO "${this.schemaName}".streams
          (workflow_uuid, key, value, "offset", function_id)
          SELECT $1 AS workflow_uuid, key, value, "offset", function_id
          FROM "${this.schemaName}".streams
          WHERE workflow_uuid = $2 AND function_id < $3`;await o.query(l,[s,e,r]);let c=`INSERT INTO "${this.schemaName}".workflow_events_history
          (workflow_uuid, function_id, key, value)
          SELECT $1 AS workflow_uuid, function_id, key, value
          FROM "${this.schemaName}".workflow_events_history
          WHERE workflow_uuid = $2 AND function_id < $3`;await o.query(c,[s,e,r]);let f=`INSERT INTO "${this.schemaName}".workflow_events
          (workflow_uuid, key, value)
          SELECT $1 AS workflow_uuid, weh1.key, weh1.value
          FROM "${this.schemaName}".workflow_events_history weh1
          WHERE weh1.workflow_uuid = $2
            AND weh1.function_id = (
              SELECT MAX(weh2.function_id)
              FROM "${this.schemaName}".workflow_events_history weh2
              WHERE weh2.workflow_uuid = $2
                AND weh2.key = weh1.key
                AND weh2.function_id < $3
            )`;await o.query(f,[s,e,r])}return await o.query("COMMIT"),s}catch(i){throw await o.query("ROLLBACK"),i}finally{o.release()}}async#t(e,r,n,s,a){let o=Date.now(),i=await this.#e(e,n,s);if(i!==void 0){if(i.functionName!==r)throw new He.DBOSUnexpectedStepError(n,s,r,i.functionName);return i.output}let u=await a();return await bm(e,n,s,r,!0,this.schemaName,o,Date.now(),{output:u}),u}async durableSleepms(e,r,n){let s,a=new Promise(i=>{s=i}),o=this.cancelWakeupMap.registerCallback(e,s);try{let i=Promise.resolve(),{promise:u,cancel:l}=await this.#r(e,r,n);i=u;try{await Promise.race([a,i])}finally{l()}}finally{this.cancelWakeupMap.deregisterCallback(o)}await this.checkIfCanceled(e)}async#r(e,r,n,s){s===void 0&&(s=n);let a=Date.now(),o=a+n,i=await this.pool.connect();try{let u=await this.#e(i,e,r);if(u){if(u.functionName!==J.DBOS_FUNCNAME_SLEEP)throw new He.DBOSUnexpectedStepError(e,r,J.DBOS_FUNCNAME_SLEEP,u.functionName);o=JSON.parse(u.output)}else await bm(i,e,r,J.DBOS_FUNCNAME_SLEEP,!1,this.schemaName,Date.now(),Date.now(),{output:YH.DBOSPortableJSON.stringify(o),serialization:YH.DBOSPortableJSON.name()});return{...(0,dn.cancellableSleep)(Math.max(Math.min(s,o-a),0)),endTime:o}}finally{i.release()}}nullTopic="__null__topic__";async send(e,r,n,s,a,o){a=a??this.nullTopic;let i=await this.pool.connect();try{await i.query("BEGIN ISOLATION LEVEL READ COMMITTED"),await this.#t(i,J.DBOS_FUNCNAME_SEND,e,r,async()=>{await i.query(`INSERT INTO "${this.schemaName}".notifications (destination_uuid, topic, message, serialization) VALUES ($1, $2, $3, $4);`,[n,a,s,o])}),await i.query("COMMIT")}catch(u){await i.query("ROLLBACK");let l=u;throw l.code==="23503"?new He.DBOSNonExistentWorkflowError(`Sent to non-existent destination workflow UUID: ${n}`):l}finally{i.release()}}async recv(e,r,n,s,a=Jb.DBOSExecutor.defaultNotificationTimeoutSec){s=s??this.nullTopic;let o=Date.now(),i=await this.getOperationResultAndThrowIfCancelled(e,r);if(i){if(i.functionName!==J.DBOS_FUNCNAME_RECV)throw new He.DBOSUnexpectedStepError(e,r,J.DBOS_FUNCNAME_RECV,i.functionName);return{serializedValue:i.output,serialization:i.serialization??null}}let u=a!==void 0?a*1e3:void 0,l=u!==void 0?Date.now()+u:void 0;for(;;){let S,g=new Promise(v=>{S=v}),E=`${e}::${s}`,T=this.notificationsMap.registerCallback(E,S),O=this.cancelWakeupMap.registerCallback(e,v=>{S()});try{if(await this.checkIfCanceled(e),(await this.pool.query(`SELECT topic FROM "${this.schemaName}".notifications WHERE destination_uuid=$1 AND topic=$2;`,[e,s])).rows.length!==0)break;let b=Date.now();if(l&&b>l)break;let N=Promise.resolve(),I=()=>{};if(u){let{promise:R,cancel:x,endTime:C}=await this.#r(e,n,u,this.dbPollingIntervalEventMs);N=R,I=x,l=C}else{let R=l?l-b:this.dbPollingIntervalEventMs;R=Math.min(this.dbPollingIntervalEventMs,R);let{promise:x,cancel:C}=(0,dn.cancellableSleep)(R);N=x,I=C}try{await Promise.race([g,N])}finally{I()}}finally{this.notificationsMap.deregisterCallback(T),this.cancelWakeupMap.deregisterCallback(O)}}await this.checkIfCanceled(e);let c=null,f=null,h=await this.pool.connect();try{await h.query("BEGIN ISOLATION LEVEL READ COMMITTED");let S=(await h.query(`WITH oldest_entry AS (
        SELECT destination_uuid, topic, message, created_at_epoch_ms, serialization
        FROM "${this.schemaName}".notifications
        WHERE destination_uuid = $1
          AND topic = $2
        ORDER BY created_at_epoch_ms ASC
        LIMIT 1
       )

        DELETE FROM "${this.schemaName}".notifications
        USING oldest_entry
        WHERE notifications.destination_uuid = oldest_entry.destination_uuid
          AND notifications.topic = oldest_entry.topic
          AND notifications.created_at_epoch_ms = oldest_entry.created_at_epoch_ms
        RETURNING notifications.*;`,[e,s])).rows;S.length>0&&(c=S[0].message,f=S[0].serialization),await bm(h,e,r,J.DBOS_FUNCNAME_RECV,!0,this.schemaName,o,Date.now(),{output:c,serialization:f}),await h.query("COMMIT")}catch(S){throw this.logger.error(S),await h.query("ROLLBACK"),S}finally{h.release()}return{serializedValue:c,serialization:f}}async setWorkflowStatus(e,r,n,s){let a=await this.pool.connect();try{await Ca(a,e,r,this.schemaName,{update:{resetRecoveryAttempts:n,resetNameTo:s?.updateName}})}finally{a.release()}}async setEvent(e,r,n,s,a){let o=await this.pool.connect();try{await o.query("BEGIN ISOLATION LEVEL READ COMMITTED"),await this.#t(o,J.DBOS_FUNCNAME_SETEVENT,e,r,async()=>{await o.query(`INSERT INTO "${this.schemaName}".workflow_events (workflow_uuid, key, value, serialization)
             VALUES ($1, $2, $3, $4)
             ON CONFLICT (workflow_uuid, key)
             DO UPDATE SET value = $3
             RETURNING workflow_uuid;`,[e,n,s,a]),await o.query(`INSERT INTO "${this.schemaName}".workflow_events_history (workflow_uuid, function_id, key, value, serialization)
             VALUES ($1, $2, $3, $4, $5)
             ON CONFLICT (workflow_uuid, function_id, key)
             DO UPDATE SET value = $4;`,[e,r,n,s,a])}),await o.query("COMMIT")}catch(i){throw this.logger.error(i),await o.query("ROLLBACK"),i}finally{o.release()}}async getEvent(e,r,n,s){let a=Date.now();if(s){let f=await this.getOperationResultAndThrowIfCancelled(s.workflowID,s.functionID);if(f){if(f.functionName!==J.DBOS_FUNCNAME_GETEVENT)throw new He.DBOSUnexpectedStepError(s.workflowID,s.functionID,J.DBOS_FUNCNAME_GETEVENT,f.functionName);return{serializedValue:f.output,serialization:null}}}let o=null,i=null,u=`${e}::${r}`,l=n!==void 0?n*1e3:void 0,c=l!==void 0?Date.now()+l:void 0;for(;;){let f,h=new Promise(E=>{f=E}),S=this.workflowEventsMap.registerCallback(u,f),g=s?.workflowID?this.cancelWakeupMap.registerCallback(s.workflowID,E=>{f()}):void 0;try{s?.workflowID&&await this.checkIfCanceled(s?.workflowID);let E=(await this.pool.query(`SELECT key, value, serialization
             FROM "${this.schemaName}".workflow_events
             WHERE workflow_uuid=$1 AND key=$2;`,[e,r])).rows;if(E.length>0){o=E[0].value,i=E[0].serialization;break}let T=Date.now();if(c&&T>c)break;let O=Promise.resolve(),v=()=>{};if(s&&l){let{promise:b,cancel:N,endTime:I}=await this.#r(s.workflowID,s.timeoutFunctionID??-1,l,this.dbPollingIntervalEventMs);O=b,v=N,c=I}else{let b=c?c-T:this.dbPollingIntervalEventMs;b=Math.min(this.dbPollingIntervalEventMs,b);let{promise:N,cancel:I}=(0,dn.cancellableSleep)(b);O=N,v=I}try{await Promise.race([h,O])}finally{v()}}finally{this.workflowEventsMap.deregisterCallback(S),g&&this.cancelWakeupMap.deregisterCallback(g)}}return s&&await this.recordOperationResult(s.workflowID,s.functionID,J.DBOS_FUNCNAME_GETEVENT,!0,a,{output:o,serialization:i}),{serializedValue:o,serialization:i}}#n(e){this.runningWorkflowMap.has(e)&&this.workflowCancellationMap.set(e,!0),this.cancelWakeupMap.callCallbacks(e)}#i(e){this.workflowCancellationMap.has(e)&&this.workflowCancellationMap.delete(e)}async cancelWorkflow(e){let r=await this.pool.connect();try{await r.query("BEGIN ISOLATION LEVEL READ COMMITTED");let n=await Kb(r,e,this.schemaName);if(!n)throw new He.DBOSNonExistentWorkflowError(`Workflow ${e} does not exist`);if(n===Se.StatusString.SUCCESS||n===Se.StatusString.ERROR||n===Se.StatusString.CANCELLED){await r.query("ROLLBACK");return}await Ca(r,e,Se.StatusString.CANCELLED,this.schemaName,{update:{queueName:null,resetDeduplicationID:!0,resetStartedAtEpochMs:!0}}),await r.query("COMMIT")}catch(n){throw this.logger.error(n),await r.query("ROLLBACK"),n}finally{r.release()}this.#n(e)}async#o(e,r){if(this.workflowCancellationMap.get(r)===!0)throw new He.DBOSWorkflowCancelledError(r);if(await Kb(e,r,this.schemaName)===Se.StatusString.CANCELLED)throw new He.DBOSWorkflowCancelledError(r)}async checkIfCanceled(e){let r=await this.pool.connect();try{await this.#o(r,e)}finally{r.release()}}async resumeWorkflow(e){this.#i(e);let r=await this.pool.connect();try{await r.query("BEGIN ISOLATION LEVEL REPEATABLE READ");let n=await Kb(r,e,this.schemaName);if(!n||n===Se.StatusString.SUCCESS||n===Se.StatusString.ERROR){if(await r.query("ROLLBACK"),!n&&n===void 0)throw new He.DBOSNonExistentWorkflowError(`Workflow ${e} does not exist`);return}await Ca(r,e,Se.StatusString.ENQUEUED,this.schemaName,{update:{queueName:dn.INTERNAL_QUEUE_NAME,resetRecoveryAttempts:!0,resetDeadline:!0,resetDeduplicationID:!0,resetStartedAtEpochMs:!0},throwOnFailure:!1}),await r.query("COMMIT")}catch(n){throw this.logger.error(n),await r.query("ROLLBACK"),n}finally{r.release()}}async getWorkflowChildren(e){let r=new Set([e]),n=[e],s=[],a=await this.pool.connect();try{for(;n.length>0;){let o=n.splice(0,n.length),i=await a.query(`SELECT DISTINCT child_workflow_id
           FROM "${this.schemaName}".operation_outputs
           WHERE workflow_uuid = ANY($1)
             AND child_workflow_id IS NOT NULL`,[o]);for(let u of i.rows)r.has(u.child_workflow_id)||(r.add(u.child_workflow_id),n.push(u.child_workflow_id),s.push(u.child_workflow_id))}}finally{a.release()}return s}async deleteWorkflow(e,r=!1){let n=[e];if(r){let a=await this.getWorkflowChildren(e);n=[...n,...a]}let s=await this.pool.connect();try{await s.query(`DELETE FROM "${this.schemaName}".workflow_status
         WHERE workflow_uuid = ANY($1)`,[n])}finally{s.release()}for(let a of n)this.runningWorkflowMap.delete(a),this.workflowCancellationMap.delete(a)}async exportWorkflow(e,r=!1){let n=[e];r&&n.push(...await this.getWorkflowChildren(e));let s=[],a=await this.pool.connect();try{for(let o of n){let i=await a.query(`SELECT
            workflow_uuid, status, name, authenticated_user, assumed_role,
            authenticated_roles, request, output, error, executor_id,
            created_at, updated_at, application_version, application_id,
            class_name, config_name, recovery_attempts, queue_name,
            workflow_timeout_ms, workflow_deadline_epoch_ms, started_at_epoch_ms,
            deduplication_id, inputs, priority, queue_partition_key, forked_from,
            parent_workflow_id, serialization
          FROM "${this.schemaName}".workflow_status
          WHERE workflow_uuid = $1`,[o]);if(i.rows.length===0)throw new He.DBOSNonExistentWorkflowError(`Workflow ${o} does not exist`);let u=i.rows[0],l=await a.query(`SELECT
            workflow_uuid, function_id, function_name, output, error,
            child_workflow_id, started_at_epoch_ms, completed_at_epoch_ms,
            serialization
          FROM "${this.schemaName}".operation_outputs
          WHERE workflow_uuid = $1`,[o]),c=await a.query(`SELECT workflow_uuid, key, value, serialization
          FROM "${this.schemaName}".workflow_events
          WHERE workflow_uuid = $1`,[o]),f=await a.query(`SELECT workflow_uuid, function_id, key, value, serialization
          FROM "${this.schemaName}".workflow_events_history
          WHERE workflow_uuid = $1`,[o]),h=await a.query(`SELECT workflow_uuid, key, value, "offset", function_id, serialization
          FROM "${this.schemaName}".streams
          WHERE workflow_uuid = $1`,[o]);s.push({workflow_status:u,operation_outputs:l.rows,workflow_events:c.rows,workflow_events_history:f.rows,streams:h.rows})}}finally{a.release()}return s}async importWorkflow(e){let r=await this.pool.connect();try{await r.query("BEGIN");for(let n of e){let s=n.workflow_status;await r.query(`INSERT INTO "${this.schemaName}".workflow_status (
            workflow_uuid, status, name, authenticated_user, assumed_role,
            authenticated_roles, request, output, error, executor_id,
            created_at, updated_at, application_version, application_id,
            class_name, config_name, recovery_attempts, queue_name,
            workflow_timeout_ms, workflow_deadline_epoch_ms, started_at_epoch_ms,
            deduplication_id, inputs, priority, queue_partition_key, forked_from,
            parent_workflow_id, serialization
          ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28)`,[s.workflow_uuid,s.status,s.name,s.authenticated_user,s.assumed_role,s.authenticated_roles,s.request,s.output,s.error,s.executor_id,s.created_at,s.updated_at,s.application_version,s.application_id,s.class_name,s.config_name,s.recovery_attempts,s.queue_name,s.workflow_timeout_ms,s.workflow_deadline_epoch_ms,s.started_at_epoch_ms,s.deduplication_id,s.inputs,s.priority,s.queue_partition_key,s.forked_from,s.parent_workflow_id,s.serialization]);for(let a of n.operation_outputs)await r.query(`INSERT INTO "${this.schemaName}".operation_outputs (
              workflow_uuid, function_id, function_name, output, error,
              child_workflow_id, started_at_epoch_ms, completed_at_epoch_ms,
              serialization
            ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)`,[a.workflow_uuid,a.function_id,a.function_name,a.output,a.error,a.child_workflow_id,a.started_at_epoch_ms,a.completed_at_epoch_ms,a.serialization]);for(let a of n.workflow_events)await r.query(`INSERT INTO "${this.schemaName}".workflow_events (
              workflow_uuid, key, value, serialization
            ) VALUES ($1, $2, $3, $4)`,[a.workflow_uuid,a.key,a.value,a.serialization]);for(let a of n.workflow_events_history)await r.query(`INSERT INTO "${this.schemaName}".workflow_events_history (
              workflow_uuid, function_id, key, value, serialization
            ) VALUES ($1, $2, $3, $4, $5)`,[a.workflow_uuid,a.function_id,a.key,a.value,a.serialization]);for(let a of n.streams)await r.query(`INSERT INTO "${this.schemaName}".streams (
              workflow_uuid, key, value, "offset", function_id, serialization
            ) VALUES ($1, $2, $3, $4, $5, $6)`,[a.workflow_uuid,a.key,a.value,a.offset,a.function_id,a.serialization])}await r.query("COMMIT")}catch(n){throw await r.query("ROLLBACK"),n}finally{r.release()}}registerRunningWorkflow(e,r){let n=r.catch(s=>{this.logger.debug("Captured error in awaitWorkflowPromise: "+s)}).finally(()=>{this.runningWorkflowMap.delete(e),this.workflowCancellationMap.delete(e)});this.runningWorkflowMap.set(e,n)}checkForRunningWorkflow(e){return this.runningWorkflowMap.has(e)}async awaitRunningWorkflows(){this.runningWorkflowMap.size>0&&(this.logger.info("Waiting for pending workflows to finish."),await Promise.allSettled(this.runningWorkflowMap.values())),this.workflowEventsMap.map.size>0&&this.logger.warn("Workflow events map is not empty - shutdown is not clean."),this.notificationsMap.map.size>0&&this.logger.warn("Message notification map is not empty - shutdown is not clean.")}async getWorkflowStatus(e,r,n){let s=async()=>{let i=(await this.listWorkflows({workflowIDs:[e]})).find(u=>u.workflowUUID===e);return i?JSON.stringify(i):null};if(r&&n){let o=await this.pool.connect();try{let i=await this.#t(o,J.DBOS_FUNCNAME_GETSTATUS,r,n,s);return a(i)}finally{o.release()}}else{let o=await s();return a(o)}function a(o){return o?JSON.parse(o):null}}async awaitWorkflowResult(e,r,n,s){let a=r!==void 0?r*1e3:void 0,o=a!==void 0?Date.now()+a:void 0;for(;;){let i,u=new Promise(f=>{i=f}),l=this.cancelWakeupMap.registerCallback(e,f=>{i()}),c=n?this.cancelWakeupMap.registerCallback(n,f=>{i()}):void 0;try{n&&await this.checkIfCanceled(n);try{let{rows:g}=await this.pool.query(`SELECT status, output, error, serialization FROM "${this.schemaName}".workflow_status 
             WHERE workflow_uuid=$1`,[e]);if(g.length>0){let E=g[0].status;if(E===Se.StatusString.SUCCESS)return{output:g[0].output,serialization:g[0].serialization};if(E===Se.StatusString.ERROR)return{error:g[0].error,serialization:g[0].serialization};if(E===Se.StatusString.CANCELLED)return{cancelled:!0}}}catch(g){let E=g;throw this.logger.error(`Exception from system database: ${E}`,E),E}let f=Date.now();if(o&&f>o)return;let h=Promise.resolve(),S=()=>{};if(s!==void 0&&n!==void 0&&a!==void 0){let{promise:g,cancel:E,endTime:T}=await this.#r(n,s,a,this.dbPollingIntervalResultMs);o=T,h=g,S=E}else{let g=o?o-f:this.dbPollingIntervalResultMs;g=Math.min(this.dbPollingIntervalResultMs,g);let{promise:E,cancel:T}=(0,dn.cancellableSleep)(g);h=E,S=T}try{await Promise.race([u,h])}finally{S()}}finally{this.cancelWakeupMap.deregisterCallback(l),c&&this.cancelWakeupMap.deregisterCallback(c)}}}reconnectTimeout=null;async#s(){let e=async()=>{let r=()=>{this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{this.reconnectTimeout=null,await e()},1e3))},n=null;try{n=await this.pool.connect(),await n.query("LISTEN dbos_notifications_channel;"),await n.query("LISTEN dbos_workflow_events_channel;");let s=a=>{this.shouldUseDBNotifications&&(a.channel==="dbos_notifications_channel"&&a.payload?this.notificationsMap.callCallbacks(a.payload):a.channel==="dbos_workflow_events_channel"&&a.payload&&this.workflowEventsMap.callCallbacks(a.payload))};n.on("notification",s),n.on("error",a=>{this.logger.warn(`Error in notifications client: ${a}`),n&&(n.removeAllListeners(),n.release(!0)),r()}),this.notificationsClient=n}catch(s){this.logger.warn(`Error in notifications listener: ${String(s)}`),n&&(n.removeAllListeners(),n.release(!0)),r()}};await e()}async getEventDispatchState(e,r,n){let s=await this.pool.query(`SELECT * FROM "${this.schemaName}".event_dispatch_kv
       WHERE workflow_fn_name = $1 AND service_name = $2 AND key = $3;`,[r,e,n]);if(s.rows.length!==0)return{service:s.rows[0].service_name,workflowFnName:s.rows[0].workflow_fn_name,key:s.rows[0].key,value:s.rows[0].value,updateTime:s.rows[0].update_time,updateSeq:s.rows[0].update_seq!==null&&s.rows[0].update_seq!==void 0?BigInt(s.rows[0].update_seq):void 0}}async upsertEventDispatchState(e){let r=await this.pool.query(`INSERT INTO "${this.schemaName}".event_dispatch_kv (
        service_name, workflow_fn_name, key, value, update_time, update_seq)
       VALUES ($1, $2, $3, $4, $5, $6)
       ON CONFLICT (service_name, workflow_fn_name, key)
       DO UPDATE SET
         update_time = GREATEST(EXCLUDED.update_time, event_dispatch_kv.update_time),
         update_seq =  GREATEST(EXCLUDED.update_seq,  event_dispatch_kv.update_seq),
         value = CASE WHEN (EXCLUDED.update_time > event_dispatch_kv.update_time 
            OR EXCLUDED.update_seq > event_dispatch_kv.update_seq 
            OR (event_dispatch_kv.update_time IS NULL and event_dispatch_kv.update_seq IS NULL)
         ) THEN EXCLUDED.value ELSE event_dispatch_kv.value END
       RETURNING value, update_time, update_seq;`,[e.service,e.workflowFnName,e.key,e.value,e.updateTime,e.updateSeq]);return{service:e.service,workflowFnName:e.workflowFnName,key:e.key,value:r.rows[0].value,updateTime:r.rows[0].update_time,updateSeq:r.rows[0].update_seq!==void 0&&r.rows[0].update_seq!==null?BigInt(r.rows[0].update_seq):void 0}}async listWorkflows(e){let r=this.schemaName,n=["workflow_uuid","status","name","recovery_attempts","config_name","class_name","authenticated_user","authenticated_roles","assumed_role","queue_name","executor_id","created_at","updated_at","application_version","application_id","workflow_deadline_epoch_ms","workflow_timeout_ms","deduplication_id","priority","queue_partition_key","started_at_epoch_ms","forked_from","parent_workflow_id"];e.loadInput=e.loadInput??!0,e.loadOutput=e.loadOutput??!0,e.loadInput&&n.push("inputs","request"),e.loadOutput&&n.push("output","error"),(e.loadInput||e.loadOutput)&&n.push("serialization"),e.sortDesc=e.sortDesc??!1;let s=[],a=[],o=1,i=(g,E)=>{if(E)if(Array.isArray(E)){let T=E.map((O,v)=>`$${o+v}`).join(", ");s.push(`${g} IN (${T})`),a.push(...E),o+=E.length}else s.push(`${g} = $${o}`),a.push(E),o++};if(e.queuesOnly&&(s.push("queue_name IS NOT NULL"),s.push(`status IN ($${o}, $${o+1})`),a.push(Se.StatusString.ENQUEUED,Se.StatusString.PENDING),o+=2),i("name",e.workflowName),i("queue_name",e.queueName),e.workflow_id_prefix)if(Array.isArray(e.workflow_id_prefix)){let g=e.workflow_id_prefix.map((E,T)=>`workflow_uuid LIKE $${o+T}`);s.push(`(${g.join(" OR ")})`),a.push(...e.workflow_id_prefix.map(E=>`${E}%`)),o+=e.workflow_id_prefix.length}else s.push(`workflow_uuid LIKE $${o}`),a.push(`${e.workflow_id_prefix}%`),o++;if(e.workflowIDs){let g=e.workflowIDs.map((E,T)=>`$${o+T}`).join(", ");s.push(`workflow_uuid IN (${g})`),a.push(...e.workflowIDs),o+=e.workflowIDs.length}i("authenticated_user",e.authenticatedUser),i("forked_from",e.forkedFrom),i("parent_workflow_id",e.parentWorkflowID),e.startTime&&(s.push(`created_at >= $${o}`),a.push(new Date(e.startTime).getTime()),o++),e.endTime&&(s.push(`created_at <= $${o}`),a.push(new Date(e.endTime).getTime()),o++),i("status",e.status),i("application_version",e.applicationVersion),i("executor_id",e.executorId);let u=s.length>0?`WHERE ${s.join(" AND ")}`:"",l=`ORDER BY created_at ${e.sortDesc?"DESC":"ASC"}`,c=e.limit?`LIMIT ${e.limit}`:"",f=e.offset?`OFFSET ${e.offset}`:"",h=`
      SELECT ${n.join(", ")}
      FROM "${r}".workflow_status
      ${u}
      ${l}
      ${c}
      ${f}
    `;return(await this.pool.query(h,a)).rows.map(She)}async clearQueueAssignment(e){return((await this.pool.query(`UPDATE "${this.schemaName}".workflow_status
        SET started_at_epoch_ms = NULL, status = $2
        WHERE workflow_uuid = $1 AND queue_name is NOT NULL AND status = $3`,[e,Se.StatusString.ENQUEUED,Se.StatusString.PENDING])).rowCount??0)>0}async getDeduplicatedWorkflow(e,r){let{rows:n}=await this.pool.query(`SELECT workflow_uuid FROM "${this.schemaName}".workflow_status
       WHERE queue_name = $1 AND deduplication_id = $2`,[e,r]);return n.length===0?null:n[0].workflow_uuid}async getQueuePartitions(e){let{rows:r}=await this.pool.query(`SELECT DISTINCT queue_partition_key FROM "${this.schemaName}".workflow_status
       WHERE queue_name = $1
         AND status = $2
         AND queue_partition_key IS NOT NULL`,[e,Se.StatusString.ENQUEUED]);return r.map(n=>n.queue_partition_key)}async findAndMarkStartableWorkflows(e,r,n,s){let a=Date.now(),o=e.rateLimit?e.rateLimit.periodSec*1e3:0,i=[],u="",l=[];s!==void 0&&(u="AND queue_partition_key = $PARTITION",l.push(s));let c=await this.pool.connect();try{await c.query("BEGIN ISOLATION LEVEL REPEATABLE READ");let f=0;if(e.rateLimit){let N=[e.name,Se.StatusString.ENQUEUED,a-o,...l],I=await c.query(`SELECT COUNT(*) FROM "${this.schemaName}".workflow_status
           WHERE queue_name = $1
             AND status <> $2
             AND started_at_epoch_ms > $3
             ${u.replace("$PARTITION","$4")}`,N);if(f=Number(I.rows[0].count),f>=e.rateLimit.limitPerPeriod)return await c.query("COMMIT"),i}let h=1/0;if(e.workerConcurrency!==void 0||e.concurrency!==void 0){let N=[e.name,Se.StatusString.PENDING,...l],I=await c.query(`SELECT executor_id, COUNT(*) as task_count
           FROM "${this.schemaName}".workflow_status
           WHERE queue_name = $1 AND status = $2
             ${u.replace("$PARTITION","$3")}
           GROUP BY executor_id`,N),R={};I.rows.forEach(C=>{R[C.executor_id]=Number(C.task_count)});let x=R[r]||0;if(e.workerConcurrency!==void 0&&(h=Math.max(0,e.workerConcurrency-x)),e.concurrency!==void 0){let C=Object.values(R).reduce((ye,H)=>ye+H,0);C>e.concurrency&&this.logger.warn(`Total running tasks (${C}) exceeds the global concurrency limit (${e.concurrency})`);let j=Math.max(0,e.concurrency-C);h=Math.min(h,j)}}if(h<=0)return await c.query("COMMIT"),i;let S=e.concurrency?"FOR UPDATE NOWAIT":"FOR UPDATE SKIP LOCKED",g=e.priorityEnabled?"ORDER BY priority ASC, created_at ASC":"ORDER BY created_at ASC",E=h!==1/0?`LIMIT ${h}`:"",T=[Se.StatusString.ENQUEUED,e.name,n,...l],O=`
        SELECT workflow_uuid
        FROM "${this.schemaName}".workflow_status
        WHERE status = $1
          AND queue_name = $2
          AND (application_version IS NULL OR application_version = $3)
          ${u.replace("$PARTITION","$4")}
        ${g}
        ${E}
        ${S}
      `,{rows:v}=await c.query(O,T),b=v.map(N=>N.workflow_uuid);for(let N of b){if(e.rateLimit&&i.length+f>=e.rateLimit.limitPerPeriod)break;await c.query(`UPDATE "${this.schemaName}".workflow_status
           SET status = $1,
               executor_id = $2,
               application_version = $3,
               started_at_epoch_ms = $4,
               workflow_deadline_epoch_ms = CASE
                 WHEN workflow_timeout_ms IS NOT NULL AND workflow_deadline_epoch_ms IS NULL
                 THEN (EXTRACT(epoch FROM now()) * 1000)::bigint + workflow_timeout_ms
                 ELSE workflow_deadline_epoch_ms
               END
           WHERE workflow_uuid = $5`,[Se.StatusString.PENDING,r,n,a,N]),i.push(N)}await c.query("COMMIT")}catch(f){throw await c.query("ROLLBACK"),f}finally{c.release()}return i}async writeStreamFromStep(e,r,n,s,a){let o=await this.pool.connect();try{await o.query("BEGIN ISOLATION LEVEL READ COMMITTED");let u=(await o.query(`SELECT MAX("offset") FROM "${this.schemaName}".streams
         WHERE workflow_uuid = $1 AND key = $2`,[e,n])).rows[0].max,l=u!==null?u+1:0;await o.query(`INSERT INTO "${this.schemaName}".streams (workflow_uuid, key, value, "offset", function_id, serialization)
         VALUES ($1, $2, $3, $4, $5, $6)`,[e,n,s,l,r,a]),await o.query("COMMIT")}catch(i){throw this.logger.error(i),await o.query("ROLLBACK"),i}finally{o.release()}}async writeStreamFromWorkflow(e,r,n,s,a,o){let i=await this.pool.connect();try{await i.query("BEGIN ISOLATION LEVEL READ COMMITTED"),await this.#t(i,o,e,r,async()=>{let l=(await i.query(`SELECT MAX("offset") FROM "${this.schemaName}".streams 
           WHERE workflow_uuid = $1 AND key = $2`,[e,n])).rows[0].max,c=l!==null?l+1:0;await i.query(`INSERT INTO "${this.schemaName}".streams (workflow_uuid, key, value, "offset", function_id, serialization)
           VALUES ($1, $2, $3, $4, $5, $6)`,[e,n,s,c,r,a])}),await i.query("COMMIT")}catch(u){throw this.logger.error(u),await i.query("ROLLBACK"),u}finally{i.release()}}async closeStream(e,r,n){await this.writeStreamFromWorkflow(e,r,n,J.DBOS_STREAM_CLOSED_SENTINEL,"portable_json",J.DBOS_FUNCNAME_CLOSESTREAM)}async readStream(e,r,n){let s=await this.pool.connect();try{let a=await s.query(`SELECT value, serialization FROM "${this.schemaName}".streams 
         WHERE workflow_uuid = $1 AND key = $2 AND "offset" = $3`,[e,r,n]);if(a.rows.length===0)throw new Error(`No value found for workflow_uuid=${e}, key=${r}, offset=${n}`);let o=a.rows[0];return{serializedValue:o.value,serialization:o.serialization}}finally{s.release()}}async garbageCollect(e,r){if(r!==void 0){let n=await this.pool.query(`SELECT created_at
         FROM "${this.schemaName}".workflow_status
         ORDER BY created_at DESC
         LIMIT 1 OFFSET $1`,[r-1]);if(n.rows.length>0){let s=n.rows[0].created_at;(e===void 0||s>e)&&(e=s)}}e!==void 0&&await this.pool.query(`DELETE FROM "${this.schemaName}".workflow_status
       WHERE created_at < $1
         AND status NOT IN ($2, $3)`,[e,Se.StatusString.PENDING,Se.StatusString.ENQUEUED])}async getMetrics(e,r){let n=new Date(e).getTime(),s=new Date(r).getTime(),a=[],o=await this.pool.query(`SELECT name, COUNT(workflow_uuid) as count
       FROM "${this.schemaName}".workflow_status
       WHERE created_at >= $1 AND created_at < $2
       GROUP BY name`,[n,s]);for(let u of o.rows)a.push({metricType:"workflow_count",metricName:u.name,value:Number(u.count)});let i=await this.pool.query(`SELECT function_name, COUNT(*) as count
       FROM "${this.schemaName}".operation_outputs
       WHERE completed_at_epoch_ms >= $1 AND completed_at_epoch_ms < $2
       GROUP BY function_name`,[n,s]);for(let u of i.rows)a.push({metricType:"step_count",metricName:u.function_name,value:Number(u.count)});return a}async checkPatch(e,r,n,s){if(r===void 0)throw new TypeError("functionID must be defined");n=`DBOS.patch-${n}`;let{rows:a}=await this.pool.query(`SELECT function_name
       FROM "${this.schemaName}".operation_outputs
      WHERE workflow_uuid=$1 AND function_id=$2`,[e,r]);if(s)return a.length===0?{isPatched:!0,hasEntry:!1}:{isPatched:!0,hasEntry:a[0].function_name===n};if(a.length!==0)return a[0].function_name===n?{isPatched:!0,hasEntry:!0}:{isPatched:!1,hasEntry:!1};let o=Date.now();return await this.pool.query(`INSERT INTO ${this.schemaName}.operation_outputs
       (workflow_uuid, function_id, output, error, function_name, child_workflow_id, started_at_epoch_ms, completed_at_epoch_ms)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
       ON CONFLICT DO NOTHING;`,[e,r,null,null,n,null,o,o]),{isPatched:!0,hasEntry:!0}}};J.PostgresSystemDatabase=Me;Ye([ze(),q("design:type",Function),q("design:paramtypes",[Object,Object,Object]),q("design:returntype",Promise)],Me.prototype,"initWorkflowStatus",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Object]),q("design:returntype",Promise)],Me.prototype,"recordWorkflowOutput",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Object]),q("design:returntype",Promise)],Me.prototype,"recordWorkflowError",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number]),q("design:returntype",Promise)],Me.prototype,"getOperationResultAndThrowIfCancelled",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,Boolean,Number,Object]),q("design:returntype",Promise)],Me.prototype,"recordOperationResult",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,Number]),q("design:returntype",Promise)],Me.prototype,"durableSleepms",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,Object,Object,Object]),q("design:returntype",Promise)],Me.prototype,"send",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,Number,String,Number]),q("design:returntype",Promise)],Me.prototype,"recv",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,Object,Object]),q("design:returntype",Promise)],Me.prototype,"setEvent",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String,Number,Object]),q("design:returntype",Promise)],Me.prototype,"getEvent",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],Me.prototype,"checkIfCanceled",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String,Number]),q("design:returntype",Promise)],Me.prototype,"getWorkflowStatus",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,Number]),q("design:returntype",Promise)],Me.prototype,"awaitWorkflowResult",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String,String]),q("design:returntype",Promise)],Me.prototype,"getEventDispatchState",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[Object]),q("design:returntype",Promise)],Me.prototype,"upsertEventDispatchState",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String]),q("design:returntype",Promise)],Me.prototype,"getDeduplicatedWorkflow",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String]),q("design:returntype",Promise)],Me.prototype,"getQueuePartitions",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,String,Object]),q("design:returntype",Promise)],Me.prototype,"writeStreamFromStep",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,String,Object,String]),q("design:returntype",Promise)],Me.prototype,"writeStreamFromWorkflow",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String,Number]),q("design:returntype",Promise)],Me.prototype,"readStream",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,String]),q("design:returntype",Promise)],Me.prototype,"getMetrics",null);Ye([ze(),q("design:type",Function),q("design:paramtypes",[String,Number,String,Boolean]),q("design:returntype",Promise)],Me.prototype,"checkPatch",null)});var Oi=p(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.ArgName=P.getRegistrationsForExternal=P.associateParameterWithExternal=P.associateMethodWithExternal=P.associateClassWithExternal=P.getTransactionalDataSource=P.registerTransactionalDataSource=P.transactionalDataSources=P.finalizeClassRegistrations=P.getConfiguredInstance=P.getOrCreateClassRegistrationByTarget=P.getClassRegistrationByName=P.getAllRegisteredFunctions=P.getAllRegisteredClassNames=P.getClassRegistration=P.getNameForClass=P.wrapDBOSFunctionAndRegister=P.wrapDBOSFunctionAndRegisterDec=P.wrapDBOSFunctionAndRegisterByUniqueName=P.wrapDBOSFunctionAndRegisterByTarget=P.getOrCreateMethodArgsRegistration=P.getRegisteredOperations=P.getFunctionRegistrationByName=P.getFunctionRegistration=P.registerFunctionWrapper=P.getRegisteredFunctionName=P.getRegisteredFunctionClassName=P.getRegisteredFunctionQualifiedName=P.getRegisteredFunctionFullName=P.insertAllMiddleware=P.registerMiddlewareInstaller=P.getLifecycleListeners=P.registerLifecycleCallback=P.clearAllRegistrations=P.ensureDBOSIsLaunched=P.ensureDBOSIsNotLaunched=P.recordDBOSShutdown=P.recordDBOSLaunch=P.ClassRegistration=P.ConfiguredInstance=P.MethodRegistration=P.DBOS_AUTH=P.MethodParameter=P.DBOSDataType=P.setAlertHandler=P.getAlertHandler=void 0;var Dn=dr(),rA;function Ahe(){return rA}P.getAlertHandler=Ahe;function Rhe(t){rA=t}P.setAlertHandler=Rhe;var Rm=class t{dataType="text";length=-1;precision=-1;scale=-1;static varchar(e){let r=new t;return r.dataType="varchar",r.length=e,r}static decimal(e,r){let n=new t;return n.dataType="decimal",n.precision=e,n.scale=r,n}static fromArg(e){if(!e)return;let r=new t;return e===String?r.dataType="text":e===Date?r.dataType="timestamp":e===Number?r.dataType="double":e===Boolean?r.dataType="boolean":r.dataType="json",r}formatAsString(){let e=this.dataType;return this.dataType==="varchar"&&this.length>0&&(e+=`(${this.length})`),this.dataType==="decimal"&&this.precision>0&&(this.scale>0?e+=`(${this.precision},${this.scale})`:e+=`(${this.precision})`),e}};P.DBOSDataType=Rm;function Xb(t){let e=t.toString(),r=[],n="",s=0,a=!1,o=!1,i=!1,u=!1,l=!1,c=!1,f=e.indexOf("(");if(f===-1)return[];let h=e.substring(f+1);for(let S=0;S<h.length;S++){let g=h[S],E=h[S+1];if(l){g==="*"&&E==="/"&&(l=!1,S++);continue}else if(u){g===`
`&&(u=!1);continue}else if(g==="/"&&E==="*"){l=!0,S++;continue}else if(g==="/"&&E==="/"){u=!0;continue}if(!(u||l)&&(g==="'"&&!o&&!i?a=!a:g==='"'&&!a&&!i?o=!o:g==="`"&&!a&&!o&&(i=!i),!(a||o||i))){if(g==="="&&s===0){c=!0;continue}if((g==="("||g==="{"||g==="[")&&s++,g===")"||g==="}"||g==="]"){if(s===0)break;s--}if(g==="."&&E==="."&&h[S+2]==="."){S+=2;continue}if(g===","&&s===0){n.trim()&&r.push(n.trim()),n="",c=!1;continue}c||(n+=g)}}return n.trim()&&n.trim()&&r.push(n.trim()),r}var Da=class{name="";index=-1;externalRegInfo=new Map;getRegisteredInfo(e){return this.externalRegInfo.has(e)||this.externalRegInfo.set(e,{}),this.externalRegInfo.get(e)}get dataType(){return this.getRegisteredInfo("type").dataType}initializeBaseType(e){this.externalRegInfo.has("type")||this.externalRegInfo.set("type",{});let r=this.externalRegInfo.get("type");r.dataType=Rm.fromArg(e)}constructor(e,r){this.index=e,this.initializeBaseType(r)}};P.MethodParameter=Da;P.DBOS_AUTH="auth";var Nm=class{defaults;name="";className="";classReg;onEnter=[];addEntryInterceptor(e,r=10){this.onEnter.push({seqNum:r,func:e}),this.onEnter.sort((n,s)=>n.seqNum-s.seqNum)}args=[];constructor(e,r,n){this.classReg=e,this.origFunction=r,this.isInstance=n}needInitialized=!0;isInstance;origFunction;registeredFunction;wrappedFunction=void 0;workflowConfig;stepConfig;regLocation;externalRegInfo=new Map;getRegisteredInfo(e){return this.externalRegInfo.has(e)||this.externalRegInfo.set(e,{}),this.externalRegInfo.get(e)}getAssignedType(){if(this.workflowConfig)return"Workflow";if(this.stepConfig)return"Step"}getClassName(){return this.className||this.classReg.getClassName()}checkFuncTypeUnassigned(e){let r=this.getAssignedType(),n;if(r&&e!==r?n=`Operation (Name: ${this.getClassName()}.${this.name}) is already registered with a conflicting function type: ${r} vs. ${e}`:r&&(n=`Operation (Name: ${this.getClassName()}.${this.name}) is already registered.`),n)throw this.regLocation&&(n=n+`
Prior registration occurred at:
${this.regLocation.join(`
`)}`),new Dn.DBOSConflictingRegistrationError(`${n}`);this.regLocation=new wi().getCleanStack(3)}setStepConfig(e){this.checkFuncTypeUnassigned("Step"),this.stepConfig=e}setWorkflowConfig(e){this.checkFuncTypeUnassigned("Workflow"),this.workflowConfig=e}init=!1;invoke(e,r){return(this.wrappedFunction??this.registeredFunction??this.origFunction).call(e,...r)}getRequiredRoles(){let e=this.getRegisteredInfo(P.DBOS_AUTH);return e?.requiredRole?e.requiredRole:this.defaults?.getRegisteredInfo(P.DBOS_AUTH)?.requiredRole||[]}};P.MethodRegistration=Nm;var Zb=class{name;constructor(e){xa&&console.warn(`ConfiguredInstance '${e}' is being created after DBOS initialization and was not available for recovery.`),this.name=e,Uhe(this,e)}initialize(){return Promise.resolve()}};P.ConfiguredInstance=Zb;var nc=class{name="";needsInitialized=!0;ormEntities=[];registeredOperationsByName=new Map;allRegisteredOperations=new Map;configuredInstances=new Map;configuredInstanceRegLocs=new Map;externalRegInfo=new Map;ctor;constructor(e){this.ctor=e}getClassName(){return this.name||this.ctor?.name||""}registerOperationByName(e,r){let n=this.registeredOperationsByName.get(e);if(n&&n!==r){let s=`Operation (Name: ${this.name}.${e}) is already registered.`;throw n.regLocation&&(s=s+`
Prior registration occurred at:
${n.regLocation.join(`
`)}`),new Dn.DBOSConflictingRegistrationError(`${s}`)}this.registeredOperationsByName.set(e,r),r.regLocation=new wi().getCleanStack(3)}getRegisteredInfo(e){return this.externalRegInfo.has(e)||this.externalRegInfo.set(e,{}),this.externalRegInfo.get(e)}};P.ClassRegistration=nc;var wi=class t extends Error{constructor(){super("StackGrabber"),Error.captureStackTrace(this,t)}getCleanStack(e=1){return this.stack?.split(`
`).slice(e+1).map(r=>">>> "+r.replace(/^\s*at\s*/,""))}},xa;function Nhe(){xa=new wi().getCleanStack(2)}P.recordDBOSLaunch=Nhe;function Phe(){xa=void 0}P.recordDBOSShutdown=Phe;function Lm(){if(xa)throw new Dn.DBOSConflictingRegistrationError(`DBOS code is being registered after DBOS.launch().  DBOS was launched from:
${xa.join(`
`)}
`)}P.ensureDBOSIsNotLaunched=Lm;function Ihe(t){if(!xa)throw new TypeError(`\`DBOS.launch()\` must be called before running ${t}.`)}P.ensureDBOSIsLaunched=Ihe;function Mhe(){Pm.length=0,Im=!1,Mm.length=0,Cn.clear(),eA.clear(),$r.clear(),Ln.clear(),P.transactionalDataSources.clear(),rA=void 0}P.clearAllRegistrations=Mhe;var Pm=[];function Lhe(t){Pm.includes(t)||Pm.push(t)}P.registerLifecycleCallback=Lhe;function Che(){return Pm}P.getLifecycleListeners=Che;var Im=!1,Mm=[];function Dhe(t){if(Im)throw new TypeError("Attempt to provide method middleware after insertion was performed");Mm.includes(t)||Mm.push(t)}P.registerMiddlewareInstaller=Dhe;function xhe(){if(Im)return;Im=!0;let t=r4();for(let e of t)for(let r of e.allRegisteredOperations.values())for(let n of Mm)n.installMiddleware(r)}P.insertAllMiddleware=xhe;var Cn=new Map;function Uhe(t,e){let r=n4(t.constructor);if(r.configuredInstances.has(e))throw new Dn.DBOSConflictingRegistrationError(`An instance of class '${t.constructor.name}' with name '${e}' was already registered.  Earlier registration occurred at:
${(r.configuredInstanceRegLocs.get(e)??[]).join(`
`)}`);r.configuredInstances.set(e,t),r.configuredInstanceRegLocs.set(e,new wi().getCleanStack(3)??[])}function Cm(t){let e="",r=t.name??"";if(Cn.has(t)){let n=Cn.get(t);e=n.getClassName(),r=n.name}return{className:e,name:r}}P.getRegisteredFunctionFullName=Cm;function khe(t){let e=Cm(t);return e.className+"."+e.name}P.getRegisteredFunctionQualifiedName=khe;function Bhe(t){return Cm(t).className}P.getRegisteredFunctionClassName=Bhe;function qhe(t){return Cm(t).name}P.getRegisteredFunctionName=qhe;function Vhe(t,e){e.wrappedFunction=t,Cn.set(t,e)}P.registerFunctionWrapper=Vhe;function nA(t){return Cn.get(t)}P.getFunctionRegistration=nA;function Fhe(t,e){let r=ic(t,!1);if(!r)return;let n=r.registeredOperationsByName.get(e);if(n)return n}P.getFunctionRegistrationByName=Fhe;function XH(t){let e=[];if(typeof t=="function")Do(t,!1).reg?.reg?.allRegisteredOperations?.forEach(n=>e.push(n));else{let r=t;for(;r;)e.push(...XH(r.constructor)),r=Object.getPrototypeOf(r)}return e}P.getRegisteredOperations=XH;var eA=new Map;function iA(t,e,r){let n=t;n&&typeof n!="function"&&(n=n.constructor),r||(r=Object.getOwnPropertyDescriptor(t,e).value);let s=eA.get(r);if(s===void 0){let a;if(t&&(a=function(i,u){let l=Reflect?.getMetadata;if(l)return l("design:paramtypes",i,u)}(t,e)),a)s=a.map((o,i)=>new Da(i,o));else if(r)s=Xb(r).map((i,u)=>new Da(u));else{let o=Object.getOwnPropertyDescriptor(t,e);s=Xb(o?.value).map((u,l)=>new Da(l))}eA.set(r,s)}return s}P.getOrCreateMethodArgsRegistration=iA;function ZH(t,e,r,n,s){let{classReg:a,isInstance:o}=tA(t,e),i=n??r.toString(),u=Cn.get(s)?.origFunction??s;if(!a.allRegisteredOperations.has(u)){let c=new Nm(a,s,o);a.allRegisteredOperations.set(s,c)}let l=a.allRegisteredOperations.get(s);if(l.needInitialized){l.needInitialized=!1,l.name=i,l.className=a.name,l.defaults=a,l.args=iA(t,r,s);let c=Xb(s);l.args.forEach(h=>{h.name||h.index<c.length&&(h.name=c[h.index])});let f=async function(...h){let S=h;for(let g of l.onEnter)S=g.func(l,S);return l.origFunction.call(this,...S)};Object.defineProperty(f,"name",{value:l.name}),l.registeredFunction=f,Cn.set(l.registeredFunction,l),Cn.set(l.origFunction,l)}return l}function $he(t,e,r,n){if(!n.value)throw Error("Use of decorator when original method is undefined");let s=e4(t,void 0,e,r,n.value);return n.value=s.wrappedFunction??s.registeredFunction,{descriptor:n,registration:s}}P.wrapDBOSFunctionAndRegisterByTarget=$he;function e4(t,e,r,n,s){Lm(),n||(n=typeof r=="string"?r:r.toString());let a=nA(s);if(a)return tA(t,e).classReg.registerOperationByName(n,a),a;let o=ZH(t,e,r,n,s);return tA(t,e).classReg.registerOperationByName(n,o),o}P.wrapDBOSFunctionAndRegisterByUniqueName=e4;function Ghe(t,e,r,n){if(!n.value)throw Error("Use of decorator when original method is undefined");let s=Dm(t,void 0,e,r,n.value);return n.value=s.wrappedFunction??s.registeredFunction,{descriptor:n,registration:s}}P.wrapDBOSFunctionAndRegisterDec=Ghe;function Dm(t,e,r,n,s){Lm();let a=nA(s);return a||ZH(t,e,r,n,s)}P.wrapDBOSFunctionAndRegister=Dm;var $r=new Map,Ln=new Map;function t4(t){let e=Do(t,!1);return e.reg?.name||e.regTarget.name}P.getNameForClass=t4;function r4(){let t=new Set;for(let[e,r]of $r)t.add(r.reg);for(let[e,r]of Ln)t.add(r.reg);return t}function Do(t,e){let r;return typeof t=="function"?r=t:r=t.constructor,Ln.has(r)?{regTarget:r,reg:Ln.get(r)}:e?(Ln.set(r,{reg:new nc(r),name:r.name,regloc:new wi().getCleanStack(1)??[]}),{regTarget:r,reg:Ln.get(r)}):{regTarget:r}}P.getClassRegistration=Do;function Whe(){let t=[];for(let[e,r]of $r)t.push(e);return t}P.getAllRegisteredClassNames=Whe;function jhe(){let t=new Set,e=[];for(let[r,n]of Cn)t.has(n)||(e.push(n),t.add(n));return e}P.getAllRegisteredFunctions=jhe;function ic(t,e=!1){if(!$r.has(t)&&!e)throw new Dn.DBOSNotRegisteredError(t,`Class '${t}' is not registered`);$r.has(t)||$r.set(t,{reg:new nc(void 0),regloc:new wi().getCleanStack(1)??[]});let r=$r.get(t).reg;return r.needsInitialized&&(r.name=t,r.needsInitialized=!1),r}P.getClassRegistrationByName=ic;function n4(t){return Do(t,!0).reg.reg}P.getOrCreateClassRegistrationByTarget=n4;function tA(t,e){!t&&e===void 0&&(e="");let r,n=!1;if(t&&(typeof t=="function"?r=t:(r=t.constructor,n=!0)),e===void 0)return{classReg:Do(r,!0).reg.reg,isInstance:n,className:e};if(!r)return{classReg:ic(e,!0),isInstance:!1,className:e};let s=Do(r,!0);if(s.reg.name&&s.reg.name!==e)throw new TypeError(`Attempt to register class under two names: ${s.reg.name} vs. ${e}`);return s.reg.name=e,{classReg:s.reg.reg,isInstance:n,className:e}}function Hhe(t,e){let r=ic(t);return r?r.configuredInstances.get(e)??null:null}P.getConfiguredInstance=Hhe;function Yhe(){function t(e,r){e.name=r,e.needsInitialized=!1;for(let[n,s]of e.registeredOperationsByName)s.className=r}for(let[e,r]of Ln){let n=r.name||r.reg.name||t4(e),s=$r.get(n);if(!s){$r.set(n,{reg:r.reg,ctor:e,regloc:r.regloc}),r.name=n,t(r.reg,n);continue}if(s.ctor&&s.ctor!==e)throw new Dn.DBOSConflictingRegistrationError(`Class ${n}(${e.name}) has been given a name that conflicts with another class ${s.ctor?.name}.`);if(s.reg!==r.reg)throw new Dn.DBOSConflictingRegistrationError(`Class: ${n}(${e.name}) has been given a name that was registered directly by name without a class.`);$r.set(n,{reg:r.reg,ctor:e,regloc:r.regloc}),r.name=n,t(r.reg,n)}}P.finalizeClassRegistrations=Yhe;P.transactionalDataSources=new Map;function zhe(t,e){if(P.transactionalDataSources.has(t)){if(P.transactionalDataSources.get(t)!==e)throw new Dn.DBOSConflictingRegistrationError(`Data source with name ${t} is already registered`);return}Lm(),P.transactionalDataSources.set(t,e)}P.registerTransactionalDataSource=zhe;function Khe(t){if(P.transactionalDataSources.has(t))return P.transactionalDataSources.get(t);throw new Dn.DBOSNotRegisteredError(t,`Data source '${t}' is not registered`)}P.getTransactionalDataSource=Khe;function Qhe(t,e){let r;return typeof e=="string"?r=ic(e,!0):r=Do(e,!0).reg.reg,r.getRegisteredInfo(t)}P.associateClassWithExternal=Qhe;function Jhe(t,e,r,n,s){let a=Dm(e,r,n,n,s);return a.externalRegInfo.has(t)||a.externalRegInfo.set(t,{}),{registration:a,regInfo:a.externalRegInfo.get(t)}}P.associateMethodWithExternal=Jhe;function Xhe(t,e,r,n,s,a){s||(s=Object.getOwnPropertyDescriptor(e,n).value);let o=Dm(e,r,n,n,s),i;if(typeof a=="number"?i=o.args[a]:i=o.args.find(u=>u.name===a),!!i)return i.externalRegInfo.has(t)||i.externalRegInfo.set(t,{}),i.externalRegInfo.get(t)}P.associateParameterWithExternal=Xhe;function Zhe(t,e,r){let n=new Array;if(e){let o;if(typeof e=="string"?o=$r.get(e)?.reg:typeof e=="function"?o=Ln.get(e)?.reg:e!==void 0&&typeof e=="object"&&(o=Ln.get(e.constructor)?.reg),o)if(r){let i=o.registeredOperationsByName.get(r);i&&a(i)}else s(o)}else{let o=r4();for(let i of o)s(i)}return n;function s(o){for(let i of o.allRegisteredOperations.values())a(i)}function a(o){let i=o.externalRegInfo.get(t),u=o.defaults?.externalRegInfo.get(t),l=[],c=!1;for(let f of o.args)f.externalRegInfo.has(t)&&(c=!0),l.push({name:f.name,index:f.index,paramConfig:f.externalRegInfo.get(t)});!i&&!u&&!c||n.push({methodReg:o,methodConfig:i,classConfig:u??{},paramConfig:l})}}P.getRegistrationsForExternal=Zhe;function e_e(t){return function(e,r,n){let a=iA(e,r)[n];a.name=t}}P.ArgName=e_e});var oc=p(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.wfQueueRunner=vi.WorkflowQueue=void 0;var i4=mu(),o4=Om(),oA=gt(),sA=class{name;concurrency;rateLimit;workerConcurrency;priorityEnabled=!1;partitionQueue=!1;constructor(e,r,n){if(this.name=e,i4.DBOS.isInitialized()&&i4.DBOS.logger.warn(`Workflow queue '${e}' is being created after DBOS initialization and will not be considered for dequeue.`),typeof r=="object"&&r!==null?(this.concurrency=r.concurrency,this.rateLimit=r.rateLimit,this.workerConcurrency=r.workerConcurrency,this.priorityEnabled=r.priorityEnabled??!1,this.partitionQueue=r.partitionQueue??!1):(this.concurrency=r,this.rateLimit=n),vi.wfQueueRunner.wfQueuesByName.has(e))throw Error(`Workflow Queue '${e}' defined multiple times`);vi.wfQueueRunner.wfQueuesByName.set(e,this)}};vi.WorkflowQueue=sA;var aA=class{wfQueuesByName=new Map;isRunning=!1;interruptResolve;pollingIntervalMs=1e3;minPollingIntervalMs=1e3;maxPollingIntervalMs=12e4;stop(){this.isRunning&&(this.isRunning=!1,this.interruptResolve&&this.interruptResolve())}clearRegistrations(){this.wfQueuesByName.clear()}async dispatchLoop(e,r){for(this.isRunning=!0;this.isRunning;){let n,s=new Promise(o=>{n=setTimeout(()=>{o()},this.pollingIntervalMs)});if(await Promise.race([s,new Promise((o,i)=>this.interruptResolve=i)]).catch(()=>{e.logger.debug("Workflow queue loop interrupted!")}),clearTimeout(n),!this.isRunning)break;let a;r!==null?a=[...r,this.wfQueuesByName.get(oA.INTERNAL_QUEUE_NAME)]:a=Array.from(this.wfQueuesByName.values());for(let o of a){let i=[];try{if(o.partitionQueue){let u=await e.systemDatabase.getQueuePartitions(o.name);for(let l of u){let c=await e.systemDatabase.findAndMarkStartableWorkflows(o,e.executorID,oA.globalParams.appVersion,l);i.push(...c)}}else i=await e.systemDatabase.findAndMarkStartableWorkflows(o,e.executorID,oA.globalParams.appVersion,void 0)}catch(u){let l=u;"code"in l&&(l.code==="40001"||l.code==="55P03")?(this.pollingIntervalMs=Math.min(this.maxPollingIntervalMs,this.pollingIntervalMs*2),e.logger.warn(`Contention detected in queue thread for ${o.name}. Increasing polling interval to ${(this.pollingIntervalMs/1e3).toFixed(2)}s.`)):e.logger.warn(`Error getting startable workflows: ${l.message}`),i=[]}i.length>0&&await(0,o4.debugTriggerPoint)(o4.DEBUG_TRIGGER_WORKFLOW_QUEUE_START);for(let u of i)try{let l=await e.executeWorkflowId(u,{isQueueDispatch:!0})}catch(l){e.logger.warn(`Could not execute workflow with id ${u}: ${l.message}`)}}this.pollingIntervalMs=Math.max(this.minPollingIntervalMs,this.pollingIntervalMs*.9)}}logRegisteredEndpoints(e){let r=e.logger;r.info("Workflow queues:");for(let[n,s]of this.wfQueuesByName){let a=s.concurrency!==void 0?`global concurrency limit: ${s.concurrency}`:"No concurrency limit set";r.info(`    ${n}: ${a}`);let o=s.workerConcurrency!==void 0?`worker concurrency limit: ${s.workerConcurrency}`:"No worker concurrency limit set";r.info(`    ${n}: ${o}`)}}};vi.wfQueueRunner=new aA});var c4=p(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.TimeMatcher=pn.convertExpression=pn.validateCrontab=pn.convertAsterisksToRanges=void 0;function t_e(t){return t.replace(/\s{2,}/g," ").trim()}function r_e(t){return t.length===5?["0"].concat(t):t}var n_e=["january","february","march","april","may","june","july","august","september","october","november","december"],i_e=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function s4(t,e){for(let r=0;r<e.length;r++)t=t.replace(new RegExp(e[r],"gi"),`${r+1}`);return t}function o_e(t){return t=s4(t,n_e),t=s4(t,i_e),t}var s_e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a_e=["sun","mon","tue","wed","thu","fri","sat"];function a4(t,e){for(let r=0;r<e.length;r++)t=t.replace(new RegExp(e[r],"gi"),`${r}`);return t}function u_e(t){return t=t.replace("7","0"),t=a4(t,s_e),a4(t,a_e)}function Ua(t,e){return t.indexOf("*")!==-1?t.replace("*",e):t}function u4(t){return t[0]=Ua(t[0],"0-59"),t[1]=Ua(t[1],"0-59"),t[2]=Ua(t[2],"0-23"),t[3]=Ua(t[3],"1-31"),t[4]=Ua(t[4],"1-12"),t[5]=Ua(t[5],"0-6"),t}pn.convertAsterisksToRanges=u4;function l_e(t,e,r,n){let s=[],a=parseInt(n),o=parseInt(r);o>a&&(a=parseInt(r),o=parseInt(n));for(let i=o;i<=a;i++)s.push(i.toString());return t.replace(new RegExp(e,"i"),s.join())}function c_e(t){let e=/(\d+)-(\d+)/,r=e.exec(t);for(;r!==null&&r.length>0;)t=l_e(t,r[0],r[1],r[2]),r=e.exec(t);return t}function f_e(t){for(let e=0;e<t.length;e++)t[e]=c_e(t[e]);return t}function d_e(t){let e=/^(.+)\/(\w+)$/;for(let r=0;r<t.length;r++){let n=e.exec(t[r]);if(n!==null&&n.length>0){let a=n[2];if(isNaN(parseInt(a)))throw new Error(a+" is not a valid step value");let o=n[1].split(","),i=[],u=parseInt(a,10);for(let l=0;l<=o.length;l++){let c=parseInt(o[l],10);c%u===0&&i.push(`${c}`)}t[r]=i.join(",")}}return t}function p_e(t){for(let e=0;e<t.length;e++){let r=t[e].split(",");for(let n=0;n<r.length;n++)r[n]=parseInt(r[n]).toString();t[e]=r.join(",")}return t}var h_e=/^(?:\d+|\*|\*\/\d+)$/;function Ba(t,e,r){let n=t.split(",");for(let s of n){let a=parseInt(s,10);if(!Number.isNaN(a)&&(a<e||a>r)||!h_e.test(s))return!1}return!0}function __e(t){return!Ba(t,0,59)}function m_e(t){return!Ba(t,0,59)}function S_e(t){return!Ba(t,0,23)}function E_e(t){return!Ba(t,1,31)}function g_e(t){return!Ba(t,1,12)}function y_e(t){return!Ba(t,0,7)}function T_e(t,e){if(__e(e[0]))throw new Error(`${t[0]} is a invalid expression for second`);if(m_e(e[1]))throw new Error(`${t[1]} is a invalid expression for minute`);if(S_e(e[2]))throw new Error(`${t[2]} is a invalid expression for hour`);if(E_e(e[3]))throw new Error(`${t[3]} is a invalid expression for day of month`);if(g_e(e[4]))throw new Error(`${t[4]} is a invalid expression for month`);if(y_e(e[5]))throw new Error(`${t[5]} is a invalid expression for week day`)}function l4(t){if(typeof t!="string")throw new TypeError("pattern must be a string!");let e=t.split(" "),r=lA(t).split(" ");return e.length===5&&e.unshift("0"),T_e(e,r),r.join(" ")}pn.validateCrontab=l4;function lA(t){let e=t_e(t).split(" ");return e=r_e(e),e[4]=o_e(e[4]),e[5]=u_e(e[5]),e=u4(e),e=f_e(e),e=d_e(e),e=p_e(e),e.join(" ")}pn.convertExpression=lA;function ka(t,e){let r=`${e}`;return t.indexOf(",")!==-1?t.split(",").includes(r):t===r}var uA=class{#e;#t;#r;#n;constructor(e,r){l4(e),this.#e=lA(e),this.#n=r,this.#t=this.#e.split(" "),this.#r=this.#n?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",fractionalSecondDigits:3,timeZone:this.#n}):null}match(e){e=this.#o(e);let r=ka(this.#t[0],e.getSeconds()),n=ka(this.#t[1],e.getMinutes()),s=ka(this.#t[2],e.getHours()),a=this.#i(e);return r&&n&&s&&a}#i(e){let r=ka(this.#t[3],e.getDate()),n=ka(this.#t[4],e.getMonth()+1),s=ka(this.#t[5],e.getDay());return r&&n&&s}nextWakeupTime(e){let r=typeof e=="number"?e:e.getTime(),n=Math.round(r);for(let s=3600;--s;s>0){n+=1e3;let a=new Date(n);if(this.match(a))return a}return new Date(n)}#o(e){return this.#r?new Date(this.#r.format(e)):typeof e=="number"?new Date(e):e}};pn.TimeMatcher=uA});var xm=p(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ScheduledReceiver=qa.SchedulerMode=void 0;var Rt=uc(),w_e=gt(),O_e=c4(),ac;(function(t){t.ExactlyOncePerInterval="ExactlyOncePerInterval",t.ExactlyOncePerIntervalWhenActive="ExactlyOncePerIntervalWhenActive"})(ac||(qa.SchedulerMode=ac={}));var sc="dbos.scheduler",cA=class t{#e=new AbortController;#t=new Array;constructor(){Rt.DBOS.registerLifecycleCallback(this)}async initialize(){for(let e of Rt.DBOS.getAssociatedInfo(sc)){if(e.methodReg.registeredFunction===void 0){Rt.DBOS.logger.warn(`Scheduled workflow ${e.methodReg.className}.${e.methodReg.name} is missing registered function; skipping`);continue}let{crontab:r,mode:n,queueName:s}=e.methodConfig;if(!r){Rt.DBOS.logger.warn(`Scheduled workflow ${e.methodReg.className}.${e.methodReg.name} is missing crontab; skipping`);continue}let a=new O_e.TimeMatcher(r),o=t.#r(e.methodReg,a,n??ac.ExactlyOncePerIntervalWhenActive,s,this.#e.signal);this.#t.push(o)}}async destroy(){this.#e.abort();let e=this.#t.splice(0);await Promise.allSettled(e)}logRegisteredEndpoints(){Rt.DBOS.logger.info("Scheduled endpoints:");for(let e of Rt.DBOS.getAssociatedInfo(sc)){let r=`${e.methodReg.className}.${e.methodReg.name}`,{crontab:n,mode:s}=e.methodConfig;n?Rt.DBOS.logger.info(`    ${r} @ ${n}; ${s??ac.ExactlyOncePerIntervalWhenActive}`):Rt.DBOS.logger.info(`    ${r} is missing crontab; skipping`)}}static async#r(e,r,n,s,a){let o=`${e.className}.${e.name}`,i=new Date().setMilliseconds(0);if(n===ac.ExactlyOncePerInterval){let u=await Rt.DBOS.getEventDispatchState(sc,o,"lastState");u?.value&&(i=parseFloat(u.value))}for(;!a.aborted;){let u=r.nextWakeupTime(i).getTime(),l=u-Date.now();if(l>0){let f=Math.min(l/10,1e4),h=Math.random()*f;l+=h}if(l>0&&await new Promise((f,h)=>{let S,g=()=>{clearTimeout(S),h(new Error("Abort signal received"))};a.addEventListener("abort",g,{once:!0}),a.aborted&&(a.removeEventListener("abort",g),h(new Error("Abort signal received"))),S=setTimeout(()=>{a.removeEventListener("abort",g),f()},l)}),a.aborted)break;if(!r.match(u)){i=u;continue}let c=new Date(u);if(e.workflowConfig&&e.registeredFunction){let f=`sched-${o}-${c.toISOString()}`,h={workflowID:f,queueName:s??w_e.INTERNAL_QUEUE_NAME};Rt.DBOS.logger.debug(`Executing scheduled workflow ${f}`),await Rt.DBOS.startWorkflow(e.registeredFunction,h)(c,new Date)}else Rt.DBOS.logger.error(`${o} is @scheduled but not a workflow`);i=await t.#n(o,u)}}static async#n(e,r){try{let n={service:sc,workflowFnName:e,key:"lastState",value:`${r}`,updateTime:r},s=await Rt.DBOS.upsertEventDispatchState(n),a=parseFloat(s.value);if(a&&a>r)return a}catch(n){let s=n;Rt.DBOS.logger.warn(`Scheduler caught an error writing to system DB: ${s.message}`),Rt.DBOS.logger.error(n)}return r}static registerScheduled(e,r){let{regInfo:n}=Rt.DBOS.associateFunctionWithInfo(sc,e,{ctorOrProto:r.ctorOrProto,className:r.className,name:r.name??e.name}),s=n;s.crontab=r.crontab,s.mode=r.mode,s.queueName=r.queueName}};qa.ScheduledReceiver=cA});var cc=p(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.globalTimeout=Nt.toWorkflowStatus=Nt.forkWorkflow=Nt.listWorkflowSteps=Nt.getWorkflow=Nt.listQueuedWorkflows=Nt.listWorkflows=void 0;var lc=wn(),v_e=require("node:crypto");async function fA(t,e){return(await t.listWorkflows(e)).map(n=>Um(n,t.getSerializer()))}Nt.listWorkflows=fA;async function b_e(t,e){return e.queuesOnly=!0,e.loadOutput=!1,(await t.listWorkflows(e)).map(n=>Um(n,t.getSerializer()))}Nt.listQueuedWorkflows=b_e;async function A_e(t,e){let r=await t.getWorkflowStatus(e);return r?Um(r,t.getSerializer()):void 0}Nt.getWorkflow=A_e;async function R_e(t,e){return await t.getWorkflowStatus(e)?(await t.getAllOperationResults(e)).map(a=>({functionID:a.function_id,name:a.function_name??"",output:a.output?(0,lc.safeParse)(t.getSerializer(),a.output,a.serialization):null,error:a.error?(0,lc.safeParseError)(t.getSerializer(),a.error,a.serialization):null,childWorkflowID:a.child_workflow_id,startedAtEpochMs:a.started_at_epoch_ms,completedAtEpochMs:a.completed_at_epoch_ms})).toSorted((a,o)=>a.functionID-o.functionID):void 0}Nt.listWorkflowSteps=R_e;async function N_e(t,e,r,n={}){let s=n.newWorkflowID??(0,v_e.randomUUID)();return await t.forkWorkflow(e,r,{...n,newWorkflowID:s}),s}Nt.forkWorkflow=N_e;function Um(t,e){return{workflowID:t.workflowUUID,status:t.status,workflowName:t.workflowName,workflowClassName:t.workflowClassName,workflowConfigName:t.workflowConfigName,queueName:t.queueName,authenticatedUser:t.authenticatedUser,assumedRole:t.assumedRole,authenticatedRoles:t.authenticatedRoles,input:t.input?(0,lc.safeParsePositionalArgs)(e,t.input,t.serialization):void 0,output:t.output?(0,lc.safeParse)(e,t.output??null,t.serialization):void 0,error:t.error?(0,lc.safeParseError)(e,t.error,t.serialization):void 0,request:t.request,executorId:t.executorId,applicationVersion:t.applicationVersion,applicationID:t.applicationID,recoveryAttempts:t.recoveryAttempts,createdAt:t.createdAt,updatedAt:t.updatedAt,timeoutMS:t.timeoutMS,deadlineEpochMS:t.deadlineEpochMS,deduplicationID:t.deduplicationID,priority:t.priority,queuePartitionKey:t.queuePartitionKey,dequeuedAt:t.startedAtEpochMs,forkedFrom:t.forkedFrom,parentWorkflowID:t.parentWorkflowID}}Nt.toWorkflowStatus=Um;async function P_e(t,e){let r=new Date(e).toISOString();for(let n of await fA(t,{status:"PENDING",endTime:r}))await t.cancelWorkflow(n.workflowID);for(let n of await fA(t,{status:"ENQUEUED",endTime:r}))await t.cancelWorkflow(n.workflowID)}Nt.globalTimeout=P_e});var mA=p(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.DebouncerClient=bi.Debouncer=bi.debouncerWorkflowFunction=void 0;var f4=require("node:crypto"),br=uc(),d4=Gi(),dA=Oi(),km=dr(),fc=gt(),_A="DEBOUNCER_TOPIC",I_e=async(t,e,...r)=>{let n=r,s=e.debounceTimeoutMs?Date.now()+e.debounceTimeoutMs:Number.MAX_VALUE,a=t;for(;Date.now()<s;){let u=Math.max(s-Date.now(),0),l=Math.min(a,u),c=await br.DBOS.recv(_A,l/1e3);if(c===null)break;n=c.args,a=c.debouncePeriodMs,await br.DBOS.setEvent(c.messageID,c.messageID)}let o=(0,dA.getFunctionRegistrationByName)(e.workflowClassName,e.workflowName);if(!o||!o.registeredFunction)throw Error(`Invalid workflow name provided to debouncer: ${e.workflowName}`);let i=o?.registeredFunction;await br.DBOS.startWorkflow(i,e.startWorkflowParams)(...n)};bi.debouncerWorkflowFunction=I_e;var pA=class{cfg;constructor(e){let r=(0,dA.getFunctionRegistration)(e.workflow);this.cfg={workflowName:r?.name??e.workflow.name,workflowClassName:(0,dA.getRegisteredFunctionClassName)(e.workflow),startWorkflowParams:e.startWorkflowParams,debounceTimeoutMs:e.debounceTimeoutMs}}async debounce(e,r,...n){if(r<=0)throw Error(`debouncePeriodMs must be positive, not ${r}`);let s={...this.cfg};for(s.startWorkflowParams=this.cfg.startWorkflowParams?{...this.cfg.startWorkflowParams}:{},s.startWorkflowParams.workflowID=s.startWorkflowParams.workflowID??await br.DBOS.randomUUID();;){let a=`${s.workflowClassName}.${s.workflowName}-${e}`;try{return await br.DBOS.startWorkflow(d4.DBOSExecutor.debouncerWorkflow,{queueName:fc.INTERNAL_QUEUE_NAME,enqueueOptions:{deduplicationID:a}})(r,s,...n),br.DBOS.retrieveWorkflow(s.startWorkflowParams.workflowID)}catch(o){if(o instanceof Error&&(0,km.getDBOSErrorCode)(o)===km.QueueDedupIDDuplicated){let i=await br.DBOS.runStep(async()=>await d4.DBOSExecutor.globalInstance?.systemDatabase.getDeduplicatedWorkflow(fc.INTERNAL_QUEUE_NAME,a));if(i){let u=await br.DBOS.randomUUID(),l={messageID:u,args:n,debouncePeriodMs:r};if(await br.DBOS.send(i,l,_A),!await br.DBOS.getEvent(i,u,1e3))continue;let S=(await br.DBOS.retrieveWorkflow(i).getWorkflowInputs())[1].startWorkflowParams.workflowID;return br.DBOS.retrieveWorkflow(S)}else continue}else throw o}}}};bi.Debouncer=pA;var hA=class{client;cfg;constructor(e,r){this.client=e,this.cfg={workflowName:r.workflowName,workflowClassName:r.workflowClassName||"",startWorkflowParams:r.startWorkflowParams,debounceTimeoutMs:r.debounceTimeoutMs}}async debounce(e,r,...n){if(r<=0)throw Error(`debouncePeriodMs must be positive, not ${r}`);let s={...this.cfg};for(s.startWorkflowParams=this.cfg.startWorkflowParams?{...this.cfg.startWorkflowParams}:{},s.startWorkflowParams.workflowID=s.startWorkflowParams.workflowID??String((0,f4.randomUUID)());;){let a=`${s.workflowClassName}.${s.workflowName}-${e}`;try{return await this.client.enqueue({workflowName:fc.DEBOUNCER_WORKLOW_NAME,queueName:fc.INTERNAL_QUEUE_NAME,deduplicationID:a},r,s,...n),this.client.retrieveWorkflow(s.startWorkflowParams.workflowID)}catch(o){if(o instanceof Error&&(0,km.getDBOSErrorCode)(o)===km.QueueDedupIDDuplicated){let i=await this.client.systemDatabase.getDeduplicatedWorkflow(fc.INTERNAL_QUEUE_NAME,a);if(i){let u=String((0,f4.randomUUID)()),l={messageID:u,args:n,debouncePeriodMs:r};if(await this.client.send(i,l,_A),!await this.client.getEvent(i,u,1e3))continue;let S=(await this.client.retrieveWorkflow(i).getWorkflowInputs())[1].startWorkflowParams.workflowID;return this.client.retrieveWorkflow(S)}else continue}else throw o}}}};bi.DebouncerClient=hA});var Gi=p(Oe=>{"use strict";var M_e=Oe&&Oe.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),L_e=Oe&&Oe.__setModuleDefault||(Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e}),C_e=Oe&&Oe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&M_e(e,t,r);return L_e(e,t),e};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.DBOSExecutor=Oe.TempWorkflowType=Oe.OperationType=Oe.DBOS_QUEUE_MAX_PRIORITY=Oe.DBOS_QUEUE_MIN_PRIORITY=void 0;var nt=dr(),Gr=Xo(),p4=nP(),Ar=zy(),h4=Uh(),D_e=Zj(),x_e=Am(),_4=require("node:crypto"),cr=Oi(),zt=qm(),SA=of(),Pt=gt(),Kt=wn(),U_e=uc(),Bm=oc(),m4=Om(),k_e=xm(),B_e=C_e(require("crypto")),dc=cc(),q_e=Tm(),V_e=mA(),pc={};Oe.DBOS_QUEUE_MIN_PRIORITY=1;Oe.DBOS_QUEUE_MAX_PRIORITY=2**31-1;Oe.OperationType={HANDLER:"handler",WORKFLOW:"workflow",TRANSACTION:"transaction",STEP:"step"};Oe.TempWorkflowType={step:"step",send:"send"};var EA=class t{config;initialized;systemDatabase;static#e="temp_workflow";telemetryCollector;static defaultNotificationTimeoutSec=60;systemDBSchemaName;logger;ctxLogger;tracer;serializer;#t=void 0;executorID=Pt.globalParams.executorID;static globalInstance=void 0;constructor(e,{systemDatabase:r}={}){if(this.config=e,this.systemDBSchemaName=e.systemDatabaseSchemaName,e.telemetry.OTLPExporter){let n=new D_e.TelemetryExporter(e.telemetry.OTLPExporter);this.telemetryCollector=new p4.TelemetryCollector(n)}else this.telemetryCollector=new p4.TelemetryCollector;this.logger=new h4.GlobalLogger(this.telemetryCollector,this.config.telemetry.logs,this.appName),this.ctxLogger=new h4.DBOSContextualLogger(this.logger,()=>(0,Ar.getActiveSpan)()),this.tracer=new Ar.Tracer(this.telemetryCollector,this.appName),this.serializer=e.serializer,r?(this.logger.debug("Using provided system database"),this.systemDatabase=r):(this.logger.debug("Using Postgres system database"),this.systemDatabase=new x_e.PostgresSystemDatabase(this.config.systemDatabaseUrl,this.logger,this.serializer,this.config.sysDbPoolSize,this.config.systemDatabasePool,this.systemDBSchemaName)),new k_e.ScheduledReceiver,this.initialized=!1,t.globalInstance=this}get appName(){return this.config.name}async init(){if(this.initialized){this.logger.error("Workflow executor already initialized!");return}try{await this.systemDatabase.init()}catch(r){if(r instanceof nt.DBOSInitializationError)throw r;this.logger.error(r);let n="Failed to initialize workflow executor: ";if(r instanceof AggregateError)for(let s of r.errors)n+=`${s.message}; `;else r instanceof Error?n+=r.message:n+=String(r);throw new nt.DBOSInitializationError(n,r instanceof Error?r:void 0)}this.initialized=!0,Pt.globalParams.appVersion===""&&(Pt.globalParams.appVersion=this.computeAppVersion(),Pt.globalParams.wasComputed=!0);let e=(0,cr.getAllRegisteredClassNames)();for(let r of e){let n=(0,cr.getClassRegistrationByName)(r);for(let[s,a]of n.configuredInstances)await a.initialize()}this.logger.info(`Initializing DBOS (v${Pt.globalParams.dbosVersion})`),this.logger.info(`System Database URL: ${(0,q_e.maskDatabaseUrl)(this.config.systemDatabaseUrl)}`),this.logger.info(`Executor ID: ${this.executorID}`),this.logger.info(`Application version: ${Pt.globalParams.appVersion}`),await this.recoverPendingWorkflows([this.executorID]),this.logger.info("DBOS launched!")}async destroy(){try{await this.systemDatabase.awaitRunningWorkflows(),await this.systemDatabase.destroy(),await this.logger.destroy()}catch(e){let r=e;throw this.logger.error(r),e}}#r(e){return{methReg:(0,cr.getFunctionRegistrationByName)(e.workflowClassName,e.workflowName),configuredInst:(0,cr.getConfiguredInstance)(e.workflowClassName,e.workflowConfigName)}}static reviveResultOrError(e,r){if(e.error)throw(0,Kt.deserializeResError)(e.error,e.serialization??null,r);return(0,Kt.deserializeValue)(e.output??null,e.serialization??null,r)}async workflow(e,r,...n){return this.internalWorkflow(e,r,void 0,void 0,...n)}async internalWorkflow(e,r,n,s,...a){let o=r.workflowUUID?r.workflowUUID:(0,_4.randomUUID)(),i=!!r.workflowUUID,u=r.timeoutMS??void 0,l=r.timeoutMS?r.queueName?void 0:Date.now()+r.timeoutMS:r.deadlineEpochMS,c=r?.enqueueOptions?.priority;if(c!==void 0&&(c<Oe.DBOS_QUEUE_MIN_PRIORITY||c>Oe.DBOS_QUEUE_MAX_PRIORITY))throw new nt.DBOSInvalidQueuePriorityError(c,Oe.DBOS_QUEUE_MIN_PRIORITY,Oe.DBOS_QUEUE_MAX_PRIORITY);if(r.queueName&&!this.getQueueByName(r.queueName).priorityEnabled&&c!==void 0)throw Error(`Priority is not enabled for queue ${r.queueName}. Setting priority will not have any effect.`);let f={...(0,zt.getCurrentContextStore)()},h={},S=(0,cr.getFunctionRegistration)(e),g=(0,cr.getRegisteredFunctionFullName)(e),E=g.name,T=g.className,O=t.#e===E||!!r.tempWfType;if(O)r.tempWfName&&(E=r.tempWfName,T=r.tempWfClass??"");else{if(!S||!S.workflowConfig)throw new nt.DBOSNotRegisteredError(e.name);h=S.workflowConfig}let v=h.maxRecoveryAttempts?h.maxRecoveryAttempts:Gr.DEFAULT_MAX_RECOVERY_ATTEMPTS,b=this.tracer.startSpan(E,{status:Gr.StatusString.PENDING,operationUUID:o,operationType:Oe.OperationType.WORKFLOW,operationName:S?.name??e.name,authenticatedUser:f?.authenticatedUser??"",authenticatedRoles:f?.authenticatedRoles??[],assumedRole:f?.assumedRole??""}),N=S?.workflowConfig?.serialization,I=(0,Kt.serializeFunctionInputOutput)(N==="portable"?{positionalArgs:a}:a,[E,"<arguments>"],this.serializer,N);a=N==="portable"?I.deserialized.positionalArgs:I.deserialized;let R={workflowUUID:o,status:r.queueName!==void 0?Gr.StatusString.ENQUEUED:Gr.StatusString.PENDING,workflowName:E,workflowClassName:T,workflowConfigName:r.configuredInstance?.name||"",queueName:r.queueName,output:null,error:null,authenticatedUser:f?.authenticatedUser||"",assumedRole:f?.assumedRole||"",authenticatedRoles:f?.authenticatedRoles||[],request:f?.request||{},executorId:Pt.globalParams.executorID,applicationVersion:Pt.globalParams.appVersion,applicationID:Pt.globalParams.appID,createdAt:Date.now(),timeoutMS:u,deadlineEpochMS:l,input:I.stringified,deduplicationID:r.enqueueOptions?.deduplicationID,priority:c??0,queuePartitionKey:r.enqueueOptions?.queuePartitionKey,parentWorkflowID:n,serialization:I.sername};O&&(R.workflowName=`${t.#e}-${r.tempWfType}-${r.tempWfName}`);let x,C;if(s!==void 0&&n!==void 0){let fe=await this.systemDatabase.getOperationResultAndThrowIfCancelled(n,s);if(fe){if(fe.error)throw(0,Kt.deserializeResError)(fe.error,fe.serialization??null,this.serializer);return new Gr.RetrievedHandle(this.systemDatabase,fe.childWorkflowID)}}let j;try{j=await this.systemDatabase.initWorkflowStatus(R,(0,_4.randomUUID)(),{maxRetries:v,isDequeuedRequest:r.isQueueDispatch,isRecoveryRequest:r.isRecoveryDispatch})}catch(fe){if(fe instanceof nt.DBOSQueueDuplicatedError&&n&&s){let ke=(0,Kt.serializeResError)(fe,this.serializer,void 0);await this.systemDatabase.recordOperationResult(n,s,R.workflowName,!0,Date.now(),{error:ke.serializedValue,serialization:ke.serialization})}throw fe}s!==void 0&&n!==void 0&&await this.systemDatabase.recordOperationResult(n,s,R.workflowName,!0,Date.now(),{childWorkflowID:o}),x=j.deadlineEpochMS,C=j.shouldExecuteOnThisExecutor,await(0,m4.debugTriggerPoint)(m4.DEBUG_TRIGGER_WORKFLOW_ENQUEUE);async function ye(fe,ke,A){let D,me={},st=new Promise((G,It)=>{D=setTimeout(It,ke-Date.now(),me)});try{return await Promise.race([fe,st])}catch(G){throw G===me?(await A.cancelWorkflow(o),await fe.catch(()=>{}),new nt.DBOSWorkflowCancelledError(o)):G}finally{clearTimeout(D)}}let H=this.serializer;async function ue(fe,ke){let A=fe;ke.logger.error(A),A.dbos_already_logged=!0;let D=(0,Kt.serializeResErrorWithSerializer)(A,H,j.serialization??null);R.error=D.serializedValue,R.status=Gr.StatusString.ERROR,await ke.systemDatabase.recordWorkflowError(o,R),b.setStatus({code:Ar.SpanStatusCode.ERROR,message:A.message})}let ot=async()=>{let fe;try{fe=await(0,Ar.runWithTrace)(b,async()=>await(0,zt.runWithParentContext)(f,{presetID:i,workflowTimeoutMS:void 0,deadlineEpochMS:l,workflowId:o,logger:this.ctxLogger,curWFFunctionId:void 0,serializationType:N},()=>{let D=e.call(r.configuredInstance,...a);return x===void 0?D:ye(D,x,this.systemDatabase)}));let A=(0,Kt.serializeFunctionInputOutputWithSerializer)(fe,[E,"<result>"],this.serializer,j.serialization);fe=A.deserialized,R.output=A.stringified,R.status=Gr.StatusString.SUCCESS,await this.systemDatabase.recordWorkflowOutput(o,R),b.setStatus({code:Ar.SpanStatusCode.OK})}catch(ke){if(ke instanceof nt.DBOSWorkflowConflictError)fe=await this.retrieveWorkflow(o).getResult(),b.setAttribute("cached",!0),b.setStatus({code:Ar.SpanStatusCode.OK});else if(ke instanceof nt.DBOSWorkflowCancelledError){if(b.setStatus({code:Ar.SpanStatusCode.ERROR,message:ke.message}),R.error=ke.message,ke.workflowID===o)throw R.status=Gr.StatusString.CANCELLED,ke;{let A=new nt.DBOSAwaitedWorkflowCancelledError(ke.workflowID);throw await ue(A,this),A}}else throw await ue(ke,this),ke}finally{this.tracer.endSpan(b)}return fe};if(C&&(r.queueName===void 0||r.executeWorkflow)&&!this.systemDatabase.checkForRunningWorkflow(o)){let fe=ot();return this.systemDatabase.registerRunningWorkflow(o,fe),new Gr.InvokedHandle(this.systemDatabase,fe,o,e.name)}else return new Gr.RetrievedHandle(this.systemDatabase,o)}getQueueByName(e){let r=Bm.wfQueueRunner.wfQueuesByName.get(e);if(!r)throw new nt.DBOSNotRegisteredError(e,`Workflow queue '${e}' is not defined.`);return r}async runStepTempWF(e,r,...n){return await(await this.startStepTempWF(e,r,void 0,void 0,...n)).getResult()}async startStepTempWF(e,r,n,s,...a){let o=async(...i)=>await this.callStepFunction(e,void 0,void 0,r.configuredInstance??null,...i);return await this.internalWorkflow(o,{...r,tempWfType:Oe.TempWorkflowType.step,tempWfName:(0,cr.getRegisteredFunctionName)(e),tempWfClass:(0,cr.getRegisteredFunctionClassName)(e)},n,s,...a)}async callStepFunction(e,r,n,s,...a){r=r??e.name??"<unnamed>";let o=Date.now();if(n||(n=(0,cr.getFunctionRegistration)(e)?.stepConfig),n===void 0)throw new nt.DBOSNotRegisteredError(r);let i=(0,zt.functionIDGetIncrement)(),u={...(0,zt.getCurrentContextStore)()},l=u.workflowId;await this.systemDatabase.checkIfCanceled(l);let c=3600,f=this.tracer.startSpan(r,{operationUUID:l,operationType:Oe.OperationType.STEP,operationName:r,authenticatedUser:u.authenticatedUser??"",assumedRole:u.assumedRole??"",authenticatedRoles:u.authenticatedRoles??[],retriesAllowed:n.retriesAllowed,intervalSeconds:n.intervalSeconds,maxAttempts:n.maxAttempts,backoffRate:n.backoffRate}),h=await this.systemDatabase.getOperationResultAndThrowIfCancelled(l,i);if(h){if(h.functionName!==r)throw new nt.DBOSUnexpectedStepError(l,i,r,h.functionName??"?");let O=t.reviveResultOrError(h,this.serializer);return f.setAttribute("cached",!0),f.setStatus({code:Ar.SpanStatusCode.OK}),this.tracer.endSpan(f),O}let S=n.maxAttempts??3,g=pc,E=pc,T=[];if(n.retriesAllowed){let O=0,v=n.intervalSeconds??1;for(v>c&&this.logger.warn(`Step config interval exceeds maximum allowed interval, capped to ${c} seconds!`);g===pc&&O++<(S??3);)try{await this.systemDatabase.checkIfCanceled(l);let b;await(0,Ar.runWithTrace)(f,async()=>{await(0,zt.runInStepContext)(u,i,S,O,async()=>{b=await e.call(s,...a)})}),g=b}catch(b){let N=b;T.push(N),this.logger.warn(`Error in step being automatically retried. Attempt ${O} of ${S}. ${N.stack}`),f.addEvent(`Step attempt ${O+1} failed`,{retryIntervalSeconds:v,error:b.message},performance.now()),O<S&&(await(0,Pt.sleepms)(v*1e3),v*=n.backoffRate??2,v=v<c?v:c)}}else try{let O;await(0,Ar.runWithTrace)(f,async()=>{await(0,zt.runInStepContext)(u,i,S,void 0,async()=>{O=await e.call(s,...a)})}),g=O}catch(O){E=O}if(g===pc)throw E=E===pc?new nt.DBOSMaxStepRetriesError(r,S,T):E,await this.systemDatabase.recordOperationResult(l,i,r,!0,o,{error:this.serializer.stringify((0,SA.serializeError)(E)),serialization:this.serializer.name()}),f.setStatus({code:Ar.SpanStatusCode.ERROR,message:E.message}),this.tracer.endSpan(f),E;{let O=(0,Kt.serializeFunctionInputOutput)(g,[r,"<result>"],this.serializer);return await this.systemDatabase.recordOperationResult(l,i,r,!0,o,{output:O.stringified,serialization:O.sername}),f.setStatus({code:Ar.SpanStatusCode.OK}),this.tracer.endSpan(f),O.deserialized}}async runSendTempWF(e,r,n,s,a){let o=async(u,l,c,f)=>{let h=(0,zt.getCurrentContextStore)(),S=(0,zt.functionIDGetIncrement)(),g=(0,Kt.serializeValue)(l,this.serializer,f??void 0);await this.systemDatabase.send(h.workflowId,S,u,g.serializedValue,c,g.serialization)},i=s?e+s:void 0;return(await this.workflow(o,{workflowUUID:i,tempWfType:Oe.TempWorkflowType.send,configuredInstance:null},e,r,n,a)).getResult()}async getEvent(e,r,n=t.defaultNotificationTimeoutSec){let s=await this.systemDatabase.getEvent(e,r,n);return(0,Kt.deserializeValue)(s.serializedValue,s.serialization,this.serializer)}forkWorkflow(e,r,n={}){let s=n.newWorkflowID??(0,zt.getNextWFID)(void 0);return(0,dc.forkWorkflow)(this.systemDatabase,e,r,{...n,newWorkflowID:s})}retrieveWorkflow(e){return new Gr.RetrievedHandle(this.systemDatabase,e)}async runInternalStep(e,r,n,s,a){let o=Date.now(),i=await this.systemDatabase.getOperationResultAndThrowIfCancelled(n,s);if(i){if(i.functionName!==r)throw new nt.DBOSUnexpectedStepError(n,s,r,i.functionName);return t.reviveResultOrError(i,this.serializer)}try{let u=await e(),l=(0,Kt.serializeFunctionInputOutput)(u,[r,"<result>"],this.serializer);return await this.systemDatabase.recordOperationResult(n,s,r,!0,o,{output:l.stringified,childWorkflowID:a}),l.deserialized}catch(u){throw await this.systemDatabase.recordOperationResult(n,s,r,!1,o,{error:this.serializer.stringify((0,SA.serializeError)(u)),childWorkflowID:a}),u}}async getWorkflowStatus(e,r,n){let s=await this.systemDatabase.getWorkflowStatus(e,r,n);return s?(0,dc.toWorkflowStatus)(s,this.serializer):null}async listWorkflows(e){return(0,dc.listWorkflows)(this.systemDatabase,e)}async listQueuedWorkflows(e){return(0,dc.listQueuedWorkflows)(this.systemDatabase,e)}async listWorkflowSteps(e){return(0,dc.listWorkflowSteps)(this.systemDatabase,e)}async recoverPendingWorkflows(e=["local"]){let r=[];for(let n of e){this.logger.debug(`Recovering workflows assigned to executor: ${n}`);let s=await this.systemDatabase.getPendingWorkflows(n,Pt.globalParams.appVersion);s.length>0?this.logger.info(`Recovering ${s.length} workflows from application version ${Pt.globalParams.appVersion}`):this.logger.info(`No workflows to recover from application version ${Pt.globalParams.appVersion}`);for(let a of s){this.logger.debug(`Recovering workflow: ${a.workflowUUID}. Queue name: ${a.queueName}`);try{a.queueName?await this.systemDatabase.clearQueueAssignment(a.workflowUUID)?r.push(this.retrieveWorkflow(a.workflowUUID)):r.push(await this.executeWorkflowId(a.workflowUUID,{isRecoveryDispatch:!0})):r.push(await this.executeWorkflowId(a.workflowUUID,{isRecoveryDispatch:!0}))}catch(o){this.logger.warn(`Recovery of workflow ${a.workflowUUID} failed: ${o.message}`)}}}return r}async initEventReceivers(e){this.#t=Bm.wfQueueRunner.dispatchLoop(this,e);for(let r of(0,cr.getLifecycleListeners)())await r.initialize?.()}async deactivateEventReceivers(e=!0){this.logger.debug("Deactivating lifecycle listeners");for(let r of(0,cr.getLifecycleListeners)())try{await r.destroy?.()}catch(n){let s=n;this.logger.warn(`Error destroying lifecycle listener: ${s.message}`)}if(this.logger.debug("Deactivating queue runner"),e)try{Bm.wfQueueRunner.stop(),await this.#t}catch(r){let n=r;this.logger.warn(`Error destroying wf queue runner: ${n.message}`)}}async executeWorkflowId(e,r){let n=await this.systemDatabase.getWorkflowStatus(e);if(!n)throw this.logger.error(`Failed to find workflow status for workflowUUID: ${e}`),new nt.DBOSError(`Failed to find workflow status for workflow UUID: ${e}`);if(!n?.input)throw this.logger.error(`Failed to find inputs for workflowUUID: ${e}`),new nt.DBOSError(`Failed to find inputs for workflow UUID: ${e}`);let s=(0,Kt.deserializePositionalArgs)(n.input,n.serialization,this.serializer),a=this.#n(e,n),{methReg:o,configuredInst:i}=this.#r(n),u=r?.startNewWorkflow?void 0:e;if(o?.workflowConfig)return await(0,zt.runWithTopContext)(a,async()=>await this.workflow(o.registeredFunction,{workflowUUID:u,configuredInstance:i,queueName:n.queueName,executeWorkflow:!0,deadlineEpochMS:n.deadlineEpochMS,isRecoveryDispatch:!!r?.isRecoveryDispatch,isQueueDispatch:!!r?.isQueueDispatch},...s));let l=n.workflowName,c=l.split("-");if(!c[0].startsWith(t.#e))throw new nt.DBOSError(`Cannot find workflow function for a non-temporary workflow, ID ${e}, class '${n.workflowClassName}', function '${l}'; did you change your code?`);if(c[1]===Oe.TempWorkflowType.step){let f=(0,cr.getFunctionRegistrationByName)(n.workflowClassName,c[2]);if(!f?.stepConfig)throw this.logger.error(`Cannot find step info for ID ${e}, name ${c[2]}`),new nt.DBOSNotRegisteredError(c[2]);return await(0,zt.runWithTopContext)(a,async()=>await this.startStepTempWF(f.registeredFunction,{workflowUUID:u,configuredInstance:i,queueName:n.queueName,executeWorkflow:!0,isRecoveryDispatch:!!r?.isRecoveryDispatch,isQueueDispatch:!!r?.isQueueDispatch},void 0,void 0,...s))}else if(c[1]===Oe.TempWorkflowType.send){let h=async(S,g,E,T)=>{let O=(0,zt.getCurrentContextStore)(),v=(0,zt.functionIDGetIncrement)(),b=(0,Kt.serializeValue)(g,this.serializer,T??void 0);await this.systemDatabase.send(O.workflowId,v,S,b.serializedValue,E,b.serialization)};return await(0,zt.runWithTopContext)(a,async()=>this.workflow(h,{tempWfName:c[2],tempWfType:Oe.TempWorkflowType.send,workflowUUID:u,queueName:n.queueName,executeWorkflow:!0,isRecoveryDispatch:!!r?.isRecoveryDispatch,isQueueDispatch:!!r?.isQueueDispatch},...s))}else throw this.logger.error(`Unrecognized temporary workflow! UUID ${e}, name ${l}`),new nt.DBOSNotRegisteredError(l)}async getEventDispatchState(e,r,n){return await this.systemDatabase.getEventDispatchState(e,r,n)}async upsertEventDispatchState(e){return await this.systemDatabase.upsertEventDispatchState(e)}#n(e,r){let n={};return n.request=r.request,n.authenticatedUser=r.authenticatedUser,n.authenticatedRoles=r.authenticatedRoles,n.assumedRole=r.assumedRole,n.serializationType=r.serialization===Kt.DBOSPortableJSON.name()?"portable":void 0,n}async cancelWorkflow(e){await this.systemDatabase.cancelWorkflow(e),this.logger.info(`Cancelling workflow ${e}`)}async getWorkflowSteps(e){return(await this.systemDatabase.getAllOperationResults(e)).map(n=>({function_id:n.function_id,function_name:n.function_name??"<unknown>",child_workflow_id:n.child_workflow_id,output:n.output!==null?this.serializer.parse(n.output):null,error:n.error!==null?(0,SA.deserializeError)(this.serializer.parse(n.error)):null}))}async resumeWorkflow(e){await this.systemDatabase.resumeWorkflow(e)}async deleteWorkflow(e,r=!1){await this.systemDatabase.deleteWorkflow(e,r),this.logger.info(`Deleted workflow ${e}${r?" and its children":""}`)}computeAppVersion(){let e=B_e.createHash("md5"),r=Array.from((0,cr.getAllRegisteredFunctions)()).filter(n=>n.workflowConfig).map(n=>n.origFunction.toString()).sort();r.push(Pt.globalParams.dbosVersion);for(let n of r)e.update(n);return e.digest("hex")}static internalQueue=void 0;static createInternalQueue(){t.internalQueue===void 0&&(t.internalQueue=new Bm.WorkflowQueue(Pt.INTERNAL_QUEUE_NAME,{}))}static debouncerWorkflow=void 0;static createDebouncerWorkflow(){t.debouncerWorkflow===void 0&&(t.debouncerWorkflow=U_e.DBOS.registerWorkflow(V_e.debouncerWorkflowFunction,{name:Pt.DEBOUNCER_WORKLOW_NAME}))}};Oe.DBOSExecutor=EA});var qm=p(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.runInStepContext=Xe.runWithDataSourceContext=Xe.runWithParentContext=Xe.runWithTopContext=Xe.functionIDGet=Xe.functionIDGetIncrement=Xe.getNextWFID=Xe.getCurrentContextStore=Xe.isInWorkflowCtx=void 0;var F_e=require("async_hooks"),Va=dr(),S4=Gi();function $_e(t){return t.workflowId!==void 0}function G_e(t){return t.workflowId===void 0?!1:!!t.curStepFunctionId}function W_e(t){return t.workflowId===void 0?!1:!!t.curTxFunctionId}function Vm(t){return!(!$_e(t)||G_e(t)||W_e(t))}Xe.isInWorkflowCtx=Vm;var Fm=new F_e.AsyncLocalStorage;function hc(){return Fm.getStore()}Xe.getCurrentContextStore=hc;function j_e(t){let e=t;if(!e){let r=hc(),n=r?.idAssignedForNextWorkflow;n&&(e=n,r.idAssignedForNextWorkflow=void 0)}return e}Xe.getNextWFID=j_e;function H_e(){let t=hc();if(!t)throw new Va.DBOSInvalidWorkflowTransitionError("Attempt to get a call ID number outside of a workflow");if(!Vm(t))throw new Va.DBOSInvalidWorkflowTransitionError("Attempt to get a call ID number in a workflow that is already in a call");return t.curWFFunctionId===void 0&&(t.curWFFunctionId=0),t.curWFFunctionId++}Xe.functionIDGetIncrement=H_e;function Y_e(){let t=hc();if(!t)throw new Va.DBOSInvalidWorkflowTransitionError("Attempt to get a call ID number outside of a workflow");if(!Vm(t))throw new Va.DBOSInvalidWorkflowTransitionError("Attempt to get a call ID number in a workflow that is already in a call");return t.curWFFunctionId===void 0&&(t.curWFFunctionId=0),t.curWFFunctionId}Xe.functionIDGet=Y_e;async function z_e(t,e){return await Fm.run(t,e)}Xe.runWithTopContext=z_e;async function E4(t,e,r){return await Fm.run({...t,...e,parentCtx:t},r)}Xe.runWithParentContext=E4;async function K_e(t,e){let r=hc()??{};return await Fm.run({...r,curTxFunctionId:t,parentCtx:r,logger:S4.DBOSExecutor.globalInstance.ctxLogger},e)}Xe.runWithDataSourceContext=K_e;async function Q_e(t,e,r,n,s){if(!t)throw new Va.DBOSInvalidWorkflowTransitionError;if(!Vm(t))throw new Va.DBOSInvalidWorkflowTransitionError;return await E4(t,{stepStatus:{stepID:e,currentAttempt:n,maxAttempts:n?r:void 0},curStepFunctionId:e,parentCtx:t,logger:S4.DBOSExecutor.globalInstance.ctxLogger},s)}Xe.runInStepContext=Q_e});var ge=p(Et=>{"use strict";var gA=Symbol.for("yaml.alias"),g4=Symbol.for("yaml.document"),$m=Symbol.for("yaml.map"),y4=Symbol.for("yaml.pair"),yA=Symbol.for("yaml.scalar"),Gm=Symbol.for("yaml.seq"),xn=Symbol.for("yaml.node.type"),J_e=t=>!!t&&typeof t=="object"&&t[xn]===gA,X_e=t=>!!t&&typeof t=="object"&&t[xn]===g4,Z_e=t=>!!t&&typeof t=="object"&&t[xn]===$m,eme=t=>!!t&&typeof t=="object"&&t[xn]===y4,T4=t=>!!t&&typeof t=="object"&&t[xn]===yA,tme=t=>!!t&&typeof t=="object"&&t[xn]===Gm;function w4(t){if(t&&typeof t=="object")switch(t[xn]){case $m:case Gm:return!0}return!1}function rme(t){if(t&&typeof t=="object")switch(t[xn]){case gA:case $m:case yA:case Gm:return!0}return!1}var nme=t=>(T4(t)||w4(t))&&!!t.anchor;Et.ALIAS=gA;Et.DOC=g4;Et.MAP=$m;Et.NODE_TYPE=xn;Et.PAIR=y4;Et.SCALAR=yA;Et.SEQ=Gm;Et.hasAnchor=nme;Et.isAlias=J_e;Et.isCollection=w4;Et.isDocument=X_e;Et.isMap=Z_e;Et.isNode=rme;Et.isPair=eme;Et.isScalar=T4;Et.isSeq=tme});var _c=p(TA=>{"use strict";var it=ge(),Qt=Symbol("break visit"),O4=Symbol("skip children"),hn=Symbol("remove node");function Wm(t,e){let r=v4(e);it.isDocument(t)?Fa(null,t.contents,r,Object.freeze([t]))===hn&&(t.contents=null):Fa(null,t,r,Object.freeze([]))}Wm.BREAK=Qt;Wm.SKIP=O4;Wm.REMOVE=hn;function Fa(t,e,r,n){let s=b4(t,e,r,n);if(it.isNode(s)||it.isPair(s))return A4(t,n,s),Fa(t,s,r,n);if(typeof s!="symbol"){if(it.isCollection(e)){n=Object.freeze(n.concat(e));for(let a=0;a<e.items.length;++a){let o=Fa(a,e.items[a],r,n);if(typeof o=="number")a=o-1;else{if(o===Qt)return Qt;o===hn&&(e.items.splice(a,1),a-=1)}}}else if(it.isPair(e)){n=Object.freeze(n.concat(e));let a=Fa("key",e.key,r,n);if(a===Qt)return Qt;a===hn&&(e.key=null);let o=Fa("value",e.value,r,n);if(o===Qt)return Qt;o===hn&&(e.value=null)}}return s}async function jm(t,e){let r=v4(e);it.isDocument(t)?await $a(null,t.contents,r,Object.freeze([t]))===hn&&(t.contents=null):await $a(null,t,r,Object.freeze([]))}jm.BREAK=Qt;jm.SKIP=O4;jm.REMOVE=hn;async function $a(t,e,r,n){let s=await b4(t,e,r,n);if(it.isNode(s)||it.isPair(s))return A4(t,n,s),$a(t,s,r,n);if(typeof s!="symbol"){if(it.isCollection(e)){n=Object.freeze(n.concat(e));for(let a=0;a<e.items.length;++a){let o=await $a(a,e.items[a],r,n);if(typeof o=="number")a=o-1;else{if(o===Qt)return Qt;o===hn&&(e.items.splice(a,1),a-=1)}}}else if(it.isPair(e)){n=Object.freeze(n.concat(e));let a=await $a("key",e.key,r,n);if(a===Qt)return Qt;a===hn&&(e.key=null);let o=await $a("value",e.value,r,n);if(o===Qt)return Qt;o===hn&&(e.value=null)}}return s}function v4(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function b4(t,e,r,n){if(typeof r=="function")return r(t,e,n);if(it.isMap(e))return r.Map?.(t,e,n);if(it.isSeq(e))return r.Seq?.(t,e,n);if(it.isPair(e))return r.Pair?.(t,e,n);if(it.isScalar(e))return r.Scalar?.(t,e,n);if(it.isAlias(e))return r.Alias?.(t,e,n)}function A4(t,e,r){let n=e[e.length-1];if(it.isCollection(n))n.items[t]=r;else if(it.isPair(n))t==="key"?n.key=r:n.value=r;else if(it.isDocument(n))n.contents=r;else{let s=it.isAlias(n)?"alias":"scalar";throw new Error(`Cannot replace node with ${s} parent`)}}TA.visit=Wm;TA.visitAsync=jm});var wA=p(N4=>{"use strict";var R4=ge(),ime=_c(),ome={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},sme=t=>t.replace(/[!,[\]{}]/g,e=>ome[e]),mc=class t{constructor(e,r){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},t.defaultYaml,e),this.tags=Object.assign({},t.defaultTags,r)}clone(){let e=new t(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new t(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:t.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},t.defaultTags);break}return e}add(e,r){this.atNextDocument&&(this.yaml={explicit:t.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},t.defaultTags),this.atNextDocument=!1);let n=e.trim().split(/[ \t]+/),s=n.shift();switch(s){case"%TAG":{if(n.length!==2&&(r(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;let[a,o]=n;return this.tags[a]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,n.length!==1)return r(0,"%YAML directive should contain exactly one part"),!1;let[a]=n;if(a==="1.1"||a==="1.2")return this.yaml.version=a,!0;{let o=/^\d+\.\d+$/.test(a);return r(6,`Unsupported YAML version ${a}`,o),!1}}default:return r(0,`Unknown directive ${s}`,!0),!1}}tagName(e,r){if(e==="!")return"!";if(e[0]!=="!")return r(`Not a valid tag: ${e}`),null;if(e[1]==="<"){let o=e.slice(2,-1);return o==="!"||o==="!!"?(r(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&r("Verbatim tags must end with a >"),o)}let[,n,s]=e.match(/^(.*!)([^!]*)$/s);s||r(`The ${e} tag has no suffix`);let a=this.tags[n];if(a)try{return a+decodeURIComponent(s)}catch(o){return r(String(o)),null}return n==="!"?e:(r(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[r,n]of Object.entries(this.tags))if(e.startsWith(n))return r+sme(e.substring(n.length));return e[0]==="!"?e:`!<${e}>`}toString(e){let r=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags),s;if(e&&n.length>0&&R4.isNode(e.contents)){let a={};ime.visit(e.contents,(o,i)=>{R4.isNode(i)&&i.tag&&(a[i.tag]=!0)}),s=Object.keys(a)}else s=[];for(let[a,o]of n)a==="!!"&&o==="tag:yaml.org,2002:"||(!e||s.some(i=>i.startsWith(o)))&&r.push(`%TAG ${a} ${o}`);return r.join(`
`)}};mc.defaultYaml={explicit:!1,version:"1.2"};mc.defaultTags={"!!":"tag:yaml.org,2002:"};N4.Directives=mc});var Hm=p(Sc=>{"use strict";var P4=ge(),ame=_c();function ume(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){let r=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(r)}return!0}function I4(t){let e=new Set;return ame.visit(t,{Value(r,n){n.anchor&&e.add(n.anchor)}}),e}function M4(t,e){for(let r=1;;++r){let n=`${t}${r}`;if(!e.has(n))return n}}function lme(t,e){let r=[],n=new Map,s=null;return{onAnchor:a=>{r.push(a),s||(s=I4(t));let o=M4(e,s);return s.add(o),o},setAnchors:()=>{for(let a of r){let o=n.get(a);if(typeof o=="object"&&o.anchor&&(P4.isScalar(o.node)||P4.isCollection(o.node)))o.node.anchor=o.anchor;else{let i=new Error("Failed to resolve repeated object (this should not happen)");throw i.source=a,i}}},sourceObjects:n}}Sc.anchorIsValid=ume;Sc.anchorNames=I4;Sc.createNodeAnchors=lme;Sc.findNewAnchor=M4});var OA=p(L4=>{"use strict";function Ec(t,e,r,n){if(n&&typeof n=="object")if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s){let o=n[s],i=Ec(t,n,String(s),o);i===void 0?delete n[s]:i!==o&&(n[s]=i)}else if(n instanceof Map)for(let s of Array.from(n.keys())){let a=n.get(s),o=Ec(t,n,s,a);o===void 0?n.delete(s):o!==a&&n.set(s,o)}else if(n instanceof Set)for(let s of Array.from(n)){let a=Ec(t,n,s,s);a===void 0?n.delete(s):a!==s&&(n.delete(s),n.add(a))}else for(let[s,a]of Object.entries(n)){let o=Ec(t,n,s,a);o===void 0?delete n[s]:o!==a&&(n[s]=o)}return t.call(e,r,n)}L4.applyReviver=Ec});var Ai=p(D4=>{"use strict";var cme=ge();function C4(t,e,r){if(Array.isArray(t))return t.map((n,s)=>C4(n,String(s),r));if(t&&typeof t.toJSON=="function"){if(!r||!cme.hasAnchor(t))return t.toJSON(e,r);let n={aliasCount:0,count:1,res:void 0};r.anchors.set(t,n),r.onCreate=a=>{n.res=a,delete r.onCreate};let s=t.toJSON(e,r);return r.onCreate&&r.onCreate(s),s}return typeof t=="bigint"&&!r?.keep?Number(t):t}D4.toJS=C4});var Ym=p(U4=>{"use strict";var fme=OA(),x4=ge(),dme=Ai(),vA=class{constructor(e){Object.defineProperty(this,x4.NODE_TYPE,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:r,maxAliasCount:n,onAnchor:s,reviver:a}={}){if(!x4.isDocument(e))throw new TypeError("A document argument is required");let o={anchors:new Map,doc:e,keep:!0,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof n=="number"?n:100},i=dme.toJS(this,"",o);if(typeof s=="function")for(let{count:u,res:l}of o.anchors.values())s(l,u);return typeof a=="function"?fme.applyReviver(a,{"":i},"",i):i}};U4.NodeBase=vA});var gc=p(B4=>{"use strict";var pme=Hm(),k4=_c(),zm=ge(),hme=Ym(),_me=Ai(),bA=class extends hme.NodeBase{constructor(e){super(zm.ALIAS),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let r;return k4.visit(e,{Node:(n,s)=>{if(s===this)return k4.visit.BREAK;s.anchor===this.source&&(r=s)}}),r}toJSON(e,r){if(!r)return{source:this.source};let{anchors:n,doc:s,maxAliasCount:a}=r,o=this.resolve(s);if(!o){let u=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(u)}let i=n.get(o);if(i||(_me.toJS(o,null,r),i=n.get(o)),!i||i.res===void 0){let u="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(u)}if(a>=0&&(i.count+=1,i.aliasCount===0&&(i.aliasCount=Km(s,o,n)),i.count*i.aliasCount>a)){let u="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(u)}return i.res}toString(e,r,n){let s=`*${this.source}`;if(e){if(pme.anchorIsValid(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(a)}if(e.implicitKey)return`${s} `}return s}};function Km(t,e,r){if(zm.isAlias(e)){let n=e.resolve(t),s=r&&n&&r.get(n);return s?s.count*s.aliasCount:0}else if(zm.isCollection(e)){let n=0;for(let s of e.items){let a=Km(t,s,r);a>n&&(n=a)}return n}else if(zm.isPair(e)){let n=Km(t,e.key,r),s=Km(t,e.value,r);return Math.max(n,s)}return 1}B4.Alias=bA});var Ze=p(AA=>{"use strict";var mme=ge(),Sme=Ym(),Eme=Ai(),gme=t=>!t||typeof t!="function"&&typeof t!="object",Ri=class extends Sme.NodeBase{constructor(e){super(mme.SCALAR),this.value=e}toJSON(e,r){return r?.keep?this.value:Eme.toJS(this.value,e,r)}toString(){return String(this.value)}};Ri.BLOCK_FOLDED="BLOCK_FOLDED";Ri.BLOCK_LITERAL="BLOCK_LITERAL";Ri.PLAIN="PLAIN";Ri.QUOTE_DOUBLE="QUOTE_DOUBLE";Ri.QUOTE_SINGLE="QUOTE_SINGLE";AA.Scalar=Ri;AA.isScalarValue=gme});var yc=p(V4=>{"use strict";var yme=gc(),xo=ge(),q4=Ze(),Tme="tag:yaml.org,2002:";function wme(t,e,r){if(e){let n=r.filter(a=>a.tag===e),s=n.find(a=>!a.format)??n[0];if(!s)throw new Error(`Tag ${e} not found`);return s}return r.find(n=>n.identify?.(t)&&!n.format)}function Ome(t,e,r){if(xo.isDocument(t)&&(t=t.contents),xo.isNode(t))return t;if(xo.isPair(t)){let f=r.schema[xo.MAP].createNode?.(r.schema,null,r);return f.items.push(t),f}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());let{aliasDuplicateObjects:n,onAnchor:s,onTagObj:a,schema:o,sourceObjects:i}=r,u;if(n&&t&&typeof t=="object"){if(u=i.get(t),u)return u.anchor||(u.anchor=s(t)),new yme.Alias(u.anchor);u={anchor:null,node:null},i.set(t,u)}e?.startsWith("!!")&&(e=Tme+e.slice(2));let l=wme(t,e,o.tags);if(!l){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){let f=new q4.Scalar(t);return u&&(u.node=f),f}l=t instanceof Map?o[xo.MAP]:Symbol.iterator in Object(t)?o[xo.SEQ]:o[xo.MAP]}a&&(a(l),delete r.onTagObj);let c=l?.createNode?l.createNode(r.schema,t,r):typeof l?.nodeClass?.from=="function"?l.nodeClass.from(r.schema,t,r):new q4.Scalar(t);return e?c.tag=e:l.default||(c.tag=l.tag),u&&(u.node=c),c}V4.createNode=Ome});var Xm=p(Jm=>{"use strict";var vme=yc(),_n=ge(),bme=Ym();function RA(t,e,r){let n=r;for(let s=e.length-1;s>=0;--s){let a=e[s];if(typeof a=="number"&&Number.isInteger(a)&&a>=0){let o=[];o[a]=n,n=o}else n=new Map([[a,n]])}return vme.createNode(n,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}var F4=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done,Qm=class extends bme.NodeBase{constructor(e,r){super(e),Object.defineProperty(this,"schema",{value:r,configurable:!0,enumerable:!1,writable:!0})}clone(e){let r=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(r.schema=e),r.items=r.items.map(n=>_n.isNode(n)||_n.isPair(n)?n.clone(e):n),this.range&&(r.range=this.range.slice()),r}addIn(e,r){if(F4(e))this.add(r);else{let[n,...s]=e,a=this.get(n,!0);if(_n.isCollection(a))a.addIn(s,r);else if(a===void 0&&this.schema)this.set(n,RA(this.schema,s,r));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${s}`)}}deleteIn(e){let[r,...n]=e;if(n.length===0)return this.delete(r);let s=this.get(r,!0);if(_n.isCollection(s))return s.deleteIn(n);throw new Error(`Expected YAML collection at ${r}. Remaining path: ${n}`)}getIn(e,r){let[n,...s]=e,a=this.get(n,!0);return s.length===0?!r&&_n.isScalar(a)?a.value:a:_n.isCollection(a)?a.getIn(s,r):void 0}hasAllNullValues(e){return this.items.every(r=>{if(!_n.isPair(r))return!1;let n=r.value;return n==null||e&&_n.isScalar(n)&&n.value==null&&!n.commentBefore&&!n.comment&&!n.tag})}hasIn(e){let[r,...n]=e;if(n.length===0)return this.has(r);let s=this.get(r,!0);return _n.isCollection(s)?s.hasIn(n):!1}setIn(e,r){let[n,...s]=e;if(s.length===0)this.set(n,r);else{let a=this.get(n,!0);if(_n.isCollection(a))a.setIn(s,r);else if(a===void 0&&this.schema)this.set(n,RA(this.schema,s,r));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${s}`)}}};Qm.maxFlowStringSingleLineLength=60;Jm.Collection=Qm;Jm.collectionFromPath=RA;Jm.isEmptyPath=F4});var Tc=p(Zm=>{"use strict";var Ame=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function NA(t,e){return/^\n+$/.test(t)?t.substring(1):e?t.replace(/^(?! *$)/gm,e):t}var Rme=(t,e,r)=>t.endsWith(`
`)?NA(r,e):r.includes(`
`)?`
`+NA(r,e):(t.endsWith(" ")?"":" ")+r;Zm.indentComment=NA;Zm.lineComment=Rme;Zm.stringifyComment=Ame});var G4=p(wc=>{"use strict";var Nme="flow",PA="block",eS="quoted";function Pme(t,e,r="flow",{indentAtStart:n,lineWidth:s=80,minContentWidth:a=20,onFold:o,onOverflow:i}={}){if(!s||s<0)return t;let u=Math.max(1+a,1+s-e.length);if(t.length<=u)return t;let l=[],c={},f=s-e.length;typeof n=="number"&&(n>s-Math.max(2,a)?l.push(0):f=s-n);let h,S,g=!1,E=-1,T=-1,O=-1;r===PA&&(E=$4(t,E,e.length),E!==-1&&(f=E+u));for(let b;b=t[E+=1];){if(r===eS&&b==="\\"){switch(T=E,t[E+1]){case"x":E+=3;break;case"u":E+=5;break;case"U":E+=9;break;default:E+=1}O=E}if(b===`
`)r===PA&&(E=$4(t,E,e.length)),f=E+e.length+u,h=void 0;else{if(b===" "&&S&&S!==" "&&S!==`
`&&S!=="	"){let N=t[E+1];N&&N!==" "&&N!==`
`&&N!=="	"&&(h=E)}if(E>=f)if(h)l.push(h),f=h+u,h=void 0;else if(r===eS){for(;S===" "||S==="	";)S=b,b=t[E+=1],g=!0;let N=E>O+1?E-2:T-1;if(c[N])return t;l.push(N),c[N]=!0,f=N+u,h=void 0}else g=!0}S=b}if(g&&i&&i(),l.length===0)return t;o&&o();let v=t.slice(0,l[0]);for(let b=0;b<l.length;++b){let N=l[b],I=l[b+1]||t.length;N===0?v=`
${e}${t.slice(0,I)}`:(r===eS&&c[N]&&(v+=`${t[N]}\\`),v+=`
${e}${t.slice(N+1,I)}`)}return v}function $4(t,e,r){let n=e,s=e+1,a=t[s];for(;a===" "||a==="	";)if(e<s+r)a=t[++e];else{do a=t[++e];while(a&&a!==`
`);n=e,s=e+1,a=t[s]}return n}wc.FOLD_BLOCK=PA;wc.FOLD_FLOW=Nme;wc.FOLD_QUOTED=eS;wc.foldFlowLines=Pme});var vc=p(W4=>{"use strict";var mn=Ze(),Ni=G4(),rS=(t,e)=>({indentAtStart:e?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),nS=t=>/^(%|---|\.\.\.)/m.test(t);function Ime(t,e,r){if(!e||e<0)return!1;let n=e-r,s=t.length;if(s<=n)return!1;for(let a=0,o=0;a<s;++a)if(t[a]===`
`){if(a-o>n)return!0;if(o=a+1,s-o<=n)return!1}return!0}function Oc(t,e){let r=JSON.stringify(t);if(e.options.doubleQuotedAsJSON)return r;let{implicitKey:n}=e,s=e.options.doubleQuotedMinMultiLineLength,a=e.indent||(nS(t)?"  ":""),o="",i=0;for(let u=0,l=r[u];l;l=r[++u])if(l===" "&&r[u+1]==="\\"&&r[u+2]==="n"&&(o+=r.slice(i,u)+"\\ ",u+=1,i=u,l="\\"),l==="\\")switch(r[u+1]){case"u":{o+=r.slice(i,u);let c=r.substr(u+2,4);switch(c){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:c.substr(0,2)==="00"?o+="\\x"+c.substr(2):o+=r.substr(u,6)}u+=5,i=u+1}break;case"n":if(n||r[u+2]==='"'||r.length<s)u+=1;else{for(o+=r.slice(i,u)+`

`;r[u+2]==="\\"&&r[u+3]==="n"&&r[u+4]!=='"';)o+=`
`,u+=2;o+=a,r[u+2]===" "&&(o+="\\"),u+=1,i=u+1}break;default:u+=1}return o=i?o+r.slice(i):r,n?o:Ni.foldFlowLines(o,a,Ni.FOLD_QUOTED,rS(e,!1))}function IA(t,e){if(e.options.singleQuote===!1||e.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return Oc(t,e);let r=e.indent||(nS(t)?"  ":""),n="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${r}`)+"'";return e.implicitKey?n:Ni.foldFlowLines(n,r,Ni.FOLD_FLOW,rS(e,!1))}function Ga(t,e){let{singleQuote:r}=e.options,n;if(r===!1)n=Oc;else{let s=t.includes('"'),a=t.includes("'");s&&!a?n=IA:a&&!s?n=Oc:n=r?IA:Oc}return n(t,e)}var MA;try{MA=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{MA=/\n+(?!\n|$)/g}function tS({comment:t,type:e,value:r},n,s,a){let{blockQuote:o,commentString:i,lineWidth:u}=n.options;if(!o||/\n[\t ]+$/.test(r)||/^\s*$/.test(r))return Ga(r,n);let l=n.indent||(n.forceBlockIndent||nS(r)?"  ":""),c=o==="literal"?!0:o==="folded"||e===mn.Scalar.BLOCK_FOLDED?!1:e===mn.Scalar.BLOCK_LITERAL?!0:!Ime(r,u,l.length);if(!r)return c?`|
`:`>
`;let f,h;for(h=r.length;h>0;--h){let R=r[h-1];if(R!==`
`&&R!=="	"&&R!==" ")break}let S=r.substring(h),g=S.indexOf(`
`);g===-1?f="-":r===S||g!==S.length-1?(f="+",a&&a()):f="",S&&(r=r.slice(0,-S.length),S[S.length-1]===`
`&&(S=S.slice(0,-1)),S=S.replace(MA,`$&${l}`));let E=!1,T,O=-1;for(T=0;T<r.length;++T){let R=r[T];if(R===" ")E=!0;else if(R===`
`)O=T;else break}let v=r.substring(0,O<T?O+1:T);v&&(r=r.substring(v.length),v=v.replace(/\n+/g,`$&${l}`));let N=(c?"|":">")+(E?l?"2":"1":"")+f;if(t&&(N+=" "+i(t.replace(/ ?[\r\n]+/g," ")),s&&s()),c)return r=r.replace(/\n+/g,`$&${l}`),`${N}
${l}${v}${r}${S}`;r=r.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${l}`);let I=Ni.foldFlowLines(`${v}${r}${S}`,l,Ni.FOLD_BLOCK,rS(n,!0));return`${N}
${l}${I}`}function Mme(t,e,r,n){let{type:s,value:a}=t,{actualString:o,implicitKey:i,indent:u,indentStep:l,inFlow:c}=e;if(i&&a.includes(`
`)||c&&/[[\]{},]/.test(a))return Ga(a,e);if(!a||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return i||c||!a.includes(`
`)?Ga(a,e):tS(t,e,r,n);if(!i&&!c&&s!==mn.Scalar.PLAIN&&a.includes(`
`))return tS(t,e,r,n);if(nS(a)){if(u==="")return e.forceBlockIndent=!0,tS(t,e,r,n);if(i&&u===l)return Ga(a,e)}let f=a.replace(/\n+/g,`$&
${u}`);if(o){let h=E=>E.default&&E.tag!=="tag:yaml.org,2002:str"&&E.test?.test(f),{compat:S,tags:g}=e.doc.schema;if(g.some(h)||S?.some(h))return Ga(a,e)}return i?f:Ni.foldFlowLines(f,u,Ni.FOLD_FLOW,rS(e,!1))}function Lme(t,e,r,n){let{implicitKey:s,inFlow:a}=e,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)}),{type:i}=t;i!==mn.Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(i=mn.Scalar.QUOTE_DOUBLE);let u=c=>{switch(c){case mn.Scalar.BLOCK_FOLDED:case mn.Scalar.BLOCK_LITERAL:return s||a?Ga(o.value,e):tS(o,e,r,n);case mn.Scalar.QUOTE_DOUBLE:return Oc(o.value,e);case mn.Scalar.QUOTE_SINGLE:return IA(o.value,e);case mn.Scalar.PLAIN:return Mme(o,e,r,n);default:return null}},l=u(i);if(l===null){let{defaultKeyType:c,defaultStringType:f}=e.options,h=s&&c||f;if(l=u(h),l===null)throw new Error(`Unsupported default string type ${h}`)}return l}W4.stringifyString=Lme});var bc=p(LA=>{"use strict";var Cme=Hm(),Pi=ge(),Dme=Tc(),xme=vc();function Ume(t,e){let r=Object.assign({blockQuote:!0,commentString:Dme.stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,e),n;switch(r.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:t,flowCollectionPadding:r.flowCollectionPadding?" ":"",indent:"",indentStep:typeof r.indent=="number"?" ".repeat(r.indent):"  ",inFlow:n,options:r}}function kme(t,e){if(e.tag){let s=t.filter(a=>a.tag===e.tag);if(s.length>0)return s.find(a=>a.format===e.format)??s[0]}let r,n;if(Pi.isScalar(e)){n=e.value;let s=t.filter(a=>a.identify?.(n));r=s.find(a=>a.format===e.format)??s.find(a=>!a.format)}else n=e,r=t.find(s=>s.nodeClass&&n instanceof s.nodeClass);if(!r){let s=n?.constructor?.name??typeof n;throw new Error(`Tag not resolved for ${s} value`)}return r}function Bme(t,e,{anchors:r,doc:n}){if(!n.directives)return"";let s=[],a=(Pi.isScalar(t)||Pi.isCollection(t))&&t.anchor;a&&Cme.anchorIsValid(a)&&(r.add(a),s.push(`&${a}`));let o=t.tag?t.tag:e.default?null:e.tag;return o&&s.push(n.directives.tagString(o)),s.join(" ")}function qme(t,e,r,n){if(Pi.isPair(t))return t.toString(e,r,n);if(Pi.isAlias(t)){if(e.doc.directives)return t.toString(e);if(e.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(t):e.resolvedAliases=new Set([t]),t=t.resolve(e.doc)}let s,a=Pi.isNode(t)?t:e.doc.createNode(t,{onTagObj:u=>s=u});s||(s=kme(e.doc.schema.tags,a));let o=Bme(a,s,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);let i=typeof s.stringify=="function"?s.stringify(a,e,r,n):Pi.isScalar(a)?xme.stringifyString(a,e,r,n):a.toString(e,r,n);return o?Pi.isScalar(a)||i[0]==="{"||i[0]==="["?`${o} ${i}`:`${o}
${e.indent}${i}`:i}LA.createStringifyContext=Ume;LA.stringify=qme});var z4=p(Y4=>{"use strict";var Ii=ge(),j4=Ze(),H4=bc(),Ac=Tc();function Vme({key:t,value:e},r,n,s){let{allNullValues:a,doc:o,indent:i,indentStep:u,options:{commentString:l,indentSeq:c,simpleKeys:f}}=r,h=Ii.isNode(t)&&t.comment||null;if(f){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(Ii.isCollection(t)){let x="With simple keys, collection cannot be used as a key value";throw new Error(x)}}let S=!f&&(!t||h&&e==null&&!r.inFlow||Ii.isCollection(t)||(Ii.isScalar(t)?t.type===j4.Scalar.BLOCK_FOLDED||t.type===j4.Scalar.BLOCK_LITERAL:typeof t=="object"));r=Object.assign({},r,{allNullValues:!1,implicitKey:!S&&(f||!a),indent:i+u});let g=!1,E=!1,T=H4.stringify(t,r,()=>g=!0,()=>E=!0);if(!S&&!r.inFlow&&T.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");S=!0}if(r.inFlow){if(a||e==null)return g&&n&&n(),T===""?"?":S?`? ${T}`:T}else if(a&&!f||e==null&&S)return T=`? ${T}`,h&&!g?T+=Ac.lineComment(T,r.indent,l(h)):E&&s&&s(),T;g&&(h=null),S?(h&&(T+=Ac.lineComment(T,r.indent,l(h))),T=`? ${T}
${i}:`):(T=`${T}:`,h&&(T+=Ac.lineComment(T,r.indent,l(h))));let O,v,b;Ii.isNode(e)?(O=!!e.spaceBefore,v=e.commentBefore,b=e.comment):(O=!1,v=null,b=null,e&&typeof e=="object"&&(e=o.createNode(e))),r.implicitKey=!1,!S&&!h&&Ii.isScalar(e)&&(r.indentAtStart=T.length+1),E=!1,!c&&u.length>=2&&!r.inFlow&&!S&&Ii.isSeq(e)&&!e.flow&&!e.tag&&!e.anchor&&(r.indent=r.indent.substring(2));let N=!1,I=H4.stringify(e,r,()=>N=!0,()=>E=!0),R=" ";if(h||O||v){if(R=O?`
`:"",v){let x=l(v);R+=`
${Ac.indentComment(x,r.indent)}`}I===""&&!r.inFlow?R===`
`&&(R=`

`):R+=`
${r.indent}`}else if(!S&&Ii.isCollection(e)){let x=I[0],C=I.indexOf(`
`),j=C!==-1,ye=r.inFlow??e.flow??e.items.length===0;if(j||!ye){let H=!1;if(j&&(x==="&"||x==="!")){let ue=I.indexOf(" ");x==="&"&&ue!==-1&&ue<C&&I[ue+1]==="!"&&(ue=I.indexOf(" ",ue+1)),(ue===-1||C<ue)&&(H=!0)}H||(R=`
${r.indent}`)}}else(I===""||I[0]===`
`)&&(R="");return T+=R+I,r.inFlow?N&&n&&n():b&&!N?T+=Ac.lineComment(T,r.indent,l(b)):E&&s&&s(),T}Y4.stringifyPair=Vme});var DA=p(CA=>{"use strict";function Fme(t,...e){t==="debug"&&console.log(...e)}function $me(t,e){(t==="debug"||t==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}CA.debug=Fme;CA.warn=$me});var kA=p(Q4=>{"use strict";var Gme=DA(),Wme=bc(),Wa=ge(),jme=Ze(),xA=Ai(),K4="<<";function Hme(t,e,{key:r,value:n}){if(t?.doc.schema.merge&&Yme(r))if(n=Wa.isAlias(n)?n.resolve(t.doc):n,Wa.isSeq(n))for(let s of n.items)UA(t,e,s);else if(Array.isArray(n))for(let s of n)UA(t,e,s);else UA(t,e,n);else{let s=xA.toJS(r,"",t);if(e instanceof Map)e.set(s,xA.toJS(n,s,t));else if(e instanceof Set)e.add(s);else{let a=zme(r,s,t),o=xA.toJS(n,a,t);a in e?Object.defineProperty(e,a,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[a]=o}}return e}var Yme=t=>t===K4||Wa.isScalar(t)&&t.value===K4&&(!t.type||t.type===jme.Scalar.PLAIN);function UA(t,e,r){let n=t&&Wa.isAlias(r)?r.resolve(t.doc):r;if(!Wa.isMap(n))throw new Error("Merge sources must be maps or map aliases");let s=n.toJSON(null,t,Map);for(let[a,o]of s)e instanceof Map?e.has(a)||e.set(a,o):e instanceof Set?e.add(a):Object.prototype.hasOwnProperty.call(e,a)||Object.defineProperty(e,a,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function zme(t,e,r){if(e===null)return"";if(typeof e!="object")return String(e);if(Wa.isNode(t)&&r?.doc){let n=Wme.createStringifyContext(r.doc,{});n.anchors=new Set;for(let a of r.anchors.keys())n.anchors.add(a.anchor);n.inFlow=!0,n.inStringifyKey=!0;let s=t.toString(n);if(!r.mapKeyWarned){let a=JSON.stringify(s);a.length>40&&(a=a.substring(0,36)+'..."'),Gme.warn(r.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${a}. Set mapAsMap: true to use object keys.`),r.mapKeyWarned=!0}return s}return JSON.stringify(e)}Q4.addPairToJSMap=Hme});var Mi=p(BA=>{"use strict";var J4=yc(),Kme=z4(),Qme=kA(),iS=ge();function Jme(t,e,r){let n=J4.createNode(t,void 0,r),s=J4.createNode(e,void 0,r);return new oS(n,s)}var oS=class t{constructor(e,r=null){Object.defineProperty(this,iS.NODE_TYPE,{value:iS.PAIR}),this.key=e,this.value=r}clone(e){let{key:r,value:n}=this;return iS.isNode(r)&&(r=r.clone(e)),iS.isNode(n)&&(n=n.clone(e)),new t(r,n)}toJSON(e,r){let n=r?.mapAsMap?new Map:{};return Qme.addPairToJSMap(r,n,this)}toString(e,r,n){return e?.doc?Kme.stringifyPair(this,e,r,n):JSON.stringify(this)}};BA.Pair=oS;BA.createPair=Jme});var qA=p(Z4=>{"use strict";var Uo=ge(),X4=bc(),sS=Tc();function Xme(t,e,r){return(e.inFlow??t.flow?eSe:Zme)(t,e,r)}function Zme({comment:t,items:e},r,{blockItemPrefix:n,flowChars:s,itemIndent:a,onChompKeep:o,onComment:i}){let{indent:u,options:{commentString:l}}=r,c=Object.assign({},r,{indent:a,type:null}),f=!1,h=[];for(let g=0;g<e.length;++g){let E=e[g],T=null;if(Uo.isNode(E))!f&&E.spaceBefore&&h.push(""),aS(r,h,E.commentBefore,f),E.comment&&(T=E.comment);else if(Uo.isPair(E)){let v=Uo.isNode(E.key)?E.key:null;v&&(!f&&v.spaceBefore&&h.push(""),aS(r,h,v.commentBefore,f))}f=!1;let O=X4.stringify(E,c,()=>T=null,()=>f=!0);T&&(O+=sS.lineComment(O,a,l(T))),f&&T&&(f=!1),h.push(n+O)}let S;if(h.length===0)S=s.start+s.end;else{S=h[0];for(let g=1;g<h.length;++g){let E=h[g];S+=E?`
${u}${E}`:`
`}}return t?(S+=`
`+sS.indentComment(l(t),u),i&&i()):f&&o&&o(),S}function eSe({items:t},e,{flowChars:r,itemIndent:n}){let{indent:s,indentStep:a,flowCollectionPadding:o,options:{commentString:i}}=e;n+=a;let u=Object.assign({},e,{indent:n,inFlow:!0,type:null}),l=!1,c=0,f=[];for(let g=0;g<t.length;++g){let E=t[g],T=null;if(Uo.isNode(E))E.spaceBefore&&f.push(""),aS(e,f,E.commentBefore,!1),E.comment&&(T=E.comment);else if(Uo.isPair(E)){let v=Uo.isNode(E.key)?E.key:null;v&&(v.spaceBefore&&f.push(""),aS(e,f,v.commentBefore,!1),v.comment&&(l=!0));let b=Uo.isNode(E.value)?E.value:null;b?(b.comment&&(T=b.comment),b.commentBefore&&(l=!0)):E.value==null&&v?.comment&&(T=v.comment)}T&&(l=!0);let O=X4.stringify(E,u,()=>T=null);g<t.length-1&&(O+=","),T&&(O+=sS.lineComment(O,n,i(T))),!l&&(f.length>c||O.includes(`
`))&&(l=!0),f.push(O),c=f.length}let{start:h,end:S}=r;if(f.length===0)return h+S;if(!l){let g=f.reduce((E,T)=>E+T.length+2,2);l=e.options.lineWidth>0&&g>e.options.lineWidth}if(l){let g=h;for(let E of f)g+=E?`
${a}${s}${E}`:`
`;return`${g}
${s}${S}`}else return`${h}${o}${f.join(" ")}${o}${S}`}function aS({indent:t,options:{commentString:e}},r,n,s){if(n&&s&&(n=n.replace(/^\n+/,"")),n){let a=sS.indentComment(e(n),t);r.push(a.trimStart())}}Z4.stringifyCollection=Xme});var Ci=p(FA=>{"use strict";var tSe=qA(),rSe=kA(),nSe=Xm(),Li=ge(),uS=Mi(),iSe=Ze();function Rc(t,e){let r=Li.isScalar(e)?e.value:e;for(let n of t)if(Li.isPair(n)&&(n.key===e||n.key===r||Li.isScalar(n.key)&&n.key.value===r))return n}var VA=class extends nSe.Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(Li.MAP,e),this.items=[]}static from(e,r,n){let{keepUndefined:s,replacer:a}=n,o=new this(e),i=(u,l)=>{if(typeof a=="function")l=a.call(r,u,l);else if(Array.isArray(a)&&!a.includes(u))return;(l!==void 0||s)&&o.items.push(uS.createPair(u,l,n))};if(r instanceof Map)for(let[u,l]of r)i(u,l);else if(r&&typeof r=="object")for(let u of Object.keys(r))i(u,r[u]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,r){let n;Li.isPair(e)?n=e:!e||typeof e!="object"||!("key"in e)?n=new uS.Pair(e,e?.value):n=new uS.Pair(e.key,e.value);let s=Rc(this.items,n.key),a=this.schema?.sortMapEntries;if(s){if(!r)throw new Error(`Key ${n.key} already set`);Li.isScalar(s.value)&&iSe.isScalarValue(n.value)?s.value.value=n.value:s.value=n.value}else if(a){let o=this.items.findIndex(i=>a(n,i)<0);o===-1?this.items.push(n):this.items.splice(o,0,n)}else this.items.push(n)}delete(e){let r=Rc(this.items,e);return r?this.items.splice(this.items.indexOf(r),1).length>0:!1}get(e,r){let s=Rc(this.items,e)?.value;return(!r&&Li.isScalar(s)?s.value:s)??void 0}has(e){return!!Rc(this.items,e)}set(e,r){this.add(new uS.Pair(e,r),!0)}toJSON(e,r,n){let s=n?new n:r?.mapAsMap?new Map:{};r?.onCreate&&r.onCreate(s);for(let a of this.items)rSe.addPairToJSMap(r,s,a);return s}toString(e,r,n){if(!e)return JSON.stringify(this);for(let s of this.items)if(!Li.isPair(s))throw new Error(`Map items must all be pairs; found ${JSON.stringify(s)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),tSe.stringifyCollection(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:n,onComment:r})}};FA.YAMLMap=VA;FA.findPair=Rc});var ja=p(tY=>{"use strict";var oSe=ge(),eY=Ci(),sSe={collection:"map",default:!0,nodeClass:eY.YAMLMap,tag:"tag:yaml.org,2002:map",resolve(t,e){return oSe.isMap(t)||e("Expected a mapping for this tag"),t},createNode:(t,e,r)=>eY.YAMLMap.from(t,e,r)};tY.map=sSe});var Di=p(rY=>{"use strict";var aSe=yc(),uSe=qA(),lSe=Xm(),cS=ge(),cSe=Ze(),fSe=Ai(),$A=class extends lSe.Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(cS.SEQ,e),this.items=[]}add(e){this.items.push(e)}delete(e){let r=lS(e);return typeof r!="number"?!1:this.items.splice(r,1).length>0}get(e,r){let n=lS(e);if(typeof n!="number")return;let s=this.items[n];return!r&&cS.isScalar(s)?s.value:s}has(e){let r=lS(e);return typeof r=="number"&&r<this.items.length}set(e,r){let n=lS(e);if(typeof n!="number")throw new Error(`Expected a valid index, not ${e}.`);let s=this.items[n];cS.isScalar(s)&&cSe.isScalarValue(r)?s.value=r:this.items[n]=r}toJSON(e,r){let n=[];r?.onCreate&&r.onCreate(n);let s=0;for(let a of this.items)n.push(fSe.toJS(a,String(s++),r));return n}toString(e,r,n){return e?uSe.stringifyCollection(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:n,onComment:r}):JSON.stringify(this)}static from(e,r,n){let{replacer:s}=n,a=new this(e);if(r&&Symbol.iterator in Object(r)){let o=0;for(let i of r){if(typeof s=="function"){let u=r instanceof Set?i:String(o++);i=s.call(r,u,i)}a.items.push(aSe.createNode(i,void 0,n))}}return a}};function lS(t){let e=cS.isScalar(t)?t.value:t;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}rY.YAMLSeq=$A});var Ha=p(iY=>{"use strict";var dSe=ge(),nY=Di(),pSe={collection:"seq",default:!0,nodeClass:nY.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve(t,e){return dSe.isSeq(t)||e("Expected a sequence for this tag"),t},createNode:(t,e,r)=>nY.YAMLSeq.from(t,e,r)};iY.seq=pSe});var Nc=p(oY=>{"use strict";var hSe=vc(),_Se={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,e,r,n){return e=Object.assign({actualString:!0},e),hSe.stringifyString(t,e,r,n)}};oY.string=_Se});var fS=p(uY=>{"use strict";var sY=Ze(),aY={identify:t=>t==null,createNode:()=>new sY.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new sY.Scalar(null),stringify:({source:t},e)=>typeof t=="string"&&aY.test.test(t)?t:e.options.nullStr};uY.nullTag=aY});var GA=p(cY=>{"use strict";var mSe=Ze(),lY={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new mSe.Scalar(t[0]==="t"||t[0]==="T"),stringify({source:t,value:e},r){if(t&&lY.test.test(t)){let n=t[0]==="t"||t[0]==="T";if(e===n)return t}return e?r.options.trueStr:r.options.falseStr}};cY.boolTag=lY});var Ya=p(fY=>{"use strict";function SSe({format:t,minFractionDigits:e,tag:r,value:n}){if(typeof n=="bigint")return String(n);let s=typeof n=="number"?n:Number(n);if(!isFinite(s))return isNaN(s)?".nan":s<0?"-.inf":".inf";let a=JSON.stringify(n);if(!t&&e&&(!r||r==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let i=e-(a.length-o-1);for(;i-- >0;)a+="0"}return a}fY.stringifyNumber=SSe});var jA=p(dS=>{"use strict";var ESe=Ze(),WA=Ya(),gSe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:WA.stringifyNumber},ySe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){let e=Number(t.value);return isFinite(e)?e.toExponential():WA.stringifyNumber(t)}},TSe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){let e=new ESe.Scalar(parseFloat(t)),r=t.indexOf(".");return r!==-1&&t[t.length-1]==="0"&&(e.minFractionDigits=t.length-r-1),e},stringify:WA.stringifyNumber};dS.float=TSe;dS.floatExp=ySe;dS.floatNaN=gSe});var YA=p(hS=>{"use strict";var dY=Ya(),pS=t=>typeof t=="bigint"||Number.isInteger(t),HA=(t,e,r,{intAsBigInt:n})=>n?BigInt(t):parseInt(t.substring(e),r);function pY(t,e,r){let{value:n}=t;return pS(n)&&n>=0?r+n.toString(e):dY.stringifyNumber(t)}var wSe={identify:t=>pS(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,e,r)=>HA(t,2,8,r),stringify:t=>pY(t,8,"0o")},OSe={identify:pS,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,e,r)=>HA(t,0,10,r),stringify:dY.stringifyNumber},vSe={identify:t=>pS(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,e,r)=>HA(t,2,16,r),stringify:t=>pY(t,16,"0x")};hS.int=OSe;hS.intHex=vSe;hS.intOct=wSe});var _Y=p(hY=>{"use strict";var bSe=ja(),ASe=fS(),RSe=Ha(),NSe=Nc(),PSe=GA(),zA=jA(),KA=YA(),ISe=[bSe.map,RSe.seq,NSe.string,ASe.nullTag,PSe.boolTag,KA.intOct,KA.int,KA.intHex,zA.floatNaN,zA.floatExp,zA.float];hY.schema=ISe});var EY=p(SY=>{"use strict";var MSe=Ze(),LSe=ja(),CSe=Ha();function mY(t){return typeof t=="bigint"||Number.isInteger(t)}var _S=({value:t})=>JSON.stringify(t),DSe=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:_S},{identify:t=>t==null,createNode:()=>new MSe.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:_S},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:t=>t==="true",stringify:_S},{identify:mY,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,e,{intAsBigInt:r})=>r?BigInt(t):parseInt(t,10),stringify:({value:t})=>mY(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:_S}],xSe={default:!0,tag:"",test:/^/,resolve(t,e){return e(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},USe=[LSe.map,CSe.seq].concat(DSe,xSe);SY.schema=USe});var JA=p(gY=>{"use strict";var QA=Ze(),kSe=vc(),BSe={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,e){if(typeof Buffer=="function")return Buffer.from(t,"base64");if(typeof atob=="function"){let r=atob(t.replace(/[\n\r]/g,"")),n=new Uint8Array(r.length);for(let s=0;s<r.length;++s)n[s]=r.charCodeAt(s);return n}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:e,value:r},n,s,a){let o=r,i;if(typeof Buffer=="function")i=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let u="";for(let l=0;l<o.length;++l)u+=String.fromCharCode(o[l]);i=btoa(u)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=QA.Scalar.BLOCK_LITERAL),e!==QA.Scalar.QUOTE_DOUBLE){let u=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),l=Math.ceil(i.length/u),c=new Array(l);for(let f=0,h=0;f<l;++f,h+=u)c[f]=i.substr(h,u);i=c.join(e===QA.Scalar.BLOCK_LITERAL?`
`:" ")}return kSe.stringifyString({comment:t,type:e,value:i},n,s,a)}};gY.binary=BSe});var ES=p(SS=>{"use strict";var mS=ge(),XA=Mi(),qSe=Ze(),VSe=Di();function yY(t,e){if(mS.isSeq(t))for(let r=0;r<t.items.length;++r){let n=t.items[r];if(!mS.isPair(n)){if(mS.isMap(n)){n.items.length>1&&e("Each pair must have its own sequence indicator");let s=n.items[0]||new XA.Pair(new qSe.Scalar(null));if(n.commentBefore&&(s.key.commentBefore=s.key.commentBefore?`${n.commentBefore}
${s.key.commentBefore}`:n.commentBefore),n.comment){let a=s.value??s.key;a.comment=a.comment?`${n.comment}
${a.comment}`:n.comment}n=s}t.items[r]=mS.isPair(n)?n:new XA.Pair(n)}}else e("Expected a sequence for this tag");return t}function TY(t,e,r){let{replacer:n}=r,s=new VSe.YAMLSeq(t);s.tag="tag:yaml.org,2002:pairs";let a=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof n=="function"&&(o=n.call(e,String(a++),o));let i,u;if(Array.isArray(o))if(o.length===2)i=o[0],u=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){let l=Object.keys(o);if(l.length===1)i=l[0],u=o[i];else throw new TypeError(`Expected tuple with one key, not ${l.length} keys`)}else i=o;s.items.push(XA.createPair(i,u,r))}return s}var FSe={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:yY,createNode:TY};SS.createPairs=TY;SS.pairs=FSe;SS.resolvePairs=yY});var t0=p(e0=>{"use strict";var wY=ge(),ZA=Ai(),Pc=Ci(),$Se=Di(),OY=ES(),ko=class t extends $Se.YAMLSeq{constructor(){super(),this.add=Pc.YAMLMap.prototype.add.bind(this),this.delete=Pc.YAMLMap.prototype.delete.bind(this),this.get=Pc.YAMLMap.prototype.get.bind(this),this.has=Pc.YAMLMap.prototype.has.bind(this),this.set=Pc.YAMLMap.prototype.set.bind(this),this.tag=t.tag}toJSON(e,r){if(!r)return super.toJSON(e);let n=new Map;r?.onCreate&&r.onCreate(n);for(let s of this.items){let a,o;if(wY.isPair(s)?(a=ZA.toJS(s.key,"",r),o=ZA.toJS(s.value,a,r)):a=ZA.toJS(s,"",r),n.has(a))throw new Error("Ordered maps must not include duplicate keys");n.set(a,o)}return n}static from(e,r,n){let s=OY.createPairs(e,r,n),a=new this;return a.items=s.items,a}};ko.tag="tag:yaml.org,2002:omap";var GSe={collection:"seq",identify:t=>t instanceof Map,nodeClass:ko,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,e){let r=OY.resolvePairs(t,e),n=[];for(let{key:s}of r.items)wY.isScalar(s)&&(n.includes(s.value)?e(`Ordered maps must not include duplicate keys: ${s.value}`):n.push(s.value));return Object.assign(new ko,r)},createNode:(t,e,r)=>ko.from(t,e,r)};e0.YAMLOMap=ko;e0.omap=GSe});var NY=p(r0=>{"use strict";var vY=Ze();function bY({value:t,source:e},r){return e&&(t?AY:RY).test.test(e)?e:t?r.options.trueStr:r.options.falseStr}var AY={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new vY.Scalar(!0),stringify:bY},RY={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new vY.Scalar(!1),stringify:bY};r0.falseTag=RY;r0.trueTag=AY});var PY=p(gS=>{"use strict";var WSe=Ze(),n0=Ya(),jSe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:n0.stringifyNumber},HSe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){let e=Number(t.value);return isFinite(e)?e.toExponential():n0.stringifyNumber(t)}},YSe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){let e=new WSe.Scalar(parseFloat(t.replace(/_/g,""))),r=t.indexOf(".");if(r!==-1){let n=t.substring(r+1).replace(/_/g,"");n[n.length-1]==="0"&&(e.minFractionDigits=n.length)}return e},stringify:n0.stringifyNumber};gS.float=YSe;gS.floatExp=HSe;gS.floatNaN=jSe});var MY=p(Mc=>{"use strict";var IY=Ya(),Ic=t=>typeof t=="bigint"||Number.isInteger(t);function yS(t,e,r,{intAsBigInt:n}){let s=t[0];if((s==="-"||s==="+")&&(e+=1),t=t.substring(e).replace(/_/g,""),n){switch(r){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}let o=BigInt(t);return s==="-"?BigInt(-1)*o:o}let a=parseInt(t,r);return s==="-"?-1*a:a}function i0(t,e,r){let{value:n}=t;if(Ic(n)){let s=n.toString(e);return n<0?"-"+r+s.substr(1):r+s}return IY.stringifyNumber(t)}var zSe={identify:Ic,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,e,r)=>yS(t,2,2,r),stringify:t=>i0(t,2,"0b")},KSe={identify:Ic,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,e,r)=>yS(t,1,8,r),stringify:t=>i0(t,8,"0")},QSe={identify:Ic,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,e,r)=>yS(t,0,10,r),stringify:IY.stringifyNumber},JSe={identify:Ic,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,e,r)=>yS(t,2,16,r),stringify:t=>i0(t,16,"0x")};Mc.int=QSe;Mc.intBin=zSe;Mc.intHex=JSe;Mc.intOct=KSe});var s0=p(o0=>{"use strict";var OS=ge(),TS=Mi(),wS=Ci(),Bo=class t extends wS.YAMLMap{constructor(e){super(e),this.tag=t.tag}add(e){let r;OS.isPair(e)?r=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?r=new TS.Pair(e.key,null):r=new TS.Pair(e,null),wS.findPair(this.items,r.key)||this.items.push(r)}get(e,r){let n=wS.findPair(this.items,e);return!r&&OS.isPair(n)?OS.isScalar(n.key)?n.key.value:n.key:n}set(e,r){if(typeof r!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof r}`);let n=wS.findPair(this.items,e);n&&!r?this.items.splice(this.items.indexOf(n),1):!n&&r&&this.items.push(new TS.Pair(e))}toJSON(e,r){return super.toJSON(e,r,Set)}toString(e,r,n){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),r,n);throw new Error("Set items must all have null values")}static from(e,r,n){let{replacer:s}=n,a=new this(e);if(r&&Symbol.iterator in Object(r))for(let o of r)typeof s=="function"&&(o=s.call(r,o,o)),a.items.push(TS.createPair(o,null,n));return a}};Bo.tag="tag:yaml.org,2002:set";var XSe={collection:"map",identify:t=>t instanceof Set,nodeClass:Bo,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,e,r)=>Bo.from(t,e,r),resolve(t,e){if(OS.isMap(t)){if(t.hasAllNullValues(!0))return Object.assign(new Bo,t);e("Set items must all have null values")}else e("Expected a mapping for this tag");return t}};o0.YAMLSet=Bo;o0.set=XSe});var u0=p(vS=>{"use strict";var ZSe=Ya();function a0(t,e){let r=t[0],n=r==="-"||r==="+"?t.substring(1):t,s=o=>e?BigInt(o):Number(o),a=n.replace(/_/g,"").split(":").reduce((o,i)=>o*s(60)+s(i),s(0));return r==="-"?s(-1)*a:a}function LY(t){let{value:e}=t,r=o=>o;if(typeof e=="bigint")r=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ZSe.stringifyNumber(t);let n="";e<0&&(n="-",e*=r(-1));let s=r(60),a=[e%s];return e<60?a.unshift(0):(e=(e-a[0])/s,a.unshift(e%s),e>=60&&(e=(e-a[0])/s,a.unshift(e))),n+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var eEe={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:r})=>a0(t,r),stringify:LY},tEe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>a0(t,!1),stringify:LY},CY={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){let e=t.match(CY.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,r,n,s,a,o,i]=e.map(Number),u=e[7]?Number((e[7]+"00").substr(1,3)):0,l=Date.UTC(r,n-1,s,a||0,o||0,i||0,u),c=e[8];if(c&&c!=="Z"){let f=a0(c,!1);Math.abs(f)<30&&(f*=60),l-=6e4*f}return new Date(l)},stringify:({value:t})=>t.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")};vS.floatTime=tEe;vS.intTime=eEe;vS.timestamp=CY});var UY=p(xY=>{"use strict";var rEe=ja(),nEe=fS(),iEe=Ha(),oEe=Nc(),sEe=JA(),DY=NY(),l0=PY(),bS=MY(),aEe=t0(),uEe=ES(),lEe=s0(),c0=u0(),cEe=[rEe.map,iEe.seq,oEe.string,nEe.nullTag,DY.trueTag,DY.falseTag,bS.intBin,bS.intOct,bS.int,bS.intHex,l0.floatNaN,l0.floatExp,l0.float,sEe.binary,aEe.omap,uEe.pairs,lEe.set,c0.intTime,c0.floatTime,c0.timestamp];xY.schema=cEe});var HY=p(p0=>{"use strict";var VY=ja(),fEe=fS(),FY=Ha(),dEe=Nc(),pEe=GA(),f0=jA(),d0=YA(),hEe=_Y(),_Ee=EY(),$Y=JA(),GY=t0(),WY=ES(),kY=UY(),jY=s0(),AS=u0(),BY=new Map([["core",hEe.schema],["failsafe",[VY.map,FY.seq,dEe.string]],["json",_Ee.schema],["yaml11",kY.schema],["yaml-1.1",kY.schema]]),qY={binary:$Y.binary,bool:pEe.boolTag,float:f0.float,floatExp:f0.floatExp,floatNaN:f0.floatNaN,floatTime:AS.floatTime,int:d0.int,intHex:d0.intHex,intOct:d0.intOct,intTime:AS.intTime,map:VY.map,null:fEe.nullTag,omap:GY.omap,pairs:WY.pairs,seq:FY.seq,set:jY.set,timestamp:AS.timestamp},mEe={"tag:yaml.org,2002:binary":$Y.binary,"tag:yaml.org,2002:omap":GY.omap,"tag:yaml.org,2002:pairs":WY.pairs,"tag:yaml.org,2002:set":jY.set,"tag:yaml.org,2002:timestamp":AS.timestamp};function SEe(t,e){let r=BY.get(e);if(!r)if(Array.isArray(t))r=[];else{let n=Array.from(BY.keys()).filter(s=>s!=="yaml11").map(s=>JSON.stringify(s)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${n} or define customTags array`)}if(Array.isArray(t))for(let n of t)r=r.concat(n);else typeof t=="function"&&(r=t(r.slice()));return r.map(n=>{if(typeof n!="string")return n;let s=qY[n];if(s)return s;let a=Object.keys(qY).map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown custom tag "${n}"; use one of ${a}`)})}p0.coreKnownTags=mEe;p0.getTags=SEe});var m0=p(YY=>{"use strict";var h0=ge(),EEe=ja(),gEe=Ha(),yEe=Nc(),RS=HY(),TEe=(t,e)=>t.key<e.key?-1:t.key>e.key?1:0,_0=class t{constructor({compat:e,customTags:r,merge:n,resolveKnownTags:s,schema:a,sortMapEntries:o,toStringDefaults:i}){this.compat=Array.isArray(e)?RS.getTags(e,"compat"):e?RS.getTags(null,e):null,this.merge=!!n,this.name=typeof a=="string"&&a||"core",this.knownTags=s?RS.coreKnownTags:{},this.tags=RS.getTags(r,this.name),this.toStringOptions=i??null,Object.defineProperty(this,h0.MAP,{value:EEe.map}),Object.defineProperty(this,h0.SCALAR,{value:yEe.string}),Object.defineProperty(this,h0.SEQ,{value:gEe.seq}),this.sortMapEntries=typeof o=="function"?o:o===!0?TEe:null}clone(){let e=Object.create(t.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};YY.Schema=_0});var KY=p(zY=>{"use strict";var wEe=ge(),S0=bc(),Lc=Tc();function OEe(t,e){let r=[],n=e.directives===!0;if(e.directives!==!1&&t.directives){let u=t.directives.toString(t);u?(r.push(u),n=!0):t.directives.docStart&&(n=!0)}n&&r.push("---");let s=S0.createStringifyContext(t,e),{commentString:a}=s.options;if(t.commentBefore){r.length!==1&&r.unshift("");let u=a(t.commentBefore);r.unshift(Lc.indentComment(u,""))}let o=!1,i=null;if(t.contents){if(wEe.isNode(t.contents)){if(t.contents.spaceBefore&&n&&r.push(""),t.contents.commentBefore){let c=a(t.contents.commentBefore);r.push(Lc.indentComment(c,""))}s.forceBlockIndent=!!t.comment,i=t.contents.comment}let u=i?void 0:()=>o=!0,l=S0.stringify(t.contents,s,()=>i=null,u);i&&(l+=Lc.lineComment(l,"",a(i))),(l[0]==="|"||l[0]===">")&&r[r.length-1]==="---"?r[r.length-1]=`--- ${l}`:r.push(l)}else r.push(S0.stringify(t.contents,s));if(t.directives?.docEnd)if(t.comment){let u=a(t.comment);u.includes(`
`)?(r.push("..."),r.push(Lc.indentComment(u,""))):r.push(`... ${u}`)}else r.push("...");else{let u=t.comment;u&&o&&(u=u.replace(/^\n+/,"")),u&&((!o||i)&&r[r.length-1]!==""&&r.push(""),r.push(Lc.indentComment(a(u),"")))}return r.join(`
`)+`
`}zY.stringifyDocument=OEe});var Cc=p(QY=>{"use strict";var vEe=gc(),za=Xm(),Rr=ge(),bEe=Mi(),AEe=Ai(),REe=m0(),NEe=KY(),E0=Hm(),PEe=OA(),IEe=yc(),g0=wA(),y0=class t{constructor(e,r,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Rr.NODE_TYPE,{value:Rr.DOC});let s=null;typeof r=="function"||Array.isArray(r)?s=r:n===void 0&&r&&(n=r,r=void 0);let a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},n);this.options=a;let{version:o}=a;n?._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new g0.Directives({version:o}),this.setSchema(o,n),this.contents=e===void 0?null:this.createNode(e,s,n)}clone(){let e=Object.create(t.prototype,{[Rr.NODE_TYPE]:{value:Rr.DOC}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=Rr.isNode(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Ka(this.contents)&&this.contents.add(e)}addIn(e,r){Ka(this.contents)&&this.contents.addIn(e,r)}createAlias(e,r){if(!e.anchor){let n=E0.anchorNames(this);e.anchor=!r||n.has(r)?E0.findNewAnchor(r||"a",n):r}return new vEe.Alias(e.anchor)}createNode(e,r,n){let s;if(typeof r=="function")e=r.call({"":e},"",e),s=r;else if(Array.isArray(r)){let T=v=>typeof v=="number"||v instanceof String||v instanceof Number,O=r.filter(T).map(String);O.length>0&&(r=r.concat(O)),s=r}else n===void 0&&r&&(n=r,r=void 0);let{aliasDuplicateObjects:a,anchorPrefix:o,flow:i,keepUndefined:u,onTagObj:l,tag:c}=n??{},{onAnchor:f,setAnchors:h,sourceObjects:S}=E0.createNodeAnchors(this,o||"a"),g={aliasDuplicateObjects:a??!0,keepUndefined:u??!1,onAnchor:f,onTagObj:l,replacer:s,schema:this.schema,sourceObjects:S},E=IEe.createNode(e,c,g);return i&&Rr.isCollection(E)&&(E.flow=!0),h(),E}createPair(e,r,n={}){let s=this.createNode(e,null,n),a=this.createNode(r,null,n);return new bEe.Pair(s,a)}delete(e){return Ka(this.contents)?this.contents.delete(e):!1}deleteIn(e){return za.isEmptyPath(e)?this.contents==null?!1:(this.contents=null,!0):Ka(this.contents)?this.contents.deleteIn(e):!1}get(e,r){return Rr.isCollection(this.contents)?this.contents.get(e,r):void 0}getIn(e,r){return za.isEmptyPath(e)?!r&&Rr.isScalar(this.contents)?this.contents.value:this.contents:Rr.isCollection(this.contents)?this.contents.getIn(e,r):void 0}has(e){return Rr.isCollection(this.contents)?this.contents.has(e):!1}hasIn(e){return za.isEmptyPath(e)?this.contents!==void 0:Rr.isCollection(this.contents)?this.contents.hasIn(e):!1}set(e,r){this.contents==null?this.contents=za.collectionFromPath(this.schema,[e],r):Ka(this.contents)&&this.contents.set(e,r)}setIn(e,r){za.isEmptyPath(e)?this.contents=r:this.contents==null?this.contents=za.collectionFromPath(this.schema,Array.from(e),r):Ka(this.contents)&&this.contents.setIn(e,r)}setSchema(e,r={}){typeof e=="number"&&(e=String(e));let n;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new g0.Directives({version:"1.1"}),n={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new g0.Directives({version:e}),n={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{let s=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${s}`)}}if(r.schema instanceof Object)this.schema=r.schema;else if(n)this.schema=new REe.Schema(Object.assign(n,r));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:r,mapAsMap:n,maxAliasCount:s,onAnchor:a,reviver:o}={}){let i={anchors:new Map,doc:this,keep:!e,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},u=AEe.toJS(this.contents,r??"",i);if(typeof a=="function")for(let{count:l,res:c}of i.anchors.values())a(c,l);return typeof o=="function"?PEe.applyReviver(o,{"":u},"",u):u}toJSON(e,r){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:r})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){let r=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${r}`)}return NEe.stringifyDocument(this,e)}};function Ka(t){if(Rr.isCollection(t))return!0;throw new Error("Expected a YAML collection as document contents")}QY.Document=y0});var Uc=p(xc=>{"use strict";var Dc=class extends Error{constructor(e,r,n,s){super(),this.name=e,this.code=n,this.message=s,this.pos=r}},T0=class extends Dc{constructor(e,r,n){super("YAMLParseError",e,r,n)}},w0=class extends Dc{constructor(e,r,n){super("YAMLWarning",e,r,n)}},MEe=(t,e)=>r=>{if(r.pos[0]===-1)return;r.linePos=r.pos.map(i=>e.linePos(i));let{line:n,col:s}=r.linePos[0];r.message+=` at line ${n}, column ${s}`;let a=s-1,o=t.substring(e.lineStarts[n-1],e.lineStarts[n]).replace(/[\n\r]+$/,"");if(a>=60&&o.length>80){let i=Math.min(a-39,o.length-79);o="\u2026"+o.substring(i),a-=i-1}if(o.length>80&&(o=o.substring(0,79)+"\u2026"),n>1&&/^ *$/.test(o.substring(0,a))){let i=t.substring(e.lineStarts[n-2],e.lineStarts[n-1]);i.length>80&&(i=i.substring(0,79)+`\u2026
`),o=i+o}if(/[^ ]/.test(o)){let i=1,u=r.linePos[1];u&&u.line===n&&u.col>s&&(i=Math.max(1,Math.min(u.col-s,80-a)));let l=" ".repeat(a)+"^".repeat(i);r.message+=`:

${o}
${l}
`}};xc.YAMLError=Dc;xc.YAMLParseError=T0;xc.YAMLWarning=w0;xc.prettifyError=MEe});var kc=p(JY=>{"use strict";function LEe(t,{flow:e,indicator:r,next:n,offset:s,onError:a,startOnNewline:o}){let i=!1,u=o,l=o,c="",f="",h=!1,S=!1,g=!1,E=null,T=null,O=null,v=null,b=null;for(let R of t)switch(g&&(R.type!=="space"&&R.type!=="newline"&&R.type!=="comma"&&a(R.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g=!1),R.type){case"space":!e&&u&&r!=="doc-start"&&R.source[0]==="	"&&a(R,"TAB_AS_INDENT","Tabs are not allowed as indentation"),l=!0;break;case"comment":{l||a(R,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let x=R.source.substring(1)||" ";c?c+=f+x:c=x,f="",u=!1;break}case"newline":u?c?c+=R.source:i=!0:f+=R.source,u=!0,h=!0,(E||T)&&(S=!0),l=!0;break;case"anchor":E&&a(R,"MULTIPLE_ANCHORS","A node can have at most one anchor"),R.source.endsWith(":")&&a(R.offset+R.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),E=R,b===null&&(b=R.offset),u=!1,l=!1,g=!0;break;case"tag":{T&&a(R,"MULTIPLE_TAGS","A node can have at most one tag"),T=R,b===null&&(b=R.offset),u=!1,l=!1,g=!0;break}case r:(E||T)&&a(R,"BAD_PROP_ORDER",`Anchors and tags must be after the ${R.source} indicator`),v&&a(R,"UNEXPECTED_TOKEN",`Unexpected ${R.source} in ${e??"collection"}`),v=R,u=!1,l=!1;break;case"comma":if(e){O&&a(R,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),O=R,u=!1,l=!1;break}default:a(R,"UNEXPECTED_TOKEN",`Unexpected ${R.type} token`),u=!1,l=!1}let N=t[t.length-1],I=N?N.offset+N.source.length:s;return g&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&a(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:O,found:v,spaceBefore:i,comment:c,hasNewline:h,hasNewlineAfterProp:S,anchor:E,tag:T,end:I,start:b??I}}JY.resolveProps=LEe});var NS=p(XY=>{"use strict";function O0(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(let e of t.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(let e of t.items){for(let r of e.start)if(r.type==="newline")return!0;if(e.sep){for(let r of e.sep)if(r.type==="newline")return!0}if(O0(e.key)||O0(e.value))return!0}return!1;default:return!0}}XY.containsNewline=O0});var v0=p(ZY=>{"use strict";var CEe=NS();function DEe(t,e,r){if(e?.type==="flow-collection"){let n=e.end[0];n.indent===t&&(n.source==="]"||n.source==="}")&&CEe.containsNewline(e)&&r(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}ZY.flowIndentCheck=DEe});var b0=p(t6=>{"use strict";var e6=ge();function xEe(t,e,r){let{uniqueKeys:n}=t.options;if(n===!1)return!1;let s=typeof n=="function"?n:(a,o)=>a===o||e6.isScalar(a)&&e6.isScalar(o)&&a.value===o.value&&!(a.value==="<<"&&t.schema.merge);return e.some(a=>s(a.key,r))}t6.mapIncludes=xEe});var a6=p(s6=>{"use strict";var r6=Mi(),UEe=Ci(),n6=kc(),kEe=NS(),i6=v0(),BEe=b0(),o6="All mapping items must start at the same column";function qEe({composeNode:t,composeEmptyNode:e},r,n,s,a){let o=a?.nodeClass??UEe.YAMLMap,i=new o(r.schema);r.atRoot&&(r.atRoot=!1);let u=n.offset,l=null;for(let c of n.items){let{start:f,key:h,sep:S,value:g}=c,E=n6.resolveProps(f,{indicator:"explicit-key-ind",next:h??S?.[0],offset:u,onError:s,startOnNewline:!0}),T=!E.found;if(T){if(h&&(h.type==="block-seq"?s(u,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==n.indent&&s(u,"BAD_INDENT",o6)),!E.anchor&&!E.tag&&!S){l=E.end,E.comment&&(i.comment?i.comment+=`
`+E.comment:i.comment=E.comment);continue}(E.hasNewlineAfterProp||kEe.containsNewline(h))&&s(h??f[f.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else E.found?.indent!==n.indent&&s(u,"BAD_INDENT",o6);let O=E.end,v=h?t(r,h,E,s):e(r,O,f,null,E,s);r.schema.compat&&i6.flowIndentCheck(n.indent,h,s),BEe.mapIncludes(r,i.items,v)&&s(O,"DUPLICATE_KEY","Map keys must be unique");let b=n6.resolveProps(S??[],{indicator:"map-value-ind",next:g,offset:v.range[2],onError:s,startOnNewline:!h||h.type==="block-scalar"});if(u=b.end,b.found){T&&(g?.type==="block-map"&&!b.hasNewline&&s(u,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),r.options.strict&&E.start<b.found.offset-1024&&s(v.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let N=g?t(r,g,b,s):e(r,u,S,null,b,s);r.schema.compat&&i6.flowIndentCheck(n.indent,g,s),u=N.range[2];let I=new r6.Pair(v,N);r.options.keepSourceTokens&&(I.srcToken=c),i.items.push(I)}else{T&&s(v.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),b.comment&&(v.comment?v.comment+=`
`+b.comment:v.comment=b.comment);let N=new r6.Pair(v);r.options.keepSourceTokens&&(N.srcToken=c),i.items.push(N)}}return l&&l<u&&s(l,"IMPOSSIBLE","Map comment with trailing content"),i.range=[n.offset,u,l??u],i}s6.resolveBlockMap=qEe});var l6=p(u6=>{"use strict";var VEe=Di(),FEe=kc(),$Ee=v0();function GEe({composeNode:t,composeEmptyNode:e},r,n,s,a){let o=a?.nodeClass??VEe.YAMLSeq,i=new o(r.schema);r.atRoot&&(r.atRoot=!1);let u=n.offset,l=null;for(let{start:c,value:f}of n.items){let h=FEe.resolveProps(c,{indicator:"seq-item-ind",next:f,offset:u,onError:s,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||f)f&&f.type==="block-seq"?s(h.end,"BAD_INDENT","All sequence items must start at the same column"):s(u,"MISSING_CHAR","Sequence item without - indicator");else{l=h.end,h.comment&&(i.comment=h.comment);continue}let S=f?t(r,f,h,s):e(r,h.end,c,null,h,s);r.schema.compat&&$Ee.flowIndentCheck(n.indent,f,s),u=S.range[2],i.items.push(S)}return i.range=[n.offset,u,l??u],i}u6.resolveBlockSeq=GEe});var Qa=p(c6=>{"use strict";function WEe(t,e,r,n){let s="";if(t){let a=!1,o="";for(let i of t){let{source:u,type:l}=i;switch(l){case"space":a=!0;break;case"comment":{r&&!a&&n(i,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let c=u.substring(1)||" ";s?s+=o+c:s=c,o="";break}case"newline":s&&(o+=u),a=!0;break;default:n(i,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}e+=u.length}}return{comment:s,offset:e}}c6.resolveEnd=WEe});var h6=p(p6=>{"use strict";var jEe=ge(),HEe=Mi(),f6=Ci(),YEe=Di(),zEe=Qa(),d6=kc(),KEe=NS(),QEe=b0(),A0="Block collections are not allowed within flow collections",R0=t=>t&&(t.type==="block-map"||t.type==="block-seq");function JEe({composeNode:t,composeEmptyNode:e},r,n,s,a){let o=n.start.source==="{",i=o?"flow map":"flow sequence",u=a?.nodeClass??(o?f6.YAMLMap:YEe.YAMLSeq),l=new u(r.schema);l.flow=!0;let c=r.atRoot;c&&(r.atRoot=!1);let f=n.offset+n.start.source.length;for(let T=0;T<n.items.length;++T){let O=n.items[T],{start:v,key:b,sep:N,value:I}=O,R=d6.resolveProps(v,{flow:i,indicator:"explicit-key-ind",next:b??N?.[0],offset:f,onError:s,startOnNewline:!1});if(!R.found){if(!R.anchor&&!R.tag&&!N&&!I){T===0&&R.comma?s(R.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${i}`):T<n.items.length-1&&s(R.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${i}`),R.comment&&(l.comment?l.comment+=`
`+R.comment:l.comment=R.comment),f=R.end;continue}!o&&r.options.strict&&KEe.containsNewline(b)&&s(b,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(T===0)R.comma&&s(R.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${i}`);else if(R.comma||s(R.start,"MISSING_CHAR",`Missing , between ${i} items`),R.comment){let x="";e:for(let C of v)switch(C.type){case"comma":case"space":break;case"comment":x=C.source.substring(1);break e;default:break e}if(x){let C=l.items[l.items.length-1];jEe.isPair(C)&&(C=C.value??C.key),C.comment?C.comment+=`
`+x:C.comment=x,R.comment=R.comment.substring(x.length+1)}}if(!o&&!N&&!R.found){let x=I?t(r,I,R,s):e(r,R.end,N,null,R,s);l.items.push(x),f=x.range[2],R0(I)&&s(x.range,"BLOCK_IN_FLOW",A0)}else{let x=R.end,C=b?t(r,b,R,s):e(r,x,v,null,R,s);R0(b)&&s(C.range,"BLOCK_IN_FLOW",A0);let j=d6.resolveProps(N??[],{flow:i,indicator:"map-value-ind",next:I,offset:C.range[2],onError:s,startOnNewline:!1});if(j.found){if(!o&&!R.found&&r.options.strict){if(N)for(let ue of N){if(ue===j.found)break;if(ue.type==="newline"){s(ue,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}R.start<j.found.offset-1024&&s(j.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else I&&("source"in I&&I.source&&I.source[0]===":"?s(I,"MISSING_CHAR",`Missing space after : in ${i}`):s(j.start,"MISSING_CHAR",`Missing , or : between ${i} items`));let ye=I?t(r,I,j,s):j.found?e(r,j.end,N,null,j,s):null;ye?R0(I)&&s(ye.range,"BLOCK_IN_FLOW",A0):j.comment&&(C.comment?C.comment+=`
`+j.comment:C.comment=j.comment);let H=new HEe.Pair(C,ye);if(r.options.keepSourceTokens&&(H.srcToken=O),o){let ue=l;QEe.mapIncludes(r,ue.items,C)&&s(x,"DUPLICATE_KEY","Map keys must be unique"),ue.items.push(H)}else{let ue=new f6.YAMLMap(r.schema);ue.flow=!0,ue.items.push(H),l.items.push(ue)}f=ye?ye.range[2]:j.end}}let h=o?"}":"]",[S,...g]=n.end,E=f;if(S&&S.source===h)E=S.offset+S.source.length;else{let T=i[0].toUpperCase()+i.substring(1),O=c?`${T} must end with a ${h}`:`${T} in block collection must be sufficiently indented and end with a ${h}`;s(f,c?"MISSING_CHAR":"BAD_INDENT",O),S&&S.source.length!==1&&g.unshift(S)}if(g.length>0){let T=zEe.resolveEnd(g,E,r.options.strict,s);T.comment&&(l.comment?l.comment+=`
`+T.comment:l.comment=T.comment),l.range=[n.offset,E,T.offset]}else l.range=[n.offset,E,E];return l}p6.resolveFlowCollection=JEe});var m6=p(_6=>{"use strict";var XEe=ge(),ZEe=Ze(),ege=Ci(),tge=Di(),rge=a6(),nge=l6(),ige=h6();function N0(t,e,r,n,s,a){let o=r.type==="block-map"?rge.resolveBlockMap(t,e,r,n,a):r.type==="block-seq"?nge.resolveBlockSeq(t,e,r,n,a):ige.resolveFlowCollection(t,e,r,n,a),i=o.constructor;return s==="!"||s===i.tagName?(o.tag=i.tagName,o):(s&&(o.tag=s),o)}function oge(t,e,r,n,s){let a=n?e.directives.tagName(n.source,f=>s(n,"TAG_RESOLVE_FAILED",f)):null,o=r.type==="block-map"?"map":r.type==="block-seq"?"seq":r.start.source==="{"?"map":"seq";if(!n||!a||a==="!"||a===ege.YAMLMap.tagName&&o==="map"||a===tge.YAMLSeq.tagName&&o==="seq"||!o)return N0(t,e,r,s,a);let i=e.schema.tags.find(f=>f.tag===a&&f.collection===o);if(!i){let f=e.schema.knownTags[a];if(f&&f.collection===o)e.schema.tags.push(Object.assign({},f,{default:!1})),i=f;else return f?.collection?s(n,"BAD_COLLECTION_TYPE",`${f.tag} used for ${o} collection, but expects ${f.collection}`,!0):s(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),N0(t,e,r,s,a)}let u=N0(t,e,r,s,a,i),l=i.resolve?.(u,f=>s(n,"TAG_RESOLVE_FAILED",f),e.options)??u,c=XEe.isNode(l)?l:new ZEe.Scalar(l);return c.range=u.range,c.tag=a,i?.format&&(c.format=i.format),c}_6.composeCollection=oge});var I0=p(S6=>{"use strict";var P0=Ze();function sge(t,e,r){let n=t.offset,s=age(t,e,r);if(!s)return{value:"",type:null,comment:"",range:[n,n,n]};let a=s.mode===">"?P0.Scalar.BLOCK_FOLDED:P0.Scalar.BLOCK_LITERAL,o=t.source?uge(t.source):[],i=o.length;for(let E=o.length-1;E>=0;--E){let T=o[E][1];if(T===""||T==="\r")i=E;else break}if(i===0){let E=s.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"",T=n+s.length;return t.source&&(T+=t.source.length),{value:E,type:a,comment:s.comment,range:[n,T,T]}}let u=t.indent+s.indent,l=t.offset+s.length,c=0;for(let E=0;E<i;++E){let[T,O]=o[E];if(O===""||O==="\r")s.indent===0&&T.length>u&&(u=T.length);else{T.length<u&&r(l+T.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),s.indent===0&&(u=T.length),c=E;break}l+=T.length+O.length+1}for(let E=o.length-1;E>=i;--E)o[E][0].length>u&&(i=E+1);let f="",h="",S=!1;for(let E=0;E<c;++E)f+=o[E][0].slice(u)+`
`;for(let E=c;E<i;++E){let[T,O]=o[E];l+=T.length+O.length+1;let v=O[O.length-1]==="\r";if(v&&(O=O.slice(0,-1)),O&&T.length<u){let N=`Block scalar lines must not be less indented than their ${s.indent?"explicit indentation indicator":"first line"}`;r(l-O.length-(v?2:1),"BAD_INDENT",N),T=""}a===P0.Scalar.BLOCK_LITERAL?(f+=h+T.slice(u)+O,h=`
`):T.length>u||O[0]==="	"?(h===" "?h=`
`:!S&&h===`
`&&(h=`

`),f+=h+T.slice(u)+O,h=`
`,S=!0):O===""?h===`
`?f+=`
`:h=`
`:(f+=h+O,h=" ",S=!1)}switch(s.chomp){case"-":break;case"+":for(let E=i;E<o.length;++E)f+=`
`+o[E][0].slice(u);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}let g=n+s.length+t.source.length;return{value:f,type:a,comment:s.comment,range:[n,g,g]}}function age({offset:t,props:e},r,n){if(e[0].type!=="block-scalar-header")return n(e[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:s}=e[0],a=s[0],o=0,i="",u=-1;for(let h=1;h<s.length;++h){let S=s[h];if(!i&&(S==="-"||S==="+"))i=S;else{let g=Number(S);!o&&g?o=g:u===-1&&(u=t+h)}}u!==-1&&n(u,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${s}`);let l=!1,c="",f=s.length;for(let h=1;h<e.length;++h){let S=e[h];switch(S.type){case"space":l=!0;case"newline":f+=S.source.length;break;case"comment":r&&!l&&n(S,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=S.source.length,c=S.source.substring(1);break;case"error":n(S,"UNEXPECTED_TOKEN",S.message),f+=S.source.length;break;default:{let g=`Unexpected token in block scalar header: ${S.type}`;n(S,"UNEXPECTED_TOKEN",g);let E=S.source;E&&typeof E=="string"&&(f+=E.length)}}}return{mode:a,indent:o,chomp:i,comment:c,length:f}}function uge(t){let e=t.split(/\n( *)/),r=e[0],n=r.match(/^( *)/),a=[n?.[1]?[n[1],r.slice(n[1].length)]:["",r]];for(let o=1;o<e.length;o+=2)a.push([e[o],e[o+1]]);return a}S6.resolveBlockScalar=sge});var L0=p(g6=>{"use strict";var M0=Ze(),lge=Qa();function cge(t,e,r){let{offset:n,type:s,source:a,end:o}=t,i,u,l=(h,S,g)=>r(n+h,S,g);switch(s){case"scalar":i=M0.Scalar.PLAIN,u=fge(a,l);break;case"single-quoted-scalar":i=M0.Scalar.QUOTE_SINGLE,u=dge(a,l);break;case"double-quoted-scalar":i=M0.Scalar.QUOTE_DOUBLE,u=pge(a,l);break;default:return r(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${s}`),{value:"",type:null,comment:"",range:[n,n+a.length,n+a.length]}}let c=n+a.length,f=lge.resolveEnd(o,c,e,r);return{value:u,type:i,comment:f.comment,range:[n,c,f.offset]}}function fge(t,e){let r="";switch(t[0]){case"	":r="a tab character";break;case",":r="flow indicator character ,";break;case"%":r="directive indicator character %";break;case"|":case">":{r=`block scalar indicator ${t[0]}`;break}case"@":case"`":{r=`reserved character ${t[0]}`;break}}return r&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${r}`),E6(t)}function dge(t,e){return(t[t.length-1]!=="'"||t.length===1)&&e(t.length,"MISSING_CHAR","Missing closing 'quote"),E6(t.slice(1,-1)).replace(/''/g,"'")}function E6(t){let e,r;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),r=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,r=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=e.exec(t);if(!n)return t;let s=n[1],a=" ",o=e.lastIndex;for(r.lastIndex=o;n=r.exec(t);)n[1]===""?a===`
`?s+=a:a=`
`:(s+=a+n[1],a=" "),o=r.lastIndex;let i=/[ \t]*(.*)/sy;return i.lastIndex=o,n=i.exec(t),s+a+(n?.[1]??"")}function pge(t,e){let r="";for(let n=1;n<t.length-1;++n){let s=t[n];if(!(s==="\r"&&t[n+1]===`
`))if(s===`
`){let{fold:a,offset:o}=hge(t,n);r+=a,n=o}else if(s==="\\"){let a=t[++n],o=_ge[a];if(o)r+=o;else if(a===`
`)for(a=t[n+1];a===" "||a==="	";)a=t[++n+1];else if(a==="\r"&&t[n+1]===`
`)for(a=t[++n+1];a===" "||a==="	";)a=t[++n+1];else if(a==="x"||a==="u"||a==="U"){let i={x:2,u:4,U:8}[a];r+=mge(t,n+1,i,e),n+=i}else{let i=t.substr(n-1,2);e(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),r+=i}}else if(s===" "||s==="	"){let a=n,o=t[n+1];for(;o===" "||o==="	";)o=t[++n+1];o!==`
`&&!(o==="\r"&&t[n+2]===`
`)&&(r+=n>a?t.slice(a,n+1):s)}else r+=s}return(t[t.length-1]!=='"'||t.length===1)&&e(t.length,"MISSING_CHAR",'Missing closing "quote'),r}function hge(t,e){let r="",n=t[e+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&t[e+2]!==`
`);)n===`
`&&(r+=`
`),e+=1,n=t[e+1];return r||(r=" "),{fold:r,offset:e}}var _ge={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function mge(t,e,r,n){let s=t.substr(e,r),o=s.length===r&&/^[0-9a-fA-F]+$/.test(s)?parseInt(s,16):NaN;if(isNaN(o)){let i=t.substr(e-2,r+2);return n(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),i}return String.fromCodePoint(o)}g6.resolveFlowScalar=cge});var w6=p(T6=>{"use strict";var Ja=ge(),y6=Ze(),Sge=I0(),Ege=L0();function gge(t,e,r,n){let{value:s,type:a,comment:o,range:i}=e.type==="block-scalar"?Sge.resolveBlockScalar(e,t.options.strict,n):Ege.resolveFlowScalar(e,t.options.strict,n),u=r?t.directives.tagName(r.source,f=>n(r,"TAG_RESOLVE_FAILED",f)):null,l=r&&u?yge(t.schema,s,u,r,n):e.type==="scalar"?Tge(t,s,e,n):t.schema[Ja.SCALAR],c;try{let f=l.resolve(s,h=>n(r??e,"TAG_RESOLVE_FAILED",h),t.options);c=Ja.isScalar(f)?f:new y6.Scalar(f)}catch(f){let h=f instanceof Error?f.message:String(f);n(r??e,"TAG_RESOLVE_FAILED",h),c=new y6.Scalar(s)}return c.range=i,c.source=s,a&&(c.type=a),u&&(c.tag=u),l.format&&(c.format=l.format),o&&(c.comment=o),c}function yge(t,e,r,n,s){if(r==="!")return t[Ja.SCALAR];let a=[];for(let i of t.tags)if(!i.collection&&i.tag===r)if(i.default&&i.test)a.push(i);else return i;for(let i of a)if(i.test?.test(e))return i;let o=t.knownTags[r];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(s(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,r!=="tag:yaml.org,2002:str"),t[Ja.SCALAR])}function Tge({directives:t,schema:e},r,n,s){let a=e.tags.find(o=>o.default&&o.test?.test(r))||e[Ja.SCALAR];if(e.compat){let o=e.compat.find(i=>i.default&&i.test?.test(r))??e[Ja.SCALAR];if(a.tag!==o.tag){let i=t.tagString(a.tag),u=t.tagString(o.tag),l=`Value may be parsed as either ${i} or ${u}`;s(n,"TAG_RESOLVE_FAILED",l,!0)}}return a}T6.composeScalar=gge});var v6=p(O6=>{"use strict";function wge(t,e,r){if(e){r===null&&(r=e.length);for(let n=r-1;n>=0;--n){let s=e[n];switch(s.type){case"space":case"comment":case"newline":t-=s.source.length;continue}for(s=e[++n];s?.type==="space";)t+=s.source.length,s=e[++n];break}}return t}O6.emptyScalarPosition=wge});var R6=p(D0=>{"use strict";var Oge=gc(),vge=m6(),b6=w6(),bge=Qa(),Age=v6(),Rge={composeNode:A6,composeEmptyNode:C0};function A6(t,e,r,n){let{spaceBefore:s,comment:a,anchor:o,tag:i}=r,u,l=!0;switch(e.type){case"alias":u=Nge(t,e,n),(o||i)&&n(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":u=b6.composeScalar(t,e,i,n),o&&(u.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":u=vge.composeCollection(Rge,t,e,i,n),o&&(u.anchor=o.source.substring(1));break;default:{let c=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;n(e,"UNEXPECTED_TOKEN",c),u=C0(t,e.offset,void 0,null,r,n),l=!1}}return o&&u.anchor===""&&n(o,"BAD_ALIAS","Anchor cannot be an empty string"),s&&(u.spaceBefore=!0),a&&(e.type==="scalar"&&e.source===""?u.comment=a:u.commentBefore=a),t.options.keepSourceTokens&&l&&(u.srcToken=e),u}function C0(t,e,r,n,{spaceBefore:s,comment:a,anchor:o,tag:i,end:u},l){let c={type:"scalar",offset:Age.emptyScalarPosition(e,r,n),indent:-1,source:""},f=b6.composeScalar(t,c,i,l);return o&&(f.anchor=o.source.substring(1),f.anchor===""&&l(o,"BAD_ALIAS","Anchor cannot be an empty string")),s&&(f.spaceBefore=!0),a&&(f.comment=a,f.range[2]=u),f}function Nge({options:t},{offset:e,source:r,end:n},s){let a=new Oge.Alias(r.substring(1));a.source===""&&s(e,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&s(e+r.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let o=e+r.length,i=bge.resolveEnd(n,o,t.strict,s);return a.range=[e,o,i.offset],i.comment&&(a.comment=i.comment),a}D0.composeEmptyNode=C0;D0.composeNode=A6});var I6=p(P6=>{"use strict";var Pge=Cc(),N6=R6(),Ige=Qa(),Mge=kc();function Lge(t,e,{offset:r,start:n,value:s,end:a},o){let i=Object.assign({_directives:e},t),u=new Pge.Document(void 0,i),l={atRoot:!0,directives:u.directives,options:u.options,schema:u.schema},c=Mge.resolveProps(n,{indicator:"doc-start",next:s??a?.[0],offset:r,onError:o,startOnNewline:!0});c.found&&(u.directives.docStart=!0,s&&(s.type==="block-map"||s.type==="block-seq")&&!c.hasNewline&&o(c.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),u.contents=s?N6.composeNode(l,s,c,o):N6.composeEmptyNode(l,c.end,n,null,c,o);let f=u.contents.range[2],h=Ige.resolveEnd(a,f,!1,o);return h.comment&&(u.comment=h.comment),u.range=[r,f,h.offset],u}P6.composeDoc=Lge});var U0=p(C6=>{"use strict";var Cge=wA(),Dge=Cc(),Bc=Uc(),M6=ge(),xge=I6(),Uge=Qa();function qc(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];let{offset:e,source:r}=t;return[e,e+(typeof r=="string"?r.length:1)]}function L6(t){let e="",r=!1,n=!1;for(let s=0;s<t.length;++s){let a=t[s];switch(a[0]){case"#":e+=(e===""?"":n?`

`:`
`)+(a.substring(1)||" "),r=!0,n=!1;break;case"%":t[s+1]?.[0]!=="#"&&(s+=1),r=!1;break;default:r||(n=!0),r=!1}}return{comment:e,afterEmptyLine:n}}var x0=class{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(r,n,s,a)=>{let o=qc(r);a?this.warnings.push(new Bc.YAMLWarning(o,n,s)):this.errors.push(new Bc.YAMLParseError(o,n,s))},this.directives=new Cge.Directives({version:e.version||"1.2"}),this.options=e}decorate(e,r){let{comment:n,afterEmptyLine:s}=L6(this.prelude);if(n){let a=e.contents;if(r)e.comment=e.comment?`${e.comment}
${n}`:n;else if(s||e.directives.docStart||!a)e.commentBefore=n;else if(M6.isCollection(a)&&!a.flow&&a.items.length>0){let o=a.items[0];M6.isPair(o)&&(o=o.key);let i=o.commentBefore;o.commentBefore=i?`${n}
${i}`:n}else{let o=a.commentBefore;a.commentBefore=o?`${n}
${o}`:n}}r?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:L6(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,r=!1,n=-1){for(let s of e)yield*this.next(s);yield*this.end(r,n)}*next(e){switch(process.env.LOG_STREAM&&console.dir(e,{depth:null}),e.type){case"directive":this.directives.add(e.source,(r,n,s)=>{let a=qc(e);a[0]+=r,this.onError(a,"BAD_DIRECTIVE",n,s)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let r=xge.composeDoc(this.options,this.directives,e,this.onError);this.atDirectives&&!r.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(r,!1),this.doc&&(yield this.doc),this.doc=r,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let r=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,n=new Bc.YAMLParseError(qc(e),"UNEXPECTED_TOKEN",r);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){let n="Unexpected doc-end without preceding document";this.errors.push(new Bc.YAMLParseError(qc(e),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;let r=Uge.resolveEnd(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),r.comment){let n=this.doc.comment;this.doc.comment=n?`${n}
${r.comment}`:r.comment}this.doc.range[2]=r.offset;break}default:this.errors.push(new Bc.YAMLParseError(qc(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,r=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let n=Object.assign({_directives:this.directives},this.options),s=new Dge.Document(void 0,n);this.atDirectives&&this.onError(r,"MISSING_CHAR","Missing directives-end indicator line"),s.range=[0,r,r],this.decorate(s,!1),yield s}}};C6.Composer=x0});var U6=p(PS=>{"use strict";var kge=I0(),Bge=L0(),qge=Uc(),D6=vc();function Vge(t,e=!0,r){if(t){let n=(s,a,o)=>{let i=typeof s=="number"?s:Array.isArray(s)?s[0]:s.offset;if(r)r(i,a,o);else throw new qge.YAMLParseError([i,i+1],a,o)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Bge.resolveFlowScalar(t,e,n);case"block-scalar":return kge.resolveBlockScalar(t,e,n)}}return null}function Fge(t,e){let{implicitKey:r=!1,indent:n,inFlow:s=!1,offset:a=-1,type:o="PLAIN"}=e,i=D6.stringifyString({type:o,value:t},{implicitKey:r,indent:n>0?" ".repeat(n):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}}),u=e.end??[{type:"newline",offset:-1,indent:n,source:`
`}];switch(i[0]){case"|":case">":{let l=i.indexOf(`
`),c=i.substring(0,l),f=i.substring(l+1)+`
`,h=[{type:"block-scalar-header",offset:a,indent:n,source:c}];return x6(h,u)||h.push({type:"newline",offset:-1,indent:n,source:`
`}),{type:"block-scalar",offset:a,indent:n,props:h,source:f}}case'"':return{type:"double-quoted-scalar",offset:a,indent:n,source:i,end:u};case"'":return{type:"single-quoted-scalar",offset:a,indent:n,source:i,end:u};default:return{type:"scalar",offset:a,indent:n,source:i,end:u}}}function $ge(t,e,r={}){let{afterKey:n=!1,implicitKey:s=!1,inFlow:a=!1,type:o}=r,i="indent"in t?t.indent:null;if(n&&typeof i=="number"&&(i+=2),!o)switch(t.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{let l=t.props[0];if(l.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=l.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}let u=D6.stringifyString({type:o,value:e},{implicitKey:s||i===null,indent:i!==null&&i>0?" ".repeat(i):"",inFlow:a,options:{blockQuote:!0,lineWidth:-1}});switch(u[0]){case"|":case">":Gge(t,u);break;case'"':k0(t,u,"double-quoted-scalar");break;case"'":k0(t,u,"single-quoted-scalar");break;default:k0(t,u,"scalar")}}function Gge(t,e){let r=e.indexOf(`
`),n=e.substring(0,r),s=e.substring(r+1)+`
`;if(t.type==="block-scalar"){let a=t.props[0];if(a.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a.source=n,t.source=s}else{let{offset:a}=t,o="indent"in t?t.indent:-1,i=[{type:"block-scalar-header",offset:a,indent:o,source:n}];x6(i,"end"in t?t.end:void 0)||i.push({type:"newline",offset:-1,indent:o,source:`
`});for(let u of Object.keys(t))u!=="type"&&u!=="offset"&&delete t[u];Object.assign(t,{type:"block-scalar",indent:o,props:i,source:s})}}function x6(t,e){if(e)for(let r of e)switch(r.type){case"space":case"comment":t.push(r);break;case"newline":return t.push(r),!0}return!1}function k0(t,e,r){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=r,t.source=e;break;case"block-scalar":{let n=t.props.slice(1),s=e.length;t.props[0].type==="block-scalar-header"&&(s-=t.props[0].source.length);for(let a of n)a.offset+=s;delete t.props,Object.assign(t,{type:r,source:e,end:n});break}case"block-map":case"block-seq":{let s={type:"newline",offset:t.offset+e.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:r,source:e,end:[s]});break}default:{let n="indent"in t?t.indent:-1,s="end"in t&&Array.isArray(t.end)?t.end.filter(a=>a.type==="space"||a.type==="comment"||a.type==="newline"):[];for(let a of Object.keys(t))a!=="type"&&a!=="offset"&&delete t[a];Object.assign(t,{type:r,indent:n,source:e,end:s})}}}PS.createScalarToken=Fge;PS.resolveAsScalar=Vge;PS.setScalarValue=$ge});var B6=p(k6=>{"use strict";var Wge=t=>"type"in t?MS(t):IS(t);function MS(t){switch(t.type){case"block-scalar":{let e="";for(let r of t.props)e+=MS(r);return e+t.source}case"block-map":case"block-seq":{let e="";for(let r of t.items)e+=IS(r);return e}case"flow-collection":{let e=t.start.source;for(let r of t.items)e+=IS(r);for(let r of t.end)e+=r.source;return e}case"document":{let e=IS(t);if(t.end)for(let r of t.end)e+=r.source;return e}default:{let e=t.source;if("end"in t&&t.end)for(let r of t.end)e+=r.source;return e}}}function IS({start:t,key:e,sep:r,value:n}){let s="";for(let a of t)s+=a.source;if(e&&(s+=MS(e)),r)for(let a of r)s+=a.source;return n&&(s+=MS(n)),s}k6.stringify=Wge});var $6=p(F6=>{"use strict";var B0=Symbol("break visit"),jge=Symbol("skip children"),q6=Symbol("remove item");function qo(t,e){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),V6(Object.freeze([]),t,e)}qo.BREAK=B0;qo.SKIP=jge;qo.REMOVE=q6;qo.itemAtPath=(t,e)=>{let r=t;for(let[n,s]of e){let a=r?.[n];if(a&&"items"in a)r=a.items[s];else return}return r};qo.parentCollection=(t,e)=>{let r=qo.itemAtPath(t,e.slice(0,-1)),n=e[e.length-1][0],s=r?.[n];if(s&&"items"in s)return s;throw new Error("Parent collection not found")};function V6(t,e,r){let n=r(e,t);if(typeof n=="symbol")return n;for(let s of["key","value"]){let a=e[s];if(a&&"items"in a){for(let o=0;o<a.items.length;++o){let i=V6(Object.freeze(t.concat([[s,o]])),a.items[o],r);if(typeof i=="number")o=i-1;else{if(i===B0)return B0;i===q6&&(a.items.splice(o,1),o-=1)}}typeof n=="function"&&s==="key"&&(n=n(e,t))}}return typeof n=="function"?n(e,t):n}F6.visit=qo});var LS=p(Jt=>{"use strict";var q0=U6(),Hge=B6(),Yge=$6(),V0="\uFEFF",F0="",$0="",G0="",zge=t=>!!t&&"items"in t,Kge=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function Qge(t){switch(t){case V0:return"<BOM>";case F0:return"<DOC>";case $0:return"<FLOW_END>";case G0:return"<SCALAR>";default:return JSON.stringify(t)}}function Jge(t){switch(t){case V0:return"byte-order-mark";case F0:return"doc-mode";case $0:return"flow-error-end";case G0:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Jt.createScalarToken=q0.createScalarToken;Jt.resolveAsScalar=q0.resolveAsScalar;Jt.setScalarValue=q0.setScalarValue;Jt.stringify=Hge.stringify;Jt.visit=Yge.visit;Jt.BOM=V0;Jt.DOCUMENT=F0;Jt.FLOW_END=$0;Jt.SCALAR=G0;Jt.isCollection=zge;Jt.isScalar=Kge;Jt.prettyToken=Qge;Jt.tokenType=Jge});var Y0=p(W6=>{"use strict";var Vc=LS();function Nr(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var G6="0123456789ABCDEFabcdef".split(""),Xge="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),W0=",[]{}".split(""),Zge=` ,[]{}
\r	`.split(""),j0=t=>!t||Zge.includes(t),H0=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,r=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!r;let n=this.next??"stream";for(;n&&(r||this.hasChars(1));)n=yield*this.parseNext(n)}atLineEnd(){let e=this.pos,r=this.buffer[e];for(;r===" "||r==="	";)r=this.buffer[++e];return!r||r==="#"||r===`
`?!0:r==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let r=this.buffer[e];if(this.indentNext>0){let n=0;for(;r===" ";)r=this.buffer[++n+e];if(r==="\r"){let s=this.buffer[n+e+1];if(s===`
`||!s&&!this.atEnd)return e+n+1}return r===`
`||n>=this.indentNext||!r&&!this.atEnd?e+n:-1}if(r==="-"||r==="."){let n=this.buffer.substr(e,3);if((n==="---"||n==="...")&&Nr(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Vc.BOM&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let r=e.length,n=e.indexOf("#");if(n!==-1){let a=e[n-1];(a===" "||a==="	")&&(r=n-1)}for(;;){let a=e[r-1];if(a===" "||a==="	")r-=1;else break}let s=(yield*this.pushCount(r))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-s),this.pushNewline(),"stream"}if(this.atLineEnd()){let r=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-r),yield*this.pushNewline(),"stream"}return yield Vc.DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let r=this.peek(3);if(r==="---"&&Nr(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(r==="..."&&Nr(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Nr(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,r]=this.peek(2);if(!r&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&Nr(r)){let n=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=n,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(e===null)return this.setNext("doc");let r=yield*this.pushIndicators();switch(e[r]){case"#":yield*this.pushCount(e.length-r);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(j0),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return r+=yield*this.parseBlockScalarHeader(),r+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-r),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,r,n=-1;do e=yield*this.pushNewline(),e>0?(r=yield*this.pushSpaces(!1),this.indentValue=n=r):r=0,r+=yield*this.pushSpaces(!0);while(e+r>0);let s=this.getLine();if(s===null)return this.setNext("flow");if((n!==-1&&n<this.indentNext&&s[0]!=="#"||n===0&&(s.startsWith("---")||s.startsWith("..."))&&Nr(s[3]))&&!(n===this.indentNext-1&&this.flowLevel===1&&(s[0]==="]"||s[0]==="}")))return this.flowLevel=0,yield Vc.FLOW_END,yield*this.parseLineStart();let a=0;for(;s[a]===",";)a+=yield*this.pushCount(1),a+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(a+=yield*this.pushIndicators(),s[a]){case void 0:return"flow";case"#":return yield*this.pushCount(s.length-a),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(j0),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let o=this.charAt(1);if(this.flowKey||Nr(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),r=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;r!==-1&&this.buffer[r+1]==="'";)r=this.buffer.indexOf("'",r+2);else for(;r!==-1;){let a=0;for(;this.buffer[r-1-a]==="\\";)a+=1;if(a%2===0)break;r=this.buffer.indexOf('"',r+1)}let n=this.buffer.substring(0,r),s=n.indexOf(`
`,this.pos);if(s!==-1){for(;s!==-1;){let a=this.continueScalar(s+1);if(a===-1)break;s=n.indexOf(`
`,a)}s!==-1&&(r=s-(n[s-1]==="\r"?2:1))}if(r===-1){if(!this.atEnd)return this.setNext("quoted-scalar");r=this.buffer.length}return yield*this.pushToIndex(r+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let r=this.buffer[++e];if(r==="+")this.blockScalarKeep=!0;else if(r>"0"&&r<="9")this.blockScalarIndent=Number(r)-1;else if(r!=="-")break}return yield*this.pushUntil(r=>Nr(r)||r==="#")}*parseBlockScalar(){let e=this.pos-1,r=0,n;e:for(let s=this.pos;n=this.buffer[s];++s)switch(n){case" ":r+=1;break;case`
`:e=s,r=0;break;case"\r":{let a=this.buffer[s+1];if(!a&&!this.atEnd)return this.setNext("block-scalar");if(a===`
`)break}default:break e}if(!n&&!this.atEnd)return this.setNext("block-scalar");if(r>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=r:this.indentNext+=this.blockScalarIndent;do{let s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)do{let s=e-1,a=this.buffer[s];a==="\r"&&(a=this.buffer[--s]);let o=s;for(;a===" "||a==="	";)a=this.buffer[--s];if(a===`
`&&s>=this.pos&&s+1+r>o)e=s;else break}while(!0);return yield Vc.SCALAR,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,r=this.pos-1,n=this.pos-1,s;for(;s=this.buffer[++n];)if(s===":"){let a=this.buffer[n+1];if(Nr(a)||e&&a===",")break;r=n}else if(Nr(s)){let a=this.buffer[n+1];if(s==="\r"&&(a===`
`?(n+=1,s=`
`,a=this.buffer[n+1]):r=n),a==="#"||e&&W0.includes(a))break;if(s===`
`){let o=this.continueScalar(n+1);if(o===-1)break;n=Math.max(n,o-2)}}else{if(e&&W0.includes(s))break;r=n}return!s&&!this.atEnd?this.setNext("plain-scalar"):(yield Vc.SCALAR,yield*this.pushToIndex(r+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,r){let n=this.buffer.slice(this.pos,e);return n?(yield n,this.pos+=n.length,n.length):(r&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(j0))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,r=this.charAt(1);if(Nr(r)||e&&W0.includes(r))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,r=this.buffer[e];for(;!Nr(r)&&r!==">";)r=this.buffer[++e];return yield*this.pushToIndex(r===">"?e+1:e,!1)}else{let e=this.pos+1,r=this.buffer[e];for(;r;)if(Xge.includes(r))r=this.buffer[++e];else if(r==="%"&&G6.includes(this.buffer[e+1])&&G6.includes(this.buffer[e+2]))r=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let r=this.pos-1,n;do n=this.buffer[++r];while(n===" "||e&&n==="	");let s=r-this.pos;return s>0&&(yield this.buffer.substr(this.pos,s),this.pos=r),s}*pushUntil(e){let r=this.pos,n=this.buffer[r];for(;!e(n);)n=this.buffer[++r];return yield*this.pushToIndex(r,!1)}};W6.Lexer=H0});var K0=p(j6=>{"use strict";var z0=class{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let r=0,n=this.lineStarts.length;for(;r<n;){let a=r+n>>1;this.lineStarts[a]<e?r=a+1:n=a}if(this.lineStarts[r]===e)return{line:r+1,col:1};if(r===0)return{line:0,col:e};let s=this.lineStarts[r-1];return{line:r,col:e-s+1}}}};j6.LineCounter=z0});var J0=p(Q6=>{"use strict";var H6=LS(),eye=Y0();function Wr(t,e){for(let r=0;r<t.length;++r)if(t[r].type===e)return!0;return!1}function Y6(t){for(let e=0;e<t.length;++e)switch(t[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function K6(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function CS(t){switch(t.type){case"document":return t.start;case"block-map":{let e=t.items[t.items.length-1];return e.sep??e.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function Xa(t){if(t.length===0)return[];let e=t.length;e:for(;--e>=0;)switch(t[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++e]?.type==="space";);return t.splice(e,t.length)}function z6(t){if(t.start.type==="flow-seq-start")for(let e of t.items)e.sep&&!e.value&&!Wr(e.start,"explicit-key-ind")&&!Wr(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,K6(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}var Q0=class{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new eye.Lexer,this.onNewLine=e}*parse(e,r=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let n of this.lexer.lex(e,r))yield*this.next(n);r||(yield*this.end())}*next(e){if(this.source=e,process.env.LOG_TOKENS&&console.log("|",H6.prettyToken(e)),this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let r=H6.tokenType(e);if(r)if(r==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=r,yield*this.step(),r){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{let n=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let r=e??this.stack.pop();if(!r)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield r;else{let n=this.peek(1);switch(r.type==="block-scalar"?r.indent="indent"in n?n.indent:0:r.type==="flow-collection"&&n.type==="document"&&(r.indent=0),r.type==="flow-collection"&&z6(r),n.type){case"document":n.value=r;break;case"block-scalar":n.props.push(r);break;case"block-map":{let s=n.items[n.items.length-1];if(s.value){n.items.push({start:[],key:r,sep:[]}),this.onKeyLine=!0;return}else if(s.sep)s.value=r;else{Object.assign(s,{key:r,sep:[]}),this.onKeyLine=!Wr(s.start,"explicit-key-ind");return}break}case"block-seq":{let s=n.items[n.items.length-1];s.value?n.items.push({start:[],value:r}):s.value=r;break}case"flow-collection":{let s=n.items[n.items.length-1];!s||s.value?n.items.push({start:[],key:r,sep:[]}):s.sep?s.value=r:Object.assign(s,{key:r,sep:[]});return}default:yield*this.pop(),yield*this.pop(r)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(r.type==="block-map"||r.type==="block-seq")){let s=r.items[r.items.length-1];s&&!s.sep&&!s.value&&s.start.length>0&&Y6(s.start)===-1&&(r.indent===0||s.start.every(a=>a.type!=="comment"||a.indent<r.indent))&&(n.type==="document"?n.end=s.start:n.items.push({start:s.start}),r.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{Y6(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let r=this.startBlockValue(e);r?this.stack.push(r):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){let r=CS(this.peek(2)),n=Xa(r),s;e.end?(s=e.end,s.push(this.sourceToken),delete e.end):s=[this.sourceToken];let a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:n,key:e,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let r=this.source.indexOf(`
`)+1;for(;r!==0;)this.onNewLine(this.offset+r),r=this.source.indexOf(`
`,r)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){let r=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,r.value){let n="end"in r.value?r.value.end:void 0;(Array.isArray(n)?n[n.length-1]:void 0)?.type==="comment"?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else if(r.sep)r.sep.push(this.sourceToken);else{if(this.atIndentedComment(r.start,e.indent)){let s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,r.start),s.push(this.sourceToken),e.items.pop();return}}r.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let n=!this.onKeyLine&&this.indent===e.indent&&r.sep&&this.type!=="seq-item-ind",s=[];if(n&&r.sep&&!r.value){let a=[];for(let o=0;o<r.sep.length;++o){let i=r.sep[o];switch(i.type){case"newline":a.push(o);break;case"space":break;case"comment":i.indent>e.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(s=r.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":n||r.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"explicit-key-ind":!r.sep&&!Wr(r.start,"explicit-key-ind")?r.start.push(this.sourceToken):n||r.value?(s.push(this.sourceToken),e.items.push({start:s})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(Wr(r.start,"explicit-key-ind"))if(r.sep)if(r.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Wr(r.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(K6(r.key)&&!Wr(r.sep,"newline")){let a=Xa(r.start),o=r.key,i=r.sep;i.push(this.sourceToken),delete r.key,delete r.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:o,sep:i}]})}else s.length>0?r.sep=r.sep.concat(s,this.sourceToken):r.sep.push(this.sourceToken);else if(Wr(r.start,"newline"))Object.assign(r,{key:null,sep:[this.sourceToken]});else{let a=Xa(r.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else r.sep?r.value||n?e.items.push({start:s,key:null,sep:[this.sourceToken]}):Wr(r.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):r.sep.push(this.sourceToken):Object.assign(r,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let a=this.flowScalar(this.type);n||r.value?(e.items.push({start:s,key:a,sep:[]}),this.onKeyLine=!0):r.sep?this.stack.push(a):(Object.assign(r,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{let a=this.startBlockValue(e);if(a){n&&a.type!=="block-seq"&&Wr(r.start,"explicit-key-ind")&&e.items.push({start:s}),this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){let r=e.items[e.items.length-1];switch(this.type){case"newline":if(r.value){let n="end"in r.value?r.value.end:void 0;(Array.isArray(n)?n[n.length-1]:void 0)?.type==="comment"?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(r.start,e.indent)){let s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,r.start),s.push(this.sourceToken),e.items.pop();return}}r.start.push(this.sourceToken)}return;case"anchor":case"tag":if(r.value||this.indent<=e.indent)break;r.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;r.value||Wr(r.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):r.start.push(this.sourceToken);return}if(this.indent>e.indent){let n=this.startBlockValue(e);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let r=e.items[e.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!r||r.sep?e.items.push({start:[this.sourceToken]}):r.start.push(this.sourceToken);return;case"map-value-ind":!r||r.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):r.sep?r.sep.push(this.sourceToken):Object.assign(r,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!r||r.value?e.items.push({start:[this.sourceToken]}):r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let s=this.flowScalar(this.type);!r||r.value?e.items.push({start:[],key:s,sep:[]}):r.sep?this.stack.push(s):Object.assign(r,{key:s,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let n=this.startBlockValue(e);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{let n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===e.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){let s=CS(n),a=Xa(s);z6(e);let o=e.end.splice(1,e.end.length);o.push(this.sourceToken);let i={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:a,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=i}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let r=this.source.indexOf(`
`)+1;for(;r!==0;)this.onNewLine(this.offset+r),r=this.source.indexOf(`
`,r)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let r=CS(e),n=Xa(r);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n}]}}case"map-value-ind":{this.onKeyLine=!0;let r=CS(e),n=Xa(r);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,r){return this.type!=="comment"||this.indent<=r?!1:e.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}};Q6.Parser=Q0});var tz=p($c=>{"use strict";var J6=U0(),tye=Cc(),Fc=Uc(),rye=DA(),nye=K0(),X6=J0();function Z6(t){let e=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||e&&new nye.LineCounter||null,prettyErrors:e}}function iye(t,e={}){let{lineCounter:r,prettyErrors:n}=Z6(e),s=new X6.Parser(r?.addNewLine),a=new J6.Composer(e),o=Array.from(a.compose(s.parse(t)));if(n&&r)for(let i of o)i.errors.forEach(Fc.prettifyError(t,r)),i.warnings.forEach(Fc.prettifyError(t,r));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function ez(t,e={}){let{lineCounter:r,prettyErrors:n}=Z6(e),s=new X6.Parser(r?.addNewLine),a=new J6.Composer(e),o=null;for(let i of a.compose(s.parse(t),!0,t.length))if(!o)o=i;else if(o.options.logLevel!=="silent"){o.errors.push(new Fc.YAMLParseError(i.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&r&&(o.errors.forEach(Fc.prettifyError(t,r)),o.warnings.forEach(Fc.prettifyError(t,r))),o}function oye(t,e,r){let n;typeof e=="function"?n=e:r===void 0&&e&&typeof e=="object"&&(r=e);let s=ez(t,r);if(!s)return null;if(s.warnings.forEach(a=>rye.warn(s.options.logLevel,a)),s.errors.length>0){if(s.options.logLevel!=="silent")throw s.errors[0];s.errors=[]}return s.toJS(Object.assign({reviver:n},r))}function sye(t,e,r){let n=null;if(typeof e=="function"||Array.isArray(e)?n=e:r===void 0&&e&&(r=e),typeof r=="string"&&(r=r.length),typeof r=="number"){let s=Math.round(r);r=s<1?void 0:s>8?{indent:8}:{indent:s}}if(t===void 0){let{keepUndefined:s}=r??e??{};if(!s)return}return new tye.Document(t,n,r).toString(r)}$c.parse=oye;$c.parseAllDocuments=iye;$c.parseDocument=ez;$c.stringify=sye});var nz=p(we=>{"use strict";var aye=U0(),uye=Cc(),lye=m0(),X0=Uc(),cye=gc(),xi=ge(),fye=Mi(),dye=Ze(),pye=Ci(),hye=Di(),_ye=LS(),mye=Y0(),Sye=K0(),Eye=J0(),DS=tz(),rz=_c();we.Composer=aye.Composer;we.Document=uye.Document;we.Schema=lye.Schema;we.YAMLError=X0.YAMLError;we.YAMLParseError=X0.YAMLParseError;we.YAMLWarning=X0.YAMLWarning;we.Alias=cye.Alias;we.isAlias=xi.isAlias;we.isCollection=xi.isCollection;we.isDocument=xi.isDocument;we.isMap=xi.isMap;we.isNode=xi.isNode;we.isPair=xi.isPair;we.isScalar=xi.isScalar;we.isSeq=xi.isSeq;we.Pair=fye.Pair;we.Scalar=dye.Scalar;we.YAMLMap=pye.YAMLMap;we.YAMLSeq=hye.YAMLSeq;we.CST=_ye;we.Lexer=mye.Lexer;we.LineCounter=Sye.LineCounter;we.Parser=Eye.Parser;we.parse=DS.parse;we.parseAllDocuments=DS.parseAllDocuments;we.parseDocument=DS.parseDocument;we.stringify=DS.stringify;we.visit=rz.visit;we.visitAsync=rz.visitAsync});var dz=p(Re=>{"use strict";var Z0=Re&&Re.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Re,"__esModule",{value:!0});Re.overwriteConfigForDBOSCloud=Re.translateRuntimeConfig=Re.getRuntimeConfig=Re.translateDbosConfig=Re.getDbosConfig=Re.getSystemDatabaseUrl=Re.isValidDatabaseName=Re.writeConfigFile=Re.readConfigFile=Re.substituteEnvVars=Re.dbosConfigFilePath=void 0;var gye=gt(),sz=Z0(nz()),yye=require("fs"),iz=Z0(require("path")),eR=Z0(require("assert")),Tye=Tm(),wye=wn();Re.dbosConfigFilePath="dbos-config.yaml";function az(t){let e=/\${([^}]+)}/g;return t.replace(e,(r,n)=>process.env[n]||'""')}Re.substituteEnvVars=az;async function Oye(t){t??=process.cwd();let e=iz.default.join(t,Re.dbosConfigFilePath),r=await s(e),n=r?sz.default.parse(az(r)):{};if(!n.name){let a=iz.default.join(t,"package.json"),o=await s(a),i=o?JSON.parse(o):{};n.name=i.name}return n;async function s(a){try{return await(0,gye.readFile)(a)}catch(o){if(o&&typeof o=="object"&&"code"in o&&o.code==="ENOENT")return;throw o}}}Re.readConfigFile=Oye;function vye(t,e){try{let r=sz.default.stringify(t);(0,yye.writeFileSync)(e,r)}catch(r){throw r instanceof Error?new Error(`Failed to write config to ${e}: ${r.message}`):r}}Re.writeConfigFile=vye;function uz(t){return!(t.length<1||t.length>63)}Re.isValidDatabaseName=uz;function lz(t){let e=t.system_database_url||a(t.name),r=new URL(e),n=r.pathname.slice(1),s=[];if(r.username||s.push("username"),r.hostname||s.push("hostname"),n||s.push("database name"),s.length>0)throw new Error(`Invalid database URL: missing required field(s): ${s.join(", ")}`);if(!uz(n))throw new Error(`Database name "${n}" in database_url ${(0,Tye.maskDatabaseUrl)(e)} is invalid.`);return e;function a(i){(0,eR.default)(i,"Application name must be defined to construct a valid database URL.");let u=process.env.PGHOST||"localhost",l=process.env.PGPORT||"5432",c=process.env.PGUSER||"postgres",f=process.env.PGPASSWORD||"dbos",h=o(i)+"_dbos_sys",S=process.env.PGCONNECT_TIMEOUT||"10",g=process.env.PGSSLMODE||(u==="localhost"?"disable":"allow"),E=new URL("postgresql://host/database");return E.username=c,E.password=f,E.hostname=u,E.port=l,E.protocol="postgresql",E.pathname=`/${h}`,E.searchParams.set("connect_timeout",S),E.searchParams.set("sslmode",g),E.toString()}function o(i){let u=i.toLowerCase().replaceAll("-","_").replaceAll(" ","_");return u.match(/^\d/)?"_"+u:u}}Re.getSystemDatabaseUrl=lz;function bye(t,e={}){return(0,eR.default)(t.language===void 0||t.language==="node",`Config file specifies invalid language ${t.language}`),cz({name:t.name,systemDatabaseUrl:t.system_database_url,systemDatabaseSchemaName:t.system_database_schema_name,logLevel:e.logLevel??t.telemetry?.logs?.logLevel,addContextMetadata:t.telemetry?.logs?.addContextMetadata,otlpTracesEndpoints:oz(t.telemetry?.OTLPExporter?.tracesEndpoint),otlpLogsEndpoints:oz(t.telemetry?.OTLPExporter?.logsEndpoint),runAdminServer:t.runtimeConfig?.runAdminServer,adminPort:t.runtimeConfig?.admin_port},e.forceConsole)}Re.getDbosConfig=bye;function oz(t){return t?Array.isArray(t)?t:[t]:[]}function cz(t,e=!1){let r=lz({system_database_url:t.systemDatabaseUrl,name:t.name});return{name:t.name,systemDatabaseUrl:r,sysDbPoolSize:t.systemDatabasePoolSize,systemDatabasePool:t.systemDatabasePool,systemDatabaseSchemaName:t.systemDatabaseSchemaName??"dbos",serializer:t.serializer??wye.DBOSJSON,telemetry:{logs:{logLevel:t.logLevel||"info",addContextMetadata:t.addContextMetadata,forceConsole:e},OTLPExporter:{tracesEndpoint:t.otlpTracesEndpoints,logsEndpoint:t.otlpLogsEndpoints}}}}Re.translateDbosConfig=cz;function Aye(t){return fz(t.runtimeConfig)}Re.getRuntimeConfig=Aye;function fz(t={}){return{runAdminServer:t.runAdminServer??!0,admin_port:t.admin_port??t.adminPort??3001,start:t.start??[],setup:t.setup??[]}}Re.translateRuntimeConfig=fz;function Rye(t,e,r){let n=process.env.DBOS_SYSTEM_DATABASE_URL;(0,eR.default)(n,"DBOS_SYSTEM_DATABASE_URL must be set in DBOS Cloud environment");let s=r.name??t.name,a=new Set(t.telemetry.OTLPExporter?.logsEndpoint),o=r.telemetry?.OTLPExporter?.logsEndpoint;o&&(Array.isArray(o)?o.forEach(f=>a.add(f)):a.add(o));let i=new Set(t.telemetry.OTLPExporter?.tracesEndpoint),u=r.telemetry?.OTLPExporter?.tracesEndpoint;u&&(Array.isArray(u)?u.forEach(f=>i.add(f)):i.add(u));let l={...t,name:s,systemDatabaseUrl:n,systemDatabaseSchemaName:r.system_database_schema_name??t.systemDatabaseSchemaName,telemetry:{logs:{...t.telemetry.logs},OTLPExporter:{logsEndpoint:Array.from(a).filter(f=>!!f),tracesEndpoint:Array.from(i).filter(f=>!!f)}}},c={...e,admin_port:3001,runAdminServer:!0};return[l,c]}Re.overwriteConfigForDBOSCloud=Rye});var UR=p(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.AlertResponse=L.ImportWorkflowResponse=L.ImportWorkflowRequest=L.ExportWorkflowResponse=L.ExportWorkflowRequest=L.GetMetricsResponse=L.MetricDataOutput=L.GetMetricsRequest=L.RetentionResponse=L.RetentionRequest=L.ForkWorkflowResponse=L.ForkWorkflowRequest=L.ListStepsResponse=L.ListStepsRequest=L.ExistPendingWorkflowsResponse=L.ExistPendingWorkflowsRequest=L.GetWorkflowResponse=L.GetWorkflowRequest=L.ListQueuedWorkflowsResponse=L.ListQueuedWorkflowsRequest=L.ListWorkflowsResponse=L.ListWorkflowsRequest=L.WorkflowSteps=L.WorkflowsOutput=L.RestartResponse=L.RestartRequest=L.ResumeResponse=L.ResumeRequest=L.DeleteResponse=L.DeleteRequest=L.CancelResponse=L.CancelRequest=L.RecoveryResponse=L.RecoveryRequest=L.ExecutorInfoResponse=L.BaseResponse=L.MessageType=void 0;var pz=of(),de;(function(t){t.EXECUTOR_INFO="executor_info",t.RECOVERY="recovery",t.CANCEL="cancel",t.DELETE="delete",t.LIST_WORKFLOWS="list_workflows",t.LIST_QUEUED_WORKFLOWS="list_queued_workflows",t.RESUME="resume",t.RESTART="restart",t.GET_WORKFLOW="get_workflow",t.EXIST_PENDING_WORKFLOWS="exist_pending_workflows",t.LIST_STEPS="list_steps",t.FORK_WORKFLOW="fork_workflow",t.RETENTION="retention",t.GET_METRICS="get_metrics",t.EXPORT_WORKFLOW="export_workflow",t.IMPORT_WORKFLOW="import_workflow",t.ALERT="alert"})(de||(L.MessageType=de={}));var et=class{type;request_id;error_message;constructor(e,r,n){this.type=e,this.request_id=r,this.error_message=n}};L.BaseResponse=et;var tR=class extends et{executor_id;application_version;hostname;language;dbos_version;constructor(e,r,n,s,a,o,i){super(de.EXECUTOR_INFO,e,i),this.executor_id=r,this.application_version=n,this.hostname=s,this.language=a,this.dbos_version=o}};L.ExecutorInfoResponse=tR;var rR=class{type=de.RECOVERY;request_id;executor_ids;constructor(e,r){this.request_id=e,this.executor_ids=r}};L.RecoveryRequest=rR;var nR=class extends et{success;constructor(e,r,n){super(de.RECOVERY,e,n),this.success=r}};L.RecoveryResponse=nR;var iR=class{type=de.CANCEL;request_id;workflow_id;constructor(e,r){this.request_id=e,this.workflow_id=r}};L.CancelRequest=iR;var oR=class extends et{success;constructor(e,r,n){super(de.CANCEL,e,n),this.success=r}};L.CancelResponse=oR;var sR=class{type=de.DELETE;request_id;workflow_id;delete_children;constructor(e,r,n=!1){this.request_id=e,this.workflow_id=r,this.delete_children=n}};L.DeleteRequest=sR;var aR=class extends et{success;constructor(e,r,n){super(de.DELETE,e,n),this.success=r}};L.DeleteResponse=aR;var uR=class{type=de.RESUME;request_id;workflow_id;constructor(e,r){this.request_id=e,this.workflow_id=r}};L.ResumeRequest=uR;var lR=class extends et{success;constructor(e,r,n){super(de.RESUME,e,n),this.success=r}};L.ResumeResponse=lR;var cR=class{type=de.RESTART;request_id;workflow_id;constructor(e,r){this.request_id=e,this.workflow_id=r}};L.RestartRequest=cR;var fR=class extends et{success;constructor(e,r,n){super(de.RESTART,e,n),this.success=r}};L.RestartResponse=fR;var dR=class{WorkflowUUID;Status;WorkflowName;WorkflowClassName;WorkflowConfigName;AuthenticatedUser;AssumedRole;AuthenticatedRoles;Input;Output;Error;CreatedAt;UpdatedAt;QueueName;ApplicationVersion;ExecutorID;WorkflowTimeoutMS;WorkflowDeadlineEpochMS;DeduplicationID;Priority;QueuePartitionKey;DequeuedAt;ForkedFrom;ParentWorkflowID;constructor(e){this.WorkflowUUID=e.workflowID,this.Status=e.status,this.WorkflowName=e.workflowName,this.WorkflowClassName=e.workflowClassName?e.workflowClassName:void 0,this.WorkflowConfigName=e.workflowConfigName?e.workflowConfigName:void 0,this.AuthenticatedUser=e.authenticatedUser?e.authenticatedUser:void 0,this.AssumedRole=e.assumedRole?e.assumedRole:void 0,this.AuthenticatedRoles=(e.authenticatedRoles??[]).length>0?JSON.stringify(e.authenticatedRoles):void 0,this.Input=e.input?JSON.stringify(e.input):void 0,this.Output=e.output?JSON.stringify(e.output):void 0,this.Error=e.error?JSON.stringify((0,pz.serializeError)(e.error)):void 0,this.CreatedAt=e.createdAt?String(e.createdAt):void 0,this.UpdatedAt=e.updatedAt?String(e.updatedAt):void 0,this.QueueName=e.queueName?e.queueName:void 0,this.ApplicationVersion=e.applicationVersion,this.ExecutorID=e.executorId,this.WorkflowTimeoutMS=e.timeoutMS!==void 0?String(e.timeoutMS):void 0,this.WorkflowDeadlineEpochMS=e.deadlineEpochMS!==void 0?String(e.deadlineEpochMS):void 0,this.DeduplicationID=e.deduplicationID,this.Priority=String(e.priority),this.QueuePartitionKey=e.queuePartitionKey,this.DequeuedAt=e.dequeuedAt!==void 0?String(e.dequeuedAt):void 0,this.ForkedFrom=e.forkedFrom,this.ParentWorkflowID=e.parentWorkflowID}};L.WorkflowsOutput=dR;var pR=class{function_id;function_name;output;error;child_workflow_id;started_at_epoch_ms;completed_at_epoch_ms;constructor(e){this.function_id=e.functionID,this.function_name=e.name,this.output=e.output?JSON.stringify(e.output):void 0,this.error=e.error?JSON.stringify((0,pz.serializeError)(e.error)):void 0,this.child_workflow_id=e.childWorkflowID??void 0,this.started_at_epoch_ms=e.startedAtEpochMs!==void 0?String(e.startedAtEpochMs):void 0,this.completed_at_epoch_ms=e.completedAtEpochMs!==void 0?String(e.completedAtEpochMs):void 0}};L.WorkflowSteps=pR;var hR=class{type=de.LIST_WORKFLOWS;request_id;body;constructor(e,r){this.request_id=e,this.body=r}};L.ListWorkflowsRequest=hR;var _R=class extends et{output;constructor(e,r,n){super(de.LIST_WORKFLOWS,e,n),this.output=r}};L.ListWorkflowsResponse=_R;var mR=class{type=de.LIST_QUEUED_WORKFLOWS;request_id;body;constructor(e,r){this.request_id=e,this.body=r}};L.ListQueuedWorkflowsRequest=mR;var SR=class extends et{output;constructor(e,r,n){super(de.LIST_QUEUED_WORKFLOWS,e,n),this.output=r}};L.ListQueuedWorkflowsResponse=SR;var ER=class{type=de.GET_WORKFLOW;request_id;workflow_id;constructor(e,r){this.request_id=e,this.workflow_id=r}};L.GetWorkflowRequest=ER;var gR=class extends et{output;constructor(e,r,n){super(de.GET_WORKFLOW,e,n),this.output=r}};L.GetWorkflowResponse=gR;var yR=class{type=de.EXIST_PENDING_WORKFLOWS;request_id;executor_id;application_version;constructor(e,r,n){this.request_id=e,this.executor_id=r,this.application_version=n}};L.ExistPendingWorkflowsRequest=yR;var TR=class extends et{exist;constructor(e,r,n){super(de.EXIST_PENDING_WORKFLOWS,e,n),this.exist=r}};L.ExistPendingWorkflowsResponse=TR;var wR=class{type=de.LIST_STEPS;request_id;workflow_id;constructor(e,r){this.request_id=e,this.workflow_id=r}};L.ListStepsRequest=wR;var OR=class extends et{output;constructor(e,r,n){super(de.LIST_STEPS,e,n),this.output=r}};L.ListStepsResponse=OR;var vR=class{type=de.FORK_WORKFLOW;request_id;body;constructor(e,r){this.request_id=e,this.body=r}};L.ForkWorkflowRequest=vR;var bR=class extends et{new_workflow_id;constructor(e,r,n){super(de.FORK_WORKFLOW,e,n),this.new_workflow_id=r}};L.ForkWorkflowResponse=bR;var AR=class{type=de.RETENTION;request_id;body;constructor(e,r){this.request_id=e,this.body=r}};L.RetentionRequest=AR;var RR=class extends et{success;constructor(e,r,n){super(de.RETENTION,e,n),this.success=r}};L.RetentionResponse=RR;var NR=class{type=de.GET_METRICS;request_id;start_time;end_time;metric_class;constructor(e,r,n,s){this.request_id=e,this.start_time=r,this.end_time=n,this.metric_class=s}};L.GetMetricsRequest=NR;var PR=class{metric_type;metric_name;value;constructor(e,r,n){this.metric_type=e,this.metric_name=r,this.value=n}};L.MetricDataOutput=PR;var IR=class extends et{metrics;constructor(e,r,n){super(de.GET_METRICS,e,n),this.metrics=r}};L.GetMetricsResponse=IR;var MR=class{type=de.EXPORT_WORKFLOW;request_id;workflow_id;export_children;constructor(e,r,n=!1){this.request_id=e,this.workflow_id=r,this.export_children=n}};L.ExportWorkflowRequest=MR;var LR=class extends et{serialized_workflow;constructor(e,r,n){super(de.EXPORT_WORKFLOW,e,n),this.serialized_workflow=r}};L.ExportWorkflowResponse=LR;var CR=class{type=de.IMPORT_WORKFLOW;request_id;serialized_workflow;constructor(e,r){this.request_id=e,this.serialized_workflow=r}};L.ImportWorkflowRequest=CR;var DR=class extends et{success;constructor(e,r,n){super(de.IMPORT_WORKFLOW,e,n),this.success=r}};L.ImportWorkflowResponse=DR;var xR=class extends et{success;constructor(e,r,n){super(de.ALERT,e,n),this.success=r}};L.AlertResponse=xR});var Sz=p(Ee=>{"use strict";var Nye=Ee&&Ee.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),Pye=Ee&&Ee.__setModuleDefault||(Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e}),kS=Ee&&Ee.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Nye(e,t,r);return Pye(e,t),e};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.DBOSAdminServer=Ee.WorkflowQueuesMetadataUrl=Ee.DeactivateUrl=Ee.PerfUrl=Ee.HealthUrl=Ee.WorkflowRecoveryUrl=Ee.WorkflowUUIDHeader=void 0;var Iye=kS(require("http")),Mye=kS(require("url")),hz=dr(),Lye=kS(require("net")),kR=require("perf_hooks"),_z=gt(),Cye=oc(),Dye=cc(),xS=kS(UR());Ee.WorkflowUUIDHeader="dbos-idempotency-key";Ee.WorkflowRecoveryUrl="/dbos-workflow-recovery";Ee.HealthUrl="/dbos-healthz";Ee.PerfUrl="/dbos-perf";Ee.DeactivateUrl="/deactivate";Ee.WorkflowQueuesMetadataUrl="/dbos-workflow-queues-metadata";async function Za(t){return new Promise((e,r)=>{let n="";t.on("data",s=>{n+=String(s)}),t.on("end",()=>{try{e(n?JSON.parse(n):{})}catch{r(new Error("Invalid JSON"))}}),t.on("error",r)})}function Xt(t,e,r){t.writeHead(e,{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}),t.end(JSON.stringify(r))}function mz(t,e,r){t.writeHead(e,{"Content-Type":"text/plain","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}),t.end(r)}function US(t){t.writeHead(204,{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}),t.end()}function xye(t,e){let r=t.split("/"),n=e.split("/");if(r.length!==n.length)return null;let s={};for(let a=0;a<r.length;a++){let o=r[a],i=n[a];if(o.startsWith(":")){let u=o.substring(1);s[u]=i}else if(o!==i)return null}return s}var BR=class t{static setupAdminApp(e){let r=[];return t.registerHealthEndpoint(e,r),t.registerRecoveryEndpoint(e,r),t.registerPerfEndpoint(e,r),t.registerDeactivateEndpoint(e,r),t.registerCancelWorkflowEndpoint(e,r),t.registerResumeWorkflowEndpoint(e,r),t.registerRestartWorkflowEndpoint(e,r),t.registerQueueMetadataEndpoint(e,r),t.registerListWorkflowStepsEndpoint(e,r),t.registerListWorkflowsEndpoint(e,r),t.registerListQueuedWorkflowsEndpoint(e,r),t.registerGetWorkflowEndpoint(e,r),t.registerForkWorkflowEndpoint(e,r),t.registerGarbageCollectEndpoint(e,r),t.registerGlobalTimeoutEndpoint(e,r),Iye.createServer(async(s,a)=>{if(s.method==="OPTIONS"){a.writeHead(200,{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type","Access-Control-Max-Age":"86400"}),a.end();return}let i=Mye.parse(s.url||"",!0).pathname||"",u=!1;for(let l of r)if(s.method===l.method){let c=xye(l.path,i);if(c!==null){u=!0;try{await l.handler(s,a,c)}catch(f){e.logger.error(`Request handler error: ${String(f)}`),Xt(a,500,{error:"Internal server error"})}break}}u||(a.writeHead(404,{"Content-Type":"text/plain"}),a.end("Not Found"))})}static async checkPortAvailabilityIPv4Ipv6(e,r){try{await this.checkPortAvailability(e,"127.0.0.1")}catch(n){let s=n;if(s.code==="EADDRINUSE")throw r.warn(`Port ${e} is already used for IPv4 address "127.0.0.1". Please use the -p option to choose another port.
${s.message}`),n;r.warn(`Error occurred while checking port availability for IPv4 address "127.0.0.1" : ${s.code}
${s.message}`)}try{await this.checkPortAvailability(e,"::1")}catch(n){let s=n;if(s.code==="EADDRINUSE")throw r.warn(`Port ${e} is already used for IPv6 address "::1". Please use the -p option to choose another port.
${s.message}`),n;r.warn(`Error occurred while checking port availability for IPv6 address "::1" : ${s.code}
${s.message}`)}}static async checkPortAvailability(e,r){return new Promise((n,s)=>{let a=new Lye.Server;a.on("error",o=>{s(o)}),a.on("listening",()=>{a.close(),n()}),a.listen({port:e,host:r},()=>{n()})})}static registerHealthEndpoint(e,r){r.push({method:"GET",path:Ee.HealthUrl,handler:async(n,s)=>(mz(s,200,"healthy"),Promise.resolve())}),e.logger.debug(`DBOS Server Registered Healthz GET ${Ee.HealthUrl}`)}static registerQueueMetadataEndpoint(e,r){r.push({method:"GET",path:Ee.WorkflowQueuesMetadataUrl,handler:async(n,s)=>{let a=[];return Cye.wfQueueRunner.wfQueuesByName.forEach((o,i)=>{a.push({name:i,concurrency:o.concurrency,workerConcurrency:o.workerConcurrency,rateLimit:o.rateLimit})}),Xt(s,200,a),Promise.resolve()}}),e.logger.debug(`DBOS Server Registered Queue Metadata GET ${Ee.WorkflowQueuesMetadataUrl}`)}static registerRecoveryEndpoint(e,r){r.push({method:"POST",path:Ee.WorkflowRecoveryUrl,handler:async(n,s)=>{let a=await Za(n);e.logger.info("Recovering workflows for executors: "+a.toString());let o=await e.recoverPendingWorkflows(a),i=await Promise.allSettled(o.map(u=>u.workflowID)).then(u=>u.filter(l=>l.status==="fulfilled").map(l=>l.value));Xt(s,200,i)}}),e.logger.debug(`DBOS Server Registered Recovery POST ${Ee.WorkflowRecoveryUrl}`)}static lastELU=kR.performance.eventLoopUtilization();static registerPerfEndpoint(e,r){r.push({method:"GET",path:Ee.PerfUrl,handler:async(n,s)=>{let a=kR.performance.eventLoopUtilization(),o=kR.performance.eventLoopUtilization(a,t.lastELU);return Xt(s,200,o),t.lastELU=a,Promise.resolve()}}),e.logger.debug(`DBOS Server Registered Perf GET ${Ee.PerfUrl}`)}static isDeactivated=!1;static registerDeactivateEndpoint(e,r){r.push({method:"GET",path:Ee.DeactivateUrl,handler:async(n,s)=>{t.isDeactivated||(e.logger.info(`Deactivating DBOS executor ${_z.globalParams.executorID} with version ${_z.globalParams.appVersion}. This executor will complete existing workflows but will not create new workflows.`),t.isDeactivated=!0),await e.deactivateEventReceivers(!1),mz(s,200,"Deactivated")}}),e.logger.debug(`DBOS Server Registered Deactivate GET ${Ee.DeactivateUrl}`)}static registerGarbageCollectEndpoint(e,r){r.push({method:"POST",path:"/dbos-garbage-collect",handler:async(s,a)=>{let o=await Za(s);await e.systemDatabase.garbageCollect(o.cutoff_epoch_timestamp_ms,o.rows_threshold),US(a)}})}static registerGlobalTimeoutEndpoint(e,r){r.push({method:"POST",path:"/dbos-global-timeout",handler:async(s,a)=>{let o=await Za(s);await(0,Dye.globalTimeout)(e.systemDatabase,o.cutoff_epoch_timestamp_ms),US(a)}})}static registerCancelWorkflowEndpoint(e,r){let n="/workflows/:workflow_id/cancel";r.push({method:"POST",path:n,handler:async(s,a,o)=>{let i=o.workflow_id;await e.cancelWorkflow(i),US(a)}}),e.logger.debug(`DBOS Server Registered Cancel Workflow POST ${n}`)}static registerResumeWorkflowEndpoint(e,r){let n="/workflows/:workflow_id/resume";r.push({method:"POST",path:n,handler:async(s,a,o)=>{let i=o.workflow_id;e.logger.info(`Resuming workflow with ID: ${i}`);try{await e.resumeWorkflow(i),US(a)}catch(u){let l="";u instanceof hz.DBOSError?l=u.message:l="Unknown error",e.logger.error(`Error resuming workflow ${i}: ${l}`),Xt(a,500,{error:`Error resuming workflow ${i}: ${l}`})}}}),e.logger.debug(`DBOS Server Registered Resume Workflow POST ${n}`)}static registerRestartWorkflowEndpoint(e,r){let n="/workflows/:workflow_id/restart";r.push({method:"POST",path:n,handler:async(s,a,o)=>{let i=o.workflow_id;e.logger.info(`Restarting workflow: ${i} with a new id`);let u=await e.forkWorkflow(i,0);Xt(a,200,{workflow_id:u})}}),e.logger.debug(`DBOS Server Registered Restart Workflow POST ${n}`)}static registerForkWorkflowEndpoint(e,r){let n="/workflows/:workflow_id/fork";r.push({method:"POST",path:n,handler:async(s,a,o)=>{let i=o.workflow_id,u=await Za(s);if(u.start_step===void 0){Xt(a,400,{error:"Missing start_step in request body"});return}e.logger.info(`Forking workflow: ${i} from step ${u.start_step} with a new id`);try{let l=await e.forkWorkflow(i,u.start_step,{newWorkflowID:u.new_workflow_id,applicationVersion:u.application_version,timeoutMS:u.timeout_ms});Xt(a,200,{workflow_id:l})}catch(l){let c="";l instanceof hz.DBOSError?c=l.message:c="Unknown error",e.logger.error(`Error forking workflow ${i}: ${c}`),Xt(a,500,{error:`Error forking workflow ${i}: ${c}`})}}}),e.logger.debug(`DBOS Server Registered Fork Workflow POST ${n}`)}static registerListWorkflowStepsEndpoint(e,r){let n="/workflows/:workflow_id/steps";r.push({method:"GET",path:n,handler:async(s,a,o)=>{let i=o.workflow_id,l=(await e.listWorkflowSteps(i))?.map(c=>new xS.WorkflowSteps(c));Xt(a,200,l)}}),e.logger.debug(`DBOS Server Registered List Workflow steps Get ${n}`)}static registerListWorkflowsEndpoint(e,r){let n="/workflows";r.push({method:"POST",path:n,handler:async(s,a)=>{let o=await Za(s),i={workflowIDs:o.workflow_uuids,workflowName:o.workflow_name,authenticatedUser:o.authenticated_user,startTime:o.start_time,endTime:o.end_time,status:o.status,applicationVersion:o.application_version,forkedFrom:o.fork_from,parentWorkflowID:o.parent_workflow_id,limit:o.limit,offset:o.offset,sortDesc:o.sort_desc,workflow_id_prefix:o.workflow_id_prefix,loadInput:o.load_input??!1,loadOutput:o.load_output??!1},l=(await e.listWorkflows(i)).map(c=>new xS.WorkflowsOutput(c));Xt(a,200,l)}}),e.logger.debug(`DBOS Server Registered List Workflows POST ${n}`)}static registerListQueuedWorkflowsEndpoint(e,r){let n="/queues";r.push({method:"POST",path:n,handler:async(s,a)=>{let o=await Za(s),i={workflowName:o.workflow_name,startTime:o.start_time,endTime:o.end_time,status:o.status,forkedFrom:o.fork_from,parentWorkflowID:o.parent_workflow_id,queueName:o.queue_name,limit:o.limit,offset:o.offset,sortDesc:o.sort_desc,loadInput:o.load_input??!1},l=(await e.listQueuedWorkflows(i)).map(c=>new xS.WorkflowsOutput(c));Xt(a,200,l)}}),e.logger.debug(`DBOS Server Registered List Queued Workflows POST ${n}`)}static registerGetWorkflowEndpoint(e,r){let n="/workflows/:workflow_id";r.push({method:"GET",path:n,handler:async(s,a,o)=>{let i=o.workflow_id,u=await e.getWorkflowStatus(i);if(u){let l=new xS.WorkflowsOutput(u);Xt(a,200,l)}else Xt(a,404,{error:`Workflow ${i} not found`})}}),e.logger.debug(`DBOS Server Registered Get Workflow GET ${n}`)}};Ee.DBOSAdminServer=BR});var Un=p((ACe,yz)=>{"use strict";var Ez=["nodebuffer","arraybuffer","fragments"],gz=typeof Blob<"u";gz&&Ez.push("blob");yz.exports={BINARY_TYPES:Ez,CLOSE_TIMEOUT:3e4,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:gz,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Gc=p((RCe,BS)=>{"use strict";var{EMPTY_BUFFER:Uye}=Un(),qR=Buffer[Symbol.species];function kye(t,e){if(t.length===0)return Uye;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),n=0;for(let s=0;s<t.length;s++){let a=t[s];r.set(a,n),n+=a.length}return n<e?new qR(r.buffer,r.byteOffset,n):r}function Tz(t,e,r,n,s){for(let a=0;a<s;a++)r[n+a]=t[a]^e[a&3]}function wz(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}function Bye(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}function VR(t){if(VR.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new qR(t):ArrayBuffer.isView(t)?e=new qR(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),VR.readOnly=!1),e}BS.exports={concat:kye,mask:Tz,toArrayBuffer:Bye,toBuffer:VR,unmask:wz};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=require("bufferutil");BS.exports.mask=function(e,r,n,s,a){a<48?Tz(e,r,n,s,a):t.mask(e,r,n,s,a)},BS.exports.unmask=function(e,r){e.length<32?wz(e,r):t.unmask(e,r)}}catch{}});var bz=p((NCe,vz)=>{"use strict";var Oz=Symbol("kDone"),FR=Symbol("kRun"),$R=class{constructor(e){this[Oz]=()=>{this.pending--,this[FR]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[FR]()}[FR](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[Oz])}}};vz.exports=$R});var jc=p((PCe,Pz)=>{"use strict";var Wc=require("zlib"),Az=Gc(),qye=bz(),{kStatusCode:Rz}=Un(),Vye=Buffer[Symbol.species],Fye=Buffer.from([0,0,255,255]),VS=Symbol("permessage-deflate"),kn=Symbol("total-length"),eu=Symbol("callback"),Ui=Symbol("buffers"),tu=Symbol("error"),qS,GR=class{constructor(e,r,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!qS){let s=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;qS=new qye(s)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[eu];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,n=e.find(s=>!(r.serverNoContextTakeover===!1&&s.server_no_context_takeover||s.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>s.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!s.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(n.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?n.client_max_window_bits=r.clientMaxWindowBits:(n.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(n=>{let s=r[n];if(s.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(s=s[0],n==="client_max_window_bits"){if(s!==!0){let a=+s;if(!Number.isInteger(a)||a<8||a>15)throw new TypeError(`Invalid value for parameter "${n}": ${s}`);s=a}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${s}`)}else if(n==="server_max_window_bits"){let a=+s;if(!Number.isInteger(a)||a<8||a>15)throw new TypeError(`Invalid value for parameter "${n}": ${s}`);s=a}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(s!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${s}`)}else throw new Error(`Unknown parameter "${n}"`);r[n]=s})}),e}decompress(e,r,n){qS.add(s=>{this._decompress(e,r,(a,o)=>{s(),n(a,o)})})}compress(e,r,n){qS.add(s=>{this._compress(e,r,(a,o)=>{s(),n(a,o)})})}_decompress(e,r,n){let s=this._isServer?"client":"server";if(!this._inflate){let a=`${s}_max_window_bits`,o=typeof this.params[a]!="number"?Wc.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=Wc.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[VS]=this,this._inflate[kn]=0,this._inflate[Ui]=[],this._inflate.on("error",Gye),this._inflate.on("data",Nz)}this._inflate[eu]=n,this._inflate.write(e),r&&this._inflate.write(Fye),this._inflate.flush(()=>{let a=this._inflate[tu];if(a){this._inflate.close(),this._inflate=null,n(a);return}let o=Az.concat(this._inflate[Ui],this._inflate[kn]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[kn]=0,this._inflate[Ui]=[],r&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),n(null,o)})}_compress(e,r,n){let s=this._isServer?"server":"client";if(!this._deflate){let a=`${s}_max_window_bits`,o=typeof this.params[a]!="number"?Wc.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=Wc.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[kn]=0,this._deflate[Ui]=[],this._deflate.on("data",$ye)}this._deflate[eu]=n,this._deflate.write(e),this._deflate.flush(Wc.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=Az.concat(this._deflate[Ui],this._deflate[kn]);r&&(a=new Vye(a.buffer,a.byteOffset,a.length-4)),this._deflate[eu]=null,this._deflate[kn]=0,this._deflate[Ui]=[],r&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),n(null,a)})}};Pz.exports=GR;function $ye(t){this[Ui].push(t),this[kn]+=t.length}function Nz(t){if(this[kn]+=t.length,this[VS]._maxPayload<1||this[kn]<=this[VS]._maxPayload){this[Ui].push(t);return}this[tu]=new RangeError("Max payload size exceeded"),this[tu].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[tu][Rz]=1009,this.removeListener("data",Nz),this.reset()}function Gye(t){if(this[VS]._inflate=null,this[tu]){this[eu](this[tu]);return}t[Rz]=1007,this[eu](t)}});var ru=p((ICe,FS)=>{"use strict";var{isUtf8:Iz}=require("buffer"),{hasBlob:Wye}=Un(),jye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Hye(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}function WR(t){let e=t.length,r=0;for(;r<e;)if((t[r]&128)===0)r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}function Yye(t){return Wye&&typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&(t[Symbol.toStringTag]==="Blob"||t[Symbol.toStringTag]==="File")}FS.exports={isBlob:Yye,isValidStatusCode:Hye,isValidUTF8:WR,tokenChars:jye};if(Iz)FS.exports.isValidUTF8=function(t){return t.length<24?WR(t):Iz(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=require("utf-8-validate");FS.exports.isValidUTF8=function(e){return e.length<32?WR(e):t(e)}}catch{}});var KR=p((MCe,kz)=>{"use strict";var{Writable:zye}=require("stream"),Mz=jc(),{BINARY_TYPES:Kye,EMPTY_BUFFER:Lz,kStatusCode:Qye,kWebSocket:Jye}=Un(),{concat:jR,toArrayBuffer:Xye,unmask:Zye}=Gc(),{isValidStatusCode:eTe,isValidUTF8:Cz}=ru(),$S=Buffer[Symbol.species],Pr=0,Dz=1,xz=2,Uz=3,HR=4,YR=5,GS=6,zR=class extends zye{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Kye[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Jye]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=Pr}_write(e,r,n){if(this._opcode===8&&this._state==Pr)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new $S(n.buffer,n.byteOffset+e,n.length-e),new $S(n.buffer,n.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let n=this._buffers[0],s=r.length-e;e>=n.length?r.set(this._buffers.shift(),s):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),s),this._buffers[0]=new $S(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}startLoop(e){this._loop=!0;do switch(this._state){case Pr:this.getInfo(e);break;case Dz:this.getPayloadLength16(e);break;case xz:this.getPayloadLength64(e);break;case Uz:this.getMask();break;case HR:this.getData(e);break;case YR:case GS:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let r=this.consume(2);if((r[0]&48)!==0){let s=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(s);return}let n=(r[0]&64)===64;if(n&&!this._extensions[Mz.extensionName]){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._fin=(r[0]&128)===128,this._opcode=r[0]&15,this._payloadLength=r[1]&127,this._opcode===0){if(n){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(!this._fragmented){let s=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let s=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(s);return}if(n){let s=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(s);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let s=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(s);return}}else{let s=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(s);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(r[1]&128)===128,this._isServer){if(!this._masked){let s=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(s);return}}else if(this._masked){let s=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(s);return}this._payloadLength===126?this._state=Dz:this._payloadLength===127?this._state=xz:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let r=this.consume(8),n=r.readUInt32BE(0);if(n>Math.pow(2,21)-1){let s=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(s);return}this._payloadLength=n*Math.pow(2,32)+r.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let r=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(r);return}this._masked?this._state=Uz:this._state=HR}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=HR}getData(e){let r=Lz;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Zye(r,this._mask)}if(this._opcode>7){this.controlMessage(r,e);return}if(this._compressed){this._state=YR,this.decompress(r,e);return}r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage(e)}decompress(e,r){this._extensions[Mz.extensionName].decompress(e,this._fin,(s,a)=>{if(s)return r(s);if(a.length){if(this._messageLength+=a.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");r(o);return}this._fragments.push(a)}this.dataMessage(r),this._state===Pr&&this.startLoop(r)})}dataMessage(e){if(!this._fin){this._state=Pr;return}let r=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=jR(n,r):this._binaryType==="arraybuffer"?s=Xye(jR(n,r)):this._binaryType==="blob"?s=new Blob(n):s=n,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=Pr):(this._state=GS,setImmediate(()=>{this.emit("message",s,!0),this._state=Pr,this.startLoop(e)}))}else{let s=jR(n,r);if(!this._skipUTF8Validation&&!Cz(s)){let a=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(a);return}this._state===YR||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=Pr):(this._state=GS,setImmediate(()=>{this.emit("message",s,!1),this._state=Pr,this.startLoop(e)}))}}controlMessage(e,r){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Lz),this.end();else{let n=e.readUInt16BE(0);if(!eTe(n)){let a=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");r(a);return}let s=new $S(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Cz(s)){let a=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");r(a);return}this._loop=!1,this.emit("conclude",n,s),this.end()}this._state=Pr;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=Pr):(this._state=GS,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=Pr,this.startLoop(r)}))}createError(e,r,n,s,a){this._loop=!1,this._errored=!0;let o=new e(n?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(o,this.createError),o.code=a,o[Qye]=s,o}};kz.exports=zR});var XR=p((CCe,Vz)=>{"use strict";var{Duplex:LCe}=require("stream"),{randomFillSync:tTe}=require("crypto"),Bz=jc(),{EMPTY_BUFFER:rTe,kWebSocket:nTe,NOOP:iTe}=Un(),{isBlob:nu,isValidStatusCode:oTe}=ru(),{mask:qz,toBuffer:Vo}=Gc(),Ir=Symbol("kByteLength"),sTe=Buffer.alloc(4),WS=8*1024,Fo,iu=WS,jr=0,aTe=1,uTe=2,QR=class t{constructor(e,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=jr,this.onerror=iTe,this[nTe]=void 0}static frame(e,r){let n,s=!1,a=2,o=!1;r.mask&&(n=r.maskBuffer||sTe,r.generateMask?r.generateMask(n):(iu===WS&&(Fo===void 0&&(Fo=Buffer.alloc(WS)),tTe(Fo,0,WS),iu=0),n[0]=Fo[iu++],n[1]=Fo[iu++],n[2]=Fo[iu++],n[3]=Fo[iu++]),o=(n[0]|n[1]|n[2]|n[3])===0,a=6);let i;typeof e=="string"?(!r.mask||o)&&r[Ir]!==void 0?i=r[Ir]:(e=Buffer.from(e),i=e.length):(i=e.length,s=r.mask&&r.readOnly&&!o);let u=i;i>=65536?(a+=8,u=127):i>125&&(a+=2,u=126);let l=Buffer.allocUnsafe(s?i+a:a);return l[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(l[0]|=64),l[1]=u,u===126?l.writeUInt16BE(i,2):u===127&&(l[2]=l[3]=0,l.writeUIntBE(i,4,6)),r.mask?(l[1]|=128,l[a-4]=n[0],l[a-3]=n[1],l[a-2]=n[2],l[a-1]=n[3],o?[l,e]:s?(qz(e,n,l,a,i),[l]):(qz(e,n,e,0,i),[l,e])):[l,e]}close(e,r,n,s){let a;if(e===void 0)a=rTe;else{if(typeof e!="number"||!oTe(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)a=Buffer.allocUnsafe(2),a.writeUInt16BE(e,0);else{let i=Buffer.byteLength(r);if(i>123)throw new RangeError("The message must not be greater than 123 bytes");a=Buffer.allocUnsafe(2+i),a.writeUInt16BE(e,0),typeof r=="string"?a.write(r,2):a.set(r,2)}}let o={[Ir]:a.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==jr?this.enqueue([this.dispatch,a,!1,o,s]):this.sendFrame(t.frame(a,o),s)}ping(e,r,n){let s,a;if(typeof e=="string"?(s=Buffer.byteLength(e),a=!1):nu(e)?(s=e.size,a=!1):(e=Vo(e),s=e.length,a=Vo.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Ir]:s,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:a,rsv1:!1};nu(e)?this._state!==jr?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==jr?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(t.frame(e,o),n)}pong(e,r,n){let s,a;if(typeof e=="string"?(s=Buffer.byteLength(e),a=!1):nu(e)?(s=e.size,a=!1):(e=Vo(e),s=e.length,a=Vo.readOnly),s>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[Ir]:s,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:a,rsv1:!1};nu(e)?this._state!==jr?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):this._state!==jr?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(t.frame(e,o),n)}send(e,r,n){let s=this._extensions[Bz.extensionName],a=r.binary?2:1,o=r.compress,i,u;typeof e=="string"?(i=Buffer.byteLength(e),u=!1):nu(e)?(i=e.size,u=!1):(e=Vo(e),i=e.length,u=Vo.readOnly),this._firstFragment?(this._firstFragment=!1,o&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=i>=s._threshold),this._compress=o):(o=!1,a=0),r.fin&&(this._firstFragment=!0);let l={[Ir]:i,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:u,rsv1:o};nu(e)?this._state!==jr?this.enqueue([this.getBlobData,e,this._compress,l,n]):this.getBlobData(e,this._compress,l,n):this._state!==jr?this.enqueue([this.dispatch,e,this._compress,l,n]):this.dispatch(e,this._compress,l,n)}getBlobData(e,r,n,s){this._bufferedBytes+=n[Ir],this._state=uTe,e.arrayBuffer().then(a=>{if(this._socket.destroyed){let i=new Error("The socket was closed while the blob was being read");process.nextTick(JR,this,i,s);return}this._bufferedBytes-=n[Ir];let o=Vo(a);r?this.dispatch(o,r,n,s):(this._state=jr,this.sendFrame(t.frame(o,n),s),this.dequeue())}).catch(a=>{process.nextTick(lTe,this,a,s)})}dispatch(e,r,n,s){if(!r){this.sendFrame(t.frame(e,n),s);return}let a=this._extensions[Bz.extensionName];this._bufferedBytes+=n[Ir],this._state=aTe,a.compress(e,n.fin,(o,i)=>{if(this._socket.destroyed){let u=new Error("The socket was closed while data was being compressed");JR(this,u,s);return}this._bufferedBytes-=n[Ir],this._state=jr,n.readOnly=!1,this.sendFrame(t.frame(i,n),s),this.dequeue()})}dequeue(){for(;this._state===jr&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][Ir],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][Ir],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};Vz.exports=QR;function JR(t,e,r){typeof r=="function"&&r(e);for(let n=0;n<t._queue.length;n++){let s=t._queue[n],a=s[s.length-1];typeof a=="function"&&a(e)}}function lTe(t,e,r){JR(t,e,r),t.onerror(e)}});var Kz=p((DCe,zz)=>{"use strict";var{kForOnEventAttribute:Hc,kListener:ZR}=Un(),Fz=Symbol("kCode"),$z=Symbol("kData"),Gz=Symbol("kError"),Wz=Symbol("kMessage"),jz=Symbol("kReason"),ou=Symbol("kTarget"),Hz=Symbol("kType"),Yz=Symbol("kWasClean"),Bn=class{constructor(e){this[ou]=null,this[Hz]=e}get target(){return this[ou]}get type(){return this[Hz]}};Object.defineProperty(Bn.prototype,"target",{enumerable:!0});Object.defineProperty(Bn.prototype,"type",{enumerable:!0});var $o=class extends Bn{constructor(e,r={}){super(e),this[Fz]=r.code===void 0?0:r.code,this[jz]=r.reason===void 0?"":r.reason,this[Yz]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[Fz]}get reason(){return this[jz]}get wasClean(){return this[Yz]}};Object.defineProperty($o.prototype,"code",{enumerable:!0});Object.defineProperty($o.prototype,"reason",{enumerable:!0});Object.defineProperty($o.prototype,"wasClean",{enumerable:!0});var su=class extends Bn{constructor(e,r={}){super(e),this[Gz]=r.error===void 0?null:r.error,this[Wz]=r.message===void 0?"":r.message}get error(){return this[Gz]}get message(){return this[Wz]}};Object.defineProperty(su.prototype,"error",{enumerable:!0});Object.defineProperty(su.prototype,"message",{enumerable:!0});var Yc=class extends Bn{constructor(e,r={}){super(e),this[$z]=r.data===void 0?null:r.data}get data(){return this[$z]}};Object.defineProperty(Yc.prototype,"data",{enumerable:!0});var cTe={addEventListener(t,e,r={}){for(let s of this.listeners(t))if(!r[Hc]&&s[ZR]===e&&!s[Hc])return;let n;if(t==="message")n=function(a,o){let i=new Yc("message",{data:o?a:a.toString()});i[ou]=this,jS(e,this,i)};else if(t==="close")n=function(a,o){let i=new $o("close",{code:a,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[ou]=this,jS(e,this,i)};else if(t==="error")n=function(a){let o=new su("error",{error:a,message:a.message});o[ou]=this,jS(e,this,o)};else if(t==="open")n=function(){let a=new Bn("open");a[ou]=this,jS(e,this,a)};else return;n[Hc]=!!r[Hc],n[ZR]=e,r.once?this.once(t,n):this.on(t,n)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[ZR]===e&&!r[Hc]){this.removeListener(t,r);break}}};zz.exports={CloseEvent:$o,ErrorEvent:su,Event:Bn,EventTarget:cTe,MessageEvent:Yc};function jS(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}});var eN=p((xCe,Qz)=>{"use strict";var{tokenChars:zc}=ru();function Sn(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}function fTe(t){let e=Object.create(null),r=Object.create(null),n=!1,s=!1,a=!1,o,i,u=-1,l=-1,c=-1,f=0;for(;f<t.length;f++)if(l=t.charCodeAt(f),o===void 0)if(c===-1&&zc[l]===1)u===-1&&(u=f);else if(f!==0&&(l===32||l===9))c===-1&&u!==-1&&(c=f);else if(l===59||l===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${f}`);c===-1&&(c=f);let S=t.slice(u,c);l===44?(Sn(e,S,r),r=Object.create(null)):o=S,u=c=-1}else throw new SyntaxError(`Unexpected character at index ${f}`);else if(i===void 0)if(c===-1&&zc[l]===1)u===-1&&(u=f);else if(l===32||l===9)c===-1&&u!==-1&&(c=f);else if(l===59||l===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${f}`);c===-1&&(c=f),Sn(r,t.slice(u,c),!0),l===44&&(Sn(e,o,r),r=Object.create(null),o=void 0),u=c=-1}else if(l===61&&u!==-1&&c===-1)i=t.slice(u,f),u=c=-1;else throw new SyntaxError(`Unexpected character at index ${f}`);else if(s){if(zc[l]!==1)throw new SyntaxError(`Unexpected character at index ${f}`);u===-1?u=f:n||(n=!0),s=!1}else if(a)if(zc[l]===1)u===-1&&(u=f);else if(l===34&&u!==-1)a=!1,c=f;else if(l===92)s=!0;else throw new SyntaxError(`Unexpected character at index ${f}`);else if(l===34&&t.charCodeAt(f-1)===61)a=!0;else if(c===-1&&zc[l]===1)u===-1&&(u=f);else if(u!==-1&&(l===32||l===9))c===-1&&(c=f);else if(l===59||l===44){if(u===-1)throw new SyntaxError(`Unexpected character at index ${f}`);c===-1&&(c=f);let S=t.slice(u,c);n&&(S=S.replace(/\\/g,""),n=!1),Sn(r,i,S),l===44&&(Sn(e,o,r),r=Object.create(null),o=void 0),i=void 0,u=c=-1}else throw new SyntaxError(`Unexpected character at index ${f}`);if(u===-1||a||l===32||l===9)throw new SyntaxError("Unexpected end of input");c===-1&&(c=f);let h=t.slice(u,c);return o===void 0?Sn(e,h,r):(i===void 0?Sn(r,h,!0):n?Sn(r,i,h.replace(/\\/g,"")):Sn(r,i,h),Sn(e,o,r)),e}function dTe(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(n=>[e].concat(Object.keys(n).map(s=>{let a=n[s];return Array.isArray(a)||(a=[a]),a.map(o=>o===!0?s:`${s}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Qz.exports={format:dTe,parse:fTe}});var KS=p((BCe,u8)=>{"use strict";var pTe=require("events"),hTe=require("https"),_Te=require("http"),Zz=require("net"),mTe=require("tls"),{randomBytes:STe,createHash:ETe}=require("crypto"),{Duplex:UCe,Readable:kCe}=require("stream"),{URL:tN}=require("url"),ki=jc(),gTe=KR(),yTe=XR(),{isBlob:TTe}=ru(),{BINARY_TYPES:Jz,CLOSE_TIMEOUT:wTe,EMPTY_BUFFER:HS,GUID:OTe,kForOnEventAttribute:rN,kListener:vTe,kStatusCode:bTe,kWebSocket:dt,NOOP:e8}=Un(),{EventTarget:{addEventListener:ATe,removeEventListener:RTe}}=Kz(),{format:NTe,parse:PTe}=eN(),{toBuffer:ITe}=Gc(),t8=Symbol("kAborted"),nN=[8,13],qn=["CONNECTING","OPEN","CLOSING","CLOSED"],MTe=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Ue=class t extends pTe{constructor(e,r,n){super(),this._binaryType=Jz[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=HS,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(n=r,r=[]):r=[r]),r8(this,e,r,n)):(this._autoPong=n.autoPong,this._closeTimeout=n.closeTimeout,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){Jz.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,n){let s=new gTe({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),a=new yTe(e,this._extensions,n.generateMask);this._receiver=s,this._sender=a,this._socket=e,s[dt]=this,a[dt]=this,e[dt]=this,s.on("conclude",DTe),s.on("drain",xTe),s.on("error",UTe),s.on("message",kTe),s.on("ping",BTe),s.on("pong",qTe),a.onerror=VTe,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",o8),e.on("data",zS),e.on("end",s8),e.on("error",a8),this._readyState=t.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ki.extensionName]&&this._extensions[ki.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){fr(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===t.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),i8(this)}}pause(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){iN(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||HS,r,n)}pong(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){iN(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||HS,r,n)}resume(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(n=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){iN(this,e,n);return}let s={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[ki.extensionName]||(s.compress=!1),this._sender.send(e||HS,s,n)}terminate(){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){fr(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=t.CLOSING,this._socket.destroy())}}};Object.defineProperty(Ue,"CONNECTING",{enumerable:!0,value:qn.indexOf("CONNECTING")});Object.defineProperty(Ue.prototype,"CONNECTING",{enumerable:!0,value:qn.indexOf("CONNECTING")});Object.defineProperty(Ue,"OPEN",{enumerable:!0,value:qn.indexOf("OPEN")});Object.defineProperty(Ue.prototype,"OPEN",{enumerable:!0,value:qn.indexOf("OPEN")});Object.defineProperty(Ue,"CLOSING",{enumerable:!0,value:qn.indexOf("CLOSING")});Object.defineProperty(Ue.prototype,"CLOSING",{enumerable:!0,value:qn.indexOf("CLOSING")});Object.defineProperty(Ue,"CLOSED",{enumerable:!0,value:qn.indexOf("CLOSED")});Object.defineProperty(Ue.prototype,"CLOSED",{enumerable:!0,value:qn.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(Ue.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty(Ue.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[rN])return e[vTe];return null},set(e){for(let r of this.listeners(t))if(r[rN]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[rN]:!0})}})});Ue.prototype.addEventListener=ATe;Ue.prototype.removeEventListener=RTe;u8.exports=Ue;function r8(t,e,r,n){let s={allowSynchronousEvents:!0,autoPong:!0,closeTimeout:wTe,protocolVersion:nN[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=s.autoPong,t._closeTimeout=s.closeTimeout,!nN.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${nN.join(", ")})`);let a;if(e instanceof tN)a=e;else try{a=new tN(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}a.protocol==="http:"?a.protocol="ws:":a.protocol==="https:"&&(a.protocol="wss:"),t._url=a.href;let o=a.protocol==="wss:",i=a.protocol==="ws+unix:",u;if(a.protocol!=="ws:"&&!o&&!i?u=`The URL's protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"`:i&&!a.pathname?u="The URL's pathname is empty":a.hash&&(u="The URL contains a fragment identifier"),u){let E=new SyntaxError(u);if(t._redirects===0)throw E;YS(t,E);return}let l=o?443:80,c=STe(16).toString("base64"),f=o?hTe.request:_Te.request,h=new Set,S;if(s.createConnection=s.createConnection||(o?CTe:LTe),s.defaultPort=s.defaultPort||l,s.port=a.port||l,s.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":c,Connection:"Upgrade",Upgrade:"websocket"},s.path=a.pathname+a.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(S=new ki(s.perMessageDeflate!==!0?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=NTe({[ki.extensionName]:S.offer()})),r.length){for(let E of r){if(typeof E!="string"||!MTe.test(E)||h.has(E))throw new SyntaxError("An invalid or duplicated subprotocol was specified");h.add(E)}s.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(a.username||a.password)&&(s.auth=`${a.username}:${a.password}`),i){let E=s.path.split(":");s.socketPath=E[0],s.path=E[1]}let g;if(s.followRedirects){if(t._redirects===0){t._originalIpc=i,t._originalSecure=o,t._originalHostOrSocketPath=i?s.socketPath:a.host;let E=n&&n.headers;if(n={...n,headers:{}},E)for(let[T,O]of Object.entries(E))n.headers[T.toLowerCase()]=O}else if(t.listenerCount("redirect")===0){let E=i?t._originalIpc?s.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:a.host===t._originalHostOrSocketPath;(!E||t._originalSecure&&!o)&&(delete s.headers.authorization,delete s.headers.cookie,E||delete s.headers.host,s.auth=void 0)}s.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),g=t._req=f(s),t._redirects&&t.emit("redirect",t.url,g)}else g=t._req=f(s);s.timeout&&g.on("timeout",()=>{fr(t,g,"Opening handshake has timed out")}),g.on("error",E=>{g===null||g[t8]||(g=t._req=null,YS(t,E))}),g.on("response",E=>{let T=E.headers.location,O=E.statusCode;if(T&&s.followRedirects&&O>=300&&O<400){if(++t._redirects>s.maxRedirects){fr(t,g,"Maximum redirects exceeded");return}g.abort();let v;try{v=new tN(T,e)}catch{let N=new SyntaxError(`Invalid URL: ${T}`);YS(t,N);return}r8(t,v,r,n)}else t.emit("unexpected-response",g,E)||fr(t,g,`Unexpected server response: ${E.statusCode}`)}),g.on("upgrade",(E,T,O)=>{if(t.emit("upgrade",E),t.readyState!==Ue.CONNECTING)return;g=t._req=null;let v=E.headers.upgrade;if(v===void 0||v.toLowerCase()!=="websocket"){fr(t,T,"Invalid Upgrade header");return}let b=ETe("sha1").update(c+OTe).digest("base64");if(E.headers["sec-websocket-accept"]!==b){fr(t,T,"Invalid Sec-WebSocket-Accept header");return}let N=E.headers["sec-websocket-protocol"],I;if(N!==void 0?h.size?h.has(N)||(I="Server sent an invalid subprotocol"):I="Server sent a subprotocol but none was requested":h.size&&(I="Server sent no subprotocol"),I){fr(t,T,I);return}N&&(t._protocol=N);let R=E.headers["sec-websocket-extensions"];if(R!==void 0){if(!S){fr(t,T,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let x;try{x=PTe(R)}catch{fr(t,T,"Invalid Sec-WebSocket-Extensions header");return}let C=Object.keys(x);if(C.length!==1||C[0]!==ki.extensionName){fr(t,T,"Server indicated an extension that was not requested");return}try{S.accept(x[ki.extensionName])}catch{fr(t,T,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[ki.extensionName]=S}t.setSocket(T,O,{allowSynchronousEvents:s.allowSynchronousEvents,generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})}),s.finishRequest?s.finishRequest(g,t):g.end()}function YS(t,e){t._readyState=Ue.CLOSING,t._errorEmitted=!0,t.emit("error",e),t.emitClose()}function LTe(t){return t.path=t.socketPath,Zz.connect(t)}function CTe(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=Zz.isIP(t.host)?"":t.host),mTe.connect(t)}function fr(t,e,r){t._readyState=Ue.CLOSING;let n=new Error(r);Error.captureStackTrace(n,fr),e.setHeader?(e[t8]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(YS,t,n)):(e.destroy(n),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}function iN(t,e,r){if(e){let n=TTe(e)?e.size:ITe(e).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(r){let n=new Error(`WebSocket is not open: readyState ${t.readyState} (${qn[t.readyState]})`);process.nextTick(r,n)}}function DTe(t,e){let r=this[dt];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[dt]!==void 0&&(r._socket.removeListener("data",zS),process.nextTick(n8,r._socket),t===1005?r.close():r.close(t,e))}function xTe(){let t=this[dt];t.isPaused||t._socket.resume()}function UTe(t){let e=this[dt];e._socket[dt]!==void 0&&(e._socket.removeListener("data",zS),process.nextTick(n8,e._socket),e.close(t[bTe])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t))}function Xz(){this[dt].emitClose()}function kTe(t,e){this[dt].emit("message",t,e)}function BTe(t){let e=this[dt];e._autoPong&&e.pong(t,!this._isServer,e8),e.emit("ping",t)}function qTe(t){this[dt].emit("pong",t)}function n8(t){t.resume()}function VTe(t){let e=this[dt];e.readyState!==Ue.CLOSED&&(e.readyState===Ue.OPEN&&(e._readyState=Ue.CLOSING,i8(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",t)))}function i8(t){t._closeTimer=setTimeout(t._socket.destroy.bind(t._socket),t._closeTimeout)}function o8(){let t=this[dt];if(this.removeListener("close",o8),this.removeListener("data",zS),this.removeListener("end",s8),t._readyState=Ue.CLOSING,!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&this._readableState.length!==0){let e=this.read(this._readableState.length);t._receiver.write(e)}t._receiver.end(),this[dt]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",Xz),t._receiver.on("finish",Xz))}function zS(t){this[dt]._receiver.write(t)||this.pause()}function s8(){let t=this[dt];t._readyState=Ue.CLOSING,t._receiver.end(),this.end()}function a8(){let t=this[dt];this.removeListener("error",a8),this.on("error",e8),t&&(t._readyState=Ue.CLOSING,this.destroy())}});var d8=p((VCe,f8)=>{"use strict";var qCe=KS(),{Duplex:FTe}=require("stream");function l8(t){t.emit("close")}function $Te(){!this.destroyed&&this._writableState.finished&&this.destroy()}function c8(t){this.removeListener("error",c8),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}function GTe(t,e){let r=!0,n=new FTe({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(a,o){let i=!o&&n._readableState.objectMode?a.toString():a;n.push(i)||t.pause()}),t.once("error",function(a){n.destroyed||(r=!1,n.destroy(a))}),t.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(s,a){if(t.readyState===t.CLOSED){a(s),process.nextTick(l8,n);return}let o=!1;t.once("error",function(u){o=!0,a(u)}),t.once("close",function(){o||a(s),process.nextTick(l8,n)}),r&&t.terminate()},n._final=function(s){if(t.readyState===t.CONNECTING){t.once("open",function(){n._final(s)});return}t._socket!==null&&(t._socket._writableState.finished?(s(),n._readableState.endEmitted&&n.destroy()):(t._socket.once("finish",function(){s()}),t.close()))},n._read=function(){t.isPaused&&t.resume()},n._write=function(s,a,o){if(t.readyState===t.CONNECTING){t.once("open",function(){n._write(s,a,o)});return}t.send(s,o)},n.on("end",$Te),n.on("error",c8),n}f8.exports=GTe});var h8=p((FCe,p8)=>{"use strict";var{tokenChars:WTe}=ru();function jTe(t){let e=new Set,r=-1,n=-1,s=0;for(s;s<t.length;s++){let o=t.charCodeAt(s);if(n===-1&&WTe[o]===1)r===-1&&(r=s);else if(s!==0&&(o===32||o===9))n===-1&&r!==-1&&(n=s);else if(o===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${s}`);n===-1&&(n=s);let i=t.slice(r,n);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);e.add(i),r=n=-1}else throw new SyntaxError(`Unexpected character at index ${s}`)}if(r===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let a=t.slice(r,s);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);return e.add(a),e}p8.exports={parse:jTe}});var T8=p((GCe,y8)=>{"use strict";var HTe=require("events"),QS=require("http"),{Duplex:$Ce}=require("stream"),{createHash:YTe}=require("crypto"),_8=eN(),Go=jc(),zTe=h8(),KTe=KS(),{CLOSE_TIMEOUT:QTe,GUID:JTe,kWebSocket:XTe}=Un(),ZTe=/^[+/0-9A-Za-z]{22}==$/,m8=0,S8=1,g8=2,oN=class extends HTe{constructor(e,r){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,closeTimeout:QTe,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:KTe,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=QS.createServer((n,s)=>{let a=QS.STATUS_CODES[426];s.writeHead(426,{"Content-Length":a.length,"Content-Type":"text/plain"}),s.end(a)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=ewe(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(s,a,o)=>{this.handleUpgrade(s,a,o,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=m8}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===g8){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Kc,this);return}if(e&&this.once("close",e),this._state!==S8)if(this._state=S8,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Kc,this):process.nextTick(Kc,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{Kc(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,n,s){r.on("error",E8);let a=e.headers["sec-websocket-key"],o=e.headers.upgrade,i=+e.headers["sec-websocket-version"];if(e.method!=="GET"){Wo(this,e,r,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){Wo(this,e,r,400,"Invalid Upgrade header");return}if(a===void 0||!ZTe.test(a)){Wo(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(i!==13&&i!==8){Wo(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){Qc(r,400);return}let u=e.headers["sec-websocket-protocol"],l=new Set;if(u!==void 0)try{l=zTe.parse(u)}catch{Wo(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let c=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&c!==void 0){let h=new Go(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let S=_8.parse(c);S[Go.extensionName]&&(h.accept(S[Go.extensionName]),f[Go.extensionName]=h)}catch{Wo(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let h={origin:e.headers[`${i===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(h,(S,g,E,T)=>{if(!S)return Qc(r,g||401,E,T);this.completeUpgrade(f,a,l,e,r,n,s)});return}if(!this.options.verifyClient(h))return Qc(r,401)}this.completeUpgrade(f,a,l,e,r,n,s)}completeUpgrade(e,r,n,s,a,o,i){if(!a.readable||!a.writable)return a.destroy();if(a[XTe])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>m8)return Qc(a,503);let l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${YTe("sha1").update(r+JTe).digest("base64")}`],c=new this.options.WebSocket(null,void 0,this.options);if(n.size){let f=this.options.handleProtocols?this.options.handleProtocols(n,s):n.values().next().value;f&&(l.push(`Sec-WebSocket-Protocol: ${f}`),c._protocol=f)}if(e[Go.extensionName]){let f=e[Go.extensionName].params,h=_8.format({[Go.extensionName]:[f]});l.push(`Sec-WebSocket-Extensions: ${h}`),c._extensions=e}this.emit("headers",l,s),a.write(l.concat(`\r
`).join(`\r
`)),a.removeListener("error",E8),c.setSocket(a,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(c),c.on("close",()=>{this.clients.delete(c),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Kc,this)})),i(c,s)}};y8.exports=oN;function ewe(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return function(){for(let n of Object.keys(e))t.removeListener(n,e[n])}}function Kc(t){t._state=g8,t.emit("close")}function E8(){this.destroy()}function Qc(t,e,r,n){r=r||QS.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${QS.STATUS_CODES[e]}\r
`+Object.keys(n).map(s=>`${s}: ${n[s]}`).join(`\r
`)+`\r
\r
`+r)}function Wo(t,e,r,n,s,a){if(t.listenerCount("wsClientError")){let o=new Error(s);Error.captureStackTrace(o,Wo),t.emit("wsClientError",o,r,e)}else Qc(r,n,s,a)}});var O8=p((WCe,w8)=>{"use strict";var Vn=KS();Vn.createWebSocketStream=d8();Vn.Server=T8();Vn.Receiver=KR();Vn.Sender=XR();Vn.WebSocket=Vn;Vn.WebSocketServer=Vn.Server;w8.exports=Vn});var N8=p(Mr=>{"use strict";var twe=Mr&&Mr.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),rwe=Mr&&Mr.__setModuleDefault||(Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e}),v8=Mr&&Mr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&twe(e,t,r);return rwe(e,t),e},b8=Mr&&Mr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.Conductor=void 0;var nwe=Oi(),sN=gt(),JS=b8(O8()),re=v8(UR()),iwe=require("node:os"),owe=cc(),swe=b8(require("node:assert")),A8=v8(require("node:zlib")),R8=require("node:util"),awe=(0,R8.promisify)(A8.gzip),uwe=(0,R8.promisify)(A8.gunzip),aN=class{dbosExec;conductorKey;conductorURL;url;websocket=void 0;isShuttingDown=!1;isClosed=!1;pingPeriodMs=2e4;pingTimeoutMs=15e3;pingIntervalTimeout=void 0;reconnectDelayMs=1e3;reconnectTimeout=void 0;constructor(e,r,n){this.dbosExec=e,this.conductorKey=r,this.conductorURL=n;let s=e.appName;(0,swe.default)(s,"Application name must be set in configuration in order to use DBOS Conductor");let a=n.replace(/\/+$/,"");this.url=`${a}/websocket/${s}/${r}`}resetWebsocket(e,r){clearInterval(r?.interval),clearTimeout(r?.timeout),e&&(e.terminate(),this.websocket===e&&(this.websocket=void 0)),!(this.reconnectTimeout||this.isShuttingDown)&&(this.dbosExec.logger.debug(`Reconnecting in ${this.reconnectDelayMs/1e3} second`),this.reconnectTimeout=setTimeout(()=>{this.dispatchLoop()},this.reconnectDelayMs))}setPingInterval(e,r){clearInterval(r.interval),clearTimeout(r.timeout),r.interval=setInterval(()=>{r.timeout=setTimeout(()=>{this.isShuttingDown||this.reconnectTimeout===void 0&&(this.dbosExec.logger.warn("Connection to conductor lost. Reconnecting..."),this.resetWebsocket(e,r))},this.pingTimeoutMs),e.readyState===JS.default.OPEN&&(this.dbosExec.logger.debug("Sending ping to conductor"),e.ping())},this.pingPeriodMs)}dispatchLoop(){if(this.websocket&&(this.websocket.readyState===JS.default.OPEN||this.websocket.readyState===JS.default.CONNECTING)){this.dbosExec.logger.warn("Conductor websocket already exists");return}if(clearTimeout(this.pingIntervalTimeout?.timeout),clearInterval(this.pingIntervalTimeout?.interval),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0,this.isShuttingDown){this.dbosExec.logger.debug("Not starting dispatch loop as conductor is shutting down");return}try{this.dbosExec.logger.debug(`Connecting to conductor at ${this.url}`);let e=new JS.default(this.url,{handshakeTimeout:5e3});this.websocket=e;let r={interval:void 0,timeout:void 0};this.setPingInterval(e,r),this.pingIntervalTimeout=r,e.on("open",()=>{this.dbosExec.logger.debug("Opened connection to DBOS conductor"),clearTimeout(r.timeout)}),e.on("pong",()=>{this.dbosExec.logger.debug("Received pong from conductor"),clearTimeout(r.timeout)}),e.on("message",async n=>{this.dbosExec.logger.debug(`Received message from conductor: ${n}`);let s=JSON.parse(n),a=s.type,o;switch(clearTimeout(r.timeout),a){case re.MessageType.EXECUTOR_INFO:let i=new re.ExecutorInfoResponse(s.request_id,sN.globalParams.executorID,sN.globalParams.appVersion,(0,iwe.hostname)(),"typescript",sN.globalParams.dbosVersion);e.send(JSON.stringify(i)),this.dbosExec.logger.info("Connected to DBOS conductor");break;case re.MessageType.RECOVERY:let u=s,l=!0;try{await this.dbosExec.recoverPendingWorkflows(u.executor_ids)}catch(K){o=`Exception encountered when recovering workflows: ${K.message}`,this.dbosExec.logger.error(o),l=!1}let c=new re.RecoveryResponse(s.request_id,l,o);e.send(JSON.stringify(c));break;case re.MessageType.CANCEL:let f=s,h=!0;try{await this.dbosExec.cancelWorkflow(f.workflow_id)}catch(K){o=`Exception encountered when cancelling workflow ${f.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o),h=!1}let S=new re.CancelResponse(s.request_id,h,o);e.send(JSON.stringify(S));break;case re.MessageType.DELETE:let g=s,E=!0;try{await this.dbosExec.deleteWorkflow(g.workflow_id,g.delete_children??!1)}catch(K){o=`Exception encountered when deleting workflow ${g.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o),E=!1}let T=new re.DeleteResponse(s.request_id,E,o);e.send(JSON.stringify(T));break;case re.MessageType.RESUME:let O=s,v=!0;try{await this.dbosExec.resumeWorkflow(O.workflow_id)}catch(K){o=`Exception encountered when resuming workflow ${O.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o),v=!1}let b=new re.ResumeResponse(s.request_id,v,o);e.send(JSON.stringify(b));break;case re.MessageType.RESTART:let N=s,I=!0;try{await this.dbosExec.forkWorkflow(N.workflow_id,0)}catch(K){o=`Exception encountered when restarting workflow ${N.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o),I=!1}let R=new re.RestartResponse(s.request_id,I,o);e.send(JSON.stringify(R));break;case re.MessageType.FORK_WORKFLOW:let x=s,C=x.body.new_workflow_id;try{C=await this.dbosExec.forkWorkflow(x.body.workflow_id,x.body.start_step,{newWorkflowID:C,applicationVersion:x.body.application_version})}catch(K){o=`Exception encountered when forking workflow ${x.body.workflow_id} to new workflow ${C} on step ${x.body.start_step}, app version ${x.body.application_version}: ${K.message}`,this.dbosExec.logger.error(o),C=void 0}let j=new re.ForkWorkflowResponse(s.request_id,C,o);e.send(JSON.stringify(j));break;case re.MessageType.LIST_WORKFLOWS:let ye=s,H=ye.body,ue={workflowIDs:H.workflow_uuids,workflowName:H.workflow_name,authenticatedUser:H.authenticated_user,startTime:H.start_time,endTime:H.end_time,status:H.status,applicationVersion:H.application_version,forkedFrom:H.forked_from,parentWorkflowID:H.parent_workflow_id,queueName:H.queue_name,limit:H.limit,offset:H.offset,sortDesc:H.sort_desc,workflow_id_prefix:H.workflow_id_prefix,loadInput:H.load_input??!1,loadOutput:H.load_output??!1,executorId:H.executor_id,queuesOnly:H.queues_only},ot=[];try{ot=(await this.dbosExec.listWorkflows(ue)).map(er=>new re.WorkflowsOutput(er))}catch(K){o=`Exception encountered when listing workflows: ${K.message}`,this.dbosExec.logger.error(o)}let fe=new re.ListWorkflowsResponse(ye.request_id,ot,o);e.send(JSON.stringify(fe));break;case re.MessageType.LIST_QUEUED_WORKFLOWS:let ke=s,A=ke.body,D={workflowIDs:A.workflow_uuids,workflowName:A.workflow_name,authenticatedUser:A.authenticated_user,startTime:A.start_time,endTime:A.end_time,status:A.status,applicationVersion:A.application_version,forkedFrom:A.forked_from,parentWorkflowID:A.parent_workflow_id,queueName:A.queue_name,limit:A.limit,offset:A.offset,sortDesc:A.sort_desc,workflow_id_prefix:A.workflow_id_prefix,loadInput:A.load_input??!1,loadOutput:A.load_output??!1,executorId:A.executor_id},me=[];try{me=(await this.dbosExec.listQueuedWorkflows(D)).map(er=>new re.WorkflowsOutput(er))}catch(K){o=`Exception encountered when listing queued workflows: ${K.message}`,this.dbosExec.logger.error(o)}let st=new re.ListQueuedWorkflowsResponse(ke.request_id,me,o);e.send(JSON.stringify(st));break;case re.MessageType.GET_WORKFLOW:let G=s,It;try{let K=await this.dbosExec.getWorkflowStatus(G.workflow_id);K&&(It=new re.WorkflowsOutput(K))}catch(K){o=`Exception encountered when getting workflow ${G.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o)}let gn=new re.GetWorkflowResponse(G.request_id,It,o);e.send(JSON.stringify(gn));break;case re.MessageType.EXIST_PENDING_WORKFLOWS:let Fn=s,qi=!1;try{qi=(await this.dbosExec.systemDatabase.getPendingWorkflows(Fn.executor_id,Fn.application_version)).length>0}catch(K){o=`Exception encountered when checking for pending workflows: ${K.message}`,this.dbosExec.logger.error(o)}let Jc=new re.ExistPendingWorkflowsResponse(s.request_id,qi,o);e.send(JSON.stringify(Jc));break;case re.MessageType.LIST_STEPS:let $n=s,Xc;try{Xc=(await this.dbosExec.listWorkflowSteps($n.workflow_id))?.map(er=>new re.WorkflowSteps(er))}catch(K){o=`Exception encountered when listing steps ${$n.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o)}let Zt=new re.ListStepsResponse($n.request_id,Xc,o);e.send(JSON.stringify(Zt));break;case re.MessageType.RETENTION:let Gn=s,Zc=!0;try{await this.dbosExec.systemDatabase.garbageCollect(Gn.body.gc_cutoff_epoch_ms,Gn.body.gc_rows_threshold),Gn.body.timeout_cutoff_epoch_ms&&await(0,owe.globalTimeout)(this.dbosExec.systemDatabase,Gn.body.timeout_cutoff_epoch_ms)}catch(K){Zc=!1,o=`Exception encountered during enforcing retention policy: ${K.message}`,this.dbosExec.logger.error(o)}let ef=new re.RetentionResponse(Gn.request_id,Zc,o);e.send(JSON.stringify(ef));break;case re.MessageType.GET_METRICS:let Yr=s;this.dbosExec.logger.debug(`Received metrics request for time range ${Yr.start_time} to ${Yr.end_time}`);let Vi=[];if(Yr.metric_class==="workflow_step_count")try{Vi=(await this.dbosExec.systemDatabase.getMetrics(Yr.start_time,Yr.end_time)).map(er=>new re.MetricDataOutput(er.metricType,er.metricName,er.value))}catch(K){o=`Exception encountered when getting metrics: ${K.message}`,this.dbosExec.logger.error(o)}else o=`Unexpected metric class: ${Yr.metric_class}`,this.dbosExec.logger.warn(o);let Yo=new re.GetMetricsResponse(Yr.request_id,Vi,o);e.send(JSON.stringify(Yo));break;case re.MessageType.EXPORT_WORKFLOW:let fu=s,Wn=null;try{let K=await this.dbosExec.systemDatabase.exportWorkflow(fu.workflow_id,fu.export_children??!1);if(K.length>0){let er=JSON.stringify(K);Wn=(await awe(er)).toString("base64")}}catch(K){o=`Exception encountered when exporting workflow ${fu.workflow_id}: ${K.message}`,this.dbosExec.logger.error(o)}let jn=new re.ExportWorkflowResponse(s.request_id,Wn,o);e.send(JSON.stringify(jn));break;case re.MessageType.IMPORT_WORKFLOW:let du=s,tf=!0;try{let K=Buffer.from(du.serialized_workflow,"base64"),er=await uwe(K),SN=JSON.parse(er.toString());await this.dbosExec.systemDatabase.importWorkflow(SN)}catch(K){o=`Exception encountered when importing workflow: ${K.message}`,this.dbosExec.logger.error(o),tf=!1}let rf=new re.ImportWorkflowResponse(s.request_id,tf,o);e.send(JSON.stringify(rf));break;case re.MessageType.ALERT:let zo=s,mN=!0;try{let K=(0,nwe.getAlertHandler)();K?await Promise.resolve(K(zo.name,zo.message,zo.metadata)):this.dbosExec.logger.warn(`Alert received (no handler registered): [${zo.name}] ${zo.message} | Metadata: ${JSON.stringify(zo.metadata)}`)}catch(K){o=`Exception in alert handler: ${K.message}`,this.dbosExec.logger.error(o),mN=!1}let W8=new re.AlertResponse(s.request_id,mN,o);e.send(JSON.stringify(W8));break;default:this.dbosExec.logger.warn(`Unknown message type: ${s.type}`);let j8=new re.BaseResponse(s.type,s.request_id,"Unknown message type");e.send(JSON.stringify(j8))}}),e.on("close",()=>{if(this.isShuttingDown){this.dbosExec.logger.info("Shutdown Conductor connection");return}else this.reconnectTimeout===void 0&&(this.dbosExec.logger.warn("Connection to conductor lost. Reconnecting."),this.resetWebsocket(e,r))}),e.on("unexpected-response",(n,s)=>{this.dbosExec.logger.warn(`Unexpected response from conductor: ${s.statusCode} ${s.statusMessage}}`),this.reconnectTimeout===void 0&&this.resetWebsocket(e,r)}),e.on("error",n=>{this.dbosExec.logger.warn(`Unexpected exception in connection to conductor. Reconnecting: ${n.message}`),this.reconnectTimeout===void 0&&this.resetWebsocket(e,r)})}catch(e){this.dbosExec.logger.warn(`Error in conductor loop. Reconnecting: ${e.message}`),this.reconnectTimeout===void 0&&this.resetWebsocket(this.websocket,this.pingIntervalTimeout)}}stop(){this.isShuttingDown=!0,clearInterval(this.pingIntervalTimeout?.interval),clearTimeout(this.pingIntervalTimeout?.timeout),clearTimeout(this.reconnectTimeout),this.websocket&&this.websocket.close(),this.isClosed=!0}};Mr.Conductor=aN});var I8=p(XS=>{"use strict";Object.defineProperty(XS,"__esModule",{value:!0});XS.registerAuthChecker=void 0;var P8=qm(),uN=mu(),lN=Oi(),lwe=dr();function cwe(t,e){let r=t.getRequiredRoles();if(r.length>0){uN.DBOS.span?.setAttribute("requiredRoles",r);let n=uN.DBOS.authenticatedRoles,s=!1,a=new Set(n);for(let o of r)if(a.has(o)){s=!0,(0,P8.getCurrentContextStore)()&&((0,P8.getCurrentContextStore)().assumedRole=o);break}if(!s){let o=new lwe.DBOSNotAuthorizedError(`User does not have a role with permission to call ${t.name}`,403);throw uN.DBOS.span?.addEvent("DBOSNotAuthorizedError",{message:o.message}),o}}return e}var cN=class{installMiddleware(e){let r=e?.defaults?.getRegisteredInfo(lN.DBOS_AUTH),n=e?.getRegisteredInfo(lN.DBOS_AUTH);(r?.requiredRole!==void 0||n?.requiredRole!==void 0)&&e.addEntryInterceptor(cwe,10)}},fwe=new cN;function dwe(){(0,lN.registerMiddlewareInstaller)(fwe)}XS.registerAuthChecker=dwe});var mu=p(En=>{"use strict";var pwe=En&&En.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(En,"__esModule",{value:!0});En.DBOS=En.runInternalStep=En.getExecutor=void 0;var ne=qm(),Z=Gi(),fN=zy(),M8=Xo(),hwe=Uh(),ce=dr(),au=dz(),_we=xm(),V=Oi(),xt=gt(),jo=wn(),L8=Sz(),dN=require("node:crypto"),mwe=N8(),C8=Am(),D8=oc(),x8=I8(),U8=pwe(require("node:assert"));function k8(){if(!Z.DBOSExecutor.globalInstance)throw new ce.DBOSExecutorNotInitializedError;return Z.DBOSExecutor.globalInstance}En.getExecutor=k8;function Hr(t,e,r,n){if(Ho.isWithinWorkflow()){if(Ho.isInStep())return t();if(Ho.isInWorkflow())return Z.DBOSExecutor.globalInstance.runInternalStep(t,e,Ho.workflowID,n??(0,ne.functionIDGetIncrement)(),r);throw new ce.DBOSInvalidWorkflowTransitionError(`Invalid call to \`${e}\` inside a \`transaction\` or \`procedure\``)}return t()}En.runInternalStep=Hr;var Ho=class t{static adminServer=void 0;static conductor=void 0;static setConfig(e){(0,U8.default)(!t.isInitialized(),"Cannot call DBOS.setConfig after DBOS.launch"),t.#t=e}static isInitialized(){return!!Z.DBOSExecutor.globalInstance?.initialized}static async launch(e){let r=await(0,au.readConfigFile)(),n=t.#t?(0,au.translateDbosConfig)(t.#t):(0,au.getDbosConfig)(r),s=t.#t?(0,au.translateRuntimeConfig)(t.#t):(0,au.getRuntimeConfig)(r);if(process.env.DBOS__CLOUD==="true"&&([n,s]=(0,au.overwriteConfigForDBOSCloud)(n,s,r)),xt.globalParams.enableOTLP=t.#t?.enableOTLP??(0,xt.defaultEnableOTLP)(),(0,fN.isTraceContextWorking)()||(0,fN.installTraceContextManager)(n.name),t.isInitialized())return;(0,V.finalizeClassRegistrations)(),(0,V.insertAllMiddleware)(),process.env.DBOS__CLOUD!=="true"&&(t.#t?.applicationVersion?xt.globalParams.appVersion=t.#t.applicationVersion:t.#t?.enablePatching&&(xt.globalParams.appVersion="PATCHING_ENABLED"),t.#t?.executorID&&(xt.globalParams.executorID=t.#t.executorID)),e?.conductorKey&&(xt.globalParams.executorID=(0,dN.randomUUID)()),Z.DBOSExecutor.createDebouncerWorkflow(),Z.DBOSExecutor.createInternalQueue(),Z.DBOSExecutor.globalInstance=new Z.DBOSExecutor(n),(0,V.recordDBOSLaunch)();let a=Z.DBOSExecutor.globalInstance;await a.init(),await Z.DBOSExecutor.globalInstance.initEventReceivers(this.#t?.listenQueues||null);for(let[i,u]of V.transactionalDataSources)await u.initialize();if(e?.conductorKey){if(!e.conductorURL){let i=process.env.DBOS_DOMAIN||"cloud.dbos.dev";e.conductorURL=`wss://${i}/conductor/v1alpha1`}t.conductor=new mwe.Conductor(Z.DBOSExecutor.globalInstance,e.conductorKey,e.conductorURL),t.conductor.dispatchLoop()}let o=t.logger;if(s.runAdminServer){let i=L8.DBOSAdminServer.setupAdminApp(a);try{await L8.DBOSAdminServer.checkPortAvailabilityIPv4Ipv6(s.admin_port,o),t.adminServer=await new Promise((u,l)=>{let c=i.listen(s?.admin_port,()=>{t.logger.debug(`DBOS Admin Server is running at http://localhost:${s?.admin_port}`),u(c)});c.on("error",f=>{l(f)})})}catch{o.warn(`Unable to start DBOS admin server on port ${s.admin_port}`)}}}static logRegisteredEndpoints(){if(Z.DBOSExecutor.globalInstance){D8.wfQueueRunner.logRegisteredEndpoints(Z.DBOSExecutor.globalInstance);for(let e of(0,V.getLifecycleListeners)())e.logRegisteredEndpoints?.()}}static async shutdown(e){if(t.adminServer&&(t.adminServer.close(),t.adminServer=void 0),t.conductor){for(t.conductor.stop();!t.conductor.isClosed;)await(0,xt.sleepms)(500);t.conductor=void 0}Z.DBOSExecutor.globalInstance&&(await Z.DBOSExecutor.globalInstance.deactivateEventReceivers(),await Z.DBOSExecutor.globalInstance.destroy(),Z.DBOSExecutor.globalInstance=void 0);for(let[r,n]of V.transactionalDataSources)await n.destroy();xt.globalParams.appVersion=process.env.DBOS__APPVERSION||"",xt.globalParams.wasComputed=!1,xt.globalParams.appID=process.env.DBOS__APPID||"",xt.globalParams.executorID=process.env.DBOS__VMID||"local",(0,V.recordDBOSShutdown)(),e?.deregister&&t.clearRegistry()}static clearRegistry(){(0,U8.default)(!t.isInitialized(),"Cannot call DBOS.clearRegistry after DBOS.launch"),(0,V.clearAllRegistrations)(),D8.wfQueueRunner.clearRegistrations(),Z.DBOSExecutor.debouncerWorkflow=void 0,Z.DBOSExecutor.internalQueue=void 0}static async deactivateEventReceivers(){return Z.DBOSExecutor.globalInstance?.deactivateEventReceivers()}static async initEventReceivers(){return Z.DBOSExecutor.globalInstance?.initEventReceivers(this.#t?.listenQueues||null)}static get#e(){return k8()}static#t;static get logger(){let e=(0,ne.getCurrentContextStore)();if(e?.logger)return e.logger;let r=Z.DBOSExecutor.globalInstance;return r?r.logger:new hwe.GlobalLogger}static get tracer(){let e=Z.DBOSExecutor.globalInstance;if(e)return e.tracer}static get span(){return(0,fN.getActiveSpan)()}static requestObject(){return(0,ne.getCurrentContextStore)()?.request}static getRequest(){return this.requestObject()}static get request(){let e=t.getRequest();if(!e)throw new ce.DBOSError("`DBOS.request` accessed from outside of HTTP requests");return e}static get applicationVersion(){return xt.globalParams.appVersion}static get executorID(){return xt.globalParams.executorID}static get workflowID(){return(0,ne.getCurrentContextStore)()?.workflowId}static get defaultSerializationType(){return(0,ne.getCurrentContextStore)()?.serializationType}static get stepID(){return t.isInStep()?(0,ne.getCurrentContextStore)()?.curStepFunctionId:t.isInTransaction()?(0,ne.getCurrentContextStore)()?.curTxFunctionId:void 0}static get stepStatus(){return(0,ne.getCurrentContextStore)()?.stepStatus}static get authenticatedUser(){return(0,ne.getCurrentContextStore)()?.authenticatedUser??""}static get authenticatedRoles(){return(0,ne.getCurrentContextStore)()?.authenticatedRoles??[]}static get assumedRole(){return(0,ne.getCurrentContextStore)()?.assumedRole??""}static isInTransaction(){return(0,ne.getCurrentContextStore)()?.curTxFunctionId!==void 0}static isInStep(){return(0,ne.getCurrentContextStore)()?.curStepFunctionId!==void 0}static isWithinWorkflow(){return(0,ne.getCurrentContextStore)()?.workflowId!==void 0}static isInWorkflow(){return t.isWithinWorkflow()&&!t.isInTransaction()&&!t.isInStep()}static async getEventDispatchState(e,r,n){return(0,V.ensureDBOSIsLaunched)("getEventDispatchState"),await t.#e.getEventDispatchState(e,r,n)}static async upsertEventDispatchState(e){return(0,V.ensureDBOSIsLaunched)("upsertEventDispatchState"),await t.#e.upsertEventDispatchState(e)}static getWorkflowStatus(e){if((0,V.ensureDBOSIsLaunched)("getWorkflowStatus"),t.isWithinWorkflow()){if(t.isInStep())return t.#e.getWorkflowStatus(e);if(t.isInWorkflow())return t.#e.getWorkflowStatus(e,t.workflowID,(0,ne.functionIDGetIncrement)());throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `getWorkflowStatus` inside a `transaction` or `procedure`")}return t.#e.getWorkflowStatus(e)}static async getResult(e,r){(0,V.ensureDBOSIsLaunched)("getResult");let n;return t.isWithinWorkflow()&&r!==void 0&&(n=(0,ne.functionIDGetIncrement)()),await t.getResultInternal(e,r,n,void 0)}static async getResultInternal(e,r,n,s){return await Hr(async()=>{let a=await Z.DBOSExecutor.globalInstance.systemDatabase.awaitWorkflowResult(e,r,t.workflowID,n);if(!a)return null;if(a?.cancelled)throw new ce.DBOSAwaitedWorkflowCancelledError(e);return Z.DBOSExecutor.reviveResultOrError(a,t.#e.serializer)},"DBOS.getResult",e,s)}static retrieveWorkflow(e){if((0,V.ensureDBOSIsLaunched)("retrieveWorkflow"),t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `retrieveWorkflow` inside a `transaction` or `step`");return new M8.RetrievedHandle(Z.DBOSExecutor.globalInstance.systemDatabase,e)}return t.#e.retrieveWorkflow(e)}static async listWorkflows(e){return(0,V.ensureDBOSIsLaunched)("listWorkflows"),await Hr(async()=>await t.#e.listWorkflows(e),"DBOS.listWorkflows")}static async listQueuedWorkflows(e){return(0,V.ensureDBOSIsLaunched)("listQueuedWorkflows"),await Hr(async()=>await t.#e.listQueuedWorkflows(e),"DBOS.listQueuedWorkflows")}static async listWorkflowSteps(e){return(0,V.ensureDBOSIsLaunched)("listWorkflowSteps"),await Hr(async()=>await t.#e.listWorkflowSteps(e),"DBOS.listWorkflowSteps")}static async cancelWorkflow(e){return(0,V.ensureDBOSIsLaunched)("cancelWorkflow"),await Hr(async()=>await t.#e.cancelWorkflow(e),"DBOS.cancelWorkflow")}static async resumeWorkflow(e){return(0,V.ensureDBOSIsLaunched)("resumeWorkflow"),await Hr(async()=>await t.#e.resumeWorkflow(e),"DBOS.resumeWorkflow"),this.retrieveWorkflow(e)}static async deleteWorkflow(e,r=!1){return(0,V.ensureDBOSIsLaunched)("deleteWorkflow"),await Hr(async()=>await t.#e.deleteWorkflow(e,r),"DBOS.deleteWorkflow")}static async forkWorkflow(e,r,n){(0,V.ensureDBOSIsLaunched)("forkWorkflow");let s=await Hr(async()=>await t.#e.forkWorkflow(e,r,n),"DBOS.forkWorkflow");return this.retrieveWorkflow(s)}static async sleepms(e){if(t.isWithinWorkflow()&&!t.isInStep()){if(t.isInTransaction())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.sleep` inside a `transaction`");let r=(0,ne.functionIDGetIncrement)();return e<=0?void 0:await Z.DBOSExecutor.globalInstance.systemDatabase.durableSleepms(t.workflowID,r,e)}await(0,xt.sleepms)(e)}static async sleepSeconds(e){return t.sleepms(e*1e3)}static async sleep(e){return t.sleepms(e)}static async now(){return t.isInWorkflow()?Hr(async()=>Promise.resolve(Date.now()),"DBOS.now"):Date.now()}static async randomUUID(){return t.isInWorkflow()?Hr(async()=>Promise.resolve((0,dN.randomUUID)()),"DBOS.randomUUID"):(0,dN.randomUUID)()}static async withNextWorkflowID(e,r){return(0,V.ensureDBOSIsLaunched)("workflows"),t.#r({idAssignedForNextWorkflow:e},r)}static async withAuthedContext(e,r,n){return(0,V.ensureDBOSIsLaunched)("auth"),t.#r({authenticatedUser:e,authenticatedRoles:r},n)}static async withNamedContext(e,r){return(0,V.ensureDBOSIsLaunched)("tracing"),t.#r({operationCaller:e},r)}static async withWorkflowQueue(e,r){return(0,V.ensureDBOSIsLaunched)("workflows"),t.#r({queueAssignedForWorkflows:e},r)}static async withWorkflowTimeout(e,r){return(0,V.ensureDBOSIsLaunched)("workflows"),t.#r({workflowTimeoutMS:e},r)}static async runWithContext(e,r){return(0,V.ensureDBOSIsLaunched)("contexts"),t.#r(e,r)}static async#r(e,r){let n=(0,ne.getCurrentContextStore)();if(n){let s={};for(let a of Object.keys(e))Object.hasOwn(n,a)&&(s[a]=e[a]),n[a]=e[a];try{return await r()}finally{for(let a of Object.keys(e))Object.hasOwn(s,a)?n[a]=s[a]:delete n[a]}}else return await(0,ne.runWithTopContext)(e,r)}static startWorkflow(e,r){(0,V.ensureDBOSIsLaunched)("workflows");let n=typeof e=="function"?null:e;if(n&&typeof n!="function"&&!(n instanceof V.ConfiguredInstance))throw new ce.DBOSInvalidWorkflowTransitionError("Attempt to call `startWorkflow` on an object that is not a `ConfiguredInstance`");if(r&&r.queueName){let o=this.#e.getQueueByName(r.queueName),i=r.enqueueOptions?.queuePartitionKey;if(o.partitionQueue&&!i)throw Error(`A workflow cannot be enqueued on partitioned queue ${r.queueName} without a partition key`);if(i&&!o.partitionQueue)throw Error(`You can only use a partition key on a partition-enabled queue. Key ${i} was used with non-partitioned queue ${r.queueName}`);if(i&&r.enqueueOptions?.deduplicationID)throw Error("Deduplication is not supported for partitioned queues")}let s=(0,V.getRegisteredOperations)(e),a={apply(o,i,u){let l=(0,V.getFunctionRegistration)(o);if(!l){let c=typeof o=="function"?o.name:o.toString();throw new ce.DBOSNotRegisteredError(c,`${c} is not a registered DBOS workflow function`)}return t.#n(n,l,u,r)},get(o,i,u){let l=Reflect.get(o,i,u),c=(0,V.getFunctionRegistration)(l)??s.find(h=>h.name===i);if(c)return(...h)=>t.#n(n,c,h,r);let f=typeof i=="string"?i:String(i);throw new ce.DBOSNotRegisteredError(f,`${f} is not a registered DBOS workflow function`)}};return new Proxy(e,a)}static async send(e,r,n,s,a){if((0,V.ensureDBOSIsLaunched)("send"),t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.send` inside a `step` or `transaction`");if(s)throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.send` with an idempotency key from within a workflow");let o=(0,ne.functionIDGetIncrement)(),i=(0,jo.serializeValue)(r,t.#e.serializer,a?.serializationType??t.defaultSerializationType);return await Z.DBOSExecutor.globalInstance.systemDatabase.send(t.workflowID,o,e,i.serializedValue,n,i.serialization)}return t.#e.runSendTempWF(e,r,n,s,a?.serializationType??t.defaultSerializationType)}static async recv(e,r){if((0,V.ensureDBOSIsLaunched)("recv"),t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.recv` inside a `step` or `transaction`");let n=(0,ne.functionIDGetIncrement)(),s=(0,ne.functionIDGetIncrement)(),a=await Z.DBOSExecutor.globalInstance.systemDatabase.recv(t.workflowID,n,s,e,r);return(0,jo.deserializeValue)(a.serializedValue,a.serialization,t.#e.serializer)}throw new ce.DBOSInvalidWorkflowTransitionError("Attempt to call `DBOS.recv` outside of a workflow")}static async setEvent(e,r,n){if((0,V.ensureDBOSIsLaunched)("setEvent"),t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.setEvent` inside a `step` or `transaction`");let s=(0,ne.functionIDGetIncrement)(),a=(0,jo.serializeValue)(r,t.#e.serializer,n?.serializationType??t.defaultSerializationType);return Z.DBOSExecutor.globalInstance.systemDatabase.setEvent(t.workflowID,s,e,a.serializedValue,a.serialization)}throw new ce.DBOSInvalidWorkflowTransitionError("Attempt to call `DBOS.setEvent` outside of a workflow")}static async getEvent(e,r,n){if((0,V.ensureDBOSIsLaunched)("getEvent"),t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.getEvent` inside a `step` or `transaction`");let s=(0,ne.functionIDGetIncrement)(),a=(0,ne.functionIDGetIncrement)(),o={workflowID:t.workflowID,functionID:s,timeoutFunctionID:a},i=await Z.DBOSExecutor.globalInstance.systemDatabase.getEvent(e,r,n??Z.DBOSExecutor.defaultNotificationTimeoutSec,o);return(0,jo.deserializeValue)(i.serializedValue,i.serialization,t.#e.serializer)}return t.#e.getEvent(e,r,n)}static async writeStream(e,r,n={}){if((0,V.ensureDBOSIsLaunched)("writeStream"),t.isWithinWorkflow()){let s=(0,jo.serializeValue)(r,t.#e.serializer,n.serializationType??t.defaultSerializationType);if(t.isInWorkflow()){let a=(0,ne.functionIDGetIncrement)();return await Z.DBOSExecutor.globalInstance.systemDatabase.writeStreamFromWorkflow(t.workflowID,a,e,s.serializedValue,s.serialization,C8.DBOS_FUNCNAME_WRITESTREAM)}else{if(t.isInStep())return await Z.DBOSExecutor.globalInstance.systemDatabase.writeStreamFromStep(t.workflowID,t.stepID,e,s.serializedValue,s.serialization);throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.writeStream` outside of a workflow or step")}}else throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.writeStream` outside of a workflow or step")}static async closeStream(e){if((0,V.ensureDBOSIsLaunched)("closeStream"),t.isWithinWorkflow())if(t.isInWorkflow()){let r=(0,ne.functionIDGetIncrement)();return await Z.DBOSExecutor.globalInstance.systemDatabase.closeStream(t.workflowID,r,e)}else throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.closeStream` outside of a workflow or step");else throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to `DBOS.closeStream` outside of a workflow")}static async*readStream(e,r){(0,V.ensureDBOSIsLaunched)("readStream");let n=0;for(;;)try{let s=await Z.DBOSExecutor.globalInstance.systemDatabase.readStream(e,r,n);if(s.serializedValue===C8.DBOS_STREAM_CLOSED_SENTINEL)break;yield(0,jo.deserializeValue)(s.serializedValue,s.serialization,Z.DBOSExecutor.globalInstance.serializer),n+=1}catch(s){if(s instanceof Error&&s.message.includes("No value found")){let a=await t.getWorkflowStatus(e);if(!a||!(0,M8.isWorkflowActive)(a.status))break;await(0,xt.sleepms)(1e3);continue}throw s}}static registerScheduled(e,r){_we.ScheduledReceiver.registerScheduled(e,r)}static className(e){function r(n){let s=(0,V.getClassRegistration)(n,!0);if(s.reg?.name&&s.reg.name!==e&&s.reg.name!==n.name)throw new ce.DBOSConflictingRegistrationError(`Attempt to assign name ${e} to class ${n.name}, which has already been aliased to ${s.reg.name}`);s.reg.name=e}return r}static scheduled(e){function r(n,s,a){return a.value&&t.registerScheduled(a.value,{...e,ctorOrProto:n,name:String(s)}),a}return r}static workflow(e={}){function r(n,s,a){let{descriptor:o,registration:i}=(0,V.wrapDBOSFunctionAndRegisterByTarget)(n,s,e.name??s,a),u=t.#i(i,e);return o.value=u,i.wrappedFunction=u,(0,V.registerFunctionWrapper)(u,i),o}return r}static registerWorkflow(e,r){let n=(0,V.wrapDBOSFunctionAndRegisterByUniqueName)(r?.ctorOrProto,r?.className,r?.name??e.name,r?.name??e.name,e);return t.#i(n,r)}static async#n(e,r,n,s={},a){(0,V.ensureDBOSIsLaunched)("workflows");let o=(0,ne.getNextWFID)(s.workflowID),i=(0,ne.getCurrentContextStore)(),u=s.queueName??i?.queueAssignedForWorkflows,l=s.timeoutMS??i?.workflowTimeoutMS,c=e===void 0||typeof e=="function"?void 0:e;if(c&&!(c instanceof V.ConfiguredInstance))throw new ce.DBOSInvalidWorkflowTransitionError("Attempt to call a `workflow` function on an object that is not a `ConfiguredInstance`");if(t.isWithinWorkflow()){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to a `workflow` function from within a `step` or `transaction`");let h=a??(0,ne.functionIDGetIncrement)(),S=(0,ne.getCurrentContextStore)(),g=S.workflowId,E={workflowUUID:o||g+"-"+h,configuredInstance:c,queueName:u,timeoutMS:l,deadlineEpochMS:s.timeoutMS===null||S?.workflowTimeoutMS===null?void 0:S?.deadlineEpochMS,enqueueOptions:s.enqueueOptions};return await f(E,g,h)}else{let h={workflowUUID:o,queueName:u,enqueueOptions:s.enqueueOptions,configuredInstance:c,timeoutMS:l};return await f(h,void 0,void 0)}function f(h,S,g){if(r.workflowConfig){let E=r.registeredFunction;return Z.DBOSExecutor.globalInstance.internalWorkflow(E,h,S,g,...n)}if(r.stepConfig){let E=r.registeredFunction;return Z.DBOSExecutor.globalInstance.startStepTempWF(E,h,S,g,...n)}throw new ce.DBOSNotRegisteredError(r.name,`${r.name} is not a registered DBOS workflow, step, or transaction function`)}}static#i(e,r){e.setWorkflowConfig(r??{});let n=async function(...s){if((0,V.ensureDBOSIsLaunched)("workflows"),t.isInWorkflow()){let o=(0,ne.functionIDGetIncrement)(),i=(0,ne.functionIDGetIncrement)();return await(await t.#n(this,e,s,void 0,o)).getResult(i)}return await(await t.#n(this,e,s)).getResult()};return(0,V.registerFunctionWrapper)(n,e),Object.defineProperty(n,"name",{value:e.name}),n}static step(e={}){function r(n,s,a){let{descriptor:o,registration:i}=(0,V.wrapDBOSFunctionAndRegisterByTarget)(n,s,e.name,a);i.setStepConfig(e);let u=async function(...l){(0,V.ensureDBOSIsLaunched)("steps");let c;if(!(this===void 0||typeof this=="function")){if(c=this,!(c instanceof V.ConfiguredInstance))throw new ce.DBOSInvalidWorkflowTransitionError("Attempt to call a `step` function on an object that is not a `ConfiguredInstance`")}if(t.isWithinWorkflow()){if(t.isInTransaction())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to a `step` function from within a `transaction`");return t.isInStep()?i.registeredFunction.call(this,...l):await Z.DBOSExecutor.globalInstance.callStepFunction(i.registeredFunction,void 0,void 0,c??null,...l)}let f=(0,ne.getNextWFID)(void 0),h={configuredInstance:c,workflowUUID:f};return await t.#e.runStepTempWF(i.registeredFunction,h,...l)};return o.value=u,i.wrappedFunction=u,(0,V.registerFunctionWrapper)(u,i),Object.defineProperty(u,"name",{value:i.name}),o}return r}static registerStep(e,r={}){let n=r.name??e.name,s=(0,V.wrapDBOSFunctionAndRegister)(r?.ctorOrProto,r?.className,n,n,e),a=async function(...o){(0,V.ensureDBOSIsLaunched)("steps");let i=this,u=s.registeredFunction??s.origFunction;if(t.isWithinWorkflow()){if(t.isInTransaction())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to a `step` function from within a `transaction`");return t.isInStep()?u.call(this,...o):await Z.DBOSExecutor.globalInstance.callStepFunction(u,n,r,i??null,...o)}if((0,ne.getNextWFID)(void 0))throw new ce.DBOSInvalidWorkflowTransitionError(`Invalid call to step '${n}' outside of a workflow; with directive to start a workflow.`);return u.call(this,...o)};return(0,V.registerFunctionWrapper)(a,s),Object.defineProperty(a,"name",{value:n}),a}static runStep(e,r={}){(0,V.ensureDBOSIsLaunched)("steps");let n=r.name??e.name;if(t.isWithinWorkflow()){if(t.isInTransaction())throw new ce.DBOSInvalidWorkflowTransitionError("Invalid call to a runStep from within a `transaction`");return t.isInStep()?e():Z.DBOSExecutor.globalInstance.callStepFunction(e,n,r,null)}if((0,ne.getNextWFID)(void 0))throw new ce.DBOSInvalidWorkflowTransitionError(`Invalid call to step '${n}' outside of a workflow; with directive to start a workflow.`);return e()}static registerSerialization(e){if(t.isInitialized())throw new TypeError("Serializers/deserializers should not be registered after DBOS.launch()");(0,jo.registerSerializationRecipe)(e)}static defaultRequiredRole(e){function r(n){let s=(0,V.associateClassWithExternal)(V.DBOS_AUTH,n);s.requiredRole=e,(0,x8.registerAuthChecker)()}return r}static requiredRole(e){function r(n,s,a){let o=(0,V.associateMethodWithExternal)(V.DBOS_AUTH,n,void 0,s.toString(),a.value);return o.regInfo.requiredRole=e,(0,x8.registerAuthChecker)(),a.value=o.registration.wrappedFunction??o.registration.registeredFunction,a}return r}static async patch(e){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("`DBOS.patch` must be called from a workflow, and not within a step");if(!t.#t?.enablePatching)throw new ce.DBOSInvalidWorkflowTransitionError("Patching is not enabled.  See `enablePatching` in `DBOSConfig`");let r=await Z.DBOSExecutor.globalInstance.systemDatabase.checkPatch(t.workflowID,(0,ne.functionIDGet)(),e,!1);return r.hasEntry&&(0,ne.functionIDGetIncrement)(),r.isPatched}static async deprecatePatch(e){if(!t.isInWorkflow())throw new ce.DBOSInvalidWorkflowTransitionError("`DBOS.deprecatePatch` must be called from a workflow, and not within a step");if(!t.#t?.enablePatching)throw new ce.DBOSInvalidWorkflowTransitionError("Patching is not enabled.  See `enablePatching` in `DBOSConfig`");let r=await Z.DBOSExecutor.globalInstance.systemDatabase.checkPatch(t.workflowID,(0,ne.functionIDGet)(),e,!0);return r.hasEntry&&(0,ne.functionIDGetIncrement)(),r.isPatched}static registerLifecycleCallback(e){(0,V.registerLifecycleCallback)(e)}static registerMiddlewareInstaller(e){(0,V.registerMiddlewareInstaller)(e)}static associateClassWithInfo(e,r){return(0,V.associateClassWithExternal)(e,r)}static associateFunctionWithInfo(e,r,n){return(0,V.associateMethodWithExternal)(e,n.ctorOrProto,n.className,n.name??r.name,r)}static associateParamWithInfo(e,r,n){return(0,V.associateParameterWithExternal)(e,n.ctorOrProto,n.className,n.name??r?.name??"<unknown>",r,n.param)}static getAssociatedInfo(e,r,n){return(0,V.getRegistrationsForExternal)(e,r,n)}static setAlertHandler(e){if(t.isInitialized())throw new ce.DBOSError("Cannot set alert handler after DBOS.launch()");if((0,V.getAlertHandler)())throw new ce.DBOSError("Alert handler is already registered. Only one handler is allowed.");(0,V.setAlertHandler)(e)}};En.DBOS=Ho});var B8=p(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});cu.DBOSClient=cu.ClientHandle=void 0;var pN=Am(),Swe=Uh(),hN=require("node:crypto"),ZS=Xo(),Ewe=gt(),Bi=wn(),uu=cc(),gwe=Gi(),ywe=dr(),lu=class{systemDatabase;workflowUUID;constructor(e,r){this.systemDatabase=e,this.workflowUUID=r}getWorkflowUUID(){return this.workflowUUID}get workflowID(){return this.workflowUUID}async getStatus(){let e=await this.systemDatabase.getWorkflowStatus(this.workflowUUID);return e?(0,uu.toWorkflowStatus)(e,this.systemDatabase.getSerializer()):null}async getResult(){let e=await this.systemDatabase.awaitWorkflowResult(this.workflowID);if(e?.cancelled)throw new ywe.DBOSAwaitedWorkflowCancelledError(this.workflowID);return gwe.DBOSExecutor.reviveResultOrError(e,this.systemDatabase.getSerializer())}async getWorkflowInputs(){let e=await this.systemDatabase.getWorkflowStatus(this.workflowUUID);return(0,Bi.deserializePositionalArgs)(e.input,e.serialization,this.systemDatabase.getSerializer())}};cu.ClientHandle=lu;var _N=class t{serializer;logger;systemDatabase;constructor(e,r,n){this.serializer=n,this.logger=new Swe.GlobalLogger,this.systemDatabase=new pN.PostgresSystemDatabase(e,this.logger,n,pN.DEFAULT_POOL_SIZE,r)}static async create({systemDatabaseUrl:e,systemDatabasePool:r,serializer:n}){let s=new t(e,r,n??Bi.DBOSJSON);return Promise.resolve(s)}async destroy(){await this.systemDatabase.destroy()}async enqueue(e,...r){let{workflowName:n,workflowClassName:s,workflowConfigName:a,queueName:o,appVersion:i}=e,u=e.workflowID??(0,hN.randomUUID)(),l=(0,Bi.serializeArgs)(r,void 0,this.serializer,e?.serializationType),c={workflowUUID:u,status:ZS.StatusString.ENQUEUED,workflowName:n,workflowClassName:s??"",workflowConfigName:a??"",queueName:o,authenticatedUser:"",output:null,error:null,assumedRole:"",authenticatedRoles:[],request:{},executorId:"",applicationVersion:i,applicationID:"",createdAt:Date.now(),timeoutMS:e.workflowTimeoutMS,deadlineEpochMS:void 0,input:l.serializedValue,deduplicationID:e.deduplicationID,priority:e.priority??0,queuePartitionKey:e.queuePartitionKey,serialization:l.serialization};return await this.systemDatabase.initWorkflowStatus(c,null),new lu(this.systemDatabase,u)}async enqueuePortable(e,r,n){let{workflowName:s,workflowClassName:a,workflowConfigName:o,queueName:i,appVersion:u}=e,l=e.workflowID??(0,hN.randomUUID)(),c=(0,Bi.serializeArgs)(r,n,this.serializer,e?.serializationType??"portable"),f={workflowUUID:l,status:ZS.StatusString.ENQUEUED,workflowName:s,workflowClassName:a??"",workflowConfigName:o??"",queueName:i,authenticatedUser:"",output:null,error:null,assumedRole:"",authenticatedRoles:[],request:{},executorId:"",applicationVersion:u,applicationID:"",createdAt:Date.now(),timeoutMS:e.workflowTimeoutMS,deadlineEpochMS:void 0,input:c.serializedValue,deduplicationID:e.deduplicationID,priority:e.priority??0,queuePartitionKey:e.queuePartitionKey,serialization:c.serialization};return await this.systemDatabase.initWorkflowStatus(f,null),new lu(this.systemDatabase,l)}async send(e,r,n,s,a){s??=(0,hN.randomUUID)();let o=(0,Bi.serializeValue)(r,this.serializer,a?.serializationType),i=(0,Bi.serializeArgs)([e,r,n,a?.serializationType],void 0,this.serializer,a?.serializationType),u={workflowUUID:`${e}-${s}`,status:ZS.StatusString.SUCCESS,workflowName:"temp_workflow-send-client",workflowClassName:"",workflowConfigName:"",authenticatedUser:"",output:null,error:null,assumedRole:"",authenticatedRoles:[],request:{},executorId:"",applicationID:"",createdAt:Date.now(),input:i.serializedValue,deduplicationID:void 0,priority:0,queuePartitionKey:void 0,serialization:i.serialization};await this.systemDatabase.initWorkflowStatus(u,null),await this.systemDatabase.send(u.workflowUUID,0,e,o.serializedValue,n,o.serialization)}async getEvent(e,r,n){let s=await this.systemDatabase.getEvent(e,r,n??60);return(0,Bi.deserializeValue)(s.serializedValue,s.serialization,this.serializer)}retrieveWorkflow(e){return new lu(this.systemDatabase,e)}cancelWorkflow(e){return this.systemDatabase.cancelWorkflow(e)}resumeWorkflow(e){return this.systemDatabase.resumeWorkflow(e)}forkWorkflow(e,r,n){return(0,uu.forkWorkflow)(this.systemDatabase,e,r,n)}getWorkflow(e){return(0,uu.getWorkflow)(this.systemDatabase,e)}listWorkflows(e){return(0,uu.listWorkflows)(this.systemDatabase,e)}listQueuedWorkflows(e){return(0,uu.listQueuedWorkflows)(this.systemDatabase,e)}listWorkflowSteps(e){return(0,uu.listWorkflowSteps)(this.systemDatabase,e)}async*readStream(e,r){let n=0;for(;;)try{let s=await this.systemDatabase.readStream(e,r,n);if(s.serializedValue===pN.DBOS_STREAM_CLOSED_SENTINEL)break;yield(0,Bi.deserializeValue)(s.serializedValue,s.serialization,this.serializer),n+=1}catch(s){if(s instanceof Error&&s.message.includes("No value found")){let a=await this.getWorkflow(e);if(!a||!(0,ZS.isWorkflowActive)(a.status))break;await(0,Ewe.sleepms)(1e3);continue}throw s}}};cu.DBOSClient=_N});var uc=p(pe=>{"use strict";var Twe=pe&&pe.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(e,r);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,s)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),wwe=pe&&pe.__setModuleDefault||(Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e}),Owe=pe&&pe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Twe(e,t,r);return wwe(e,t),e};Object.defineProperty(pe,"__esModule",{value:!0});pe.MethodParameter=pe.ConfiguredInstance=pe.DebouncerClient=pe.Debouncer=pe.StatusString=pe.DBOSWorkflowConflictError=pe.Error=pe.WorkflowQueue=pe.ArgName=pe.DBOSDataType=pe.SchedulerMode=pe.DBOSClient=pe.DBOS=void 0;var vwe=mu();Object.defineProperty(pe,"DBOS",{enumerable:!0,get:function(){return vwe.DBOS}});var bwe=B8();Object.defineProperty(pe,"DBOSClient",{enumerable:!0,get:function(){return bwe.DBOSClient}});var Awe=xm();Object.defineProperty(pe,"SchedulerMode",{enumerable:!0,get:function(){return Awe.SchedulerMode}});var q8=Oi();Object.defineProperty(pe,"DBOSDataType",{enumerable:!0,get:function(){return q8.DBOSDataType}});Object.defineProperty(pe,"ArgName",{enumerable:!0,get:function(){return q8.ArgName}});var Rwe=oc();Object.defineProperty(pe,"WorkflowQueue",{enumerable:!0,get:function(){return Rwe.WorkflowQueue}});pe.Error=Owe(dr());var Nwe=dr();Object.defineProperty(pe,"DBOSWorkflowConflictError",{enumerable:!0,get:function(){return Nwe.DBOSWorkflowConflictError}});var Pwe=Xo();Object.defineProperty(pe,"StatusString",{enumerable:!0,get:function(){return Pwe.StatusString}});var V8=mA();Object.defineProperty(pe,"Debouncer",{enumerable:!0,get:function(){return V8.Debouncer}});Object.defineProperty(pe,"DebouncerClient",{enumerable:!0,get:function(){return V8.DebouncerClient}});var F8=Oi();Object.defineProperty(pe,"ConfiguredInstance",{enumerable:!0,get:function(){return F8.ConfiguredInstance}});Object.defineProperty(pe,"MethodParameter",{enumerable:!0,get:function(){return F8.MethodParameter}})});var G8=X8(uc()),$8=process.argv[2];async function Iwe(){console.log(`Using DB URL: ${$8}`);let t=await G8.DBOSClient.create({systemDatabaseUrl:$8});try{let e=await t.enqueuePortable({workflowName:"workflowPortable",workflowClassName:"workflows",queueName:"testq"},["s",1,{k:"k",v:["v"]}]);await t.send(e.workflowID,"m","incoming",void 0,{serializationType:"portable"});let r=await e.getResult();console.assert(r==='s-1-k:v@"m"')}finally{await t.destroy()}}Iwe().then(()=>{}).catch(console.error);
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
